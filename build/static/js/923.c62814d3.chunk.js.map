{"version":3,"file":"static/js/923.c62814d3.chunk.js","mappings":"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","sources":["components/OTA.tsx","services/cacheService.ts","services/api.ts"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { apiService } from '../services/api';\r\nimport '../App.css';\r\n\r\ninterface FirmwareVersion {\r\n  id: number;\r\n  version: string;\r\n  filename: string;\r\n  size: number;\r\n  checksum?: string;\r\n  description?: string;\r\n  release_notes?: string;\r\n  is_active: boolean;\r\n  created_at: string;\r\n}\r\n\r\ninterface OTAConfig {\r\n  enable_auto_update: boolean;\r\n  update_strategy: 'immediate' | 'scheduled' | 'manual';\r\n  max_concurrent_updates: number;\r\n  firmware_retention_days: number;\r\n}\r\n\r\ninterface OTAHealth {\r\n  status: string;\r\n  service: string;\r\n  firmware_versions: number;\r\n  active_firmware: number;\r\n  timestamp: string;\r\n}\r\n\r\nexport const OTA: React.FC = () => {\r\n  const [firmwares, setFirmwares] = useState<FirmwareVersion[]>([]);\r\n  const [config, setConfig] = useState<OTAConfig | null>(null);\r\n  const [health, setHealth] = useState<OTAHealth | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [uploadingFile, setUploadingFile] = useState<File | null>(null);\r\n  const [uploadingMetadata, setUploadingMetadata] = useState({\r\n    version: '',\r\n    description: '',\r\n    release_notes: '',\r\n  });\r\n  const [configForm, setConfigForm] = useState<OTAConfig | null>(null);\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n  const [errorMessage, setErrorMessage] = useState('');\r\n\r\n  useEffect(() => {\r\n    loadOTAData();\r\n  }, []);\r\n\r\n  const loadOTAData = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const [fwRes, configRes, healthRes] = await Promise.all([\r\n        apiService.getFirmwareVersions(false),\r\n        apiService.getOTAConfig(),\r\n        apiService.getOTAHealth(),\r\n      ]);\r\n\r\n      setFirmwares(fwRes);\r\n      setConfig(configRes);\r\n      setConfigForm(configRes);\r\n      setHealth(healthRes);\r\n    } catch (error: any) {\r\n      setErrorMessage(error.message || 'Failed to load OTA data');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files?.[0]) {\r\n      setUploadingFile(e.target.files[0]);\r\n    }\r\n  };\r\n\r\n  const handleUploadFirmware = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!uploadingFile || !uploadingMetadata.version) {\r\n      setErrorMessage('Please select a file and enter version number');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      const formData = new FormData();\r\n      formData.append('file', uploadingFile);\r\n      formData.append('version', uploadingMetadata.version);\r\n      formData.append('filename', uploadingFile.name);\r\n      formData.append('size', uploadingFile.size.toString());\r\n      formData.append('description', uploadingMetadata.description || '');\r\n      formData.append('release_notes', uploadingMetadata.release_notes || '');\r\n      formData.append('is_active', 'false');\r\n\r\n      await apiService.uploadFirmwareVersion(formData);\r\n      setSuccessMessage('Firmware uploaded successfully');\r\n      setUploadingFile(null);\r\n      setUploadingMetadata({ version: '', description: '', release_notes: '' });\r\n      loadOTAData();\r\n    } catch (error: any) {\r\n      setErrorMessage(error.message || 'Failed to upload firmware');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleToggleFirmwareActive = async (firmware: FirmwareVersion) => {\r\n    try {\r\n      setLoading(true);\r\n      await apiService.updateFirmwareVersion(firmware.id, {\r\n        is_active: !firmware.is_active,\r\n      });\r\n      setSuccessMessage(`Firmware ${!firmware.is_active ? 'activated' : 'deactivated'} successfully`);\r\n      loadOTAData();\r\n    } catch (error: any) {\r\n      setErrorMessage(error.message || 'Failed to update firmware status');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSaveConfig = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!configForm) return;\r\n\r\n    try {\r\n      setLoading(true);\r\n      await apiService.updateOTAConfig(configForm);\r\n      setSuccessMessage('OTA configuration updated successfully');\r\n      setConfig(configForm);\r\n    } catch (error: any) {\r\n      setErrorMessage(error.message || 'Failed to update configuration');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"admin-container\">\r\n      <div className=\"admin-header\">\r\n        <h1>Over-The-Air (OTA) Updates</h1>\r\n        <div className=\"health-status\">\r\n          {health && (\r\n            <>\r\n              <span className={`status-badge status-badge-${health.status === 'ok' ? 'success' : 'danger'}`}>\r\n                {health.status.toUpperCase()}\r\n              </span>\r\n              <span className=\"ml-2\">\r\n                {health.firmware_versions} versions ({health.active_firmware} active)\r\n              </span>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {successMessage && (\r\n        <div className=\"alert alert-success mt-3 fade-in\">\r\n          {successMessage}\r\n          <button\r\n            className=\"alert-close\"\r\n            onClick={() => setSuccessMessage('')}\r\n          >\r\n            ×\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {errorMessage && (\r\n        <div className=\"alert alert-danger mt-3 fade-in\">\r\n          {errorMessage}\r\n          <button\r\n            className=\"alert-close\"\r\n            onClick={() => setErrorMessage('')}\r\n          >\r\n            ×\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {loading && <div className=\"loading-spinner\">Loading OTA data...</div>}\r\n\r\n      <div className=\"admin-grid\">\r\n        {/* Upload Section */}\r\n        <div className=\"admin-card\">\r\n          <h2>Upload New Firmware</h2>\r\n          <form onSubmit={handleUploadFirmware} className=\"form\">\r\n            <div className=\"form-group\">\r\n              <label>Version (e.g., 0x00020000)</label>\r\n              <input\r\n                type=\"text\"\r\n                className=\"form-control\"\r\n                placeholder=\"0x00020000\"\r\n                value={uploadingMetadata.version}\r\n                onChange={(e) =>\r\n                  setUploadingMetadata({ ...uploadingMetadata, version: e.target.value })\r\n                }\r\n              />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label>Firmware File</label>\r\n              <input\r\n                type=\"file\"\r\n                className=\"form-control\"\r\n                accept=\".bin,.hex,.elf\"\r\n                onChange={handleFileSelect}\r\n              />\r\n              {uploadingFile && <small className=\"form-text\">File: {uploadingFile.name}</small>}\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label>Description</label>\r\n              <textarea\r\n                className=\"form-control\"\r\n                placeholder=\"Brief description of this firmware version\"\r\n                rows={2}\r\n                value={uploadingMetadata.description}\r\n                onChange={(e) =>\r\n                  setUploadingMetadata({ ...uploadingMetadata, description: e.target.value })\r\n                }\r\n              />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label>Release Notes</label>\r\n              <textarea\r\n                className=\"form-control\"\r\n                placeholder=\"Detailed release notes and changelog\"\r\n                rows={3}\r\n                value={uploadingMetadata.release_notes}\r\n                onChange={(e) =>\r\n                  setUploadingMetadata({ ...uploadingMetadata, release_notes: e.target.value })\r\n                }\r\n              />\r\n            </div>\r\n\r\n            <button type=\"submit\" className=\"btn btn-primary\" disabled={loading}>\r\n              {loading ? 'Uploading...' : 'Upload Firmware'}\r\n            </button>\r\n          </form>\r\n        </div>\r\n\r\n        {/* Firmware Versions */}\r\n        <div className=\"admin-card\">\r\n          <h2>Firmware Versions</h2>\r\n          {firmwares.length === 0 ? (\r\n            <p className=\"text-muted\">No firmware versions uploaded yet</p>\r\n          ) : (\r\n            <div className=\"firmware-list\">\r\n              {firmwares.map((fw) => (\r\n                <div key={fw.id} className={`firmware-item ${fw.is_active ? 'active' : ''}`}>\r\n                  <div className=\"firmware-header\">\r\n                    <span className={`version-badge ${fw.is_active ? 'active' : 'inactive'}`}>\r\n                      {fw.version}\r\n                    </span>\r\n                    <span className=\"filename\">{fw.filename}</span>\r\n                    <span className=\"size\">({(fw.size / 1024 / 1024).toFixed(2)} MB)</span>\r\n                  </div>\r\n                  {fw.description && <p className=\"description\">{fw.description}</p>}\r\n                  <div className=\"firmware-footer\">\r\n                    <small className=\"text-muted\">\r\n                      Created: {new Date(fw.created_at).toLocaleDateString()}\r\n                    </small>\r\n                    <button\r\n                      className={`btn btn-sm ${fw.is_active ? 'btn-danger' : 'btn-success'}`}\r\n                      onClick={() => handleToggleFirmwareActive(fw)}\r\n                      disabled={loading}\r\n                    >\r\n                      {fw.is_active ? 'Deactivate' : 'Activate'}\r\n                    </button>\r\n                  </div>\r\n                  {fw.release_notes && (\r\n                    <details className=\"mt-2\">\r\n                      <summary>Release Notes</summary>\r\n                      <p className=\"release-notes\">{fw.release_notes}</p>\r\n                    </details>\r\n                  )}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* OTA Configuration */}\r\n        <div className=\"admin-card\">\r\n          <h2>OTA Configuration</h2>\r\n          {configForm && (\r\n            <form onSubmit={handleSaveConfig} className=\"form\">\r\n              <div className=\"form-group\">\r\n                <label className=\"checkbox-label\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={configForm.enable_auto_update}\r\n                    onChange={(e) =>\r\n                      setConfigForm({ ...configForm, enable_auto_update: e.target.checked })\r\n                    }\r\n                  />\r\n                  <span>Enable Automatic Updates</span>\r\n                </label>\r\n              </div>\r\n\r\n              <div className=\"form-group\">\r\n                <label>Update Strategy</label>\r\n                <select\r\n                  className=\"form-control\"\r\n                  value={configForm.update_strategy}\r\n                  onChange={(e) =>\r\n                    setConfigForm({\r\n                      ...configForm,\r\n                      update_strategy: e.target.value as any,\r\n                    })\r\n                  }\r\n                >\r\n                  <option value=\"immediate\">Immediate - Push updates immediately</option>\r\n                  <option value=\"scheduled\">Scheduled - Push during maintenance window</option>\r\n                  <option value=\"manual\">Manual - Wait for device to request</option>\r\n                </select>\r\n              </div>\r\n\r\n              <div className=\"form-group\">\r\n                <label>Max Concurrent Updates</label>\r\n                <input\r\n                  type=\"number\"\r\n                  className=\"form-control\"\r\n                  min=\"1\"\r\n                  max=\"50\"\r\n                  value={configForm.max_concurrent_updates}\r\n                  onChange={(e) =>\r\n                    setConfigForm({\r\n                      ...configForm,\r\n                      max_concurrent_updates: parseInt(e.target.value),\r\n                    })\r\n                  }\r\n                />\r\n                <small className=\"form-text\">\r\n                  Maximum number of devices updating simultaneously\r\n                </small>\r\n              </div>\r\n\r\n              <div className=\"form-group\">\r\n                <label>Firmware Retention (days)</label>\r\n                <input\r\n                  type=\"number\"\r\n                  className=\"form-control\"\r\n                  min=\"1\"\r\n                  max=\"365\"\r\n                  value={configForm.firmware_retention_days}\r\n                  onChange={(e) =>\r\n                    setConfigForm({\r\n                      ...configForm,\r\n                      firmware_retention_days: parseInt(e.target.value),\r\n                    })\r\n                  }\r\n                />\r\n                <small className=\"form-text\">\r\n                  Keep old firmware files for this many days before cleanup\r\n                </small>\r\n              </div>\r\n\r\n              <button type=\"submit\" className=\"btn btn-primary\" disabled={loading}>\r\n                {loading ? 'Saving...' : 'Save Configuration'}\r\n              </button>\r\n            </form>\r\n          )}\r\n        </div>\r\n\r\n        {/* Device Update Info */}\r\n        <div className=\"admin-card\">\r\n          <h2>OTA Update Strategy</h2>\r\n          <div className=\"info-box\">\r\n            <h4>Current Strategy: {config?.update_strategy.toUpperCase()}</h4>\r\n            <ul>\r\n              <li>\r\n                <strong>Immediate:</strong> Updates offered to devices immediately when\r\n                activated\r\n              </li>\r\n              <li>\r\n                <strong>Scheduled:</strong> Updates offered during configured maintenance\r\n                windows\r\n              </li>\r\n              <li>\r\n                <strong>Manual:</strong> Devices must explicitly request updates via API\r\n              </li>\r\n            </ul>\r\n\r\n            <h4 className=\"mt-3\">For STM32 Devices:</h4>\r\n            <code className=\"code-block\">\r\n              POST /ota/devices/&#123;device_id&#125;/check\r\n              <br />\r\n              With: &#123;\"device_id\": \"...\", \"firmware_version\": \"0x00010000\"&#125;\r\n            </code>\r\n\r\n            <h4 className=\"mt-3\">Device Response Format:</h4>\r\n            <pre className=\"code-block\">\r\n              {JSON.stringify(\r\n                {\r\n                  id: 'fw_1',\r\n                  version: '0x00020000',\r\n                  size: 1048576,\r\n                  url: 'https://api.../ota/firmware/1/download',\r\n                  checksum: 'sha256_hash',\r\n                  status: 1,\r\n                },\r\n                null,\r\n                2\r\n              )}\r\n            </pre>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","/**\r\n * Simple in-memory cache service for API responses\r\n * Reduces unnecessary API calls and speeds up page loads\r\n */\r\n\r\ninterface CacheEntry {\r\n  data: any;\r\n  timestamp: number;\r\n  expiresIn: number; // milliseconds\r\n}\r\n\r\nclass CacheService {\r\n  private cache: Map<string, CacheEntry> = new Map();\r\n  private static readonly DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes default\r\n  private static readonly LONG_TTL = 30 * 60 * 1000; // 30 minutes for static data\r\n\r\n  /**\r\n   * Set a cache entry\r\n   */\r\n  set(key: string, data: any, ttlMs: number = CacheService.DEFAULT_TTL): void {\r\n    this.cache.set(key, {\r\n      data,\r\n      timestamp: Date.now(),\r\n      expiresIn: ttlMs,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get a cache entry if valid\r\n   */\r\n  get(key: string): any | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    // Check if expired\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return entry.data;\r\n  }\r\n\r\n  /**\r\n   * Check if key exists and is not expired\r\n   */\r\n  has(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return false;\r\n\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Clear a specific cache entry\r\n   */\r\n  clear(key: string): void {\r\n    this.cache.delete(key);\r\n  }\r\n\r\n  /**\r\n   * Clear all cache entries\r\n   */\r\n  clearAll(): void {\r\n    this.cache.clear();\r\n  }\r\n\r\n  /**\r\n   * Get cache size\r\n   */\r\n  size(): number {\r\n    return this.cache.size;\r\n  }\r\n\r\n  /**\r\n   * Get TTL constants\r\n   */\r\n  static getTTL(type: 'short' | 'long' = 'short'): number {\r\n    return type === 'long' ? CacheService.LONG_TTL : CacheService.DEFAULT_TTL;\r\n  }\r\n}\r\n\r\nexport const cacheService = new CacheService();\r\nexport const DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes\r\nexport const LONG_TTL = 30 * 60 * 1000; // 30 minutes\r\n","import { cacheService, DEFAULT_TTL } from './cacheService';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'https://smart-solar-django-backend-git-dev0-360watts-projects.vercel.app/api';\r\n\r\nclass ApiService {\r\n  private getAuthHeaders(): HeadersInit {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (tokens) {\r\n      try {\r\n        const parsedTokens = JSON.parse(tokens);\r\n        return {\r\n          'Authorization': `Bearer ${parsedTokens.access}`,\r\n          'Content-Type': 'application/json',\r\n        };\r\n      } catch (error) {\r\n        console.error('Error parsing auth tokens:', error);\r\n      }\r\n    }\r\n    return {\r\n      'Content-Type': 'application/json',\r\n    };\r\n  }\r\n\r\n  private async request(endpoint: string, options: RequestInit = {}): Promise<any> {\r\n    const url = `${API_BASE_URL}${endpoint}`;\r\n    let headers = this.getAuthHeaders();\r\n\r\n    let response = await fetch(url, {\r\n      ...options,\r\n      headers: {\r\n        ...headers,\r\n        ...options.headers,\r\n      },\r\n    });\r\n\r\n    if (response.status === 401) {\r\n      // Try to refresh token\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        // Retry with new token\r\n        headers = this.getAuthHeaders();\r\n        response = await fetch(url, {\r\n          ...options,\r\n          headers: {\r\n            ...headers,\r\n            ...options.headers,\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      // Token refresh failed or not attempted, logout\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`API request failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  private async refreshToken(): Promise<boolean> {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (!tokens) return false;\r\n\r\n    try {\r\n      const parsedTokens = JSON.parse(tokens);\r\n      const response = await fetch(`${API_BASE_URL}/auth/token/refresh/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ refresh: parsedTokens.refresh }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        const newTokens = {\r\n          access: data.access,\r\n          refresh: parsedTokens.refresh, // Keep the same refresh token\r\n        };\r\n        localStorage.setItem('authTokens', JSON.stringify(newTokens));\r\n        return true;\r\n      }\r\n    } catch (error) {\r\n      console.error('Token refresh failed:', error);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  async getConfiguration(): Promise<any> {\r\n    return this.request('/config/');\r\n  }\r\n\r\n  async getTelemetry(): Promise<any[]> {\r\n    return this.request('/telemetry/');\r\n  }\r\n\r\n  async provisionDevice(data: any): Promise<any> {\r\n    const response = await fetch(`${API_BASE_URL}/devices/provision`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n    if (!response.ok) {\r\n      throw new Error(`Provisioning failed: ${response.statusText}`);\r\n    }\r\n    return response.json();\r\n  }\r\n\r\n  async getAlerts(): Promise<any[]> {\r\n    const cacheKey = 'alerts';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/alerts/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getSystemHealth(): Promise<any> {\r\n    const cacheKey = 'system_health';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/health/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getKPIs(): Promise<any> {\r\n    const cacheKey = 'kpis';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/kpis/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getUsers(search?: string): Promise<any[]> {\r\n    const cacheKey = `users_${search || 'all'}`;\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    const data = await this.request(`/users/${params}`);\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async createUser(userData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(userData),\r\n    });\r\n    // Invalidate users cache\r\n    cacheService.clear('users_all');\r\n    cacheService.clearAll(); // Clear all cache for safety\r\n    return result;\r\n  }\r\n\r\n  async createEmployee(employeeData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ ...employeeData, is_staff: true }),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async getUserDevices(userId: number): Promise<any[]> {\r\n    return this.request(`/users/${userId}/devices/`);\r\n  }\r\n\r\n  async updateUser(userId: number, data: any): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async deleteUser(userId: number): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  // Profile Management (for current logged-in user)\r\n  async getProfile(): Promise<any> {\r\n    return this.request('/profile/');\r\n  }\r\n\r\n  async updateProfile(data: any): Promise<any> {\r\n    return this.request('/profile/update/', {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async changePassword(data: { current_password: string; new_password: string }): Promise<any> {\r\n    return this.request('/profile/change-password/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // Customer Management (separate from staff users/employees)\r\n  async getCustomers(search?: string): Promise<any[]> {\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    return this.request(`/customers/${params}`);\r\n  }\r\n\r\n  async createCustomer(customerData: any): Promise<any> {\r\n    return this.request('/customers/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(customerData),\r\n    });\r\n  }\r\n\r\n  async getCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/`);\r\n  }\r\n\r\n  async updateCustomer(customerId: number, data: any): Promise<any> {\r\n    return this.request(`/customers/${customerId}/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getPresets(): Promise<any[]> {\r\n    const cacheKey = 'presets';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/presets/');\r\n    // Use longer TTL for presets as they change less frequently\r\n    cacheService.set(cacheKey, data, 30 * 60 * 1000); // 30 minutes\r\n    return data;\r\n  }\r\n\r\n  async createPreset(data: any): Promise<any> {\r\n    const result = await this.request('/presets/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async updatePreset(id: number, data: any): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async deletePreset(id: number): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async getGlobalSlaves(): Promise<any[]> {\r\n    return this.request('/slaves/');\r\n  }\r\n\r\n  async createGlobalSlave(slaveData: any): Promise<any> {\r\n    return this.request('/slaves/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateGlobalSlave(slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteGlobalSlave(slaveId: number): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getDevices(search?: string, page: number = 1, pageSize: number = 25): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    if (search) params.append('search', search);\r\n    params.append('page', page.toString());\r\n    params.append('page_size', pageSize.toString());\r\n    \r\n    const queryString = params.toString();\r\n    return this.request(`/devices/?${queryString}`);\r\n  }\r\n\r\n  async createDevice(deviceData: any): Promise<any> {\r\n    return this.request('/devices/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(deviceData),\r\n    });\r\n  }\r\n\r\n  async updateDevice(deviceId: number, data: any): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async deleteDevicesBulk(deviceIds: number[]): Promise<any> {\r\n    return this.request(`/devices/delete-bulk/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ device_ids: deviceIds }),\r\n    });\r\n  }\r\n\r\n  async getSlaves(configId: string): Promise<any[]> {\r\n    return this.request(`/presets/${configId}/slaves/`);\r\n  }\r\n\r\n  async createSlave(configId: string, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/create/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateSlave(configId: string, slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteSlave(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async addSlavesToPreset(configId: string, slaveIds: number[]): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/add/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ slave_ids: slaveIds }),\r\n    });\r\n  }\r\n\r\n  // OTA (Over-The-Air) Update Endpoints\r\n  async getFirmwareVersions(activeOnly: boolean = true): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    params.append('active', activeOnly.toString());\r\n    return this.request(`/ota/firmware/?${params.toString()}`);\r\n  }\r\n\r\n  async uploadFirmwareVersion(formData: FormData): Promise<any> {\r\n    const headers = this.getAuthHeaders();\r\n    delete (headers as any)['Content-Type']; // Let browser set it for FormData\r\n    \r\n    return fetch(`${API_BASE_URL}/ota/firmware/create/`, {\r\n      method: 'POST',\r\n      headers: {\r\n        ...headers,\r\n        'Authorization': `Bearer ${JSON.parse(localStorage.getItem('authTokens') || '{}').access}`,\r\n      },\r\n      body: formData,\r\n    }).then(res => res.json());\r\n  }\r\n\r\n  async updateFirmwareVersion(firmwareId: number, data: any): Promise<any> {\r\n    return this.request(`/ota/firmware/${firmwareId}/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async getDeviceUpdateLogs(deviceId: string): Promise<any> {\r\n    return this.request(`/ota/devices/${deviceId}/logs`);\r\n  }\r\n\r\n  async getOTAConfig(): Promise<any> {\r\n    return this.request(`/ota/config/`);\r\n  }\r\n\r\n  async updateOTAConfig(config: any): Promise<any> {\r\n    return this.request(`/ota/config/update/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(config),\r\n    });\r\n  }\r\n\r\n  async getOTAHealth(): Promise<any> {\r\n    return this.request(`/ota/health/`);\r\n  }\r\n}\r\n\r\nexport const apiService = new ApiService();"],"names":["OTA","firmwares","setFirmwares","useState","config","setConfig","health","setHealth","loading","setLoading","uploadingFile","setUploadingFile","uploadingMetadata","setUploadingMetadata","version","description","release_notes","configForm","setConfigForm","successMessage","setSuccessMessage","errorMessage","setErrorMessage","useEffect","loadOTAData","async","fwRes","configRes","healthRes","Promise","all","apiService","getFirmwareVersions","getOTAConfig","getOTAHealth","error","message","_jsxs","className","children","_jsx","_Fragment","concat","status","toUpperCase","firmware_versions","active_firmware","onClick","onSubmit","e","preventDefault","formData","FormData","append","name","size","toString","uploadFirmwareVersion","type","placeholder","value","onChange","_objectSpread","target","accept","_e$target$files","files","rows","disabled","length","map","fw","is_active","filename","toFixed","Date","created_at","toLocaleDateString","updateFirmwareVersion","firmware","id","handleToggleFirmwareActive","updateOTAConfig","checked","enable_auto_update","update_strategy","min","max","max_concurrent_updates","parseInt","firmware_retention_days","JSON","stringify","url","checksum","CacheService","constructor","cache","Map","set","key","data","ttlMs","arguments","undefined","DEFAULT_TTL","this","timestamp","now","expiresIn","get","entry","delete","has","clear","clearAll","getTTL","LONG_TTL","cacheService","API_BASE_URL","process","getAuthHeaders","tokens","localStorage","getItem","parsedTokens","parse","access","console","request","endpoint","options","headers","response","fetch","refreshToken","removeItem","window","location","href","Error","ok","errorText","text","statusText","json","method","body","refresh","newTokens","setItem","getConfiguration","getTelemetry","provisionDevice","getAlerts","cacheKey","cached","getSystemHealth","getKPIs","getUsers","search","params","encodeURIComponent","createUser","userData","result","createEmployee","employeeData","is_staff","getUserDevices","userId","updateUser","deleteUser","getProfile","updateProfile","changePassword","getCustomers","createCustomer","customerData","getCustomer","customerId","updateCustomer","deleteCustomer","getPresets","createPreset","updatePreset","deletePreset","getGlobalSlaves","createGlobalSlave","slaveData","updateGlobalSlave","slaveId","deleteGlobalSlave","getDevices","page","pageSize","URLSearchParams","queryString","createDevice","deviceData","updateDevice","deviceId","deleteDevice","deleteDevicesBulk","deviceIds","device_ids","getSlaves","configId","createSlave","updateSlave","deleteSlave","addSlavesToPreset","slaveIds","slave_ids","activeOnly","then","res","firmwareId","getDeviceUpdateLogs"],"sourceRoot":""}