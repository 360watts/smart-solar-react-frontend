"use strict";(self.webpackChunksmart_solar_frontend=self.webpackChunksmart_solar_frontend||[]).push([[35],{8035(e,s,t){t.r(s),t.d(s,{default:()=>o});var a=t(9379),l=t(5043),r=t(5560),n=t(8421),i=t(579);const o=()=>{var e,s;const{isDark:t}=(0,n.D)(),[o,d]=(0,l.useState)([]),[c,h]=(0,l.useState)([]),[x,g]=(0,l.useState)(!0),[m,u]=(0,l.useState)(null),[p,v]=(0,l.useState)(null),[j,b]=(0,l.useState)(!1),[f,y]=(0,l.useState)(""),[_,N]=(0,l.useState)(null),[A,w]=(0,l.useState)(null),[C,S]=(0,l.useState)([]),[k,I]=(0,l.useState)(!1),[T,D]=(0,l.useState)(null),[R,B]=(0,l.useState)("none"),[M,L]=(0,l.useState)([]),[E,F]=(0,l.useState)(!1),[O,P]=(0,l.useState)([]),[W,z]=(0,l.useState)(""),[U,K]=(0,l.useState)({config_id:"",name:"",description:"",baud_rate:9600,data_bits:8,stop_bits:1,parity:0}),[H,G]=(0,l.useState)({name:"",description:"",baud_rate:9600,data_bits:8,stop_bits:1,parity:0}),[V,Y]=(0,l.useState)({slave_id:"",device_name:"",polling_interval_ms:5e3,timeout_ms:1e3,enabled:!0,registers:[]}),[q,J]=(0,l.useState)({label:"",address:0,num_registers:1,function_code:3,register_type:3,data_type:0,byte_order:0,word_order:0,access_mode:0,scale_factor:1,offset:0,unit:"",decimal_places:2,category:"Electrical",high_alarm_threshold:null,low_alarm_threshold:null,description:"",enabled:!0}),[Q,X]=(0,l.useState)({show:!1,preset:null}),[Z,$]=(0,l.useState)({show:!1,slave:null}),[ee,se]=(0,l.useState)({show:!1,message:""});(0,l.useEffect)(()=>{le()},[]),(0,l.useEffect)(()=>{if(!j||"select"!==R)return;(async()=>{try{F(!0);const e=(await r.K.getGlobalSlaves()).map(e=>({id:e.id,slaveId:e.slave_id,deviceName:e.device_name,pollingIntervalMs:e.polling_interval_ms,timeoutMs:e.timeout_ms,enabled:e.enabled,registers:e.registers||[]}));L(e)}catch(e){console.error("Failed to fetch global slaves:",e)}finally{F(!1)}})()},[j,R]);const[te,ae]=(0,l.useState)("");(0,l.useEffect)(()=>{const e=setTimeout(()=>{ae(f)},300);return()=>clearTimeout(e)},[f]),(0,l.useEffect)(()=>{le(te)},[te]),(0,l.useEffect)(()=>{j&&(Y({slave_id:"",device_name:"",polling_interval_ms:5e3,timeout_ms:1e3,enabled:!0,registers:[]}),J({label:"",address:0,num_registers:1,function_code:3,register_type:3,data_type:0,byte_order:0,word_order:0,access_mode:0,scale_factor:1,offset:0,unit:"",decimal_places:2,category:"Electrical",high_alarm_threshold:null,low_alarm_threshold:null,description:"",enabled:!0}))},[j]);const le=async e=>{try{const s=await r.K.getPresets();let t=s;if(e){const a=e.toLowerCase();t=s.filter(e=>e.name.toLowerCase().includes(a)||e.config_id.toLowerCase().includes(a)||e.description.toLowerCase().includes(a))}d(s),h(t),g(!1)}catch(s){u(s instanceof Error?s.message:"An error occurred"),g(!1)}},re=async()=>{if(p)try{await r.K.updatePreset(p.id,U),v(null),await le(f)}catch(e){u(e instanceof Error?e.message:"Failed to update preset")}},ne=async()=>{try{var e,s;const t=await r.K.createPreset(H),a=(null===t||void 0===t||null===(e=t.gateway_configuration)||void 0===e||null===(s=e.general_settings)||void 0===s?void 0:s.config_id)||(null===t||void 0===t?void 0:t.config_id)||(null===t||void 0===t?void 0:t.configId)||"";if(a||"none"===R||u("Preset created but config id was not returned. Slave setup skipped."),a&&"create"===R){if(!V.slave_id||!V.device_name)return void u("Slave ID and Device Name are required to create a slave.");await r.K.createSlave(a,{slave_id:parseInt(V.slave_id),device_name:V.device_name,polling_interval_ms:V.polling_interval_ms,timeout_ms:V.timeout_ms,enabled:V.enabled,registers:V.registers})}a&&"select"===R&&O.length>0&&await r.K.addSlavesToPreset(a,O),b(!1),B("none"),P([]),G({name:"",description:"",baud_rate:9600,data_bits:8,stop_bits:1,parity:0}),await le(f)}catch(t){u(t instanceof Error?t.message:"Failed to create preset")}},ie=e=>{var s;return null!==(s={0:"UINT16",1:"INT16",2:"UINT32",3:"INT32",4:"FLOAT32",5:"UINT64",6:"INT64",7:"FLOAT64",8:"BOOL",9:"STRING"}[e])&&void 0!==s?s:"Unknown (".concat(e,")")},oe=async e=>{w(e),await de(e.config_id)},de=async e=>{try{const[s,t]=await Promise.all([r.K.getSlaves(e),r.K.getGlobalSlaves()]),a=new Set(s.map(e=>e.id)),l=(e,s)=>({id:e.id,slaveId:e.slave_id,deviceName:e.device_name,pollingIntervalMs:e.polling_interval_ms,timeoutMs:e.timeout_ms,enabled:e.enabled,attached:s,registers:(e.registers||[]).map(e=>({id:e.id,label:e.label,address:e.address,numRegisters:e.num_registers,functionCode:e.function_code,dataType:e.data_type,scaleFactor:e.scale_factor,offset:e.offset,enabled:e.enabled}))}),n=s.map(e=>l(e,!0)),i=(t||[]).filter(e=>!a.has(e.id)).map(e=>l(e,!1));S([...n,...i])}catch(s){console.error("Failed to fetch slaves:",s),u("Failed to load slaves for this preset")}},ce=(e,s)=>{const t=o.map(t=>t.config_id===e?(0,a.A)((0,a.A)({},t),{},{slaves_count:s}):t);d(t);const l=f.toLowerCase(),r=t.filter(e=>e.name.toLowerCase().includes(l)||e.config_id.toLowerCase().includes(l)||e.description.toLowerCase().includes(l));h(r),A&&A.config_id===e&&w((0,a.A)((0,a.A)({},A),{},{slaves_count:s}))},he=async()=>{if(A){if(!T){const e=parseInt(V.slave_id);if(C.find(s=>s.slaveId===e))return void u("Slave ID ".concat(e," already exists for this configuration. Please choose a different ID."))}try{const e={slave_id:parseInt(V.slave_id),device_name:V.device_name,polling_interval_ms:V.polling_interval_ms,timeout_ms:V.timeout_ms,enabled:V.enabled,registers:V.registers};if(T){const s=await r.K.updateSlave(A.config_id,T.slaveId,e),t={id:s.id,slaveId:s.slave_id,deviceName:s.device_name,pollingIntervalMs:s.polling_interval_ms,timeoutMs:s.timeout_ms,enabled:s.enabled,registers:s.registers.map(e=>({id:e.id,label:e.label,address:e.address,numRegisters:e.num_registers,functionCode:e.function_code,dataType:e.data_type,scaleFactor:e.scale_factor,offset:e.offset,enabled:e.enabled}))},a=C.map(e=>e.slaveId===T.slaveId?t:e);S(a),ce(A.config_id,a.length),D(null)}else{const s=await r.K.createSlave(A.config_id,e),t={id:s.id,slaveId:s.slave_id,deviceName:s.device_name,pollingIntervalMs:s.polling_interval_ms,timeoutMs:s.timeout_ms,enabled:s.enabled,registers:s.registers.map(e=>({id:e.id,label:e.label,address:e.address,numRegisters:e.num_registers,functionCode:e.function_code,dataType:e.data_type,scaleFactor:e.scale_factor,offset:e.offset,enabled:e.enabled}))},a=[...C,t];S(a),ce(A.config_id,a.length),I(!1)}Y({slave_id:"",device_name:"",polling_interval_ms:5e3,timeout_ms:1e3,enabled:!0,registers:[]})}catch(e){u(e instanceof Error?e.message:"Failed to save slave")}}};return x?(0,i.jsx)("div",{className:"loading",children:"Loading presets..."}):m?(0,i.jsxs)("div",{className:"error",children:["Error: ",m]}):(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{children:"Device Presets"}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsxs)("h2",{children:["Presets (",c.length,")"]}),(0,i.jsxs)("div",{className:"card-actions",children:[(0,i.jsx)("input",{type:"text",placeholder:"Search presets...",value:f,onChange:e=>{y(e.target.value)},className:"search-input"}),(0,i.jsx)("button",{onClick:()=>b(!0),className:"btn",children:"Create New Preset"})]})]}),(0,i.jsxs)("table",{className:"table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{textAlign:"center"},children:"Name"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Config ID"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Description"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Slaves"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:c.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{textAlign:"center"},children:e.name}),(0,i.jsx)("td",{style:{textAlign:"center"},children:e.config_id}),(0,i.jsx)("td",{style:{textAlign:"center"},children:e.description}),(0,i.jsx)("td",{style:{textAlign:"center"},children:e.slaves_count||0}),(0,i.jsxs)("td",{style:{textAlign:"center"},children:[(0,i.jsx)("button",{onClick:()=>(e=>{N(e)})(e),style:{background:"none",border:"none",cursor:"pointer",color:"#94a3b8",margin:"0 6px"},title:"View Details",children:(0,i.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,i.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,i.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})}),(0,i.jsx)("button",{onClick:()=>oe(e),style:{background:"none",border:"none",cursor:"pointer",color:"#6366f1",margin:"0 6px"},title:"Configure Slaves",children:(0,i.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,i.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,i.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15"}),(0,i.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),(0,i.jsx)("line",{x1:"21",y1:"3",x2:"3",y2:"21"})]})}),(0,i.jsx)("button",{onClick:()=>(e=>{v(e),K({config_id:e.gateway_configuration.general_settings.config_id,name:e.name,description:e.description,baud_rate:e.gateway_configuration.uart_configuration.baud_rate,data_bits:e.gateway_configuration.uart_configuration.data_bits,stop_bits:e.gateway_configuration.uart_configuration.stop_bits,parity:"None"===e.gateway_configuration.uart_configuration.parity?0:"Odd"===e.gateway_configuration.uart_configuration.parity?1:2}),de(e.gateway_configuration.general_settings.config_id).catch(e=>{console.error("Failed to load slaves for preset edit:",e)})})(e),style:{background:"none",border:"none",cursor:"pointer",color:"#3b82f6",margin:"0 6px"},title:"Edit",children:(0,i.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,i.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,i.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),(0,i.jsx)("button",{onClick:()=>(e=>{console.log("\ud83d\uddd1\ufe0f handleDelete called with preset:",e.name),X({show:!0,preset:e})})(e),style:{background:"none",border:"none",cursor:"pointer",color:"#ef4444",margin:"0 6px"},title:"Delete",children:(0,i.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,i.jsx)("polyline",{points:"3,6 5,6 21,6"}),(0,i.jsx)("path",{d:"M19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2"}),(0,i.jsx)("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),(0,i.jsx)("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})})]})]},e.id))})]})]}),(p||j)&&(0,i.jsx)("div",{className:"modal",children:(0,i.jsxs)("div",{className:"modal-content",children:[(0,i.jsx)("h3",{children:p?"Edit Preset: ".concat(p.name):"Create New Preset"}),(0,i.jsx)("div",{className:"modal-body",children:(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),p?re():ne()},children:[(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsx)("h4",{className:"form-section-title",children:"Preset Details"}),(0,i.jsxs)("div",{className:"form-grid form-grid-2",children:[p&&(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Config ID"}),(0,i.jsx)("input",{type:"text",value:U.config_id,onChange:e=>K((0,a.A)((0,a.A)({},U),{},{config_id:e.target.value})),required:!0,autoComplete:"off",readOnly:!0,className:"form-control-readonly"})]}),(0,i.jsxs)("div",{className:"form-group",style:p?{}:{gridColumn:"1 / -1"},children:[(0,i.jsx)("label",{children:"Preset Name"}),(0,i.jsx)("input",{type:"text",value:p?U.name:H.name,onChange:e=>p?K((0,a.A)((0,a.A)({},U),{},{name:e.target.value})):G((0,a.A)((0,a.A)({},H),{},{name:e.target.value})),required:!0,autoComplete:"off",placeholder:"e.g., Standard Gateway Config"})]}),(0,i.jsxs)("div",{className:"form-group full-width",children:[(0,i.jsx)("label",{children:"Description"}),(0,i.jsx)("textarea",{value:p?U.description:H.description,onChange:e=>p?K((0,a.A)((0,a.A)({},U),{},{description:e.target.value})):G((0,a.A)((0,a.A)({},H),{},{description:e.target.value})),autoComplete:"off",placeholder:"Describe the purpose of this preset...",rows:2})]})]})]}),(0,i.jsxs)("div",{className:"form-section compact-inputs",children:[(0,i.jsx)("h4",{className:"form-section-title",children:"UART Configuration"}),(0,i.jsxs)("div",{className:"form-grid form-grid-4",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Baud Rate"}),(0,i.jsxs)("select",{value:p?U.baud_rate:H.baud_rate,onChange:e=>p?K((0,a.A)((0,a.A)({},U),{},{baud_rate:parseInt(e.target.value)})):G((0,a.A)((0,a.A)({},H),{},{baud_rate:parseInt(e.target.value)})),children:[(0,i.jsx)("option",{value:9600,children:"9600"}),(0,i.jsx)("option",{value:19200,children:"19200"}),(0,i.jsx)("option",{value:38400,children:"38400"}),(0,i.jsx)("option",{value:57600,children:"57600"}),(0,i.jsx)("option",{value:115200,children:"115200"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Data Bits"}),(0,i.jsxs)("select",{value:p?U.data_bits:H.data_bits,onChange:e=>p?K((0,a.A)((0,a.A)({},U),{},{data_bits:parseInt(e.target.value)})):G((0,a.A)((0,a.A)({},H),{},{data_bits:parseInt(e.target.value)})),children:[(0,i.jsx)("option",{value:7,children:"7"}),(0,i.jsx)("option",{value:8,children:"8"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Stop Bits"}),(0,i.jsxs)("select",{value:p?U.stop_bits:H.stop_bits,onChange:e=>p?K((0,a.A)((0,a.A)({},U),{},{stop_bits:parseInt(e.target.value)})):G((0,a.A)((0,a.A)({},H),{},{stop_bits:parseInt(e.target.value)})),children:[(0,i.jsx)("option",{value:1,children:"1"}),(0,i.jsx)("option",{value:2,children:"2"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Parity"}),(0,i.jsxs)("select",{value:p?U.parity:H.parity,onChange:e=>p?K((0,a.A)((0,a.A)({},U),{},{parity:parseInt(e.target.value)})):G((0,a.A)((0,a.A)({},H),{},{parity:parseInt(e.target.value)})),children:[(0,i.jsx)("option",{value:0,children:"None"}),(0,i.jsx)("option",{value:1,children:"Odd"}),(0,i.jsx)("option",{value:2,children:"Even"})]})]})]})]}),j&&(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsx)("h4",{className:"form-section-title",children:"Initial Slave Setup"}),(0,i.jsx)("p",{className:"form-section-desc",children:"Optionally configure a slave device for this preset immediately."}),(0,i.jsxs)("div",{className:"slave-options-container",children:[(0,i.jsxs)("div",{className:"slave-option-card",children:[(0,i.jsx)("div",{className:"slave-option-header",children:(0,i.jsxs)("label",{className:"radio-card-label",children:[(0,i.jsx)("input",{type:"radio",name:"slaveMode",checked:"create"===R,onChange:()=>B("create")}),(0,i.jsx)("span",{children:"Create New Slave"})]})}),(0,i.jsxs)("div",{className:"slave-option-content ".concat("create"===R?"active":""),children:[(0,i.jsx)("p",{className:"text-sm text-muted",children:"Define a new slave device configuration from scratch."}),"create"===R&&(0,i.jsx)("div",{className:"nested-form",children:(0,i.jsxs)("div",{className:"form-grid form-grid-2",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Slave ID"}),(0,i.jsx)("input",{type:"number",value:V.slave_id,onChange:e=>Y((0,a.A)((0,a.A)({},V),{},{slave_id:e.target.value})),required:!0,placeholder:"1-247"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Device Name"}),(0,i.jsx)("input",{type:"text",value:V.device_name,onChange:e=>Y((0,a.A)((0,a.A)({},V),{},{device_name:e.target.value})),required:!0,placeholder:"Device Name"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Polling (ms)"}),(0,i.jsx)("input",{type:"number",value:V.polling_interval_ms,onChange:e=>Y((0,a.A)((0,a.A)({},V),{},{polling_interval_ms:parseInt(e.target.value)})),placeholder:"5000"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Timeout (ms)"}),(0,i.jsx)("input",{type:"number",value:V.timeout_ms,onChange:e=>Y((0,a.A)((0,a.A)({},V),{},{timeout_ms:parseInt(e.target.value)})),placeholder:"1000"})]})]})})]})]}),(0,i.jsxs)("div",{className:"slave-option-card",children:[(0,i.jsx)("div",{className:"slave-option-header",children:(0,i.jsxs)("label",{className:"radio-card-label",children:[(0,i.jsx)("input",{type:"radio",name:"slaveMode",checked:"select"===R,onChange:()=>B("select")}),(0,i.jsx)("span",{children:"Link Existing Slave"})]})}),(0,i.jsxs)("div",{className:"slave-option-content ".concat("select"===R?"active":""),children:[(0,i.jsx)("p",{className:"text-sm text-muted",children:"Select an existing slave configuration to reuse."}),"select"===R&&(0,i.jsx)("div",{style:{marginTop:"10px"},children:E?(0,i.jsx)("p",{className:"text-sm text-muted",children:"Loading slaves..."}):0===M.length?(0,i.jsx)("p",{className:"text-sm text-muted",children:"No existing slaves found."}):(()=>{const e=M.filter(e=>e.deviceName.toLowerCase().includes(W.toLowerCase())||String(e.slaveId).includes(W));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{type:"text",placeholder:"Search by name or slave ID\u2026",value:W,onChange:e=>z(e.target.value),style:{width:"100%",marginBottom:"8px",padding:"6px 10px",borderRadius:"4px",border:"1px solid rgba(148,163,184,0.25)",background:"rgba(15,23,42,0.6)",color:"#f8fafc",fontSize:"0.875rem",boxSizing:"border-box"}}),(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"6px",maxHeight:"200px",overflowY:"auto",border:"1px solid rgba(148,163,184,0.15)",borderRadius:"4px",padding:"8px"},children:0===e.length?(0,i.jsx)("p",{style:{margin:0,color:"#94a3b8",fontSize:"0.85em"},children:"No slaves match your search."}):e.map(e=>(0,i.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer",padding:"4px 6px",borderRadius:"3px",background:O.includes(e.id)?"rgba(99,102,241,0.2)":"transparent"},children:[(0,i.jsx)("input",{type:"checkbox",checked:O.includes(e.id),onChange:s=>{s.target.checked?P([...O,e.id]):P(O.filter(s=>s!==e.id))}}),(0,i.jsxs)("span",{children:[(0,i.jsx)("strong",{children:e.deviceName})," ",(0,i.jsxs)("span",{style:{color:"#94a3b8",fontSize:"0.85em"},children:["(Slave ID: ",e.slaveId,")"]})]})]},e.id))}),(0,i.jsxs)("small",{className:"form-hint",style:{marginTop:"4px",display:"block"},children:[e.length," of ",M.length," shown",O.length>0&&(0,i.jsxs)("span",{className:"form-hint-accent",children:[" \xb7 ",O.length," selected"]})]})]})})()})]})]}),(0,i.jsxs)("div",{className:"slave-option-card",children:[(0,i.jsx)("div",{className:"slave-option-header",children:(0,i.jsxs)("label",{className:"radio-card-label",children:[(0,i.jsx)("input",{type:"radio",name:"slaveMode",checked:"none"===R,onChange:()=>B("none")}),(0,i.jsx)("span",{children:"Skip for Now"})]})}),(0,i.jsx)("div",{className:"slave-option-content",children:(0,i.jsx)("p",{className:"text-sm text-muted",children:"Create preset without any initial slave configuration."})})]})]})]}),p&&(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsx)("h4",{className:"form-section-title",children:"Preset Slave Devices"}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsxs)("h5",{children:["Slaves (",C.length,")"]}),(0,i.jsx)("button",{type:"button",onClick:()=>oe(p),className:"btn btn-sm",children:"Configure Slaves"})]}),0===C.length?(0,i.jsx)("div",{style:{textAlign:"center",padding:"10px",color:"#666"},children:(0,i.jsx)("p",{children:"No slave devices for this preset."})}):(0,i.jsxs)("table",{className:"table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{textAlign:"center"},children:"Slave ID"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Device Name"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Polling"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Timeout"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Registers"})]})}),(0,i.jsx)("tbody",{children:C.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{textAlign:"center"},children:e.slaveId}),(0,i.jsx)("td",{children:e.deviceName}),(0,i.jsxs)("td",{style:{textAlign:"center"},children:[e.pollingIntervalMs,"ms"]}),(0,i.jsxs)("td",{style:{textAlign:"center"},children:[e.timeoutMs,"ms"]}),(0,i.jsx)("td",{style:{textAlign:"center"},children:e.registers.length})]},e.id))})]})]})]})]})}),(0,i.jsxs)("div",{className:"form-actions",children:[(0,i.jsx)("button",{type:"submit",className:"btn",onClick:e=>{e.preventDefault(),p?re():ne()},children:p?"Save":"Create"}),(0,i.jsx)("button",{type:"button",onClick:()=>{v(null),b(!1),B("none"),P([]),z("")},className:"btn btn-secondary",children:"Cancel"})]})]})}),_&&(0,i.jsx)("div",{className:"modal",children:(0,i.jsxs)("div",{className:"modal-content",style:{maxWidth:"700px"},children:[(0,i.jsxs)("h3",{style:{marginBottom:12},children:["Gateway Configuration: ",_.name]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20,marginBottom:16,paddingLeft:20},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{style:{marginBottom:8},children:"General Settings"}),(0,i.jsxs)("div",{style:{paddingLeft:0},children:[(0,i.jsxs)("p",{style:{margin:"6px 0",wordBreak:"break-word"},children:[(0,i.jsx)("strong",{children:"Config ID:"})," ",_.gateway_configuration.general_settings.config_id]}),(0,i.jsxs)("p",{style:{margin:"6px 0"},children:[(0,i.jsx)("strong",{children:"Schema Version:"})," ",_.gateway_configuration.general_settings.schema_version]}),(0,i.jsxs)("p",{style:{margin:"6px 0"},children:[(0,i.jsx)("strong",{children:"Last Updated:"})," ",_.gateway_configuration.general_settings.last_updated]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{style:{marginBottom:8},children:"UART Configuration"}),(0,i.jsxs)("div",{style:{paddingLeft:0},children:[(0,i.jsxs)("p",{style:{margin:"6px 0"},children:[(0,i.jsx)("strong",{children:"Baud Rate:"})," ",_.gateway_configuration.uart_configuration.baud_rate]}),(0,i.jsxs)("p",{style:{margin:"6px 0"},children:[(0,i.jsx)("strong",{children:"Data Bits:"})," ",_.gateway_configuration.uart_configuration.data_bits]}),(0,i.jsxs)("p",{style:{margin:"6px 0"},children:[(0,i.jsx)("strong",{children:"Stop Bits:"})," ",_.gateway_configuration.uart_configuration.stop_bits]}),(0,i.jsxs)("p",{style:{margin:"6px 0"},children:[(0,i.jsx)("strong",{children:"Parity:"})," ",_.gateway_configuration.uart_configuration.parity]})]})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px",paddingLeft:20},children:[(0,i.jsxs)("p",{style:{margin:"6px 0",wordBreak:"break-word"},children:[(0,i.jsx)("strong",{children:"Description:"})," ",_.description||(0,i.jsx)("em",{children:"No description"})]}),(0,i.jsxs)("p",{style:{margin:"6px 0"},children:[(0,i.jsx)("strong",{children:"Slave Devices:"})," ",_.slaves_count]})]}),(0,i.jsx)("div",{className:"form-actions",children:(0,i.jsx)("button",{onClick:()=>{N(null)},className:"btn btn-secondary",children:"Close"})})]})}),A&&(0,i.jsx)("div",{className:"modal",children:(0,i.jsxs)("div",{className:"modal-content",style:{maxWidth:"1200px",maxHeight:"90vh",overflow:"auto"},children:[(0,i.jsxs)("h3",{children:["Configure Slaves: ",A.name]}),m&&(0,i.jsxs)("div",{className:"error",style:{marginBottom:"20px",padding:"10px",backgroundColor:"#f8d7da",border:"1px solid #f5c6cb",borderRadius:"4px",color:"#721c24"},children:[(0,i.jsx)("strong",{children:"Error:"})," ",m,(0,i.jsx)("button",{onClick:()=>u(null),style:{float:"right",background:"none",border:"none",color:"#721c24",cursor:"pointer",fontSize:"16px"},title:"Close error",children:"\xd7"})]}),(0,i.jsxs)("div",{className:"card",style:{marginBottom:"20px"},children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsxs)("h4",{children:["Slave Devices (",C.length,")"]}),(0,i.jsx)("button",{onClick:()=>{Y({slave_id:"",device_name:"",polling_interval_ms:5e3,timeout_ms:1e3,enabled:!0,registers:[]}),D(null),I(!0)},className:"btn",children:"Add Slave"})]}),0===C.length?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",color:"#666"},children:[(0,i.jsx)("p",{children:"No slave devices configured yet."}),(0,i.jsx)("p",{children:'Click "Add Slave" to configure your first slave device.'})]}):(0,i.jsxs)("table",{className:"table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{textAlign:"center"},children:"Slave ID"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Device Name"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Polling Interval"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Timeout"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Status"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Registers"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:C.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{textAlign:"center"},children:e.slaveId}),(0,i.jsx)("td",{children:e.deviceName}),(0,i.jsxs)("td",{style:{textAlign:"center"},children:[e.pollingIntervalMs,"ms"]}),(0,i.jsxs)("td",{style:{textAlign:"center"},children:[e.timeoutMs,"ms"]}),(0,i.jsx)("td",{style:{textAlign:"center"},children:(0,i.jsx)("span",{className:e.enabled?"status-online":"status-offline",children:e.enabled?"Enabled":"Disabled"})}),(0,i.jsx)("td",{style:{textAlign:"center"},children:e.registers.length}),(0,i.jsxs)("td",{style:{textAlign:"center"},children:[e.attached?(0,i.jsx)("button",{onClick:()=>(async e=>{if(A)try{await r.K.detachSlaveFromPreset(A.config_id,e.slaveId),await de(A.config_id),ce(A.config_id,C.filter(e=>e.attached).length-1)}catch(s){u(s instanceof Error?s.message:"Failed to detach slave from preset")}})(e),style:{background:"none",border:"none",cursor:"pointer",color:"#ef4444",marginRight:"8px"},title:"Remove from preset",children:"Remove"}):(0,i.jsx)("button",{onClick:()=>(async e=>{if(A)try{await r.K.addSlavesToPreset(A.config_id,[e.id]),await de(A.config_id),ce(A.config_id,C.filter(e=>e.attached).length+1)}catch(s){u(s instanceof Error?s.message:"Failed to attach slave to preset")}})(e),style:{background:"none",border:"none",cursor:"pointer",color:"#10b981",marginRight:"8px"},title:"Add to preset",children:"Add"}),(0,i.jsx)("button",{onClick:()=>(e=>{Y({slave_id:e.slaveId.toString(),device_name:e.deviceName,polling_interval_ms:e.pollingIntervalMs,timeout_ms:e.timeoutMs,enabled:e.enabled,registers:[...e.registers]}),D(e)})(e),style:{background:"none",border:"none",cursor:"pointer",color:"#3b82f6",marginRight:"10px"},title:"Edit",children:(0,i.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,i.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,i.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),(0,i.jsx)("button",{onClick:()=>(e=>{A&&(console.log("\ud83d\uddd1\ufe0f handleDeleteSlave called with slave:",e.deviceName),$({show:!0,slave:e}))})(e),style:{background:"none",border:"none",cursor:"pointer",color:"#ef4444"},title:"Delete",children:(0,i.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,i.jsx)("polyline",{points:"3,6 5,6 21,6"}),(0,i.jsx)("path",{d:"M19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2"}),(0,i.jsx)("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),(0,i.jsx)("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})})]})]},e.id))})]})]}),(0,i.jsx)("div",{className:"form-actions",children:(0,i.jsx)("button",{onClick:()=>{w(null),S([]),I(!1),D(null),Y({slave_id:"",device_name:"",polling_interval_ms:5e3,timeout_ms:1e3,enabled:!0,registers:[]})},className:"btn btn-secondary",children:"Close"})})]})}),(k||T)&&A&&(0,i.jsx)("div",{className:"modal",children:(0,i.jsxs)("div",{className:"modal-content large-modal",children:[(0,i.jsx)("h3",{children:T?"Edit Slave: ".concat(T.deviceName):"Configure New Slave"}),(0,i.jsx)("div",{className:"modal-body",children:(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),he()},children:[(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsx)("h4",{className:"form-section-title",children:"Basic Information"}),(0,i.jsxs)("div",{className:"form-grid form-grid-2",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Slave ID"}),(0,i.jsx)("input",{type:"number",value:V.slave_id,onChange:e=>Y((0,a.A)((0,a.A)({},V),{},{slave_id:e.target.value})),required:!0,min:"1",max:"247",placeholder:"1-247"}),(0,i.jsxs)("small",{className:"form-hint",children:["Unique identifier (1-247)",C.length>0&&(0,i.jsxs)("span",{className:"form-hint-accent",children:["Existing: ",C.map(e=>e.slaveId).join(", ")]})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Device Name"}),(0,i.jsx)("input",{type:"text",value:V.device_name,onChange:e=>Y((0,a.A)((0,a.A)({},V),{},{device_name:e.target.value})),required:!0,placeholder:"e.g., Solar Inverter"})]})]})]}),(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsx)("h4",{className:"form-section-title",children:"Communication Settings"}),(0,i.jsxs)("div",{className:"form-grid form-grid-3",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Polling Interval (ms)"}),(0,i.jsx)("input",{type:"number",value:V.polling_interval_ms,onChange:e=>Y((0,a.A)((0,a.A)({},V),{},{polling_interval_ms:parseInt(e.target.value)})),min:"100",placeholder:"5000"}),(0,i.jsx)("small",{className:"form-hint",children:"How often to poll"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Timeout (ms)"}),(0,i.jsx)("input",{type:"number",value:V.timeout_ms,onChange:e=>Y((0,a.A)((0,a.A)({},V),{},{timeout_ms:parseInt(e.target.value)})),min:"100",placeholder:"1000"}),(0,i.jsx)("small",{className:"form-hint",children:"Response timeout"})]}),(0,i.jsxs)("div",{className:"form-group checkbox-group",children:[(0,i.jsx)("label",{children:"Status"}),(0,i.jsxs)("label",{className:"checkbox-label checkbox-vertical",children:[(0,i.jsx)("input",{type:"checkbox",checked:V.enabled,onChange:e=>Y((0,a.A)((0,a.A)({},V),{},{enabled:e.target.checked}))}),(0,i.jsx)("span",{className:V.enabled?"status-text-enabled":"status-text-disabled",children:V.enabled?"Enabled":"Disabled"})]})]})]})]}),(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsx)("h4",{className:"form-section-title",children:"Register Mappings"}),(0,i.jsx)("p",{className:"form-section-desc",children:"Configure the Modbus registers to read from this slave device."}),(0,i.jsxs)("div",{className:"form-subsection",children:[(0,i.jsx)("h5",{className:"form-subsection-title",children:"Add New Register"}),(0,i.jsxs)("div",{className:"form-grid form-grid-auto",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Label *"}),(0,i.jsx)("input",{type:"text",placeholder:"e.g., Battery_Voltage",value:q.label,onChange:e=>J((0,a.A)((0,a.A)({},q),{},{label:e.target.value}))})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Address *"}),(0,i.jsx)("input",{type:"number",placeholder:"40001",value:q.address,onChange:e=>J((0,a.A)((0,a.A)({},q),{},{address:parseInt(e.target.value)})),min:"1"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Num Registers"}),(0,i.jsx)("input",{type:"number",placeholder:"1",value:q.num_registers||1,onChange:e=>J((0,a.A)((0,a.A)({},q),{},{num_registers:parseInt(e.target.value)})),min:"1",max:"125"}),(0,i.jsx)("small",{className:"form-hint",children:"Count (1-125)"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Function Code *"}),(0,i.jsxs)("select",{value:q.function_code||3,onChange:e=>J((0,a.A)((0,a.A)({},q),{},{function_code:parseInt(e.target.value)})),children:[(0,i.jsx)("option",{value:1,children:"0x01 - Read Coils"}),(0,i.jsx)("option",{value:2,children:"0x02 - Read Discrete Inputs"}),(0,i.jsx)("option",{value:3,children:"0x03 - Read Holding Registers"}),(0,i.jsx)("option",{value:4,children:"0x04 - Read Input Registers"}),(0,i.jsx)("option",{value:5,children:"0x05 - Write Single Coil"}),(0,i.jsx)("option",{value:6,children:"0x06 - Write Single Register"}),(0,i.jsx)("option",{value:15,children:"0x0F - Write Multiple Coils"}),(0,i.jsx)("option",{value:16,children:"0x10 - Write Multiple Registers"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Data Type *"}),(0,i.jsxs)("select",{value:q.data_type,onChange:e=>J((0,a.A)((0,a.A)({},q),{},{data_type:parseInt(e.target.value)})),children:[(0,i.jsx)("option",{value:0,children:"UINT16 (16-bit Unsigned)"}),(0,i.jsx)("option",{value:1,children:"INT16 (16-bit Signed)"}),(0,i.jsx)("option",{value:2,children:"UINT32 (32-bit Unsigned)"}),(0,i.jsx)("option",{value:3,children:"INT32 (32-bit Signed)"}),(0,i.jsx)("option",{value:4,children:"FLOAT32 (32-bit Float)"}),(0,i.jsx)("option",{value:5,children:"UINT64 (64-bit Unsigned)"}),(0,i.jsx)("option",{value:6,children:"INT64 (64-bit Signed)"}),(0,i.jsx)("option",{value:7,children:"FLOAT64 (64-bit Float)"}),(0,i.jsx)("option",{value:8,children:"BOOL (Single Bit)"}),(0,i.jsx)("option",{value:9,children:"STRING (ASCII)"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Byte Order"}),(0,i.jsxs)("select",{value:q.byte_order||0,onChange:e=>J((0,a.A)((0,a.A)({},q),{},{byte_order:parseInt(e.target.value)})),children:[(0,i.jsx)("option",{value:0,children:"Big Endian (AB)"}),(0,i.jsx)("option",{value:1,children:"Little Endian (BA)"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Word Order"}),(0,i.jsxs)("select",{value:q.word_order||0,onChange:e=>J((0,a.A)((0,a.A)({},q),{},{word_order:parseInt(e.target.value)})),children:[(0,i.jsx)("option",{value:0,children:"Big Endian (AB CD)"}),(0,i.jsx)("option",{value:1,children:"Little Endian (CD AB)"}),(0,i.jsx)("option",{value:2,children:"Mid-Big Endian (BA DC)"}),(0,i.jsx)("option",{value:3,children:"Mid-Little Endian (DC BA)"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Decimal Places"}),(0,i.jsx)("input",{type:"number",placeholder:"2",value:q.decimal_places||2,onChange:e=>J((0,a.A)((0,a.A)({},q),{},{decimal_places:parseInt(e.target.value)})),min:"0",max:"6"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Access Mode"}),(0,i.jsxs)("select",{value:q.access_mode||0,onChange:e=>J((0,a.A)((0,a.A)({},q),{},{access_mode:parseInt(e.target.value)})),children:[(0,i.jsx)("option",{value:0,children:"Read Only"}),(0,i.jsx)("option",{value:1,children:"Read/Write"}),(0,i.jsx)("option",{value:2,children:"Write Only"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Scale Factor"}),(0,i.jsx)("input",{type:"number",placeholder:"1.0",value:q.scale_factor,onChange:e=>J((0,a.A)((0,a.A)({},q),{},{scale_factor:parseFloat(e.target.value)})),step:"0.001"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Offset"}),(0,i.jsx)("input",{type:"number",placeholder:"0.0",value:q.offset,onChange:e=>J((0,a.A)((0,a.A)({},q),{},{offset:parseFloat(e.target.value)})),step:"0.01"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Unit"}),(0,i.jsx)("input",{type:"text",placeholder:"V, A, W, \xb0C, etc.",value:q.unit||"",onChange:e=>J((0,a.A)((0,a.A)({},q),{},{unit:e.target.value}))})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Category"}),(0,i.jsxs)("select",{value:q.category||"Grid",onChange:e=>J((0,a.A)((0,a.A)({},q),{},{category:e.target.value})),children:[(0,i.jsx)("option",{value:"Grid",children:"Grid"}),(0,i.jsx)("option",{value:"BMS",children:"BMS"}),(0,i.jsx)("option",{value:"Status",children:"Status"}),(0,i.jsx)("option",{value:"Energy",children:"Energy"}),(0,i.jsx)("option",{value:"Temperature",children:"Temperature"}),(0,i.jsx)("option",{value:"Battery",children:"Battery"}),(0,i.jsx)("option",{value:"Load",children:"Load"}),(0,i.jsx)("option",{value:"PV",children:"PV"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"High Alarm"}),(0,i.jsx)("input",{type:"number",placeholder:"Optional",value:null!==(e=q.high_alarm_threshold)&&void 0!==e?e:"",onChange:e=>J((0,a.A)((0,a.A)({},q),{},{high_alarm_threshold:e.target.value?parseFloat(e.target.value):null})),step:"0.01"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Low Alarm"}),(0,i.jsx)("input",{type:"number",placeholder:"Optional",value:null!==(s=q.low_alarm_threshold)&&void 0!==s?s:"",onChange:e=>J((0,a.A)((0,a.A)({},q),{},{low_alarm_threshold:e.target.value?parseFloat(e.target.value):null})),step:"0.01"})]}),(0,i.jsxs)("div",{className:"form-group checkbox-group",children:[(0,i.jsx)("label",{children:"Enabled"}),(0,i.jsxs)("label",{className:"checkbox-label checkbox-vertical",children:[(0,i.jsx)("input",{type:"checkbox",checked:q.enabled,onChange:e=>J((0,a.A)((0,a.A)({},q),{},{enabled:e.target.checked}))}),(0,i.jsx)("span",{children:q.enabled?"Yes":"No"})]})]}),(0,i.jsx)("div",{className:"form-group form-group-btn",children:(0,i.jsx)("button",{type:"button",onClick:()=>{const e={id:Date.now(),label:q.label,address:q.address,numRegisters:q.num_registers,functionCode:q.function_code,registerType:q.register_type,dataType:q.data_type,byteOrder:q.byte_order,wordOrder:q.word_order,accessMode:q.access_mode,scaleFactor:q.scale_factor,offset:q.offset,unit:q.unit,decimalPlaces:q.decimal_places,category:q.category,highAlarmThreshold:q.high_alarm_threshold,lowAlarmThreshold:q.low_alarm_threshold,description:q.description,enabled:q.enabled};Y((0,a.A)((0,a.A)({},V),{},{registers:[...V.registers,e]})),J({label:"",address:0,num_registers:1,function_code:3,register_type:3,data_type:0,byte_order:0,word_order:0,access_mode:0,scale_factor:1,offset:0,unit:"",decimal_places:2,category:"Electrical",high_alarm_threshold:null,low_alarm_threshold:null,description:"",enabled:!0})},className:"btn btn-sm",children:"Add Register"})})]}),(0,i.jsxs)("div",{className:"form-group",style:{marginTop:"10px"},children:[(0,i.jsx)("label",{children:"Description"}),(0,i.jsx)("input",{type:"text",placeholder:"e.g., 0=Off, 1=On, 2=Standby",value:q.description||"",onChange:e=>J((0,a.A)((0,a.A)({},q),{},{description:e.target.value})),style:{width:"100%"}})]})]}),V.registers.length>0?(0,i.jsxs)("div",{className:"registers-table-wrapper",children:[(0,i.jsxs)("h5",{className:"form-subsection-title",children:["Configured Registers (",V.registers.length,")"]}),(0,i.jsxs)("table",{className:"table registers-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Label"}),(0,i.jsx)("th",{children:"Address"}),(0,i.jsx)("th",{children:"Function"}),(0,i.jsx)("th",{children:"Data Type"}),(0,i.jsx)("th",{children:"Unit"}),(0,i.jsx)("th",{children:"Scale"}),(0,i.jsx)("th",{children:"Offset"}),(0,i.jsx)("th",{children:"Category"}),(0,i.jsx)("th",{children:"Alarms"}),(0,i.jsx)("th",{children:"Status"}),(0,i.jsx)("th",{children:"Actions"})]})}),(0,i.jsx)("tbody",{children:V.registers.map((e,s)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.label}),(0,i.jsx)("td",{children:e.address}),(0,i.jsx)("td",{children:e.functionCode||3}),(0,i.jsx)("td",{children:ie(e.dataType)}),(0,i.jsx)("td",{children:e.unit||"-"}),(0,i.jsx)("td",{children:e.scaleFactor}),(0,i.jsx)("td",{children:e.offset}),(0,i.jsx)("td",{children:e.category||"-"}),(0,i.jsx)("td",{children:e.highAlarmThreshold||e.lowAlarmThreshold?(0,i.jsxs)("small",{children:[e.highAlarmThreshold&&"H:".concat(e.highAlarmThreshold),e.highAlarmThreshold&&e.lowAlarmThreshold&&" / ",e.lowAlarmThreshold&&"L:".concat(e.lowAlarmThreshold)]}):"-"}),(0,i.jsx)("td",{children:(0,i.jsx)("span",{className:"status-badge ".concat(e.enabled?"status-badge-success":"status-badge-danger"),children:e.enabled?"Enabled":"Disabled"})}),(0,i.jsx)("td",{children:(0,i.jsx)("button",{type:"button",onClick:()=>(e=>{Y((0,a.A)((0,a.A)({},V),{},{registers:V.registers.filter((s,t)=>t!==e)}))})(s),className:"btn-icon btn-icon-danger",title:"Remove",children:"\u2715"})})]},s))})]})]}):(0,i.jsx)("div",{className:"empty-state",children:"No registers configured yet. Add registers above to define what data to read from this slave device."})]})]})}),(0,i.jsxs)("div",{className:"modal-footer",children:[(0,i.jsx)("button",{type:"button",className:"btn btn-primary",onClick:e=>{e.preventDefault(),he()},children:T?"Save Changes":"Create Slave"}),(0,i.jsx)("button",{type:"button",onClick:()=>{I(!1),D(null)},className:"btn btn-secondary",children:"Cancel"})]})]})}),Q.show&&Q.preset&&(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},children:(0,i.jsxs)("div",{style:{background:t?"#2d2d2d":"white",borderRadius:"16px",padding:"2rem",maxWidth:"500px",width:"90%",boxShadow:t?"0 20px 60px rgba(0,0,0,0.6)":"0 20px 60px rgba(0,0,0,0.3)",border:"2px solid #7f1d1d",animation:"slideIn 0.2s ease-out"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1.5rem"},children:[(0,i.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem",animation:"pulse 2s infinite"},children:"\ud83d\uddd1\ufe0f"}),(0,i.jsx)("h3",{style:{fontSize:"1.5rem",fontWeight:"600",margin:0,color:"#7f1d1d"},children:"Delete Preset"})]}),(0,i.jsxs)("div",{style:{marginBottom:"1.5rem",color:t?"#b0b0b0":"#495057",lineHeight:"1.6"},children:[(0,i.jsxs)("p",{style:{marginBottom:"1rem"},children:["Are you sure you want to delete preset ",(0,i.jsx)("strong",{style:{color:t?"#e0e0e0":"#2c3e50"},children:Q.preset.name}),"?"]}),(0,i.jsxs)("div",{style:{background:t?"rgba(127, 29, 29, 0.1)":"#fee2e2",border:t?"1px solid rgba(127, 29, 29, 0.3)":"1px solid #fecaca",borderRadius:"8px",padding:"0.75rem 1rem",fontSize:"0.9rem",color:t?"#fca5a5":"#991b1b"},children:[(0,i.jsx)("strong",{children:"\u26a0\ufe0f Warning:"})," This will permanently delete the preset configuration. Devices using this preset will need to be reconfigured."]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[(0,i.jsx)("button",{onClick:()=>X({show:!1,preset:null}),style:{background:t?"#3a3a3a":"#e0e0e0",color:t?"#e0e0e0":"#495057",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},onMouseOver:e=>e.currentTarget.style.background=t?"#4a4a4a":"#d0d0d0",onMouseOut:e=>e.currentTarget.style.background=t?"#3a3a3a":"#e0e0e0",children:"Cancel"}),(0,i.jsx)("button",{onClick:async()=>{if(Q.preset)try{await r.K.deletePreset(Q.preset.id);const e=o.filter(e=>e.id!==Q.preset.id);d(e);const s=f.toLowerCase(),t=e.filter(e=>e.name.toLowerCase().includes(s)||e.config_id.toLowerCase().includes(s)||e.description.toLowerCase().includes(s));h(t),X({show:!1,preset:null}),se({show:!0,message:'Preset "'.concat(Q.preset.name,'" has been deleted successfully.')})}catch(e){u(e instanceof Error?e.message:"Failed to delete preset"),X({show:!1,preset:null})}},style:{background:"linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%)",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",boxShadow:"0 4px 12px rgba(127, 29, 29, 0.3)",transition:"all 0.2s"},onMouseOver:e=>e.currentTarget.style.transform="translateY(-1px)",onMouseOut:e=>e.currentTarget.style.transform="translateY(0)",children:"Yes, Delete"})]})]})}),Z.show&&Z.slave&&(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},children:(0,i.jsxs)("div",{style:{background:t?"#2d2d2d":"white",borderRadius:"16px",padding:"2rem",maxWidth:"500px",width:"90%",boxShadow:t?"0 20px 60px rgba(0,0,0,0.6)":"0 20px 60px rgba(0,0,0,0.3)",border:"2px solid #dc3545",animation:"slideIn 0.2s ease-out"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1.5rem"},children:[(0,i.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem",animation:"pulse 2s infinite"},children:"\u26a0\ufe0f"}),(0,i.jsx)("h3",{style:{fontSize:"1.5rem",fontWeight:"600",margin:0,color:"#dc3545"},children:"Remove Slave Device"})]}),(0,i.jsxs)("div",{style:{marginBottom:"1.5rem",color:t?"#b0b0b0":"#495057",lineHeight:"1.6"},children:[(0,i.jsxs)("p",{style:{marginBottom:"1rem"},children:["Are you sure you want to remove slave device ",(0,i.jsx)("strong",{style:{color:t?"#e0e0e0":"#2c3e50"},children:Z.slave.deviceName})," (ID: ",Z.slave.slaveId,")?"]}),(0,i.jsxs)("div",{style:{background:t?"rgba(220, 53, 69, 0.1)":"#f8d7da",border:t?"1px solid rgba(220, 53, 69, 0.3)":"1px solid #f5c6cb",borderRadius:"8px",padding:"0.75rem 1rem",fontSize:"0.9rem",color:t?"#ff9999":"#721c24"},children:[(0,i.jsx)("strong",{children:"\u26a0\ufe0f Warning:"})," This will remove the slave device configuration and all its register mappings."]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[(0,i.jsx)("button",{onClick:()=>$({show:!1,slave:null}),style:{background:t?"#3a3a3a":"#e0e0e0",color:t?"#e0e0e0":"#495057",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},onMouseOver:e=>e.currentTarget.style.background=t?"#4a4a4a":"#d0d0d0",onMouseOut:e=>e.currentTarget.style.background=t?"#3a3a3a":"#e0e0e0",children:"Cancel"}),(0,i.jsx)("button",{onClick:async()=>{if(Z.slave&&A)try{await r.K.deleteSlave(A.config_id,Z.slave.slaveId);const e=C.filter(e=>e.id!==Z.slave.id);S(e),ce(A.config_id,e.length),$({show:!1,slave:null}),se({show:!0,message:'Slave device "'.concat(Z.slave.deviceName,'" has been removed.')})}catch(e){u(e instanceof Error?e.message:"Failed to delete slave"),$({show:!1,slave:null})}},style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",boxShadow:"0 4px 12px rgba(220, 53, 69, 0.3)",transition:"all 0.2s"},onMouseOver:e=>e.currentTarget.style.transform="translateY(-1px)",onMouseOut:e=>e.currentTarget.style.transform="translateY(0)",children:"Yes, Remove"})]})]})}),ee.show&&(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(2px)"},children:(0,i.jsx)("div",{style:{background:t?"#2d2d2d":"white",borderRadius:"16px",padding:"2rem",maxWidth:"450px",width:"90%",boxShadow:t?"0 20px 60px rgba(0,0,0,0.6)":"0 20px 60px rgba(0,0,0,0.3)",border:t?"1px solid #28a745":"2px solid #28a745",animation:"slideIn 0.2s ease-out"},children:(0,i.jsxs)("div",{style:{textAlign:"center"},children:[(0,i.jsx)("div",{style:{width:"64px",height:"64px",borderRadius:"50%",background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"2rem",margin:"0 auto 1rem",animation:"scaleIn 0.3s ease-out"},children:"\u2713"}),(0,i.jsx)("h3",{style:{fontSize:"1.5rem",fontWeight:"600",marginBottom:"1rem",color:t?"#e0e0e0":"#2c3e50"},children:"Success"}),(0,i.jsx)("p",{style:{color:t?"#b0b0b0":"#495057",lineHeight:"1.6",marginBottom:"1.5rem"},children:ee.message}),(0,i.jsx)("button",{onClick:()=>se({show:!1,message:""}),style:{background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",color:"white",border:"none",padding:"0.75rem 2rem",borderRadius:"8px",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",boxShadow:"0 4px 12px rgba(40, 167, 69, 0.3)",transition:"all 0.2s"},onMouseOver:e=>e.currentTarget.style.transform="translateY(-1px)",onMouseOut:e=>e.currentTarget.style.transform="translateY(0)",children:"Got it!"})]})})})]})}}}]);
//# sourceMappingURL=35.515868d3.chunk.js.map