{"version":3,"file":"static/js/35.3728da18.chunk.js","mappings":"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","sources":["components/DevicePresets.tsx","services/cacheService.ts","services/api.ts"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { apiService } from '../services/api';\r\nimport { useTheme } from '../contexts/ThemeContext';\r\n\r\ninterface Preset {\r\n  id: number;\r\n  config_id: string;\r\n  name: string;\r\n  description: string;\r\n  gateway_configuration: {\r\n    general_settings: {\r\n      config_id: string;\r\n      schema_version: number;\r\n      last_updated: string;\r\n    };\r\n    uart_configuration: {\r\n      baud_rate: number;\r\n      data_bits: number;\r\n      stop_bits: number;\r\n      parity: string;\r\n    };\r\n  };\r\n  slaves_count: number;\r\n}\r\n\r\ninterface SlaveDevice {\r\n  id: number;\r\n  slaveId: number;\r\n  deviceName: string;\r\n  pollingIntervalMs: number;\r\n  timeoutMs: number;\r\n  enabled: boolean;\r\n  attached?: boolean;\r\n  registers: RegisterMapping[];\r\n}\r\n\r\ninterface RegisterMapping {\r\n  id: number;\r\n  label: string;\r\n  address: number;\r\n  numRegisters: number;\r\n  functionCode: number;\r\n  registerType?: number;\r\n  dataType: number;\r\n  byteOrder?: number;\r\n  wordOrder?: number;\r\n  accessMode?: number;\r\n  scaleFactor: number;\r\n  offset: number;\r\n  unit?: string;\r\n  decimalPlaces?: number;\r\n  category?: string;\r\n  highAlarmThreshold?: number | null;\r\n  lowAlarmThreshold?: number | null;\r\n  description?: string;\r\n  enabled: boolean;\r\n}\r\n\r\nconst DevicePresets: React.FC = () => {\r\n  const { isDark } = useTheme();\r\n  const [presets, setPresets] = useState<Preset[]>([]);\r\n  const [filteredPresets, setFilteredPresets] = useState<Preset[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [editingPreset, setEditingPreset] = useState<Preset | null>(null);\r\n  const [creatingPreset, setCreatingPreset] = useState(false);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [selectedPreset, setSelectedPreset] = useState<Preset | null>(null);\r\n  const [configuringSlaves, setConfiguringSlaves] = useState<Preset | null>(null);\r\n  const [slaves, setSlaves] = useState<SlaveDevice[]>([]);\r\n  const [creatingSlave, setCreatingSlave] = useState(false);\r\n  const [editingSlave, setEditingSlave] = useState<SlaveDevice | null>(null);\r\n  const [createPresetSlaveMode, setCreatePresetSlaveMode] = useState<'none' | 'create' | 'select'>('none');\r\n  const [globalSlaves, setGlobalSlaves] = useState<SlaveDevice[]>([]);\r\n  const [globalSlavesLoading, setGlobalSlavesLoading] = useState(false);\r\n  const [selectedGlobalSlaveIds, setSelectedGlobalSlaveIds] = useState<number[]>([]);\r\n  const [slaveSearch, setSlaveSearch] = useState('');\r\n  const [editForm, setEditForm] = useState({\r\n    config_id: '',\r\n    name: '',\r\n    description: '',\r\n    baud_rate: 9600,\r\n    data_bits: 8,\r\n    stop_bits: 1,\r\n    parity: 0,\r\n  });\r\n  const [createForm, setCreateForm] = useState({\r\n    name: '',\r\n    description: '',\r\n    baud_rate: 9600,\r\n    data_bits: 8,\r\n    stop_bits: 1,\r\n    parity: 0,\r\n  });\r\n  const [slaveForm, setSlaveForm] = useState({\r\n    slave_id: '',\r\n    device_name: '',\r\n    polling_interval_ms: 5000,\r\n    timeout_ms: 1000,\r\n    enabled: true,\r\n    registers: [] as RegisterMapping[]\r\n  });\r\n  const [registerForm, setRegisterForm] = useState({\r\n    label: '',\r\n    address: 0,\r\n    num_registers: 1,\r\n    function_code: 3,\r\n    register_type: 3,\r\n    data_type: 0,\r\n    byte_order: 0,\r\n    word_order: 0,\r\n    access_mode: 0,\r\n    scale_factor: 1.0,\r\n    offset: 0.0,\r\n    unit: '',\r\n    decimal_places: 2,\r\n    category: 'Electrical',\r\n    high_alarm_threshold: null as number | null,\r\n    low_alarm_threshold: null as number | null,\r\n    description: '',\r\n    enabled: true,\r\n  });\r\n\r\n  // Modern modal states\r\n  const [deletePresetModal, setDeletePresetModal] = useState<{ show: boolean; preset: Preset | null }>({ show: false, preset: null });\r\n  const [deleteSlaveModal, setDeleteSlaveModal] = useState<{ show: boolean; slave: SlaveDevice | null }>({ show: false, slave: null });\r\n  const [successModal, setSuccessModal] = useState<{ show: boolean; message: string }>({ show: false, message: '' });\r\n\r\n  useEffect(() => {\r\n    fetchPresets();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!creatingPreset || createPresetSlaveMode !== 'select') return;\r\n\r\n    const fetchGlobalSlaves = async () => {\r\n      try {\r\n        setGlobalSlavesLoading(true);\r\n        const data = await apiService.getGlobalSlaves();\r\n        const mapped = data.map((slave: any) => ({\r\n          id: slave.id,\r\n          slaveId: slave.slave_id,\r\n          deviceName: slave.device_name,\r\n          pollingIntervalMs: slave.polling_interval_ms,\r\n          timeoutMs: slave.timeout_ms,\r\n          enabled: slave.enabled,\r\n          registers: slave.registers || [],\r\n        }));\r\n        setGlobalSlaves(mapped);\r\n      } catch (err) {\r\n        console.error('Failed to fetch global slaves:', err);\r\n      } finally {\r\n        setGlobalSlavesLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchGlobalSlaves();\r\n  }, [creatingPreset, createPresetSlaveMode]);\r\n\r\n  const [debouncedSearchTerm, setDebouncedSearchTerm] = useState('');\r\n\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setDebouncedSearchTerm(searchTerm);\r\n    }, 300);\r\n    return () => clearTimeout(timer);\r\n  }, [searchTerm]);\r\n\r\n  useEffect(() => {\r\n    fetchPresets(debouncedSearchTerm);\r\n  }, [debouncedSearchTerm]);\r\n\r\n  useEffect(() => {\r\n    if (!creatingPreset) return;\r\n    setSlaveForm({\r\n      slave_id: '',\r\n      device_name: '',\r\n      polling_interval_ms: 5000,\r\n      timeout_ms: 1000,\r\n      enabled: true,\r\n      registers: [] as RegisterMapping[]\r\n    });\r\n    setRegisterForm({\r\n      label: '',\r\n      address: 0,\r\n      num_registers: 1,\r\n      function_code: 3,\r\n      register_type: 3,\r\n      data_type: 0,\r\n      byte_order: 0,\r\n      word_order: 0,\r\n      access_mode: 0,\r\n      scale_factor: 1.0,\r\n      offset: 0.0,\r\n      unit: '',\r\n      decimal_places: 2,\r\n      category: 'Electrical',\r\n      high_alarm_threshold: null,\r\n      low_alarm_threshold: null,\r\n      description: '',\r\n      enabled: true,\r\n    });\r\n  }, [creatingPreset]);\r\n\r\n  const fetchPresets = async (search?: string) => {\r\n    try {\r\n      const data = await apiService.getPresets();\r\n      // Filter presets based on search term\r\n      let filteredData = data;\r\n      if (search) {\r\n        const searchLower = search.toLowerCase();\r\n        filteredData = data.filter((preset: Preset) =>\r\n          preset.name.toLowerCase().includes(searchLower) ||\r\n          preset.config_id.toLowerCase().includes(searchLower) ||\r\n          preset.description.toLowerCase().includes(searchLower)\r\n        );\r\n      }\r\n      setPresets(data);\r\n      setFilteredPresets(filteredData);\r\n      setLoading(false);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'An error occurred');\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSearch = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setSearchTerm(e.target.value);\r\n  };\r\n\r\n  const handleEdit = (preset: Preset) => {\r\n    setEditingPreset(preset);\r\n    setEditForm({\r\n      config_id: preset.gateway_configuration.general_settings.config_id,\r\n      name: preset.name,\r\n      description: preset.description,\r\n      baud_rate: preset.gateway_configuration.uart_configuration.baud_rate,\r\n      data_bits: preset.gateway_configuration.uart_configuration.data_bits,\r\n      stop_bits: preset.gateway_configuration.uart_configuration.stop_bits,\r\n      parity: preset.gateway_configuration.uart_configuration.parity === 'None' ? 0 : \r\n              preset.gateway_configuration.uart_configuration.parity === 'Odd' ? 1 : 2,\r\n    });\r\n    // Load slaves for this preset so they are visible in the edit modal\r\n    fetchSlavesForPreset(preset.gateway_configuration.general_settings.config_id).catch((e) => {\r\n      console.error('Failed to load slaves for preset edit:', e);\r\n    });\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    if (!editingPreset) return;\r\n\r\n    try {\r\n      await apiService.updatePreset(editingPreset.id, editForm);\r\n      setEditingPreset(null);\r\n      // Refetch to get the updated preset with all fields\r\n      await fetchPresets(searchTerm);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to update preset');\r\n    }\r\n  };\r\n\r\n  const handleCreate = async () => {\r\n    try {\r\n      const result = await apiService.createPreset(createForm);\r\n      const createdConfigId =\r\n        result?.gateway_configuration?.general_settings?.config_id ||\r\n        result?.config_id ||\r\n        result?.configId ||\r\n        '';\r\n\r\n      if (!createdConfigId && createPresetSlaveMode !== 'none') {\r\n        setError('Preset created but config id was not returned. Slave setup skipped.');\r\n      }\r\n\r\n      if (createdConfigId && createPresetSlaveMode === 'create') {\r\n        if (!slaveForm.slave_id || !slaveForm.device_name) {\r\n          setError('Slave ID and Device Name are required to create a slave.');\r\n          return;\r\n        }\r\n        await apiService.createSlave(createdConfigId, {\r\n          slave_id: parseInt(slaveForm.slave_id),\r\n          device_name: slaveForm.device_name,\r\n          polling_interval_ms: slaveForm.polling_interval_ms,\r\n          timeout_ms: slaveForm.timeout_ms,\r\n          enabled: slaveForm.enabled,\r\n          registers: slaveForm.registers,\r\n        });\r\n      }\r\n\r\n      if (createdConfigId && createPresetSlaveMode === 'select' && selectedGlobalSlaveIds.length > 0) {\r\n        await apiService.addSlavesToPreset(createdConfigId, selectedGlobalSlaveIds);\r\n      }\r\n\r\n      setCreatingPreset(false);\r\n      setCreatePresetSlaveMode('none');\r\n      setSelectedGlobalSlaveIds([]);\r\n      setCreateForm({\r\n        name: '',\r\n        description: '',\r\n        baud_rate: 9600,\r\n        data_bits: 8,\r\n        stop_bits: 1,\r\n        parity: 0,\r\n      });\r\n      // Refetch to get the new preset with all fields\r\n      await fetchPresets(searchTerm);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to create preset');\r\n    }\r\n  };\r\n\r\n  const handleDelete = (preset: any) => {\r\n    console.log(' handleDelete called with preset:', preset.name);\r\n    setDeletePresetModal({ show: true, preset });\r\n  };\r\n\r\n  const confirmDeletePreset = async () => {\r\n    if (!deletePresetModal.preset) return;\r\n    \r\n    try {\r\n      await apiService.deletePreset(deletePresetModal.preset.id);\r\n      const updatedPresets = presets.filter(p => p.id !== deletePresetModal.preset!.id);\r\n      setPresets(updatedPresets);\r\n      // Also update filtered presets to remove the deleted preset immediately\r\n      const searchLower = searchTerm.toLowerCase();\r\n      const updatedFiltered = updatedPresets.filter((preset: Preset) =>\r\n        preset.name.toLowerCase().includes(searchLower) ||\r\n        preset.config_id.toLowerCase().includes(searchLower) ||\r\n        preset.description.toLowerCase().includes(searchLower)\r\n      );\r\n      setFilteredPresets(updatedFiltered);\r\n      setDeletePresetModal({ show: false, preset: null });\r\n      setSuccessModal({ \r\n        show: true, \r\n        message: `Preset \"${deletePresetModal.preset.name}\" has been deleted successfully.` \r\n      });\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to delete preset');\r\n      setDeletePresetModal({ show: false, preset: null });\r\n    }\r\n  };\r\n\r\n  const handleViewDetails = (preset: Preset) => {\r\n    setSelectedPreset(preset);\r\n  };\r\n\r\n  const handleCloseDetails = () => {\r\n    setSelectedPreset(null);\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setEditingPreset(null);\r\n    setCreatingPreset(false);\r\n    setCreatePresetSlaveMode('none');\r\n    setSelectedGlobalSlaveIds([]);\r\n    setSlaveSearch('');\r\n  };\r\n\r\n  const getDataTypeName = (dataType: number): string => {\r\n    const types: Record<number, string> = {\r\n      0: 'UINT16', 1: 'INT16', 2: 'UINT32', 3: 'INT32',\r\n      4: 'FLOAT32', 5: 'UINT64', 6: 'INT64', 7: 'FLOAT64',\r\n      8: 'BOOL', 9: 'STRING',\r\n    };\r\n    return types[dataType] ?? `Unknown (${dataType})`;\r\n  };\r\n\r\n  const handleConfigureSlaves = async (preset: Preset) => {\r\n    setConfiguringSlaves(preset);\r\n    await fetchSlavesForPreset(preset.config_id);\r\n  };\r\n\r\n  const fetchSlavesForPreset = async (configId: string) => {\r\n    try {\r\n      // Fetch both preset-attached slaves and global (unattached) slaves\r\n      const [attachedData, globalData] = await Promise.all([\r\n        apiService.getSlaves(configId),\r\n        apiService.getGlobalSlaves(),\r\n      ]);\r\n\r\n      const attachedIds = new Set(attachedData.map((s: any) => s.id));\r\n\r\n      const mapSlave = (slave: any, attached: boolean) => ({\r\n        id: slave.id,\r\n        slaveId: slave.slave_id,\r\n        deviceName: slave.device_name,\r\n        pollingIntervalMs: slave.polling_interval_ms,\r\n        timeoutMs: slave.timeout_ms,\r\n        enabled: slave.enabled,\r\n        attached,\r\n        registers: (slave.registers || []).map((reg: any) => ({\r\n          id: reg.id,\r\n          label: reg.label,\r\n          address: reg.address,\r\n          numRegisters: reg.num_registers,\r\n          functionCode: reg.function_code,\r\n          dataType: reg.data_type,\r\n          scaleFactor: reg.scale_factor,\r\n          offset: reg.offset,\r\n          enabled: reg.enabled,\r\n        }))\r\n      });\r\n\r\n      const mappedAttached = attachedData.map((s: any) => mapSlave(s, true));\r\n      const mappedGlobals = (globalData || [])\r\n        .filter((s: any) => !attachedIds.has(s.id))\r\n        .map((s: any) => mapSlave(s, false));\r\n\r\n      // Show attached slaves first, then available global slaves\r\n      setSlaves([...mappedAttached, ...mappedGlobals]);\r\n    } catch (err) {\r\n      console.error('Failed to fetch slaves:', err);\r\n      setError('Failed to load slaves for this preset');\r\n    }\r\n  };\r\n\r\n  const updatePresetSlaveCount = (configId: string, count: number) => {\r\n    // Update presets state\r\n    const updatedPresets = presets.map(p => \r\n      p.config_id === configId ? { ...p, slaves_count: count } : p\r\n    );\r\n    setPresets(updatedPresets);\r\n    \r\n    // Update filtered presets\r\n    const searchLower = searchTerm.toLowerCase();\r\n    const updatedFiltered = updatedPresets.filter((preset: Preset) =>\r\n      preset.name.toLowerCase().includes(searchLower) ||\r\n      preset.config_id.toLowerCase().includes(searchLower) ||\r\n      preset.description.toLowerCase().includes(searchLower)\r\n    );\r\n    setFilteredPresets(updatedFiltered);\r\n    \r\n    // Update configuringSlaves if it's the same preset\r\n    if (configuringSlaves && configuringSlaves.config_id === configId) {\r\n      setConfiguringSlaves({ ...configuringSlaves, slaves_count: count });\r\n    }\r\n  };\r\n\r\n  const handleCancelSlaveConfig = () => {\r\n    setConfiguringSlaves(null);\r\n    setSlaves([]);\r\n    setCreatingSlave(false);\r\n    setEditingSlave(null);\r\n    setSlaveForm({\r\n      slave_id: '',\r\n      device_name: '',\r\n      polling_interval_ms: 5000,\r\n      timeout_ms: 1000,\r\n      enabled: true,\r\n      registers: []\r\n    });\r\n  };\r\n\r\n  const handleCreateSlave = () => {\r\n    setSlaveForm({\r\n      slave_id: '',\r\n      device_name: '',\r\n      polling_interval_ms: 5000,\r\n      timeout_ms: 1000,\r\n      enabled: true,\r\n      registers: []\r\n    });\r\n    // Ensure we are not editing an existing slave when opening the create modal\r\n    setEditingSlave(null);\r\n    setCreatingSlave(true);\r\n  };\r\n\r\n  const handleEditSlave = (slave: SlaveDevice) => {\r\n    setSlaveForm({\r\n      slave_id: slave.slaveId.toString(),\r\n      device_name: slave.deviceName,\r\n      polling_interval_ms: slave.pollingIntervalMs,\r\n      timeout_ms: slave.timeoutMs,\r\n      enabled: slave.enabled,\r\n      registers: [...slave.registers]\r\n    });\r\n    setEditingSlave(slave);\r\n  };\r\n\r\n  const handleAttachSlaveToPreset = async (slave: SlaveDevice) => {\r\n    if (!configuringSlaves) return;\r\n    try {\r\n      await apiService.addSlavesToPreset(configuringSlaves.config_id, [slave.id]);\r\n      // refresh list for this preset\r\n      await fetchSlavesForPreset(configuringSlaves.config_id);\r\n      updatePresetSlaveCount(configuringSlaves.config_id, slaves.filter(s => s.attached).length + 1);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to attach slave to preset');\r\n    }\r\n  };\r\n\r\n  const handleDetachSlaveFromPreset = async (slave: SlaveDevice) => {\r\n    if (!configuringSlaves) return;\r\n    try {\r\n      await apiService.detachSlaveFromPreset(configuringSlaves.config_id, slave.slaveId);\r\n      // refresh list for this preset\r\n      await fetchSlavesForPreset(configuringSlaves.config_id);\r\n      updatePresetSlaveCount(configuringSlaves.config_id, slaves.filter(s => s.attached).length - 1);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to detach slave from preset');\r\n    }\r\n  };\r\n\r\n  const handleSaveSlave = async () => {\r\n    if (!configuringSlaves) return;\r\n\r\n    // Validate slave ID uniqueness for new slaves\r\n    if (!editingSlave) {\r\n      const slaveId = parseInt(slaveForm.slave_id);\r\n      const existingSlave = slaves.find(s => s.slaveId === slaveId);\r\n      if (existingSlave) {\r\n        setError(`Slave ID ${slaveId} already exists for this configuration. Please choose a different ID.`);\r\n        return;\r\n      }\r\n    }\r\n\r\n    try {\r\n      const slaveData = {\r\n        slave_id: parseInt(slaveForm.slave_id),\r\n        device_name: slaveForm.device_name,\r\n        polling_interval_ms: slaveForm.polling_interval_ms,\r\n        timeout_ms: slaveForm.timeout_ms,\r\n        enabled: slaveForm.enabled,\r\n        registers: slaveForm.registers\r\n      };\r\n\r\n      if (editingSlave) {\r\n        const updatedSlave = await apiService.updateSlave(configuringSlaves.config_id, editingSlave.slaveId, slaveData);\r\n        // Map response to match interface\r\n        const mappedSlave = {\r\n          id: updatedSlave.id,\r\n          slaveId: updatedSlave.slave_id,\r\n          deviceName: updatedSlave.device_name,\r\n          pollingIntervalMs: updatedSlave.polling_interval_ms,\r\n          timeoutMs: updatedSlave.timeout_ms,\r\n          enabled: updatedSlave.enabled,\r\n          registers: updatedSlave.registers.map((reg: any) => ({\r\n            id: reg.id,\r\n            label: reg.label,\r\n            address: reg.address,\r\n            numRegisters: reg.num_registers,\r\n            functionCode: reg.function_code,\r\n            dataType: reg.data_type,\r\n            scaleFactor: reg.scale_factor,\r\n            offset: reg.offset,\r\n            enabled: reg.enabled,\r\n          }))\r\n        };\r\n        const updatedSlaves = slaves.map(s => s.slaveId === editingSlave.slaveId ? mappedSlave : s);\r\n        setSlaves(updatedSlaves);\r\n        // Update preset count\r\n        updatePresetSlaveCount(configuringSlaves.config_id, updatedSlaves.length);\r\n        setEditingSlave(null);\r\n      } else {\r\n        const newSlave = await apiService.createSlave(configuringSlaves.config_id, slaveData);\r\n        // Map response to match interface\r\n        const mappedSlave = {\r\n          id: newSlave.id,\r\n          slaveId: newSlave.slave_id,\r\n          deviceName: newSlave.device_name,\r\n          pollingIntervalMs: newSlave.polling_interval_ms,\r\n          timeoutMs: newSlave.timeout_ms,\r\n          enabled: newSlave.enabled,\r\n          registers: newSlave.registers.map((reg: any) => ({\r\n            id: reg.id,\r\n            label: reg.label,\r\n            address: reg.address,\r\n            numRegisters: reg.num_registers,\r\n            functionCode: reg.function_code,\r\n            dataType: reg.data_type,\r\n            scaleFactor: reg.scale_factor,\r\n            offset: reg.offset,\r\n            enabled: reg.enabled,\r\n          }))\r\n        };\r\n        const updatedSlaves = [...slaves, mappedSlave];\r\n        setSlaves(updatedSlaves);\r\n        // Update preset count\r\n        updatePresetSlaveCount(configuringSlaves.config_id, updatedSlaves.length);\r\n        setCreatingSlave(false);\r\n      }\r\n\r\n      setSlaveForm({\r\n        slave_id: '',\r\n        device_name: '',\r\n        polling_interval_ms: 5000,\r\n        timeout_ms: 1000,\r\n        enabled: true,\r\n        registers: []\r\n      });\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to save slave');\r\n    }\r\n  };\r\n\r\n  const handleDeleteSlave = (slave: SlaveDevice) => {\r\n    if (!configuringSlaves) return;\r\n    console.log(' handleDeleteSlave called with slave:', slave.deviceName);\r\n    setDeleteSlaveModal({ show: true, slave });\r\n  };\r\n\r\n  const confirmDeleteSlave = async () => {\r\n    if (!deleteSlaveModal.slave || !configuringSlaves) return;\r\n    \r\n    try {\r\n      await apiService.deleteSlave(configuringSlaves.config_id, deleteSlaveModal.slave.slaveId);\r\n      const updatedSlaves = slaves.filter(s => s.id !== deleteSlaveModal.slave!.id);\r\n      setSlaves(updatedSlaves);\r\n      // Update preset count\r\n      updatePresetSlaveCount(configuringSlaves.config_id, updatedSlaves.length);\r\n      setDeleteSlaveModal({ show: false, slave: null });\r\n      setSuccessModal({ \r\n        show: true, \r\n        message: `Slave device \"${deleteSlaveModal.slave.deviceName}\" has been removed.` \r\n      });\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to delete slave');\r\n      setDeleteSlaveModal({ show: false, slave: null });\r\n    }\r\n  };\r\n\r\n  const addRegister = () => {\r\n    const newRegister: RegisterMapping = {\r\n      id: Date.now(),\r\n      label: registerForm.label,\r\n      address: registerForm.address,\r\n      numRegisters: registerForm.num_registers,\r\n      functionCode: registerForm.function_code,\r\n      registerType: registerForm.register_type,\r\n      dataType: registerForm.data_type,\r\n      byteOrder: registerForm.byte_order,\r\n      wordOrder: registerForm.word_order,\r\n      accessMode: registerForm.access_mode,\r\n      scaleFactor: registerForm.scale_factor,\r\n      offset: registerForm.offset,\r\n      unit: registerForm.unit,\r\n      decimalPlaces: registerForm.decimal_places,\r\n      category: registerForm.category,\r\n      highAlarmThreshold: registerForm.high_alarm_threshold,\r\n      lowAlarmThreshold: registerForm.low_alarm_threshold,\r\n      description: registerForm.description,\r\n      enabled: registerForm.enabled,\r\n    };\r\n\r\n    setSlaveForm({ ...slaveForm, registers: [...slaveForm.registers, newRegister] });\r\n\r\n    setRegisterForm({\r\n      label: '',\r\n      address: 0,\r\n      num_registers: 1,\r\n      function_code: 3,\r\n      register_type: 3,\r\n      data_type: 0,\r\n      byte_order: 0,\r\n      word_order: 0,\r\n      access_mode: 0,\r\n      scale_factor: 1.0,\r\n      offset: 0.0,\r\n      unit: '',\r\n      decimal_places: 2,\r\n      category: 'Electrical',\r\n      high_alarm_threshold: null,\r\n      low_alarm_threshold: null,\r\n      description: '',\r\n      enabled: true,\r\n    });\r\n  };\r\n\r\n  const removeRegister = (index: number) => {\r\n    setSlaveForm({\r\n      ...slaveForm,\r\n      registers: slaveForm.registers.filter((_, i) => i !== index)\r\n    });\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"loading\">Loading presets...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div className=\"error\">Error: {error}</div>;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h1>Device Presets</h1>\r\n\r\n      <div className=\"card\">\r\n        <div className=\"card-header\">\r\n          <h2>Presets ({filteredPresets.length})</h2>\r\n          <div className=\"card-actions\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search presets...\"\r\n              value={searchTerm}\r\n              onChange={handleSearch}\r\n              className=\"search-input\"\r\n            />\r\n            <button onClick={() => setCreatingPreset(true)} className=\"btn\">\r\n              Create New Preset\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <table className=\"table\">\r\n          <thead>\r\n            <tr>\r\n              <th style={{ textAlign: 'center' }}>Name</th>\r\n              <th style={{ textAlign: 'center' }}>Config ID</th>\r\n              <th style={{ textAlign: 'center' }}>Description</th>\r\n              <th style={{ textAlign: 'center' }}>Slaves</th>\r\n              <th style={{ textAlign: 'center' }}>Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {filteredPresets.map((preset) => (\r\n              <tr key={preset.id}>\r\n                <td style={{ textAlign: 'center' }}>{preset.name}</td>\r\n                <td style={{ textAlign: 'center' }}>{preset.config_id}</td>\r\n                <td style={{ textAlign: 'center' }}>{preset.description}</td>\r\n                <td style={{ textAlign: 'center' }}>{preset.slaves_count || 0}</td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <button onClick={() => handleViewDetails(preset)} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#94a3b8', margin: '0 6px' }} title=\"View Details\">\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                      <path d=\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\"></path>\r\n                      <circle cx=\"12\" cy=\"12\" r=\"3\"></circle>\r\n                    </svg>\r\n                  </button>\r\n                  <button onClick={() => handleConfigureSlaves(preset)} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#6366f1', margin: '0 6px' }} title=\"Configure Slaves\">\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect>\r\n                      <line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line>\r\n                      <line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line>\r\n                      <line x1=\"21\" y1=\"3\" x2=\"3\" y2=\"21\"></line>\r\n                    </svg>\r\n                  </button>\r\n                  <button onClick={() => handleEdit(preset)} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#3b82f6', margin: '0 6px' }} title=\"Edit\">\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                      <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\r\n                      <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\r\n                    </svg>\r\n                  </button>\r\n                  <button onClick={() => handleDelete(preset)} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#ef4444', margin: '0 6px' }} title=\"Delete\">\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                      <polyline points=\"3,6 5,6 21,6\"></polyline>\r\n                      <path d=\"M19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2\"></path>\r\n                      <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\"></line>\r\n                      <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\"></line>\r\n                    </svg>\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {(editingPreset || creatingPreset) && (\r\n        <div className=\"modal\">\r\n          <div className=\"modal-content\">\r\n            <h3>{editingPreset ? `Edit Preset: ${editingPreset.name}` : 'Create New Preset'}</h3>\r\n            <div className=\"modal-body\">\r\n              <form onSubmit={(e) => { e.preventDefault(); editingPreset ? handleSave() : handleCreate(); }}>\r\n                \r\n                {/* Section 1: Preset Information */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Preset Details</h4>\r\n                  <div className=\"form-grid form-grid-2\">\r\n                    {editingPreset && (\r\n                      <div className=\"form-group\">\r\n                        <label>Config ID</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={editForm.config_id}\r\n                          onChange={(e) => setEditForm({...editForm, config_id: e.target.value})}\r\n                          required\r\n                          autoComplete=\"off\"\r\n                          readOnly\r\n                          className=\"form-control-readonly\"\r\n                        />\r\n                      </div>\r\n                    )}\r\n                    <div className=\"form-group\" style={editingPreset ? {} : { gridColumn: '1 / -1' }}>\r\n                      <label>Preset Name</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingPreset ? editForm.name : createForm.name}\r\n                        onChange={(e) => editingPreset ? setEditForm({...editForm, name: e.target.value}) : setCreateForm({...createForm, name: e.target.value})}\r\n                        required\r\n                        autoComplete=\"off\"\r\n                        placeholder=\"e.g., Standard Gateway Config\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"form-group full-width\">\r\n                      <label>Description</label>\r\n                      <textarea\r\n                        value={editingPreset ? editForm.description : createForm.description}\r\n                        onChange={(e) => editingPreset ? setEditForm({...editForm, description: e.target.value}) : setCreateForm({...createForm, description: e.target.value})}\r\n                        autoComplete=\"off\"\r\n                        placeholder=\"Describe the purpose of this preset...\"\r\n                        rows={2}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Section 2: UART Configuration */}\r\n                <div className=\"form-section compact-inputs\">\r\n                  <h4 className=\"form-section-title\">UART Configuration</h4>\r\n                  <div className=\"form-grid form-grid-4\">\r\n                    <div className=\"form-group\">\r\n                      <label>Baud Rate</label>\r\n                      <select\r\n                        value={editingPreset ? editForm.baud_rate : createForm.baud_rate}\r\n                        onChange={(e) => editingPreset ? setEditForm({...editForm, baud_rate: parseInt(e.target.value)}) : setCreateForm({...createForm, baud_rate: parseInt(e.target.value)})}\r\n                      >\r\n                        <option value={9600}>9600</option>\r\n                        <option value={19200}>19200</option>\r\n                        <option value={38400}>38400</option>\r\n                        <option value={57600}>57600</option>\r\n                        <option value={115200}>115200</option>\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label>Data Bits</label>\r\n                      <select\r\n                        value={editingPreset ? editForm.data_bits : createForm.data_bits}\r\n                        onChange={(e) => editingPreset ? setEditForm({...editForm, data_bits: parseInt(e.target.value)}) : setCreateForm({...createForm, data_bits: parseInt(e.target.value)})}\r\n                      >\r\n                        <option value={7}>7</option>\r\n                        <option value={8}>8</option>\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label>Stop Bits</label>\r\n                      <select\r\n                        value={editingPreset ? editForm.stop_bits : createForm.stop_bits}\r\n                        onChange={(e) => editingPreset ? setEditForm({...editForm, stop_bits: parseInt(e.target.value)}) : setCreateForm({...createForm, stop_bits: parseInt(e.target.value)})}\r\n                      >\r\n                        <option value={1}>1</option>\r\n                        <option value={2}>2</option>\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label>Parity</label>\r\n                      <select\r\n                        value={editingPreset ? editForm.parity : createForm.parity}\r\n                        onChange={(e) => editingPreset ? setEditForm({...editForm, parity: parseInt(e.target.value)}) : setCreateForm({...createForm, parity: parseInt(e.target.value)})}\r\n                      >\r\n                        <option value={0}>None</option>\r\n                        <option value={1}>Odd</option>\r\n                        <option value={2}>Even</option>\r\n                      </select>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Section 3: Initial Slave Setup (Create Mode Only) */}\r\n                {creatingPreset && (\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Initial Slave Setup</h4>\r\n                    <p className=\"form-section-desc\">Optionally configure a slave device for this preset immediately.</p>\r\n                    \r\n                    <div className=\"slave-options-container\">\r\n                      <div className=\"slave-option-card\">\r\n                        <div className=\"slave-option-header\">\r\n                          <label className=\"radio-card-label\">\r\n                            <input\r\n                              type=\"radio\"\r\n                              name=\"slaveMode\"\r\n                              checked={createPresetSlaveMode === 'create'}\r\n                              onChange={() => setCreatePresetSlaveMode('create')}\r\n                            />\r\n                            <span>Create New Slave</span>\r\n                          </label>\r\n                        </div>\r\n                        <div className={`slave-option-content ${createPresetSlaveMode === 'create' ? 'active' : ''}`}>\r\n                          <p className=\"text-sm text-muted\">Define a new slave device configuration from scratch.</p>\r\n                          {createPresetSlaveMode === 'create' && (\r\n                             <div className=\"nested-form\">\r\n                                <div className=\"form-grid form-grid-2\">\r\n                                  <div className=\"form-group\">\r\n                                    <label>Slave ID</label>\r\n                                    <input\r\n                                      type=\"number\"\r\n                                      value={slaveForm.slave_id}\r\n                                      onChange={(e) => setSlaveForm({ ...slaveForm, slave_id: e.target.value })}\r\n                                      required\r\n                                      placeholder=\"1-247\"\r\n                                    />\r\n                                  </div>\r\n                                  <div className=\"form-group\">\r\n                                    <label>Device Name</label>\r\n                                    <input\r\n                                      type=\"text\"\r\n                                      value={slaveForm.device_name}\r\n                                      onChange={(e) => setSlaveForm({ ...slaveForm, device_name: e.target.value })}\r\n                                      required\r\n                                      placeholder=\"Device Name\"\r\n                                    />\r\n                                  </div>\r\n                                  <div className=\"form-group\">\r\n                                    <label>Polling (ms)</label>\r\n                                    <input\r\n                                      type=\"number\"\r\n                                      value={slaveForm.polling_interval_ms}\r\n                                      onChange={(e) => setSlaveForm({ ...slaveForm, polling_interval_ms: parseInt(e.target.value) })}\r\n                                      placeholder=\"5000\"\r\n                                    />\r\n                                  </div>\r\n                                  <div className=\"form-group\">\r\n                                    <label>Timeout (ms)</label>\r\n                                    <input\r\n                                      type=\"number\"\r\n                                      value={slaveForm.timeout_ms}\r\n                                      onChange={(e) => setSlaveForm({ ...slaveForm, timeout_ms: parseInt(e.target.value) })}\r\n                                      placeholder=\"1000\"\r\n                                    />\r\n                                  </div>\r\n                                </div>\r\n                             </div>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"slave-option-card\">\r\n                        <div className=\"slave-option-header\">\r\n                          <label className=\"radio-card-label\">\r\n                            <input\r\n                              type=\"radio\"\r\n                              name=\"slaveMode\"\r\n                              checked={createPresetSlaveMode === 'select'}\r\n                              onChange={() => setCreatePresetSlaveMode('select')}\r\n                            />\r\n                            <span>Link Existing Slave</span>\r\n                          </label>\r\n                        </div>\r\n                        <div className={`slave-option-content ${createPresetSlaveMode === 'select' ? 'active' : ''}`}>\r\n                           <p className=\"text-sm text-muted\">Select an existing slave configuration to reuse.</p>\r\n                           {createPresetSlaveMode === 'select' && (\r\n                              <div style={{ marginTop: '10px' }}>\r\n                                {globalSlavesLoading ? (\r\n                                  <p className=\"text-sm text-muted\">Loading slaves...</p>\r\n                                ) : globalSlaves.length === 0 ? (\r\n                                  <p className=\"text-sm text-muted\">No existing slaves found.</p>\r\n                                ) : (() => {\r\n                                  const filtered = globalSlaves.filter(s =>\r\n                                    s.deviceName.toLowerCase().includes(slaveSearch.toLowerCase()) ||\r\n                                    String(s.slaveId).includes(slaveSearch)\r\n                                  );\r\n                                  return (\r\n                                    <>\r\n                                      <input\r\n                                        type=\"text\"\r\n                                        placeholder=\"Search by name or slave ID\"\r\n                                        value={slaveSearch}\r\n                                        onChange={(e) => setSlaveSearch(e.target.value)}\r\n                                        style={{ width: '100%', marginBottom: '8px', padding: '6px 10px', borderRadius: '4px', border: '1px solid rgba(148,163,184,0.25)', background: 'rgba(15,23,42,0.6)', color: '#f8fafc', fontSize: '0.875rem', boxSizing: 'border-box' }}\r\n                                      />\r\n                                      <div style={{ display: 'flex', flexDirection: 'column', gap: '6px', maxHeight: '200px', overflowY: 'auto', border: '1px solid rgba(148,163,184,0.15)', borderRadius: '4px', padding: '8px' }}>\r\n                                        {filtered.length === 0 ? (\r\n                                          <p style={{ margin: 0, color: '#94a3b8', fontSize: '0.85em' }}>No slaves match your search.</p>\r\n                                        ) : filtered.map((slave) => (\r\n                                          <label key={slave.id} style={{ display: 'flex', alignItems: 'center', gap: '10px', cursor: 'pointer', padding: '4px 6px', borderRadius: '3px', background: selectedGlobalSlaveIds.includes(slave.id) ? 'rgba(99,102,241,0.2)' : 'transparent' }}>\r\n                                            <input\r\n                                              type=\"checkbox\"\r\n                                              checked={selectedGlobalSlaveIds.includes(slave.id)}\r\n                                              onChange={(e) => {\r\n                                                if (e.target.checked) {\r\n                                                  setSelectedGlobalSlaveIds([...selectedGlobalSlaveIds, slave.id]);\r\n                                                } else {\r\n                                                  setSelectedGlobalSlaveIds(selectedGlobalSlaveIds.filter(id => id !== slave.id));\r\n                                                }\r\n                                              }}\r\n                                            />\r\n                                            <span><strong>{slave.deviceName}</strong> <span style={{ color: '#94a3b8', fontSize: '0.85em' }}>(Slave ID: {slave.slaveId})</span></span>\r\n                                          </label>\r\n                                        ))}\r\n                                      </div>\r\n                                      <small className=\"form-hint\" style={{ marginTop: '4px', display: 'block' }}>\r\n                                        {filtered.length} of {globalSlaves.length} shown\r\n                                        {selectedGlobalSlaveIds.length > 0 && (\r\n                                          <span className=\"form-hint-accent\">  {selectedGlobalSlaveIds.length} selected</span>\r\n                                        )}\r\n                                      </small>\r\n                                    </>\r\n                                  );\r\n                                })()}\r\n                              </div>\r\n                           )}\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"slave-option-card\">\r\n                        <div className=\"slave-option-header\">\r\n                          <label className=\"radio-card-label\">\r\n                            <input\r\n                              type=\"radio\"\r\n                              name=\"slaveMode\"\r\n                              checked={createPresetSlaveMode === 'none'}\r\n                              onChange={() => setCreatePresetSlaveMode('none')}\r\n                            />\r\n                            <span>Skip for Now</span>\r\n                          </label>\r\n                        </div>\r\n                        <div className=\"slave-option-content\">\r\n                          <p className=\"text-sm text-muted\">Create preset without any initial slave configuration.</p>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Section 4: Existing Slaves for this Preset (when editing) */}\r\n                {editingPreset && (\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Preset Slave Devices</h4>\r\n                    <div className=\"card\">\r\n                      <div className=\"card-header\">\r\n                        <h5>Slaves ({slaves.length})</h5>\r\n                        <button type=\"button\" onClick={() => handleConfigureSlaves(editingPreset)} className=\"btn btn-sm\">Configure Slaves</button>\r\n                      </div>\r\n                      {slaves.length === 0 ? (\r\n                        <div style={{ textAlign: 'center', padding: '10px', color: '#666' }}>\r\n                          <p>No slave devices for this preset.</p>\r\n                        </div>\r\n                      ) : (\r\n                        <table className=\"table\">\r\n                          <thead>\r\n                            <tr>\r\n                              <th style={{ textAlign: 'center' }}>Slave ID</th>\r\n                              <th style={{ textAlign: 'center' }}>Device Name</th>\r\n                              <th style={{ textAlign: 'center' }}>Polling</th>\r\n                              <th style={{ textAlign: 'center' }}>Timeout</th>\r\n                              <th style={{ textAlign: 'center' }}>Registers</th>\r\n                            </tr>\r\n                          </thead>\r\n                          <tbody>\r\n                            {slaves.map(s => (\r\n                              <tr key={s.id}>\r\n                                <td style={{ textAlign: 'center' }}>{s.slaveId}</td>\r\n                                <td>{s.deviceName}</td>\r\n                                <td style={{ textAlign: 'center' }}>{s.pollingIntervalMs}ms</td>\r\n                                <td style={{ textAlign: 'center' }}>{s.timeoutMs}ms</td>\r\n                                <td style={{ textAlign: 'center' }}>{s.registers.length}</td>\r\n                              </tr>\r\n                            ))}\r\n                          </tbody>\r\n                        </table>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n              </form>\r\n            </div>\r\n            <div className=\"form-actions\">\r\n              <button type=\"submit\" className=\"btn\" onClick={(e) => { e.preventDefault(); editingPreset ? handleSave() : handleCreate(); }}>{editingPreset ? 'Save' : 'Create'}</button>\r\n              <button type=\"button\" onClick={handleCancel} className=\"btn btn-secondary\">Cancel</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {selectedPreset && (\r\n        <div className=\"modal\">\r\n          <div className=\"modal-content\" style={{ maxWidth: '700px' }}>\r\n            <h3 style={{ marginBottom: 12 }}>Gateway Configuration: {selectedPreset.name}</h3>\r\n\r\n            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 20, marginBottom: 16, paddingLeft: 20 }}>\r\n              <div>\r\n                <h4 style={{ marginBottom: 8 }}>General Settings</h4>\r\n                <div style={{ paddingLeft: 0 }}>\r\n                  <p style={{ margin: '6px 0', wordBreak: 'break-word' }}><strong>Config ID:</strong> {selectedPreset.gateway_configuration.general_settings.config_id}</p>\r\n                  <p style={{ margin: '6px 0' }}><strong>Schema Version:</strong> {selectedPreset.gateway_configuration.general_settings.schema_version}</p>\r\n                  <p style={{ margin: '6px 0' }}><strong>Last Updated:</strong> {selectedPreset.gateway_configuration.general_settings.last_updated}</p>\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <h4 style={{ marginBottom: 8 }}>UART Configuration</h4>\r\n                <div style={{ paddingLeft: 0 }}>\r\n                  <p style={{ margin: '6px 0' }}><strong>Baud Rate:</strong> {selectedPreset.gateway_configuration.uart_configuration.baud_rate}</p>\r\n                  <p style={{ margin: '6px 0' }}><strong>Data Bits:</strong> {selectedPreset.gateway_configuration.uart_configuration.data_bits}</p>\r\n                  <p style={{ margin: '6px 0' }}><strong>Stop Bits:</strong> {selectedPreset.gateway_configuration.uart_configuration.stop_bits}</p>\r\n                  <p style={{ margin: '6px 0' }}><strong>Parity:</strong> {selectedPreset.gateway_configuration.uart_configuration.parity}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{ marginBottom: '20px', paddingLeft: 20 }}>\r\n              <p style={{ margin: '6px 0', wordBreak: 'break-word' }}><strong>Description:</strong> {selectedPreset.description || <em>No description</em>}</p>\r\n              <p style={{ margin: '6px 0' }}><strong>Slave Devices:</strong> {selectedPreset.slaves_count}</p>\r\n            </div>\r\n            <div className=\"form-actions\">\r\n              <button onClick={handleCloseDetails} className=\"btn btn-secondary\">Close</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {configuringSlaves && (\r\n        <div className=\"modal\">\r\n          <div className=\"modal-content\" style={{ maxWidth: '1200px', maxHeight: '90vh', overflow: 'auto' }}>\r\n            <h3>Configure Slaves: {configuringSlaves.name}</h3>\r\n\r\n            {error && (\r\n              <div className=\"error\" style={{ marginBottom: '20px', padding: '10px', backgroundColor: '#f8d7da', border: '1px solid #f5c6cb', borderRadius: '4px', color: '#721c24' }}>\r\n                <strong>Error:</strong> {error}\r\n                <button\r\n                  onClick={() => setError(null)}\r\n                  style={{ float: 'right', background: 'none', border: 'none', color: '#721c24', cursor: 'pointer', fontSize: '16px' }}\r\n                  title=\"Close error\"\r\n                >\r\n                  \r\n                </button>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"card\" style={{ marginBottom: '20px' }}>\r\n              <div className=\"card-header\">\r\n                <h4>Slave Devices ({slaves.length})</h4>\r\n                <button onClick={handleCreateSlave} className=\"btn\">Add Slave</button>\r\n              </div>\r\n\r\n              {slaves.length === 0 ? (\r\n                <div style={{ textAlign: 'center', padding: '40px 20px', color: '#666' }}>\r\n                  <p>No slave devices configured yet.</p>\r\n                  <p>Click \"Add Slave\" to configure your first slave device.</p>\r\n                </div>\r\n              ) : (\r\n                <table className=\"table\">\r\n                  <thead>\r\n                    <tr>\r\n                      <th style={{ textAlign: 'center' }}>Slave ID</th>\r\n                      <th style={{ textAlign: 'center' }}>Device Name</th>\r\n                      <th style={{ textAlign: 'center' }}>Polling Interval</th>\r\n                      <th style={{ textAlign: 'center' }}>Timeout</th>\r\n                      <th style={{ textAlign: 'center' }}>Status</th>\r\n                      <th style={{ textAlign: 'center' }}>Registers</th>\r\n                      <th style={{ textAlign: 'center' }}>Actions</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {slaves.map((slave) => (\r\n                      <tr key={slave.id}>\r\n                        <td style={{ textAlign: 'center' }}>{slave.slaveId}</td>\r\n                        <td>{slave.deviceName}</td>\r\n                        <td style={{ textAlign: 'center' }}>{slave.pollingIntervalMs}ms</td>\r\n                        <td style={{ textAlign: 'center' }}>{slave.timeoutMs}ms</td>\r\n                        <td style={{ textAlign: 'center' }}>\r\n                          <span className={slave.enabled ? 'status-online' : 'status-offline'}>\r\n                            {slave.enabled ? 'Enabled' : 'Disabled'}\r\n                          </span>\r\n                        </td>\r\n                        <td style={{ textAlign: 'center' }}>{slave.registers.length}</td>\r\n                        <td style={{ textAlign: 'center' }}>\r\n                          {slave.attached ? (\r\n                            <button onClick={() => handleDetachSlaveFromPreset(slave)} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#ef4444', marginRight: '8px' }} title=\"Remove from preset\">\r\n                              Remove\r\n                            </button>\r\n                          ) : (\r\n                            <button onClick={() => handleAttachSlaveToPreset(slave)} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#10b981', marginRight: '8px' }} title=\"Add to preset\">\r\n                              Add\r\n                            </button>\r\n                          )}\r\n                          <button onClick={() => handleEditSlave(slave)} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#3b82f6', marginRight: '10px' }} title=\"Edit\">\r\n                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                              <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\r\n                              <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\r\n                            </svg>\r\n                          </button>\r\n                          <button onClick={() => handleDeleteSlave(slave)} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#ef4444' }} title=\"Delete\">\r\n                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                              <polyline points=\"3,6 5,6 21,6\"></polyline>\r\n                              <path d=\"M19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2\"></path>\r\n                              <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\"></line>\r\n                              <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\"></line>\r\n                            </svg>\r\n                          </button>\r\n                        </td>\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                </table>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"form-actions\">\r\n              <button onClick={handleCancelSlaveConfig} className=\"btn btn-secondary\">Close</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Slave Configuration Modal */}\r\n      {(creatingSlave || editingSlave) && configuringSlaves && (\r\n        <div className=\"modal\">\r\n          <div className=\"modal-content large-modal\">\r\n            <h3>{editingSlave ? `Edit Slave: ${editingSlave.deviceName}` : 'Configure New Slave'}</h3>\r\n            \r\n            <div className=\"modal-body\">\r\n              <form onSubmit={(e) => { e.preventDefault(); handleSaveSlave(); }}>\r\n                \r\n                {/* Section 1: Basic Information */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Basic Information</h4>\r\n                  <div className=\"form-grid form-grid-2\">\r\n                    <div className=\"form-group\">\r\n                      <label>Slave ID</label>\r\n                      <input\r\n                        type=\"number\"\r\n                        value={slaveForm.slave_id}\r\n                        onChange={(e) => setSlaveForm({...slaveForm, slave_id: e.target.value})}\r\n                        required\r\n                        min=\"1\"\r\n                        max=\"247\"\r\n                        placeholder=\"1-247\"\r\n                      />\r\n                      <small className=\"form-hint\">\r\n                        Unique identifier (1-247)\r\n                        {slaves.length > 0 && (\r\n                          <span className=\"form-hint-accent\">\r\n                            Existing: {slaves.map(s => s.slaveId).join(', ')}\r\n                          </span>\r\n                        )}\r\n                      </small>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label>Device Name</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={slaveForm.device_name}\r\n                        onChange={(e) => setSlaveForm({...slaveForm, device_name: e.target.value})}\r\n                        required\r\n                        placeholder=\"e.g., Solar Inverter\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Section 2: Communication Settings */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Communication Settings</h4>\r\n                  <div className=\"form-grid form-grid-3\">\r\n                    <div className=\"form-group\">\r\n                      <label>Polling Interval (ms)</label>\r\n                      <input\r\n                        type=\"number\"\r\n                        value={slaveForm.polling_interval_ms}\r\n                        onChange={(e) => setSlaveForm({...slaveForm, polling_interval_ms: parseInt(e.target.value)})}\r\n                        min=\"100\"\r\n                        placeholder=\"5000\"\r\n                      />\r\n                      <small className=\"form-hint\">How often to poll</small>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label>Timeout (ms)</label>\r\n                      <input\r\n                        type=\"number\"\r\n                        value={slaveForm.timeout_ms}\r\n                        onChange={(e) => setSlaveForm({...slaveForm, timeout_ms: parseInt(e.target.value)})}\r\n                        min=\"100\"\r\n                        placeholder=\"1000\"\r\n                      />\r\n                      <small className=\"form-hint\">Response timeout</small>\r\n                    </div>\r\n                    <div className=\"form-group checkbox-group\">\r\n                      <label>Status</label>\r\n                      <label className=\"checkbox-label checkbox-vertical\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={slaveForm.enabled}\r\n                          onChange={(e) => setSlaveForm({...slaveForm, enabled: e.target.checked})}\r\n                        />\r\n                        <span className={slaveForm.enabled ? 'status-text-enabled' : 'status-text-disabled'}>\r\n                          {slaveForm.enabled ? 'Enabled' : 'Disabled'}\r\n                        </span>\r\n                      </label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Section 3: Register Mappings */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Register Mappings</h4>\r\n                  <p className=\"form-section-desc\">Configure the Modbus registers to read from this slave device.</p>\r\n\r\n                  <div className=\"form-subsection\">\r\n                    <h5 className=\"form-subsection-title\">Add New Register</h5>\r\n                    <div className=\"form-grid form-grid-auto\">\r\n                      {/* Row 1: Basic Info */}\r\n                      <div className=\"form-group\">\r\n                        <label>Label *</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          placeholder=\"e.g., Battery_Voltage\"\r\n                          value={registerForm.label}\r\n                          onChange={(e) => setRegisterForm({...registerForm, label: e.target.value})}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Address *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          placeholder=\"40001\"\r\n                          value={registerForm.address}\r\n                          onChange={(e) => setRegisterForm({...registerForm, address: parseInt(e.target.value)})}\r\n                          min=\"1\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Num Registers</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          placeholder=\"1\"\r\n                          value={registerForm.num_registers || 1}\r\n                          onChange={(e) => setRegisterForm({...registerForm, num_registers: parseInt(e.target.value)})}\r\n                          min=\"1\"\r\n                          max=\"125\"\r\n                        />\r\n                        <small className=\"form-hint\">Count (1-125)</small>\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Function Code *</label>\r\n                        <select\r\n                          value={registerForm.function_code || 3}\r\n                          onChange={(e) => setRegisterForm({...registerForm, function_code: parseInt(e.target.value)})}\r\n                        >\r\n                          <option value={0x01}>0x01 - Read Coils</option>\r\n                          <option value={0x02}>0x02 - Read Discrete Inputs</option>\r\n                          <option value={0x03}>0x03 - Read Holding Registers</option>\r\n                          <option value={0x04}>0x04 - Read Input Registers</option>\r\n                          <option value={0x05}>0x05 - Write Single Coil</option>\r\n                          <option value={0x06}>0x06 - Write Single Register</option>\r\n                          <option value={0x0F}>0x0F - Write Multiple Coils</option>\r\n                          <option value={0x10}>0x10 - Write Multiple Registers</option>\r\n                        </select>\r\n                      </div>\r\n\r\n                      {/* Row 2: Data Type & Format */}\r\n                      <div className=\"form-group\">\r\n                        <label>Data Type *</label>\r\n                        <select\r\n                          value={registerForm.data_type}\r\n                          onChange={(e) => setRegisterForm({...registerForm, data_type: parseInt(e.target.value)})}\r\n                        >\r\n                          <option value={0}>UINT16 (16-bit Unsigned)</option>\r\n                          <option value={1}>INT16 (16-bit Signed)</option>\r\n                          <option value={2}>UINT32 (32-bit Unsigned)</option>\r\n                          <option value={3}>INT32 (32-bit Signed)</option>\r\n                          <option value={4}>FLOAT32 (32-bit Float)</option>\r\n                          <option value={5}>UINT64 (64-bit Unsigned)</option>\r\n                          <option value={6}>INT64 (64-bit Signed)</option>\r\n                          <option value={7}>FLOAT64 (64-bit Float)</option>\r\n                          <option value={8}>BOOL (Single Bit)</option>\r\n                          <option value={9}>STRING (ASCII)</option>\r\n                        </select>\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Byte Order</label>\r\n                        <select\r\n                          value={registerForm.byte_order || 0}\r\n                          onChange={(e) => setRegisterForm({...registerForm, byte_order: parseInt(e.target.value)})}\r\n                        >\r\n                          <option value={0}>Big Endian (AB)</option>\r\n                          <option value={1}>Little Endian (BA)</option>\r\n                        </select>\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Word Order</label>\r\n                        <select\r\n                          value={registerForm.word_order || 0}\r\n                          onChange={(e) => setRegisterForm({...registerForm, word_order: parseInt(e.target.value)})}\r\n                        >\r\n                          <option value={0}>Big Endian (AB CD)</option>\r\n                          <option value={1}>Little Endian (CD AB)</option>\r\n                          <option value={2}>Mid-Big Endian (BA DC)</option>\r\n                          <option value={3}>Mid-Little Endian (DC BA)</option>\r\n                        </select>\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Decimal Places</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          placeholder=\"2\"\r\n                          value={registerForm.decimal_places || 2}\r\n                          onChange={(e) => setRegisterForm({...registerForm, decimal_places: parseInt(e.target.value)})}\r\n                          min=\"0\"\r\n                          max=\"6\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Access Mode</label>\r\n                        <select\r\n                          value={registerForm.access_mode || 0}\r\n                          onChange={(e) => setRegisterForm({...registerForm, access_mode: parseInt(e.target.value)})}\r\n                        >\r\n                          <option value={0}>Read Only</option>\r\n                          <option value={1}>Read/Write</option>\r\n                          <option value={2}>Write Only</option>\r\n                        </select>\r\n                      </div>\r\n\r\n                      {/* Row 3: Scaling & Units */}\r\n                      <div className=\"form-group\">\r\n                        <label>Scale Factor</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          placeholder=\"1.0\"\r\n                          value={registerForm.scale_factor}\r\n                          onChange={(e) => setRegisterForm({...registerForm, scale_factor: parseFloat(e.target.value)})}\r\n                          step=\"0.001\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Offset</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          placeholder=\"0.0\"\r\n                          value={registerForm.offset}\r\n                          onChange={(e) => setRegisterForm({...registerForm, offset: parseFloat(e.target.value)})}\r\n                          step=\"0.01\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Unit</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          placeholder=\"V, A, W, C, etc.\"\r\n                          value={registerForm.unit || ''}\r\n                          onChange={(e) => setRegisterForm({...registerForm, unit: e.target.value})}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Category</label>\r\n                        <select\r\n                          value={registerForm.category || 'Grid'}\r\n                          onChange={(e) => setRegisterForm({...registerForm, category: e.target.value})}\r\n                        >\r\n                          <option value=\"Grid\">Grid</option>\r\n                          <option value=\"BMS\">BMS</option>\r\n                          <option value=\"Status\">Status</option>\r\n                          <option value=\"Energy\">Energy</option>\r\n                          <option value=\"Temperature\">Temperature</option>\r\n                          <option value=\"Battery\">Battery</option>\r\n                          <option value=\"Load\">Load</option>\r\n                          <option value=\"PV\">PV</option>\r\n                        </select>\r\n                      </div>\r\n\r\n                      {/* Row 4: Alarms & Status */}\r\n                      <div className=\"form-group\">\r\n                        <label>High Alarm</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          placeholder=\"Optional\"\r\n                          value={registerForm.high_alarm_threshold ?? ''}\r\n                          onChange={(e) => setRegisterForm({...registerForm, high_alarm_threshold: e.target.value ? parseFloat(e.target.value) : null})}\r\n                          step=\"0.01\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Low Alarm</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          placeholder=\"Optional\"\r\n                          value={registerForm.low_alarm_threshold ?? ''}\r\n                          onChange={(e) => setRegisterForm({...registerForm, low_alarm_threshold: e.target.value ? parseFloat(e.target.value) : null})}\r\n                          step=\"0.01\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group checkbox-group\">\r\n                        <label>Enabled</label>\r\n                        <label className=\"checkbox-label checkbox-vertical\">\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            checked={registerForm.enabled}\r\n                            onChange={(e) => setRegisterForm({...registerForm, enabled: e.target.checked})}\r\n                          />\r\n                          <span>{registerForm.enabled ? 'Yes' : 'No'}</span>\r\n                        </label>\r\n                      </div>\r\n                      <div className=\"form-group form-group-btn\">\r\n                        <button type=\"button\" onClick={addRegister} className=\"btn btn-sm\">\r\n                          Add Register\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Description - full width */}\r\n                    <div className=\"form-group\" style={{ marginTop: '10px' }}>\r\n                      <label>Description</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        placeholder=\"e.g., 0=Off, 1=On, 2=Standby\"\r\n                        value={registerForm.description || ''}\r\n                        onChange={(e) => setRegisterForm({...registerForm, description: e.target.value})}\r\n                        style={{ width: '100%' }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Registers Table */}\r\n                  {slaveForm.registers.length > 0 ? (\r\n                    <div className=\"registers-table-wrapper\">\r\n                      <h5 className=\"form-subsection-title\">Configured Registers ({slaveForm.registers.length})</h5>\r\n                      <table className=\"table registers-table\">\r\n                        <thead>\r\n                          <tr>\r\n                            <th>Label</th>\r\n                            <th>Address</th>\r\n                            <th>Function</th>\r\n                            <th>Data Type</th>\r\n                            <th>Unit</th>\r\n                            <th>Scale</th>\r\n                            <th>Offset</th>\r\n                            <th>Category</th>\r\n                            <th>Alarms</th>\r\n                            <th>Status</th>\r\n                            <th>Actions</th>\r\n                          </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                          {slaveForm.registers.map((reg, index) => (\r\n                            <tr key={index}>\r\n                              <td>{reg.label}</td>\r\n                              <td>{reg.address}</td>\r\n                              <td>{reg.functionCode || 3}</td>\r\n                              <td>{getDataTypeName(reg.dataType)}</td>\r\n                              <td>{reg.unit || '-'}</td>\r\n                              <td>{reg.scaleFactor}</td>\r\n                              <td>{reg.offset}</td>\r\n                              <td>{reg.category || '-'}</td>\r\n                              <td>\r\n                                {reg.highAlarmThreshold || reg.lowAlarmThreshold ? (\r\n                                  <small>\r\n                                    {reg.highAlarmThreshold && `H:${reg.highAlarmThreshold}`}\r\n                                    {reg.highAlarmThreshold && reg.lowAlarmThreshold && ' / '}\r\n                                    {reg.lowAlarmThreshold && `L:${reg.lowAlarmThreshold}`}\r\n                                  </small>\r\n                                ) : '-'}\r\n                              </td>\r\n                              <td>\r\n                                <span className={`status-badge ${reg.enabled ? 'status-badge-success' : 'status-badge-danger'}`}>\r\n                                  {reg.enabled ? 'Enabled' : 'Disabled'}\r\n                                </span>\r\n                              </td>\r\n                              <td>\r\n                                <button\r\n                                  type=\"button\"\r\n                                  onClick={() => removeRegister(index)}\r\n                                  className=\"btn-icon btn-icon-danger\"\r\n                                  title=\"Remove\"\r\n                                >\r\n                                  \r\n                                </button>\r\n                              </td>\r\n                            </tr>\r\n                          ))}\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"empty-state\">\r\n                      No registers configured yet. Add registers above to define what data to read from this slave device.\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n              </form>\r\n            </div>\r\n\r\n            {/* Modal Footer */}\r\n            <div className=\"modal-footer\">\r\n              <button type=\"button\" className=\"btn btn-primary\" onClick={(e) => { e.preventDefault(); handleSaveSlave(); }}>\r\n                {editingSlave ? 'Save Changes' : 'Create Slave'}\r\n              </button>\r\n              <button type=\"button\" onClick={() => { setCreatingSlave(false); setEditingSlave(null); }} className=\"btn btn-secondary\">\r\n                Cancel\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modern Delete Preset Confirmation Modal */}\r\n      {deletePresetModal.show && deletePresetModal.preset && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: 'rgba(0,0,0,0.6)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          zIndex: 1000,\r\n          backdropFilter: 'blur(4px)'\r\n        }}>\r\n          <div style={{\r\n            background: isDark ? '#2d2d2d' : 'white',\r\n            borderRadius: '16px',\r\n            padding: '2rem',\r\n            maxWidth: '500px',\r\n            width: '90%',\r\n            boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n            border: isDark ? '2px solid #7f1d1d' : '2px solid #7f1d1d',\r\n            animation: 'slideIn 0.2s ease-out'\r\n          }}>\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '1.5rem' }}>\r\n              <div style={{\r\n                width: '48px',\r\n                height: '48px',\r\n                borderRadius: '12px',\r\n                background: 'linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%)',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                fontSize: '1.5rem',\r\n                animation: 'pulse 2s infinite'\r\n              }}>\r\n                \r\n              </div>\r\n              <h3 style={{ fontSize: '1.5rem', fontWeight: '600', margin: 0, color: '#7f1d1d' }}>\r\n                Delete Preset\r\n              </h3>\r\n            </div>\r\n            \r\n            <div style={{ marginBottom: '1.5rem', color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.6' }}>\r\n              <p style={{ marginBottom: '1rem' }}>\r\n                Are you sure you want to delete preset <strong style={{ color: isDark ? '#e0e0e0' : '#2c3e50' }}>{deletePresetModal.preset.name}</strong>?\r\n              </p>\r\n              <div style={{\r\n                background: isDark ? 'rgba(127, 29, 29, 0.1)' : '#fee2e2',\r\n                border: isDark ? '1px solid rgba(127, 29, 29, 0.3)' : '1px solid #fecaca',\r\n                borderRadius: '8px',\r\n                padding: '0.75rem 1rem',\r\n                fontSize: '0.9rem',\r\n                color: isDark ? '#fca5a5' : '#991b1b'\r\n              }}>\r\n                <strong> Warning:</strong> This will permanently delete the preset configuration. Devices using this preset will need to be reconfigured.\r\n              </div>\r\n            </div>\r\n            \r\n            <div style={{ display: 'flex', gap: '0.75rem', justifyContent: 'flex-end' }}>\r\n              <button\r\n                onClick={() => setDeletePresetModal({ show: false, preset: null })}\r\n                style={{\r\n                  background: isDark ? '#3a3a3a' : '#e0e0e0',\r\n                  color: isDark ? '#e0e0e0' : '#495057',\r\n                  border: 'none',\r\n                  padding: '0.75rem 1.5rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '0.95rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer',\r\n                  transition: 'all 0.2s'\r\n                }}\r\n                onMouseOver={e => e.currentTarget.style.background = isDark ? '#4a4a4a' : '#d0d0d0'}\r\n                onMouseOut={e => e.currentTarget.style.background = isDark ? '#3a3a3a' : '#e0e0e0'}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={confirmDeletePreset}\r\n                style={{\r\n                  background: 'linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%)',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '0.75rem 1.5rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '0.95rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer',\r\n                  boxShadow: '0 4px 12px rgba(127, 29, 29, 0.3)',\r\n                  transition: 'all 0.2s'\r\n                }}\r\n                onMouseOver={e => e.currentTarget.style.transform = 'translateY(-1px)'}\r\n                onMouseOut={e => e.currentTarget.style.transform = 'translateY(0)'}\r\n              >\r\n                Yes, Delete\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modern Delete Slave Confirmation Modal */}\r\n      {deleteSlaveModal.show && deleteSlaveModal.slave && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: 'rgba(0,0,0,0.6)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          zIndex: 1000,\r\n          backdropFilter: 'blur(4px)'\r\n        }}>\r\n          <div style={{\r\n            background: isDark ? '#2d2d2d' : 'white',\r\n            borderRadius: '16px',\r\n            padding: '2rem',\r\n            maxWidth: '500px',\r\n            width: '90%',\r\n            boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n            border: isDark ? '2px solid #dc3545' : '2px solid #dc3545',\r\n            animation: 'slideIn 0.2s ease-out'\r\n          }}>\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '1.5rem' }}>\r\n              <div style={{\r\n                width: '48px',\r\n                height: '48px',\r\n                borderRadius: '12px',\r\n                background: 'linear-gradient(135deg, #dc3545 0%, #c82333 100%)',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                fontSize: '1.5rem',\r\n                animation: 'pulse 2s infinite'\r\n              }}>\r\n                \r\n              </div>\r\n              <h3 style={{ fontSize: '1.5rem', fontWeight: '600', margin: 0, color: '#dc3545' }}>\r\n                Remove Slave Device\r\n              </h3>\r\n            </div>\r\n            \r\n            <div style={{ marginBottom: '1.5rem', color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.6' }}>\r\n              <p style={{ marginBottom: '1rem' }}>\r\n                Are you sure you want to remove slave device <strong style={{ color: isDark ? '#e0e0e0' : '#2c3e50' }}>{deleteSlaveModal.slave.deviceName}</strong> (ID: {deleteSlaveModal.slave.slaveId})?\r\n              </p>\r\n              <div style={{\r\n                background: isDark ? 'rgba(220, 53, 69, 0.1)' : '#f8d7da',\r\n                border: isDark ? '1px solid rgba(220, 53, 69, 0.3)' : '1px solid #f5c6cb',\r\n                borderRadius: '8px',\r\n                padding: '0.75rem 1rem',\r\n                fontSize: '0.9rem',\r\n                color: isDark ? '#ff9999' : '#721c24'\r\n              }}>\r\n                <strong> Warning:</strong> This will remove the slave device configuration and all its register mappings.\r\n              </div>\r\n            </div>\r\n            \r\n            <div style={{ display: 'flex', gap: '0.75rem', justifyContent: 'flex-end' }}>\r\n              <button\r\n                onClick={() => setDeleteSlaveModal({ show: false, slave: null })}\r\n                style={{\r\n                  background: isDark ? '#3a3a3a' : '#e0e0e0',\r\n                  color: isDark ? '#e0e0e0' : '#495057',\r\n                  border: 'none',\r\n                  padding: '0.75rem 1.5rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '0.95rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer',\r\n                  transition: 'all 0.2s'\r\n                }}\r\n                onMouseOver={e => e.currentTarget.style.background = isDark ? '#4a4a4a' : '#d0d0d0'}\r\n                onMouseOut={e => e.currentTarget.style.background = isDark ? '#3a3a3a' : '#e0e0e0'}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={confirmDeleteSlave}\r\n                style={{\r\n                  background: 'linear-gradient(135deg, #dc3545 0%, #c82333 100%)',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '0.75rem 1.5rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '0.95rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer',\r\n                  boxShadow: '0 4px 12px rgba(220, 53, 69, 0.3)',\r\n                  transition: 'all 0.2s'\r\n                }}\r\n                onMouseOver={e => e.currentTarget.style.transform = 'translateY(-1px)'}\r\n                onMouseOut={e => e.currentTarget.style.transform = 'translateY(0)'}\r\n              >\r\n                Yes, Remove\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modern Success Notification Modal */}\r\n      {successModal.show && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: 'rgba(0,0,0,0.4)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          zIndex: 1000,\r\n          backdropFilter: 'blur(2px)'\r\n        }}>\r\n          <div style={{\r\n            background: isDark ? '#2d2d2d' : 'white',\r\n            borderRadius: '16px',\r\n            padding: '2rem',\r\n            maxWidth: '450px',\r\n            width: '90%',\r\n            boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n            border: isDark ? '1px solid #28a745' : '2px solid #28a745',\r\n            animation: 'slideIn 0.2s ease-out'\r\n          }}>\r\n            <div style={{ textAlign: 'center' }}>\r\n              <div style={{\r\n                width: '64px',\r\n                height: '64px',\r\n                borderRadius: '50%',\r\n                background: 'linear-gradient(135deg, #28a745 0%, #20c997 100%)',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                fontSize: '2rem',\r\n                margin: '0 auto 1rem',\r\n                animation: 'scaleIn 0.3s ease-out'\r\n              }}>\r\n                \r\n              </div>\r\n              \r\n              <h3 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1rem', color: isDark ? '#e0e0e0' : '#2c3e50' }}>\r\n                Success\r\n              </h3>\r\n              \r\n              <p style={{ color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.6', marginBottom: '1.5rem' }}>\r\n                {successModal.message}\r\n              </p>\r\n              \r\n              <button\r\n                onClick={() => setSuccessModal({ show: false, message: '' })}\r\n                style={{\r\n                  background: 'linear-gradient(135deg, #28a745 0%, #20c997 100%)',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '0.75rem 2rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '0.95rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer',\r\n                  boxShadow: '0 4px 12px rgba(40, 167, 69, 0.3)',\r\n                  transition: 'all 0.2s'\r\n                }}\r\n                onMouseOver={e => e.currentTarget.style.transform = 'translateY(-1px)'}\r\n                onMouseOut={e => e.currentTarget.style.transform = 'translateY(0)'}\r\n              >\r\n                Got it!\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DevicePresets;\r\n","/**\r\n * Enhanced in-memory cache service for API responses\r\n * Features:\r\n * - TTL-based expiration\r\n * - Stale-while-revalidate pattern support\r\n * - Subscription system for real-time updates\r\n * - Pattern-based cache invalidation\r\n */\r\n\r\ninterface CacheEntry {\r\n  data: any;\r\n  timestamp: number;\r\n  expiresIn: number; // milliseconds\r\n  staleTime?: number; // Time after which data is considered stale but usable\r\n}\r\n\r\ninterface CacheSubscription {\r\n  callback: (data: any) => void;\r\n  pattern?: RegExp;\r\n}\r\n\r\nclass CacheService {\r\n  private cache: Map<string, CacheEntry> = new Map();\r\n  private subscribers: Map<string, Set<CacheSubscription>> = new Map();\r\n  private static readonly DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes default\r\n  private static readonly LONG_TTL = 30 * 60 * 1000; // 30 minutes for static data\r\n  private static readonly REALTIME_TTL = 10 * 1000; // 10 seconds for real-time data\r\n  private static readonly STALE_TIME = 30 * 1000; // 30 seconds before data is stale\r\n\r\n  /**\r\n   * Set a cache entry and notify subscribers\r\n   */\r\n  set(key: string, data: any, ttlMs: number = CacheService.DEFAULT_TTL, staleTime?: number): void {\r\n    this.cache.set(key, {\r\n      data,\r\n      timestamp: Date.now(),\r\n      expiresIn: ttlMs,\r\n      staleTime: staleTime ?? Math.min(ttlMs / 2, CacheService.STALE_TIME),\r\n    });\r\n    \r\n    // Notify subscribers\r\n    this.notifySubscribers(key, data);\r\n  }\r\n\r\n  /**\r\n   * Get a cache entry if valid (returns null if expired)\r\n   */\r\n  get(key: string): any | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    // Check if expired\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return entry.data;\r\n  }\r\n\r\n  /**\r\n   * Get cache entry even if stale (for stale-while-revalidate pattern)\r\n   * Returns { data, isStale } or null if no entry exists\r\n   */\r\n  getWithStaleStatus(key: string): { data: any; isStale: boolean; isExpired: boolean } | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    const now = Date.now();\r\n    const age = now - entry.timestamp;\r\n    const isExpired = age > entry.expiresIn;\r\n    const isStale = age > (entry.staleTime ?? entry.expiresIn / 2);\r\n\r\n    // Remove if fully expired\r\n    if (isExpired) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      data: entry.data,\r\n      isStale,\r\n      isExpired: false,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Check if key exists and is not expired\r\n   */\r\n  has(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return false;\r\n\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Check if cached data is stale but usable\r\n   */\r\n  isStale(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return true;\r\n\r\n    const now = Date.now();\r\n    const age = now - entry.timestamp;\r\n    return age > (entry.staleTime ?? entry.expiresIn / 2);\r\n  }\r\n\r\n  /**\r\n   * Clear a specific cache entry\r\n   */\r\n  clear(key: string): void {\r\n    this.cache.delete(key);\r\n  }\r\n\r\n  /**\r\n   * Clear cache entries matching a pattern\r\n   */\r\n  clearPattern(pattern: string | RegExp): void {\r\n    const regex = typeof pattern === 'string' ? new RegExp(pattern) : pattern;\r\n    const keysToDelete: string[] = [];\r\n    \r\n    this.cache.forEach((_, key) => {\r\n      if (regex.test(key)) {\r\n        keysToDelete.push(key);\r\n      }\r\n    });\r\n    \r\n    keysToDelete.forEach(key => this.cache.delete(key));\r\n  }\r\n\r\n  /**\r\n   * Clear all cache entries\r\n   */\r\n  clearAll(): void {\r\n    this.cache.clear();\r\n  }\r\n\r\n  /**\r\n   * Get cache size\r\n   */\r\n  size(): number {\r\n    return this.cache.size;\r\n  }\r\n\r\n  /**\r\n   * Subscribe to cache updates for a specific key\r\n   */\r\n  subscribe(key: string, callback: (data: any) => void): () => void {\r\n    if (!this.subscribers.has(key)) {\r\n      this.subscribers.set(key, new Set());\r\n    }\r\n    \r\n    const subscription: CacheSubscription = { callback };\r\n    this.subscribers.get(key)!.add(subscription);\r\n\r\n    // Return unsubscribe function\r\n    return () => {\r\n      const subs = this.subscribers.get(key);\r\n      if (subs) {\r\n        subs.delete(subscription);\r\n        if (subs.size === 0) {\r\n          this.subscribers.delete(key);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Subscribe to cache updates matching a pattern\r\n   */\r\n  subscribePattern(pattern: RegExp, callback: (data: any) => void): () => void {\r\n    const key = `__pattern__${pattern.source}`;\r\n    if (!this.subscribers.has(key)) {\r\n      this.subscribers.set(key, new Set());\r\n    }\r\n    \r\n    const subscription: CacheSubscription = { callback, pattern };\r\n    this.subscribers.get(key)!.add(subscription);\r\n\r\n    return () => {\r\n      const subs = this.subscribers.get(key);\r\n      if (subs) {\r\n        subs.delete(subscription);\r\n        if (subs.size === 0) {\r\n          this.subscribers.delete(key);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Notify all subscribers of a cache update\r\n   */\r\n  private notifySubscribers(key: string, data: any): void {\r\n    // Direct key subscribers\r\n    const directSubs = this.subscribers.get(key);\r\n    if (directSubs) {\r\n      directSubs.forEach(sub => {\r\n        try {\r\n          sub.callback(data);\r\n        } catch (error) {\r\n          console.error(`Cache subscriber error for key ${key}:`, error);\r\n        }\r\n      });\r\n    }\r\n\r\n    // Pattern subscribers\r\n    this.subscribers.forEach((subs, subKey) => {\r\n      if (subKey.startsWith('__pattern__')) {\r\n        subs.forEach(sub => {\r\n          if (sub.pattern && sub.pattern.test(key)) {\r\n            try {\r\n              sub.callback(data);\r\n            } catch (error) {\r\n              console.error(`Cache pattern subscriber error for key ${key}:`, error);\r\n            }\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get all keys in cache\r\n   */\r\n  keys(): string[] {\r\n    return Array.from(this.cache.keys());\r\n  }\r\n\r\n  /**\r\n   * Get cache stats for debugging\r\n   */\r\n  getStats(): { size: number; keys: string[]; subscribers: number } {\r\n    return {\r\n      size: this.cache.size,\r\n      keys: this.keys(),\r\n      subscribers: Array.from(this.subscribers.values()).reduce((sum, set) => sum + set.size, 0),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get TTL constants\r\n   */\r\n  static getTTL(type: 'short' | 'long' | 'realtime' = 'short'): number {\r\n    switch (type) {\r\n      case 'realtime':\r\n        return CacheService.REALTIME_TTL;\r\n      case 'long':\r\n        return CacheService.LONG_TTL;\r\n      default:\r\n        return CacheService.DEFAULT_TTL;\r\n    }\r\n  }\r\n}\r\n\r\nexport const cacheService = new CacheService();\r\nexport const DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes\r\nexport const LONG_TTL = 30 * 60 * 1000; // 30 minutes\r\nexport const REALTIME_TTL = 10 * 1000; // 10 seconds\r\n","import { cacheService, DEFAULT_TTL } from './cacheService';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'https://smart-solar-django-backend.vercel.app/api';\r\n\r\nclass ApiService {\r\n  private getAuthHeaders(): HeadersInit {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (tokens) {\r\n      try {\r\n        const parsedTokens = JSON.parse(tokens);\r\n        return {\r\n          'Authorization': `Bearer ${parsedTokens.access}`,\r\n          'Content-Type': 'application/json',\r\n        };\r\n      } catch (error) {\r\n        console.error('Error parsing auth tokens:', error);\r\n      }\r\n    }\r\n    return {\r\n      'Content-Type': 'application/json',\r\n    };\r\n  }\r\n\r\n  private async request(endpoint: string, options: RequestInit = {}): Promise<any> {\r\n    const url = `${API_BASE_URL}${endpoint}`;\r\n    let headers = this.getAuthHeaders();\r\n\r\n    let response = await fetch(url, {\r\n      ...options,\r\n      headers: {\r\n        ...headers,\r\n        ...options.headers,\r\n      },\r\n    });\r\n\r\n    if (response.status === 401) {\r\n      // Try to refresh token\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        // Retry with new token\r\n        headers = this.getAuthHeaders();\r\n        response = await fetch(url, {\r\n          ...options,\r\n          headers: {\r\n            ...headers,\r\n            ...options.headers,\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      // Token refresh failed or not attempted, logout\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`API request failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n    }\r\n\r\n    if (response.status === 204) return null;\r\n    return response.json();\r\n  }\r\n\r\n  private async refreshToken(): Promise<boolean> {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (!tokens) return false;\r\n\r\n    try {\r\n      const parsedTokens = JSON.parse(tokens);\r\n      const response = await fetch(`${API_BASE_URL}/auth/token/refresh/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ refresh: parsedTokens.refresh }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        const newTokens = {\r\n          access: data.access,\r\n          refresh: parsedTokens.refresh, // Keep the same refresh token\r\n        };\r\n        localStorage.setItem('authTokens', JSON.stringify(newTokens));\r\n        return true;\r\n      }\r\n    } catch (error) {\r\n      console.error('Token refresh failed:', error);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  async getConfiguration(): Promise<any> {\r\n    return this.request('/config/');\r\n  }\r\n\r\n  async getTelemetry(): Promise<any[]> {\r\n    return this.request('/telemetry/');\r\n  }\r\n\r\n  async provisionDevice(data: any): Promise<any> {\r\n    const response = await fetch(`${API_BASE_URL}/devices/provision`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n    if (!response.ok) {\r\n      throw new Error(`Provisioning failed: ${response.statusText}`);\r\n    }\r\n    return response.json();\r\n  }\r\n\r\n  async getAlerts(): Promise<any[]> {\r\n    const cacheKey = 'alerts';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/alerts/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getSystemHealth(): Promise<any> {\r\n    const cacheKey = 'system_health';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/health/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getKPIs(): Promise<any> {\r\n    const cacheKey = 'kpis';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/kpis/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getUsers(search?: string): Promise<any[]> {\r\n    const cacheKey = `users_${search || 'all'}`;\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    const data = await this.request(`/users/${params}`);\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async createUser(userData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(userData),\r\n    });\r\n    // Invalidate users cache\r\n    cacheService.clear('users_all');\r\n    cacheService.clearAll(); // Clear all cache for safety\r\n    return result;\r\n  }\r\n\r\n  async createEmployee(employeeData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ ...employeeData, is_staff: true }),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async getUserDevices(userId: number): Promise<any[]> {\r\n    return this.request(`/users/${userId}/devices/`);\r\n  }\r\n\r\n  async getUserSite(userId: number): Promise<any> {\r\n    return this.request(`/users/${userId}/site/`);\r\n  }\r\n\r\n  async createUserSite(userId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/users/${userId}/site/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async updateUserSite(userId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/users/${userId}/site/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async getDeviceSite(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/`);\r\n  }\r\n\r\n  async createDeviceSite(deviceId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async updateDeviceSite(deviceId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // DynamoDB site data\r\n  async getSiteTelemetry(siteId: string, params?: { start_date?: string; end_date?: string; days?: number }): Promise<any[]> {\r\n    const query = new URLSearchParams();\r\n    if (params?.start_date) query.append('start_date', params.start_date);\r\n    if (params?.end_date) query.append('end_date', params.end_date);\r\n    if (params?.days) query.append('days', params.days.toString());\r\n    const url = `/sites/${siteId}/telemetry/${query.toString() ? '?' + query.toString() : ''}`;\r\n    return this.request(url);\r\n  }\r\n\r\n  /**\r\n   * Historical telemetry from S3 (older than DynamoDB's 7-day TTL window).\r\n   * S3 path: telemetry_csv/{site_id}/{YYYY}/{MM}/{DD}/{HH}/data.csv\r\n   * Returns same shape as getSiteTelemetry.\r\n   */\r\n  async getSiteHistory(siteId: string, params: { start_date: string; end_date: string }): Promise<any[]> {\r\n    const query = new URLSearchParams({ start_date: params.start_date, end_date: params.end_date });\r\n    return this.request(`/sites/${siteId}/history/?${query.toString()}`);\r\n  }\r\n\r\n  async getSiteForecast(siteId: string, params?: { date?: string; start_date?: string; end_date?: string }): Promise<any[]> {\r\n    const query = new URLSearchParams();\r\n    if (params?.date) query.append('date', params.date);\r\n    if (params?.start_date) query.append('start_date', params.start_date);\r\n    if (params?.end_date) query.append('end_date', params.end_date);\r\n    const url = `/sites/${siteId}/forecast/${query.toString() ? '?' + query.toString() : ''}`;\r\n    return this.request(url);\r\n  }\r\n\r\n  /**\r\n   * Returns { current: WeatherObs | null, hourly_forecast: WeatherFcst[] }\r\n   *   current.obs_timestamp     ISO UTC of the observation\r\n   *   current.ghi_wm2           global horizontal irradiance (W/m)\r\n   *   current.temperature_c     air temperature (C)\r\n   *   current.humidity_pct      relative humidity (%)\r\n   *   current.wind_speed_ms     wind speed (m/s)\r\n   *   current.cloud_cover_pct   cloud cover (%)\r\n   *   hourly_forecast[n].forecast_for  ISO UTC of the forecast slot\r\n   *   hourly_forecast[n].ghi_wm2     same fields as current\r\n   */\r\n  async getSiteWeather(siteId: string): Promise<{ current: any | null; hourly_forecast: any[] } | null> {\r\n    return this.request(`/sites/${siteId}/weather/`);\r\n  }\r\n\r\n  async updateUser(userId: number, data: any): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async deleteUser(userId: number): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  // Profile Management (for current logged-in user)\r\n  async getProfile(): Promise<any> {\r\n    return this.request('/profile/');\r\n  }\r\n\r\n  async updateProfile(data: any): Promise<any> {\r\n    return this.request('/profile/update/', {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async changePassword(data: { current_password: string; new_password: string }): Promise<any> {\r\n    return this.request('/profile/change-password/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // Customer Management (separate from staff users/employees)\r\n  async getCustomers(search?: string): Promise<any[]> {\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    return this.request(`/customers/${params}`);\r\n  }\r\n\r\n  async createCustomer(customerData: any): Promise<any> {\r\n    return this.request('/customers/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(customerData),\r\n    });\r\n  }\r\n\r\n  async getCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/`);\r\n  }\r\n\r\n  async updateCustomer(customerId: number, data: any): Promise<any> {\r\n    return this.request(`/customers/${customerId}/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getPresets(): Promise<any[]> {\r\n    const cacheKey = 'presets';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/presets/');\r\n    // Use longer TTL for presets as they change less frequently\r\n    cacheService.set(cacheKey, data, 30 * 60 * 1000); // 30 minutes\r\n    return data;\r\n  }\r\n\r\n  async createPreset(data: any): Promise<any> {\r\n    const result = await this.request('/presets/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async updatePreset(id: number, data: any): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async deletePreset(id: number): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async getGlobalSlaves(): Promise<any[]> {\r\n    return this.request('/slaves/');\r\n  }\r\n\r\n  async createGlobalSlave(slaveData: any): Promise<any> {\r\n    return this.request('/slaves/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateGlobalSlave(slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteGlobalSlave(slaveId: number): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getDevices(search?: string, page: number = 1, pageSize: number = 25): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    if (search) params.append('search', search);\r\n    params.append('page', page.toString());\r\n    params.append('page_size', pageSize.toString());\r\n    \r\n    const queryString = params.toString();\r\n    return this.request(`/devices/?${queryString}`);\r\n  }\r\n\r\n  async createDevice(deviceData: any): Promise<any> {\r\n    return this.request('/devices/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(deviceData),\r\n    });\r\n  }\r\n\r\n  async updateDevice(deviceId: number, data: any): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async rebootDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/reboot/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  async hardResetDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/hard-reset/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  async getDeviceLogs(deviceId: number, limit: number = 100, offset: number = 0): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/logs/?limit=${limit}&offset=${offset}`);\r\n  }\r\n\r\n  async toggleDeviceLogs(deviceId: number, enabled: boolean): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/logs/toggle/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ enabled }),\r\n    });\r\n  }\r\n\r\n  async deleteDevicesBulk(deviceIds: number[]): Promise<any> {\r\n    return this.request(`/devices/delete-bulk/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ device_ids: deviceIds }),\r\n    });\r\n  }\r\n\r\n  async getSlaves(configId: string): Promise<any[]> {\r\n    return this.request(`/presets/${configId}/slaves/`);\r\n  }\r\n\r\n  async createSlave(configId: string, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/create/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateSlave(configId: string, slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteSlave(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async addSlavesToPreset(configId: string, slaveIds: number[]): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/add/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ slave_ids: slaveIds }),\r\n    });\r\n  }\r\n\r\n  async detachSlaveFromPreset(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/detach/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  // OTA (Over-The-Air) Update Endpoints\r\n  async getFirmwareVersions(activeOnly: boolean = true): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    params.append('active', activeOnly.toString());\r\n    return this.request(`/ota/firmware/?${params.toString()}`);\r\n  }\r\n\r\n  async uploadFirmwareVersion(formData: FormData): Promise<any> {\r\n    const url = `${API_BASE_URL}/ota/firmware/create/`;\r\n    const tokens = localStorage.getItem('authTokens');\r\n    \r\n    if (!tokens) {\r\n      throw new Error('Authentication required');\r\n    }\r\n    \r\n    const parsedTokens = JSON.parse(tokens);\r\n    let headers: HeadersInit = {\r\n      'Authorization': `Bearer ${parsedTokens.access}`,\r\n    };\r\n    // Don't set Content-Type - let browser set it with boundary for multipart/form-data\r\n    \r\n    let response = await fetch(url, {\r\n      method: 'POST',\r\n      headers,\r\n      body: formData,\r\n    });\r\n\r\n    // Handle 401 with token refresh\r\n    if (response.status === 401) {\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        const newTokens = JSON.parse(localStorage.getItem('authTokens') || '{}');\r\n        headers = {\r\n          'Authorization': `Bearer ${newTokens.access}`,\r\n        };\r\n        response = await fetch(url, {\r\n          method: 'POST',\r\n          headers,\r\n          body: formData,\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`Upload failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  async updateFirmwareVersion(firmwareId: number, data: any): Promise<any> {\r\n    return this.request(`/ota/firmware/${firmwareId}/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteFirmwareVersion(firmwareId: number): Promise<any> {\r\n    return this.request(`/ota/firmware/${firmwareId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getDeviceUpdateLogs(deviceId: string): Promise<any> {\r\n    return this.request(`/ota/devices/${deviceId}/logs`);\r\n  }\r\n\r\n  async getOTAConfig(): Promise<any> {\r\n    return this.request(`/ota/config/`);\r\n  }\r\n\r\n  async updateOTAConfig(config: any): Promise<any> {\r\n    return this.request(`/ota/config/update/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(config),\r\n    });\r\n  }\r\n\r\n  async getOTAHealth(): Promise<any> {\r\n    return this.request(`/ota/health/`);\r\n  }\r\n\r\n  async triggerRollback(deviceSerial: string, notes?: string): Promise<any> {\r\n    return this.request(`/ota/updates/rollback/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        device_serial: deviceSerial,\r\n        notes: notes || ''\r\n      }),\r\n    });\r\n  }\r\n\r\n  async deployFirmware(firmwareId: number, deviceSerials: string[], notes?: string): Promise<any> {\r\n    return this.request(`/ota/updates/multiple/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        firmware_id: firmwareId,\r\n        device_serials: deviceSerials,\r\n        notes: notes || ''\r\n      }),\r\n    });\r\n  }\r\n\r\n  async listTargetedUpdates(): Promise<any> {\r\n    return this.request(`/ota/updates/`);\r\n  }\r\n\r\n  async getTargetedUpdate(updateId: number): Promise<any> {\r\n    return this.request(`/ota/updates/${updateId}/`);\r\n  }\r\n}\r\n\r\nexport const apiService = new ApiService();"],"names":["DevicePresets","_registerForm$high_al","_registerForm$low_ala","isDark","useTheme","presets","setPresets","useState","filteredPresets","setFilteredPresets","loading","setLoading","error","setError","editingPreset","setEditingPreset","creatingPreset","setCreatingPreset","searchTerm","setSearchTerm","selectedPreset","setSelectedPreset","configuringSlaves","setConfiguringSlaves","slaves","setSlaves","creatingSlave","setCreatingSlave","editingSlave","setEditingSlave","createPresetSlaveMode","setCreatePresetSlaveMode","globalSlaves","setGlobalSlaves","globalSlavesLoading","setGlobalSlavesLoading","selectedGlobalSlaveIds","setSelectedGlobalSlaveIds","slaveSearch","setSlaveSearch","editForm","setEditForm","config_id","name","description","baud_rate","data_bits","stop_bits","parity","createForm","setCreateForm","slaveForm","setSlaveForm","slave_id","device_name","polling_interval_ms","timeout_ms","enabled","registers","registerForm","setRegisterForm","label","address","num_registers","function_code","register_type","data_type","byte_order","word_order","access_mode","scale_factor","offset","unit","decimal_places","category","high_alarm_threshold","low_alarm_threshold","deletePresetModal","setDeletePresetModal","show","preset","deleteSlaveModal","setDeleteSlaveModal","slave","successModal","setSuccessModal","message","useEffect","fetchPresets","async","mapped","apiService","getGlobalSlaves","map","id","slaveId","deviceName","pollingIntervalMs","timeoutMs","err","console","fetchGlobalSlaves","debouncedSearchTerm","setDebouncedSearchTerm","timer","setTimeout","clearTimeout","data","getPresets","filteredData","search","searchLower","toLowerCase","filter","includes","Error","handleSave","updatePreset","handleCreate","_result$gateway_confi","_result$gateway_confi2","result","createPreset","createdConfigId","gateway_configuration","general_settings","configId","createSlave","parseInt","length","addSlavesToPreset","getDataTypeName","dataType","_types$dataType","concat","handleConfigureSlaves","fetchSlavesForPreset","attachedData","globalData","Promise","all","getSlaves","attachedIds","Set","s","mapSlave","attached","reg","numRegisters","functionCode","scaleFactor","mappedAttached","mappedGlobals","has","updatePresetSlaveCount","count","updatedPresets","p","_objectSpread","slaves_count","updatedFiltered","handleSaveSlave","find","slaveData","updatedSlave","updateSlave","mappedSlave","updatedSlaves","newSlave","_jsx","className","children","_jsxs","type","placeholder","value","onChange","e","target","onClick","style","textAlign","handleViewDetails","background","border","cursor","color","margin","title","width","height","viewBox","fill","stroke","strokeWidth","d","cx","cy","r","x","y","rx","ry","x1","y1","x2","y2","uart_configuration","catch","handleEdit","log","handleDelete","points","onSubmit","preventDefault","required","autoComplete","readOnly","gridColumn","rows","checked","marginTop","filtered","String","_Fragment","marginBottom","padding","borderRadius","fontSize","boxSizing","display","flexDirection","gap","maxHeight","overflowY","alignItems","handleCancel","maxWidth","gridTemplateColumns","paddingLeft","wordBreak","schema_version","last_updated","handleCloseDetails","overflow","backgroundColor","float","handleCreateSlave","detachSlaveFromPreset","handleDetachSlaveFromPreset","marginRight","handleAttachSlaveToPreset","toString","handleEditSlave","handleDeleteSlave","handleCancelSlaveConfig","min","max","join","parseFloat","step","addRegister","newRegister","Date","now","registerType","byteOrder","wordOrder","accessMode","decimalPlaces","highAlarmThreshold","lowAlarmThreshold","index","_","i","removeRegister","position","top","left","right","bottom","justifyContent","zIndex","backdropFilter","boxShadow","animation","fontWeight","lineHeight","transition","onMouseOver","currentTarget","onMouseOut","deletePreset","transform","deleteSlave","CacheService","constructor","cache","Map","subscribers","set","key","ttlMs","arguments","undefined","DEFAULT_TTL","staleTime","this","timestamp","expiresIn","Math","STALE_TIME","notifySubscribers","get","entry","delete","getWithStaleStatus","_entry$staleTime","age","isExpired","isStale","_entry$staleTime2","clear","clearPattern","pattern","regex","RegExp","keysToDelete","forEach","test","push","clearAll","size","subscribe","callback","subscription","add","subs","subscribePattern","source","directSubs","sub","subKey","startsWith","keys","Array","from","getStats","values","reduce","sum","getTTL","REALTIME_TTL","LONG_TTL","cacheService","API_BASE_URL","process","getAuthHeaders","tokens","localStorage","getItem","parsedTokens","JSON","parse","access","request","endpoint","options","url","headers","response","fetch","status","refreshToken","removeItem","window","location","href","ok","errorText","text","statusText","json","method","body","stringify","refresh","newTokens","setItem","getConfiguration","getTelemetry","provisionDevice","getAlerts","cacheKey","cached","getSystemHealth","getKPIs","getUsers","params","encodeURIComponent","createUser","userData","createEmployee","employeeData","is_staff","getUserDevices","userId","getUserSite","createUserSite","updateUserSite","getDeviceSite","deviceId","createDeviceSite","updateDeviceSite","getSiteTelemetry","siteId","query","URLSearchParams","start_date","append","end_date","days","getSiteHistory","getSiteForecast","date","getSiteWeather","updateUser","deleteUser","getProfile","updateProfile","changePassword","getCustomers","createCustomer","customerData","getCustomer","customerId","updateCustomer","deleteCustomer","createGlobalSlave","updateGlobalSlave","deleteGlobalSlave","getDevices","page","pageSize","queryString","createDevice","deviceData","updateDevice","deleteDevice","rebootDevice","hardResetDevice","getDeviceLogs","limit","toggleDeviceLogs","deleteDevicesBulk","deviceIds","device_ids","slaveIds","slave_ids","getFirmwareVersions","activeOnly","uploadFirmwareVersion","formData","updateFirmwareVersion","firmwareId","deleteFirmwareVersion","getDeviceUpdateLogs","getOTAConfig","updateOTAConfig","config","getOTAHealth","triggerRollback","deviceSerial","notes","device_serial","deployFirmware","deviceSerials","firmware_id","device_serials","listTargetedUpdates","getTargetedUpdate","updateId"],"sourceRoot":""}