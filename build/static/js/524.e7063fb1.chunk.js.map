{"version":3,"file":"static/js/524.e7063fb1.chunk.js","mappings":"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","sources":["components/SystemHealth.tsx","services/cacheService.ts","services/api.ts"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { apiService } from '../services/api';\r\n\r\ninterface SystemHealthData {\r\n  total_devices: number;\r\n  active_devices: number;\r\n  total_telemetry_points: number;\r\n  uptime_seconds: number;\r\n  database_status: string;\r\n  mqtt_status: string;\r\n  overall_health: string;\r\n}\r\n\r\nconst SystemHealth: React.FC = () => {\r\n  const [health, setHealth] = useState<SystemHealthData | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    fetchSystemHealth();\r\n    // Refresh health data every 60 seconds\r\n    const interval = setInterval(fetchSystemHealth, 60000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const fetchSystemHealth = async () => {\r\n    try {\r\n      const data = await apiService.getSystemHealth();\r\n      setHealth(data);\r\n      setLoading(false);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'An error occurred');\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const formatUptime = (seconds: number) => {\r\n    const days = Math.floor(seconds / 86400);\r\n    const hours = Math.floor((seconds % 86400) / 3600);\r\n    const minutes = Math.floor((seconds % 3600) / 60);\r\n    return `${days}d ${hours}h ${minutes}m`;\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status.toLowerCase()) {\r\n      case 'healthy': return 'status-online';\r\n      case 'warning': return 'status-warning';\r\n      case 'critical': return 'status-critical';\r\n      default: return 'status-offline';\r\n    }\r\n  };\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status.toLowerCase()) {\r\n      case 'healthy': return '‚úÖ';\r\n      case 'warning': return '‚ö†Ô∏è';\r\n      case 'critical': return 'üö®';\r\n      default: return '‚ùì';\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"loading\">Loading system health...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div className=\"error\">Error: {error}</div>;\r\n  }\r\n\r\n  if (!health) {\r\n    return <div className=\"error\">No health data available</div>;\r\n  }\r\n\r\n  const deviceUptime = (health.active_devices / health.total_devices) * 100;\r\n\r\n  return (\r\n    <div>\r\n      <h1>System Health Dashboard</h1>\r\n\r\n      <div className=\"grid grid-cols-2\">\r\n        <div className=\"card\">\r\n          <h3>Overall System Status</h3>\r\n          <div className={`status-indicator ${getStatusColor(health.overall_health)}`}>\r\n            {getStatusIcon(health.overall_health)} {health.overall_health.toUpperCase()}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"card\">\r\n          <h3>System Uptime</h3>\r\n          <p className=\"metric-large\">{formatUptime(health.uptime_seconds)}</p>\r\n          <p className=\"metric-label\">Since first telemetry</p>\r\n        </div>\r\n\r\n        <div className=\"card\">\r\n          <h3>Device Connectivity</h3>\r\n          <p className=\"metric-large\">{health.active_devices}/{health.total_devices}</p>\r\n          <p className=\"metric-label\">Active/Total Devices</p>\r\n          <div className=\"progress-bar\">\r\n            <div\r\n              className=\"progress-fill\"\r\n              style={{ width: `${deviceUptime}%` }}\r\n            ></div>\r\n          </div>\r\n          <p className=\"metric-small\">{deviceUptime.toFixed(1)}% uptime</p>\r\n        </div>\r\n\r\n        <div className=\"card\">\r\n          <h3>Data Collection</h3>\r\n          <p className=\"metric-large\">{health.total_telemetry_points.toLocaleString()}</p>\r\n          <p className=\"metric-label\">Total Data Points</p>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-2\">\r\n        <div className=\"card\">\r\n          <h3>Service Status</h3>\r\n          <div className=\"service-status\">\r\n            <div className=\"service-item\">\r\n              <span className=\"service-name\">Database</span>\r\n              <span className={`service-status ${getStatusColor(health.database_status)}`}>\r\n                {getStatusIcon(health.database_status)} {health.database_status}\r\n              </span>\r\n            </div>\r\n            <div className=\"service-item\">\r\n              <span className=\"service-name\">MQTT Broker</span>\r\n              <span className={`service-status ${getStatusColor(health.mqtt_status)}`}>\r\n                {getStatusIcon(health.mqtt_status)} {health.mqtt_status}\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"card\">\r\n          <h3>Performance Metrics</h3>\r\n          <div className=\"metrics-list\">\r\n            <div className=\"metric-item\">\r\n              <span>Data Points/Hour:</span>\r\n              <span>{(health.total_telemetry_points / (health.uptime_seconds / 3600)).toFixed(1)}</span>\r\n            </div>\r\n            <div className=\"metric-item\">\r\n              <span>Avg Data/Device:</span>\r\n              <span>{health.total_devices > 0 ? (health.total_telemetry_points / health.total_devices).toFixed(0) : '0'}</span>\r\n            </div>\r\n            <div className=\"metric-item\">\r\n              <span>Active Device Ratio:</span>\r\n              <span>{deviceUptime.toFixed(1)}%</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"card\">\r\n        <h3>System Information</h3>\r\n        <div className=\"system-info\">\r\n          <p><strong>Last Updated:</strong> {new Date().toLocaleString()}</p>\r\n          <p><strong>Monitoring Since:</strong> {new Date(Date.now() - health.uptime_seconds * 1000).toLocaleString()}</p>\r\n          <p><strong>API Status:</strong> <span className=\"status-online\">Connected</span></p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SystemHealth;","/**\r\n * Enhanced in-memory cache service for API responses\r\n * Features:\r\n * - TTL-based expiration\r\n * - Stale-while-revalidate pattern support\r\n * - Subscription system for real-time updates\r\n * - Pattern-based cache invalidation\r\n */\r\n\r\ninterface CacheEntry {\r\n  data: any;\r\n  timestamp: number;\r\n  expiresIn: number; // milliseconds\r\n  staleTime?: number; // Time after which data is considered stale but usable\r\n}\r\n\r\ninterface CacheSubscription {\r\n  callback: (data: any) => void;\r\n  pattern?: RegExp;\r\n}\r\n\r\nclass CacheService {\r\n  private cache: Map<string, CacheEntry> = new Map();\r\n  private subscribers: Map<string, Set<CacheSubscription>> = new Map();\r\n  private static readonly DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes default\r\n  private static readonly LONG_TTL = 30 * 60 * 1000; // 30 minutes for static data\r\n  private static readonly REALTIME_TTL = 10 * 1000; // 10 seconds for real-time data\r\n  private static readonly STALE_TIME = 30 * 1000; // 30 seconds before data is stale\r\n\r\n  /**\r\n   * Set a cache entry and notify subscribers\r\n   */\r\n  set(key: string, data: any, ttlMs: number = CacheService.DEFAULT_TTL, staleTime?: number): void {\r\n    this.cache.set(key, {\r\n      data,\r\n      timestamp: Date.now(),\r\n      expiresIn: ttlMs,\r\n      staleTime: staleTime ?? Math.min(ttlMs / 2, CacheService.STALE_TIME),\r\n    });\r\n    \r\n    // Notify subscribers\r\n    this.notifySubscribers(key, data);\r\n  }\r\n\r\n  /**\r\n   * Get a cache entry if valid (returns null if expired)\r\n   */\r\n  get(key: string): any | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    // Check if expired\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return entry.data;\r\n  }\r\n\r\n  /**\r\n   * Get cache entry even if stale (for stale-while-revalidate pattern)\r\n   * Returns { data, isStale } or null if no entry exists\r\n   */\r\n  getWithStaleStatus(key: string): { data: any; isStale: boolean; isExpired: boolean } | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    const now = Date.now();\r\n    const age = now - entry.timestamp;\r\n    const isExpired = age > entry.expiresIn;\r\n    const isStale = age > (entry.staleTime ?? entry.expiresIn / 2);\r\n\r\n    // Remove if fully expired\r\n    if (isExpired) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      data: entry.data,\r\n      isStale,\r\n      isExpired: false,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Check if key exists and is not expired\r\n   */\r\n  has(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return false;\r\n\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Check if cached data is stale but usable\r\n   */\r\n  isStale(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return true;\r\n\r\n    const now = Date.now();\r\n    const age = now - entry.timestamp;\r\n    return age > (entry.staleTime ?? entry.expiresIn / 2);\r\n  }\r\n\r\n  /**\r\n   * Clear a specific cache entry\r\n   */\r\n  clear(key: string): void {\r\n    this.cache.delete(key);\r\n  }\r\n\r\n  /**\r\n   * Clear cache entries matching a pattern\r\n   */\r\n  clearPattern(pattern: string | RegExp): void {\r\n    const regex = typeof pattern === 'string' ? new RegExp(pattern) : pattern;\r\n    const keysToDelete: string[] = [];\r\n    \r\n    this.cache.forEach((_, key) => {\r\n      if (regex.test(key)) {\r\n        keysToDelete.push(key);\r\n      }\r\n    });\r\n    \r\n    keysToDelete.forEach(key => this.cache.delete(key));\r\n  }\r\n\r\n  /**\r\n   * Clear all cache entries\r\n   */\r\n  clearAll(): void {\r\n    this.cache.clear();\r\n  }\r\n\r\n  /**\r\n   * Get cache size\r\n   */\r\n  size(): number {\r\n    return this.cache.size;\r\n  }\r\n\r\n  /**\r\n   * Subscribe to cache updates for a specific key\r\n   */\r\n  subscribe(key: string, callback: (data: any) => void): () => void {\r\n    if (!this.subscribers.has(key)) {\r\n      this.subscribers.set(key, new Set());\r\n    }\r\n    \r\n    const subscription: CacheSubscription = { callback };\r\n    this.subscribers.get(key)!.add(subscription);\r\n\r\n    // Return unsubscribe function\r\n    return () => {\r\n      const subs = this.subscribers.get(key);\r\n      if (subs) {\r\n        subs.delete(subscription);\r\n        if (subs.size === 0) {\r\n          this.subscribers.delete(key);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Subscribe to cache updates matching a pattern\r\n   */\r\n  subscribePattern(pattern: RegExp, callback: (data: any) => void): () => void {\r\n    const key = `__pattern__${pattern.source}`;\r\n    if (!this.subscribers.has(key)) {\r\n      this.subscribers.set(key, new Set());\r\n    }\r\n    \r\n    const subscription: CacheSubscription = { callback, pattern };\r\n    this.subscribers.get(key)!.add(subscription);\r\n\r\n    return () => {\r\n      const subs = this.subscribers.get(key);\r\n      if (subs) {\r\n        subs.delete(subscription);\r\n        if (subs.size === 0) {\r\n          this.subscribers.delete(key);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Notify all subscribers of a cache update\r\n   */\r\n  private notifySubscribers(key: string, data: any): void {\r\n    // Direct key subscribers\r\n    const directSubs = this.subscribers.get(key);\r\n    if (directSubs) {\r\n      directSubs.forEach(sub => {\r\n        try {\r\n          sub.callback(data);\r\n        } catch (error) {\r\n          console.error(`Cache subscriber error for key ${key}:`, error);\r\n        }\r\n      });\r\n    }\r\n\r\n    // Pattern subscribers\r\n    this.subscribers.forEach((subs, subKey) => {\r\n      if (subKey.startsWith('__pattern__')) {\r\n        subs.forEach(sub => {\r\n          if (sub.pattern && sub.pattern.test(key)) {\r\n            try {\r\n              sub.callback(data);\r\n            } catch (error) {\r\n              console.error(`Cache pattern subscriber error for key ${key}:`, error);\r\n            }\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get all keys in cache\r\n   */\r\n  keys(): string[] {\r\n    return Array.from(this.cache.keys());\r\n  }\r\n\r\n  /**\r\n   * Get cache stats for debugging\r\n   */\r\n  getStats(): { size: number; keys: string[]; subscribers: number } {\r\n    return {\r\n      size: this.cache.size,\r\n      keys: this.keys(),\r\n      subscribers: Array.from(this.subscribers.values()).reduce((sum, set) => sum + set.size, 0),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get TTL constants\r\n   */\r\n  static getTTL(type: 'short' | 'long' | 'realtime' = 'short'): number {\r\n    switch (type) {\r\n      case 'realtime':\r\n        return CacheService.REALTIME_TTL;\r\n      case 'long':\r\n        return CacheService.LONG_TTL;\r\n      default:\r\n        return CacheService.DEFAULT_TTL;\r\n    }\r\n  }\r\n}\r\n\r\nexport const cacheService = new CacheService();\r\nexport const DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes\r\nexport const LONG_TTL = 30 * 60 * 1000; // 30 minutes\r\nexport const REALTIME_TTL = 10 * 1000; // 10 seconds\r\n","import { cacheService, DEFAULT_TTL } from './cacheService';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'https://smart-solar-django-backend.vercel.app/api';\r\n\r\nclass ApiService {\r\n  private getAuthHeaders(): HeadersInit {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (tokens) {\r\n      try {\r\n        const parsedTokens = JSON.parse(tokens);\r\n        return {\r\n          'Authorization': `Bearer ${parsedTokens.access}`,\r\n          'Content-Type': 'application/json',\r\n        };\r\n      } catch (error) {\r\n        console.error('Error parsing auth tokens:', error);\r\n      }\r\n    }\r\n    return {\r\n      'Content-Type': 'application/json',\r\n    };\r\n  }\r\n\r\n  private async request(endpoint: string, options: RequestInit = {}): Promise<any> {\r\n    const url = `${API_BASE_URL}${endpoint}`;\r\n    let headers = this.getAuthHeaders();\r\n\r\n    let response = await fetch(url, {\r\n      ...options,\r\n      headers: {\r\n        ...headers,\r\n        ...options.headers,\r\n      },\r\n    });\r\n\r\n    if (response.status === 401) {\r\n      // Try to refresh token\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        // Retry with new token\r\n        headers = this.getAuthHeaders();\r\n        response = await fetch(url, {\r\n          ...options,\r\n          headers: {\r\n            ...headers,\r\n            ...options.headers,\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      // Token refresh failed or not attempted, logout\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`API request failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n    }\r\n\r\n    if (response.status === 204) return null;\r\n    return response.json();\r\n  }\r\n\r\n  private async refreshToken(): Promise<boolean> {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (!tokens) return false;\r\n\r\n    try {\r\n      const parsedTokens = JSON.parse(tokens);\r\n      const response = await fetch(`${API_BASE_URL}/auth/token/refresh/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ refresh: parsedTokens.refresh }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        const newTokens = {\r\n          access: data.access,\r\n          refresh: parsedTokens.refresh, // Keep the same refresh token\r\n        };\r\n        localStorage.setItem('authTokens', JSON.stringify(newTokens));\r\n        return true;\r\n      }\r\n    } catch (error) {\r\n      console.error('Token refresh failed:', error);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  async getConfiguration(): Promise<any> {\r\n    return this.request('/config/');\r\n  }\r\n\r\n  async getTelemetry(): Promise<any[]> {\r\n    return this.request('/telemetry/');\r\n  }\r\n\r\n  async provisionDevice(data: any): Promise<any> {\r\n    const response = await fetch(`${API_BASE_URL}/devices/provision`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n    if (!response.ok) {\r\n      throw new Error(`Provisioning failed: ${response.statusText}`);\r\n    }\r\n    return response.json();\r\n  }\r\n\r\n  async getAlerts(): Promise<any[]> {\r\n    const cacheKey = 'alerts';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/alerts/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getSystemHealth(): Promise<any> {\r\n    const cacheKey = 'system_health';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/health/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getKPIs(): Promise<any> {\r\n    const cacheKey = 'kpis';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/kpis/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getUsers(search?: string): Promise<any[]> {\r\n    const cacheKey = `users_${search || 'all'}`;\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    const data = await this.request(`/users/${params}`);\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async createUser(userData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(userData),\r\n    });\r\n    // Invalidate users cache\r\n    cacheService.clear('users_all');\r\n    cacheService.clearAll(); // Clear all cache for safety\r\n    return result;\r\n  }\r\n\r\n  async createEmployee(employeeData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ ...employeeData, is_staff: true }),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async getUserDevices(userId: number): Promise<any[]> {\r\n    return this.request(`/users/${userId}/devices/`);\r\n  }\r\n\r\n  async getUserSite(userId: number): Promise<any> {\r\n    return this.request(`/users/${userId}/site/`);\r\n  }\r\n\r\n  async createUserSite(userId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/users/${userId}/site/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async updateUserSite(userId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/users/${userId}/site/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async getDeviceSite(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/`);\r\n  }\r\n\r\n  async createDeviceSite(deviceId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async updateDeviceSite(deviceId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // DynamoDB site data\r\n  async getSiteTelemetry(siteId: string, params?: { start_date?: string; end_date?: string; days?: number }): Promise<any[]> {\r\n    const query = new URLSearchParams();\r\n    if (params?.start_date) query.append('start_date', params.start_date);\r\n    if (params?.end_date) query.append('end_date', params.end_date);\r\n    if (params?.days) query.append('days', params.days.toString());\r\n    const url = `/sites/${siteId}/telemetry/${query.toString() ? '?' + query.toString() : ''}`;\r\n    return this.request(url);\r\n  }\r\n\r\n  async getSiteForecast(siteId: string, params?: { date?: string; start_date?: string; end_date?: string }): Promise<any[]> {\r\n    const query = new URLSearchParams();\r\n    if (params?.date) query.append('date', params.date);\r\n    if (params?.start_date) query.append('start_date', params.start_date);\r\n    if (params?.end_date) query.append('end_date', params.end_date);\r\n    const url = `/sites/${siteId}/forecast/${query.toString() ? '?' + query.toString() : ''}`;\r\n    return this.request(url);\r\n  }\r\n\r\n  async getSiteWeather(siteId: string): Promise<any> {\r\n    return this.request(`/sites/${siteId}/weather/`);\r\n  }\r\n\r\n  async updateUser(userId: number, data: any): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async deleteUser(userId: number): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  // Profile Management (for current logged-in user)\r\n  async getProfile(): Promise<any> {\r\n    return this.request('/profile/');\r\n  }\r\n\r\n  async updateProfile(data: any): Promise<any> {\r\n    return this.request('/profile/update/', {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async changePassword(data: { current_password: string; new_password: string }): Promise<any> {\r\n    return this.request('/profile/change-password/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // Customer Management (separate from staff users/employees)\r\n  async getCustomers(search?: string): Promise<any[]> {\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    return this.request(`/customers/${params}`);\r\n  }\r\n\r\n  async createCustomer(customerData: any): Promise<any> {\r\n    return this.request('/customers/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(customerData),\r\n    });\r\n  }\r\n\r\n  async getCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/`);\r\n  }\r\n\r\n  async updateCustomer(customerId: number, data: any): Promise<any> {\r\n    return this.request(`/customers/${customerId}/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getPresets(): Promise<any[]> {\r\n    const cacheKey = 'presets';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/presets/');\r\n    // Use longer TTL for presets as they change less frequently\r\n    cacheService.set(cacheKey, data, 30 * 60 * 1000); // 30 minutes\r\n    return data;\r\n  }\r\n\r\n  async createPreset(data: any): Promise<any> {\r\n    const result = await this.request('/presets/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async updatePreset(id: number, data: any): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async deletePreset(id: number): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async getGlobalSlaves(): Promise<any[]> {\r\n    return this.request('/slaves/');\r\n  }\r\n\r\n  async createGlobalSlave(slaveData: any): Promise<any> {\r\n    return this.request('/slaves/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateGlobalSlave(slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteGlobalSlave(slaveId: number): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getDevices(search?: string, page: number = 1, pageSize: number = 25): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    if (search) params.append('search', search);\r\n    params.append('page', page.toString());\r\n    params.append('page_size', pageSize.toString());\r\n    \r\n    const queryString = params.toString();\r\n    return this.request(`/devices/?${queryString}`);\r\n  }\r\n\r\n  async createDevice(deviceData: any): Promise<any> {\r\n    return this.request('/devices/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(deviceData),\r\n    });\r\n  }\r\n\r\n  async updateDevice(deviceId: number, data: any): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async rebootDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/reboot/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  async hardResetDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/hard-reset/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  async getDeviceLogs(deviceId: number, limit: number = 100, offset: number = 0): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/logs/?limit=${limit}&offset=${offset}`);\r\n  }\r\n\r\n  async toggleDeviceLogs(deviceId: number, enabled: boolean): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/logs/toggle/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ enabled }),\r\n    });\r\n  }\r\n\r\n  async deleteDevicesBulk(deviceIds: number[]): Promise<any> {\r\n    return this.request(`/devices/delete-bulk/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ device_ids: deviceIds }),\r\n    });\r\n  }\r\n\r\n  async getSlaves(configId: string): Promise<any[]> {\r\n    return this.request(`/presets/${configId}/slaves/`);\r\n  }\r\n\r\n  async createSlave(configId: string, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/create/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateSlave(configId: string, slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteSlave(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async addSlavesToPreset(configId: string, slaveIds: number[]): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/add/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ slave_ids: slaveIds }),\r\n    });\r\n  }\r\n\r\n  async detachSlaveFromPreset(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/detach/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  // OTA (Over-The-Air) Update Endpoints\r\n  async getFirmwareVersions(activeOnly: boolean = true): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    params.append('active', activeOnly.toString());\r\n    return this.request(`/ota/firmware/?${params.toString()}`);\r\n  }\r\n\r\n  async uploadFirmwareVersion(formData: FormData): Promise<any> {\r\n    const url = `${API_BASE_URL}/ota/firmware/create/`;\r\n    const tokens = localStorage.getItem('authTokens');\r\n    \r\n    if (!tokens) {\r\n      throw new Error('Authentication required');\r\n    }\r\n    \r\n    const parsedTokens = JSON.parse(tokens);\r\n    let headers: HeadersInit = {\r\n      'Authorization': `Bearer ${parsedTokens.access}`,\r\n    };\r\n    // Don't set Content-Type - let browser set it with boundary for multipart/form-data\r\n    \r\n    let response = await fetch(url, {\r\n      method: 'POST',\r\n      headers,\r\n      body: formData,\r\n    });\r\n\r\n    // Handle 401 with token refresh\r\n    if (response.status === 401) {\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        const newTokens = JSON.parse(localStorage.getItem('authTokens') || '{}');\r\n        headers = {\r\n          'Authorization': `Bearer ${newTokens.access}`,\r\n        };\r\n        response = await fetch(url, {\r\n          method: 'POST',\r\n          headers,\r\n          body: formData,\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`Upload failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  async updateFirmwareVersion(firmwareId: number, data: any): Promise<any> {\r\n    return this.request(`/ota/firmware/${firmwareId}/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteFirmwareVersion(firmwareId: number): Promise<any> {\r\n    return this.request(`/ota/firmware/${firmwareId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getDeviceUpdateLogs(deviceId: string): Promise<any> {\r\n    return this.request(`/ota/devices/${deviceId}/logs`);\r\n  }\r\n\r\n  async getOTAConfig(): Promise<any> {\r\n    return this.request(`/ota/config/`);\r\n  }\r\n\r\n  async updateOTAConfig(config: any): Promise<any> {\r\n    return this.request(`/ota/config/update/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(config),\r\n    });\r\n  }\r\n\r\n  async getOTAHealth(): Promise<any> {\r\n    return this.request(`/ota/health/`);\r\n  }\r\n\r\n  async triggerRollback(deviceSerial: string, notes?: string): Promise<any> {\r\n    return this.request(`/ota/updates/rollback/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        device_serial: deviceSerial,\r\n        notes: notes || ''\r\n      }),\r\n    });\r\n  }\r\n\r\n  async deployFirmware(firmwareId: number, deviceSerials: string[], notes?: string): Promise<any> {\r\n    return this.request(`/ota/updates/multiple/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        firmware_id: firmwareId,\r\n        device_serials: deviceSerials,\r\n        notes: notes || ''\r\n      }),\r\n    });\r\n  }\r\n\r\n  async listTargetedUpdates(): Promise<any> {\r\n    return this.request(`/ota/updates/`);\r\n  }\r\n\r\n  async getTargetedUpdate(updateId: number): Promise<any> {\r\n    return this.request(`/ota/updates/${updateId}/`);\r\n  }\r\n}\r\n\r\nexport const apiService = new ApiService();"],"names":["SystemHealth","health","setHealth","useState","loading","setLoading","error","setError","useEffect","fetchSystemHealth","interval","setInterval","clearInterval","async","data","apiService","getSystemHealth","err","Error","message","getStatusColor","status","toLowerCase","getStatusIcon","_jsx","className","children","_jsxs","deviceUptime","active_devices","total_devices","concat","overall_health","toUpperCase","seconds","days","Math","floor","hours","minutes","formatUptime","uptime_seconds","style","width","toFixed","total_telemetry_points","toLocaleString","database_status","mqtt_status","Date","now","CacheService","constructor","cache","Map","subscribers","set","key","ttlMs","arguments","length","undefined","DEFAULT_TTL","staleTime","this","timestamp","expiresIn","min","STALE_TIME","notifySubscribers","get","entry","delete","getWithStaleStatus","_entry$staleTime","age","isExpired","isStale","has","_entry$staleTime2","clear","clearPattern","pattern","regex","RegExp","keysToDelete","forEach","_","test","push","clearAll","size","subscribe","callback","Set","subscription","add","subs","subscribePattern","source","directSubs","sub","console","subKey","startsWith","keys","Array","from","getStats","values","reduce","sum","getTTL","REALTIME_TTL","LONG_TTL","cacheService","API_BASE_URL","process","getAuthHeaders","tokens","localStorage","getItem","parsedTokens","JSON","parse","access","request","endpoint","options","url","headers","response","fetch","_objectSpread","refreshToken","removeItem","window","location","href","ok","errorText","text","statusText","json","method","body","stringify","refresh","newTokens","setItem","getConfiguration","getTelemetry","provisionDevice","getAlerts","cacheKey","cached","getKPIs","getUsers","search","params","encodeURIComponent","createUser","userData","result","createEmployee","employeeData","is_staff","getUserDevices","userId","getUserSite","createUserSite","updateUserSite","getDeviceSite","deviceId","createDeviceSite","updateDeviceSite","getSiteTelemetry","siteId","query","URLSearchParams","start_date","append","end_date","toString","getSiteForecast","date","getSiteWeather","updateUser","deleteUser","getProfile","updateProfile","changePassword","getCustomers","createCustomer","customerData","getCustomer","customerId","updateCustomer","deleteCustomer","getPresets","createPreset","updatePreset","id","deletePreset","getGlobalSlaves","createGlobalSlave","slaveData","updateGlobalSlave","slaveId","deleteGlobalSlave","getDevices","page","pageSize","queryString","createDevice","deviceData","updateDevice","deleteDevice","rebootDevice","hardResetDevice","getDeviceLogs","limit","offset","toggleDeviceLogs","enabled","deleteDevicesBulk","deviceIds","device_ids","getSlaves","configId","createSlave","updateSlave","deleteSlave","addSlavesToPreset","slaveIds","slave_ids","detachSlaveFromPreset","getFirmwareVersions","activeOnly","uploadFirmwareVersion","formData","updateFirmwareVersion","firmwareId","deleteFirmwareVersion","getDeviceUpdateLogs","getOTAConfig","updateOTAConfig","config","getOTAHealth","triggerRollback","deviceSerial","notes","device_serial","deployFirmware","deviceSerials","firmware_id","device_serials","listTargetedUpdates","getTargetedUpdate","updateId"],"sourceRoot":""}