{"version":3,"file":"static/js/560.ce41a549.chunk.js","mappings":"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","sources":["constants.ts","services/cacheService.ts","services/api.ts"],"sourcesContent":["export const IST_TIMEZONE = 'Asia/Kolkata';\r\n\r\nexport const CHART_COLORS = ['#00a63e', '#F07522', '#3b82f6', '#8b5cf6', '#10b981', '#f59e0b'];\r\n\r\nexport const DEFAULT_PAGE_SIZE = 25;\r\n\r\nexport const DEVICE_HEARTBEAT_TIMEOUT_MS = 300_000;\r\n","/**\r\n * Enhanced in-memory cache service for API responses\r\n * Features:\r\n * - TTL-based expiration\r\n * - Stale-while-revalidate pattern support\r\n * - Subscription system for real-time updates\r\n * - Pattern-based cache invalidation\r\n */\r\n\r\ninterface CacheEntry {\r\n  data: any;\r\n  timestamp: number;\r\n  expiresIn: number; // milliseconds\r\n  staleTime?: number; // Time after which data is considered stale but usable\r\n}\r\n\r\ninterface CacheSubscription {\r\n  callback: (data: any) => void;\r\n  pattern?: RegExp;\r\n}\r\n\r\nclass CacheService {\r\n  private cache: Map<string, CacheEntry> = new Map();\r\n  private subscribers: Map<string, Set<CacheSubscription>> = new Map();\r\n  private static readonly DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes default\r\n  private static readonly LONG_TTL = 30 * 60 * 1000; // 30 minutes for static data\r\n  private static readonly REALTIME_TTL = 10 * 1000; // 10 seconds for real-time data\r\n  private static readonly STALE_TIME = 30 * 1000; // 30 seconds before data is stale\r\n\r\n  /**\r\n   * Set a cache entry and notify subscribers\r\n   */\r\n  set(key: string, data: any, ttlMs: number = CacheService.DEFAULT_TTL, staleTime?: number): void {\r\n    this.cache.set(key, {\r\n      data,\r\n      timestamp: Date.now(),\r\n      expiresIn: ttlMs,\r\n      staleTime: staleTime ?? Math.min(ttlMs / 2, CacheService.STALE_TIME),\r\n    });\r\n    \r\n    // Notify subscribers\r\n    this.notifySubscribers(key, data);\r\n  }\r\n\r\n  /**\r\n   * Get a cache entry if valid (returns null if expired)\r\n   */\r\n  get(key: string): any | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    // Check if expired\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return entry.data;\r\n  }\r\n\r\n  /**\r\n   * Get cache entry even if stale (for stale-while-revalidate pattern)\r\n   * Returns { data, isStale } or null if no entry exists\r\n   */\r\n  getWithStaleStatus(key: string): { data: any; isStale: boolean; isExpired: boolean } | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    const now = Date.now();\r\n    const age = now - entry.timestamp;\r\n    const isExpired = age > entry.expiresIn;\r\n    const isStale = age > (entry.staleTime ?? entry.expiresIn / 2);\r\n\r\n    // Remove if fully expired\r\n    if (isExpired) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      data: entry.data,\r\n      isStale,\r\n      isExpired: false,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Check if key exists and is not expired\r\n   */\r\n  has(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return false;\r\n\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Check if cached data is stale but usable\r\n   */\r\n  isStale(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return true;\r\n\r\n    const now = Date.now();\r\n    const age = now - entry.timestamp;\r\n    return age > (entry.staleTime ?? entry.expiresIn / 2);\r\n  }\r\n\r\n  /**\r\n   * Clear a specific cache entry\r\n   */\r\n  clear(key: string): void {\r\n    this.cache.delete(key);\r\n  }\r\n\r\n  /**\r\n   * Clear cache entries matching a pattern\r\n   */\r\n  clearPattern(pattern: string | RegExp): void {\r\n    const regex = typeof pattern === 'string' ? new RegExp(pattern) : pattern;\r\n    const keysToDelete: string[] = [];\r\n    \r\n    this.cache.forEach((_, key) => {\r\n      if (regex.test(key)) {\r\n        keysToDelete.push(key);\r\n      }\r\n    });\r\n    \r\n    keysToDelete.forEach(key => this.cache.delete(key));\r\n  }\r\n\r\n  /**\r\n   * Clear all cache entries\r\n   */\r\n  clearAll(): void {\r\n    this.cache.clear();\r\n  }\r\n\r\n  /**\r\n   * Get cache size\r\n   */\r\n  size(): number {\r\n    return this.cache.size;\r\n  }\r\n\r\n  /**\r\n   * Subscribe to cache updates for a specific key\r\n   */\r\n  subscribe(key: string, callback: (data: any) => void): () => void {\r\n    if (!this.subscribers.has(key)) {\r\n      this.subscribers.set(key, new Set());\r\n    }\r\n    \r\n    const subscription: CacheSubscription = { callback };\r\n    this.subscribers.get(key)!.add(subscription);\r\n\r\n    // Return unsubscribe function\r\n    return () => {\r\n      const subs = this.subscribers.get(key);\r\n      if (subs) {\r\n        subs.delete(subscription);\r\n        if (subs.size === 0) {\r\n          this.subscribers.delete(key);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Subscribe to cache updates matching a pattern\r\n   */\r\n  subscribePattern(pattern: RegExp, callback: (data: any) => void): () => void {\r\n    const key = `__pattern__${pattern.source}`;\r\n    if (!this.subscribers.has(key)) {\r\n      this.subscribers.set(key, new Set());\r\n    }\r\n    \r\n    const subscription: CacheSubscription = { callback, pattern };\r\n    this.subscribers.get(key)!.add(subscription);\r\n\r\n    return () => {\r\n      const subs = this.subscribers.get(key);\r\n      if (subs) {\r\n        subs.delete(subscription);\r\n        if (subs.size === 0) {\r\n          this.subscribers.delete(key);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Notify all subscribers of a cache update\r\n   */\r\n  private notifySubscribers(key: string, data: any): void {\r\n    // Direct key subscribers\r\n    const directSubs = this.subscribers.get(key);\r\n    if (directSubs) {\r\n      directSubs.forEach(sub => {\r\n        try {\r\n          sub.callback(data);\r\n        } catch (error) {\r\n          console.error(`Cache subscriber error for key ${key}:`, error);\r\n        }\r\n      });\r\n    }\r\n\r\n    // Pattern subscribers\r\n    this.subscribers.forEach((subs, subKey) => {\r\n      if (subKey.startsWith('__pattern__')) {\r\n        subs.forEach(sub => {\r\n          if (sub.pattern && sub.pattern.test(key)) {\r\n            try {\r\n              sub.callback(data);\r\n            } catch (error) {\r\n              console.error(`Cache pattern subscriber error for key ${key}:`, error);\r\n            }\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get all keys in cache\r\n   */\r\n  keys(): string[] {\r\n    return Array.from(this.cache.keys());\r\n  }\r\n\r\n  /**\r\n   * Get cache stats for debugging\r\n   */\r\n  getStats(): { size: number; keys: string[]; subscribers: number } {\r\n    return {\r\n      size: this.cache.size,\r\n      keys: this.keys(),\r\n      subscribers: Array.from(this.subscribers.values()).reduce((sum, set) => sum + set.size, 0),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get TTL constants\r\n   */\r\n  static getTTL(type: 'short' | 'long' | 'realtime' = 'short'): number {\r\n    switch (type) {\r\n      case 'realtime':\r\n        return CacheService.REALTIME_TTL;\r\n      case 'long':\r\n        return CacheService.LONG_TTL;\r\n      default:\r\n        return CacheService.DEFAULT_TTL;\r\n    }\r\n  }\r\n}\r\n\r\nexport const cacheService = new CacheService();\r\nexport const DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes\r\nexport const LONG_TTL = 30 * 60 * 1000; // 30 minutes\r\nexport const REALTIME_TTL = 10 * 1000; // 10 seconds\r\n","import { cacheService, DEFAULT_TTL } from './cacheService';\r\nimport { DEFAULT_PAGE_SIZE } from '../constants';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'https://smart-solar-django-backend.vercel.app/api';\r\n\r\nclass ApiService {\r\n  private getAuthHeaders(): HeadersInit {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (tokens) {\r\n      try {\r\n        const parsedTokens = JSON.parse(tokens);\r\n        return {\r\n          'Authorization': `Bearer ${parsedTokens.access}`,\r\n          'Content-Type': 'application/json',\r\n        };\r\n      } catch (error) {\r\n        console.error('Error parsing auth tokens:', error);\r\n      }\r\n    }\r\n    return {\r\n      'Content-Type': 'application/json',\r\n    };\r\n  }\r\n\r\n  /** Normalize backend error: supports { error }, { detail }, or raw text. */\r\n  private async parseErrorResponse(response: Response): Promise<string> {\r\n    const text = await response.text();\r\n    try {\r\n      const body = JSON.parse(text);\r\n      if (body?.error) return body.error;\r\n      if (body?.detail) return typeof body.detail === 'string' ? body.detail : JSON.stringify(body.detail);\r\n    } catch {\r\n      // ignore\r\n    }\r\n    return text || `API request failed: ${response.status} ${response.statusText}`;\r\n  }\r\n\r\n  private async request(endpoint: string, options: RequestInit = {}): Promise<any> {\r\n    const url = `${API_BASE_URL}${endpoint}`;\r\n    let headers = this.getAuthHeaders();\r\n\r\n    let response = await fetch(url, {\r\n      ...options,\r\n      headers: {\r\n        ...headers,\r\n        ...options.headers,\r\n      },\r\n    });\r\n\r\n    if (response.status === 401) {\r\n      // Try to refresh token\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        // Retry with new token\r\n        headers = this.getAuthHeaders();\r\n        response = await fetch(url, {\r\n          ...options,\r\n          headers: {\r\n            ...headers,\r\n            ...options.headers,\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      // Token refresh failed or not attempted, logout\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const message = await this.parseErrorResponse(response);\r\n      throw new Error(message);\r\n    }\r\n\r\n    if (response.status === 204) return null;\r\n    return response.json();\r\n  }\r\n\r\n  private async refreshToken(): Promise<boolean> {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (!tokens) return false;\r\n\r\n    try {\r\n      const parsedTokens = JSON.parse(tokens);\r\n      const response = await fetch(`${API_BASE_URL}/auth/token/refresh/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ refresh: parsedTokens.refresh }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        const newTokens = {\r\n          access: data.access,\r\n          refresh: parsedTokens.refresh, // Keep the same refresh token\r\n        };\r\n        localStorage.setItem('authTokens', JSON.stringify(newTokens));\r\n        return true;\r\n      }\r\n    } catch (error) {\r\n      console.error('Token refresh failed:', error);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Fetches gateway configuration. Returns null when none exists (404),\r\n   * so the UI can treat it as \"no config\" / global mode.\r\n   */\r\n  async getConfiguration(): Promise<any> {\r\n    const url = `${API_BASE_URL}/config/`;\r\n    const headers = this.getAuthHeaders();\r\n    let response = await fetch(url, { headers });\r\n\r\n    if (response.status === 401) {\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        response = await fetch(url, { headers: this.getAuthHeaders() });\r\n      }\r\n    }\r\n    if (response.status === 401) {\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n    if (response.status === 404) return null;\r\n    if (!response.ok) {\r\n      const message = await this.parseErrorResponse(response);\r\n      throw new Error(message);\r\n    }\r\n    return response.json();\r\n  }\r\n\r\n  async getTelemetry(): Promise<any[]> {\r\n    return this.request('/telemetry/');\r\n  }\r\n\r\n  async provisionDevice(data: any): Promise<any> {\r\n    const response = await fetch(`${API_BASE_URL}/devices/provision`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n    if (!response.ok) {\r\n      throw new Error(`Provisioning failed: ${response.statusText}`);\r\n    }\r\n    return response.json();\r\n  }\r\n\r\n  async getAlerts(): Promise<any[]> {\r\n    const cacheKey = 'alerts';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/alerts/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getSystemHealth(): Promise<any> {\r\n    const cacheKey = 'system_health';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/health/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getKPIs(): Promise<any> {\r\n    const cacheKey = 'kpis';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/kpis/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getUsers(search?: string, page = 1, pageSize = DEFAULT_PAGE_SIZE): Promise<any> {\r\n    const cacheKey = `users_${search || 'all'}_${page}_${pageSize}`;\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const params = new URLSearchParams();\r\n    if (search) params.set('search', search);\r\n    params.set('page', String(page));\r\n    params.set('page_size', String(pageSize));\r\n    const data = await this.request(`/users/?${params.toString()}`);\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async createUser(userData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(userData),\r\n    });\r\n    cacheService.clearPattern(/^users_/);\r\n    return result;\r\n  }\r\n\r\n  async createEmployee(employeeData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ ...employeeData, is_staff: true }),\r\n    });\r\n    cacheService.clearPattern(/^users_/);\r\n    return result;\r\n  }\r\n\r\n  async getUserDevices(userId: number): Promise<any[]> {\r\n    return this.request(`/users/${userId}/devices/`);\r\n  }\r\n\r\n  async getUserSite(userId: number): Promise<any> {\r\n    return this.request(`/users/${userId}/site/`);\r\n  }\r\n\r\n  async createUserSite(userId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/users/${userId}/site/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async updateUserSite(userId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/users/${userId}/site/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async getDeviceSite(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/`);\r\n  }\r\n\r\n  async createDeviceSite(deviceId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async updateDeviceSite(deviceId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // DynamoDB site data\r\n  async getSiteTelemetry(siteId: string, params?: { start_date?: string; end_date?: string; days?: number }): Promise<any[]> {\r\n    const query = new URLSearchParams();\r\n    if (params?.start_date) query.append('start_date', params.start_date);\r\n    if (params?.end_date) query.append('end_date', params.end_date);\r\n    if (params?.days) query.append('days', params.days.toString());\r\n    const url = `/sites/${siteId}/telemetry/${query.toString() ? '?' + query.toString() : ''}`;\r\n    // 60-second TTL: live data changes frequently but a 1-min cache avoids duplicate fetches\r\n    // on tab switches and rapid re-renders without showing stale data\r\n    const cacheKey = `telemetry_${siteId}_${query.toString()}`;\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n    const data = await this.request(url);\r\n    cacheService.set(cacheKey, data, 60 * 1000);\r\n    return data;\r\n  }\r\n\r\n  /**\r\n   * Historical telemetry from S3 (older than DynamoDB's 7-day TTL window).\r\n   * S3 path: telemetry_csv/{site_id}/{YYYY}/{MM}/{DD}/{HH}/data.csv\r\n   * Returns same shape as getSiteTelemetry.\r\n   */\r\n  async getSiteHistory(siteId: string, params: { start_date: string; end_date: string }): Promise<any[]> {\r\n    const query = new URLSearchParams({ start_date: params.start_date, end_date: params.end_date });\r\n    // 5-minute TTL: S3 history is immutable for past data, very safe to cache\r\n    const cacheKey = `history_${siteId}_${query.toString()}`;\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n    const data = await this.request(`/sites/${siteId}/history/?${query.toString()}`);\r\n    cacheService.set(cacheKey, data, 5 * 60 * 1000);\r\n    return data;\r\n  }\r\n\r\n  async getSiteForecast(siteId: string, params?: { date?: string; start_date?: string; end_date?: string }): Promise<any[]> {\r\n    const query = new URLSearchParams();\r\n    if (params?.date) query.append('date', params.date);\r\n    if (params?.start_date) query.append('start_date', params.start_date);\r\n    if (params?.end_date) query.append('end_date', params.end_date);\r\n    const url = `/sites/${siteId}/forecast/${query.toString() ? '?' + query.toString() : ''}`;\r\n    // 15-minute TTL: scheduler refreshes forecast every 15 min, so this is the ideal cache window\r\n    const cacheKey = `forecast_${siteId}_${query.toString()}`;\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n    const data = await this.request(url);\r\n    cacheService.set(cacheKey, data, 15 * 60 * 1000);\r\n    return data;\r\n  }\r\n\r\n  /**\r\n   * Returns { current: WeatherObs | null, hourly_forecast: WeatherFcst[] }\r\n   *   current.obs_timestamp    — ISO UTC of the observation\r\n   *   current.ghi_wm2          — global horizontal irradiance (W/m²)\r\n   *   current.temperature_c    — air temperature (°C)\r\n   *   current.humidity_pct     — relative humidity (%)\r\n   *   current.wind_speed_ms    — wind speed (m/s)\r\n   *   current.cloud_cover_pct  — cloud cover (%)\r\n   *   hourly_forecast[n].forecast_for — ISO UTC of the forecast slot\r\n   *   hourly_forecast[n].ghi_wm2 …   — same fields as current\r\n   */\r\n  async getSiteWeather(siteId: string): Promise<{ current: any | null; hourly_forecast: any[] } | null> {\r\n    // 15-minute TTL: weather data refreshes at the same cadence as the forecast scheduler\r\n    const cacheKey = `weather_${siteId}`;\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n    const data = await this.request(`/sites/${siteId}/weather/`);\r\n    cacheService.set(cacheKey, data, 15 * 60 * 1000);\r\n    return data;\r\n  }\r\n\r\n  async updateUser(userId: number, data: any): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clearPattern(/^users_/);\r\n    return result;\r\n  }\r\n\r\n  async deleteUser(userId: number): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clearPattern(/^users_/);\r\n    return result;\r\n  }\r\n\r\n  // Profile Management (for current logged-in user)\r\n  async getProfile(): Promise<any> {\r\n    return this.request('/profile/');\r\n  }\r\n\r\n  async updateProfile(data: any): Promise<any> {\r\n    return this.request('/profile/update/', {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async changePassword(data: { current_password: string; new_password: string }): Promise<any> {\r\n    return this.request('/profile/change-password/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // Customer Management (separate from staff users/employees)\r\n  async getCustomers(search?: string): Promise<any[]> {\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    return this.request(`/customers/${params}`);\r\n  }\r\n\r\n  async createCustomer(customerData: any): Promise<any> {\r\n    return this.request('/customers/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(customerData),\r\n    });\r\n  }\r\n\r\n  async getCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/`);\r\n  }\r\n\r\n  async updateCustomer(customerId: number, data: any): Promise<any> {\r\n    return this.request(`/customers/${customerId}/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getPresets(): Promise<any[]> {\r\n    const cacheKey = 'presets';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/presets/');\r\n    // Use longer TTL for presets as they change less frequently\r\n    cacheService.set(cacheKey, data, 30 * 60 * 1000); // 30 minutes\r\n    return data;\r\n  }\r\n\r\n  async createPreset(data: any): Promise<any> {\r\n    const result = await this.request('/presets/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async updatePreset(id: number, data: any): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async deletePreset(id: number): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async getGlobalSlaves(): Promise<any[]> {\r\n    return this.request('/slaves/');\r\n  }\r\n\r\n  async createGlobalSlave(slaveData: any): Promise<any> {\r\n    return this.request('/slaves/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateGlobalSlave(slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteGlobalSlave(slaveId: number): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getDevices(search?: string, page: number = 1, pageSize: number = DEFAULT_PAGE_SIZE): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    if (search) params.append('search', search);\r\n    params.append('page', page.toString());\r\n    params.append('page_size', pageSize.toString());\r\n    \r\n    const queryString = params.toString();\r\n    return this.request(`/devices/?${queryString}`);\r\n  }\r\n\r\n  async createDevice(deviceData: any): Promise<any> {\r\n    return this.request('/devices/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(deviceData),\r\n    });\r\n  }\r\n\r\n  async updateDevice(deviceId: number, data: any): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async rebootDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/reboot/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  async hardResetDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/hard-reset/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  async getDeviceLogs(deviceId: number, limit: number = 100, offset: number = 0): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/logs/?limit=${limit}&offset=${offset}`);\r\n  }\r\n\r\n  async toggleDeviceLogs(deviceId: number, enabled: boolean): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/logs/toggle/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ enabled }),\r\n    });\r\n  }\r\n\r\n  async deleteDevicesBulk(deviceIds: number[]): Promise<any> {\r\n    return this.request(`/devices/delete-bulk/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ device_ids: deviceIds }),\r\n    });\r\n  }\r\n\r\n  async getSlaves(configId: string): Promise<any[]> {\r\n    return this.request(`/presets/${configId}/slaves/`);\r\n  }\r\n\r\n  async createSlave(configId: string, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/create/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateSlave(configId: string, slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteSlave(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async addSlavesToPreset(configId: string, slaveIds: number[]): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/add/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ slave_ids: slaveIds }),\r\n    });\r\n  }\r\n\r\n  async detachSlaveFromPreset(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/detach/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  // OTA (Over-The-Air) Update Endpoints\r\n  async getFirmwareVersions(activeOnly: boolean = true): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    params.append('active', activeOnly.toString());\r\n    return this.request(`/ota/firmware/?${params.toString()}`);\r\n  }\r\n\r\n  async uploadFirmwareVersion(formData: FormData): Promise<any> {\r\n    const url = `${API_BASE_URL}/ota/firmware/create/`;\r\n    const tokens = localStorage.getItem('authTokens');\r\n    \r\n    if (!tokens) {\r\n      throw new Error('Authentication required');\r\n    }\r\n    \r\n    const parsedTokens = JSON.parse(tokens);\r\n    let headers: HeadersInit = {\r\n      'Authorization': `Bearer ${parsedTokens.access}`,\r\n    };\r\n    // Don't set Content-Type - let browser set it with boundary for multipart/form-data\r\n    \r\n    let response = await fetch(url, {\r\n      method: 'POST',\r\n      headers,\r\n      body: formData,\r\n    });\r\n\r\n    // Handle 401 with token refresh\r\n    if (response.status === 401) {\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        const newTokens = JSON.parse(localStorage.getItem('authTokens') || '{}');\r\n        headers = {\r\n          'Authorization': `Bearer ${newTokens.access}`,\r\n        };\r\n        response = await fetch(url, {\r\n          method: 'POST',\r\n          headers,\r\n          body: formData,\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`Upload failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  async updateFirmwareVersion(firmwareId: number, data: any): Promise<any> {\r\n    return this.request(`/ota/firmware/${firmwareId}/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteFirmwareVersion(firmwareId: number): Promise<any> {\r\n    return this.request(`/ota/firmware/${firmwareId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getDeviceUpdateLogs(deviceId: string): Promise<any> {\r\n    return this.request(`/ota/devices/${deviceId}/logs`);\r\n  }\r\n\r\n  async getOTAConfig(): Promise<any> {\r\n    return this.request(`/ota/config/`);\r\n  }\r\n\r\n  async updateOTAConfig(config: any): Promise<any> {\r\n    return this.request(`/ota/config/update/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(config),\r\n    });\r\n  }\r\n\r\n  async getOTAHealth(): Promise<any> {\r\n    return this.request(`/ota/health/`);\r\n  }\r\n\r\n  async triggerRollback(deviceSerial: string, notes?: string): Promise<any> {\r\n    return this.request(`/ota/updates/rollback/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        device_serial: deviceSerial,\r\n        notes: notes || ''\r\n      }),\r\n    });\r\n  }\r\n\r\n  async deployFirmware(firmwareId: number, deviceSerials: string[], notes?: string): Promise<any> {\r\n    return this.request(`/ota/updates/multiple/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        firmware_id: firmwareId,\r\n        device_serials: deviceSerials,\r\n        notes: notes || ''\r\n      }),\r\n    });\r\n  }\r\n\r\n  async listTargetedUpdates(): Promise<any> {\r\n    return this.request(`/ota/updates/`);\r\n  }\r\n\r\n  async getTargetedUpdate(updateId: number): Promise<any> {\r\n    return this.request(`/ota/updates/${updateId}/`);\r\n  }\r\n}\r\n\r\nexport const apiService = new ApiService();"],"names":["IST_TIMEZONE","DEFAULT_PAGE_SIZE","CacheService","constructor","cache","Map","subscribers","set","key","data","ttlMs","arguments","length","undefined","DEFAULT_TTL","staleTime","this","timestamp","Date","now","expiresIn","Math","min","STALE_TIME","notifySubscribers","get","entry","delete","getWithStaleStatus","_entry$staleTime","age","isExpired","isStale","has","_entry$staleTime2","clear","clearPattern","pattern","regex","RegExp","keysToDelete","forEach","_","test","push","clearAll","size","subscribe","callback","Set","subscription","add","subs","subscribePattern","concat","source","directSubs","sub","error","console","subKey","startsWith","keys","Array","from","getStats","values","reduce","sum","getTTL","REALTIME_TTL","LONG_TTL","cacheService","API_BASE_URL","process","apiService","getAuthHeaders","tokens","localStorage","getItem","parsedTokens","JSON","parse","access","parseErrorResponse","response","text","body","detail","stringify","_unused","status","statusText","request","endpoint","options","url","headers","fetch","_objectSpread","refreshToken","removeItem","window","location","href","Error","ok","message","json","method","refresh","newTokens","setItem","getConfiguration","getTelemetry","provisionDevice","getAlerts","cacheKey","cached","getSystemHealth","getKPIs","getUsers","search","page","pageSize","params","URLSearchParams","String","toString","createUser","userData","result","createEmployee","employeeData","is_staff","getUserDevices","userId","getUserSite","createUserSite","updateUserSite","getDeviceSite","deviceId","createDeviceSite","updateDeviceSite","getSiteTelemetry","siteId","query","start_date","append","end_date","days","getSiteHistory","getSiteForecast","date","getSiteWeather","updateUser","deleteUser","getProfile","updateProfile","changePassword","getCustomers","encodeURIComponent","createCustomer","customerData","getCustomer","customerId","updateCustomer","deleteCustomer","getPresets","createPreset","updatePreset","id","deletePreset","getGlobalSlaves","createGlobalSlave","slaveData","updateGlobalSlave","slaveId","deleteGlobalSlave","getDevices","queryString","createDevice","deviceData","updateDevice","deleteDevice","rebootDevice","hardResetDevice","getDeviceLogs","limit","offset","toggleDeviceLogs","enabled","deleteDevicesBulk","deviceIds","device_ids","getSlaves","configId","createSlave","updateSlave","deleteSlave","addSlavesToPreset","slaveIds","slave_ids","detachSlaveFromPreset","getFirmwareVersions","activeOnly","uploadFirmwareVersion","formData","errorText","updateFirmwareVersion","firmwareId","deleteFirmwareVersion","getDeviceUpdateLogs","getOTAConfig","updateOTAConfig","config","getOTAHealth","triggerRollback","deviceSerial","notes","device_serial","deployFirmware","deviceSerials","firmware_id","device_serials","listTargetedUpdates","getTargetedUpdate","updateId"],"sourceRoot":""}