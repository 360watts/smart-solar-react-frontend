{"version":3,"file":"static/js/923.1ecdc5fc.chunk.js","mappings":"0MA+CO,MAAMA,EAAgBA,KAAO,IAADC,EACjC,MAAM,OAAEC,IAAWC,EAAAA,EAAAA,MAGZC,EAAWC,IAAgBC,EAAAA,EAAAA,UAA4B,KACvDC,EAAYC,IAAiBF,EAAAA,EAAAA,UAAS,CAC3CG,KAAM,GACNC,QAAS,GACTC,YAAa,WACbC,cAAe,QACfC,aAAc,GACdC,KAAM,QAIDC,EAAkBC,IAAuBV,EAAAA,EAAAA,UAA2B,CACzEW,gBAAiB,GACjBC,cAAe,GACfC,KAAM,YACNC,cAAc,EACdC,cAAe,IACfC,iBAAkB,MAEbC,EAAcC,IAAmBlB,EAAAA,EAAAA,UAAiC,CACvEmB,MAAM,EACNC,SAAU,GACVC,YAAa,EACbC,aAAc,MAETC,EAAaC,IAAkBxB,EAAAA,EAAAA,WAAS,IAGxCyB,EAASC,IAAc1B,EAAAA,EAAAA,UAAyB,KAChD2B,EAAcC,IAAmB5B,EAAAA,EAAAA,UAAyC,QAC1E6B,EAAgBC,IAAqB9B,EAAAA,EAAAA,WAAS,IAC9C+B,EAAkBC,IAAuBhC,EAAAA,EAAAA,WAAS,IAClDiC,EAAkBC,IAAuBlC,EAAAA,EAAAA,UAAc,OAGvDmC,EAAcC,IAAmBpC,EAAAA,EAAAA,UAAS,CAC/CqC,gBAAiB,GACjBC,OAAQ,MAEHC,EAAmBC,IAAwBxC,EAAAA,EAAAA,WAAS,IACpDyC,EAAiBC,IAAsB1C,EAAAA,EAAAA,UAAS,CACrD2C,eAAgB,MAChBC,OAAQ,MACRvC,YAAa,SAIfwC,EAAAA,EAAAA,WAAU,KACRC,IACAC,IACAC,IAGA,MAAMC,EAAWC,YAAY,KAC3BF,KACC,KAEH,MAAO,IAAMG,cAAcF,IAE1B,IAEH,MAAMH,EAAmBM,UACvB,IACEpB,GAAoB,GACpB,MAAMqB,QAAiBC,EAAAA,EAAWC,qBAAoB,GAGhDC,GAA2CH,EAASI,SAAWJ,GAAY,IAAIK,IAAKC,IAAO,IAAAC,EAAAC,EAAA,MAAM,CACrGC,GAAIH,EAAGG,GACP3D,KAAMwD,EAAGI,UAAQ,aAAAC,OAAiBL,EAAGvD,SACrCA,QAASuD,EAAGvD,QACZC,aAA2B,QAAduD,EAAAD,EAAGM,mBAAW,IAAAL,GAAsC,QAAtCC,EAAdD,EAAgBM,MAAM,sCAA8B,IAAAL,OAAtC,EAAdA,EAAuD,KAAM,UAC1EM,qBAAsB,QACtB3D,KAAM,KACN4D,KAAMT,EAAGS,MAAQ,EACjBC,SAAUV,EAAGU,UAAY,GACzBC,gBAAiC,IAAjBX,EAAGY,UACnBhE,aAAcoD,EAAGa,eAAiBb,EAAGM,aAAe,GACpDrB,OAAQe,EAAGY,UAAY,SAAW,QAClCE,WAAYd,EAAGe,aAAc,IAAIC,MAAOC,iBAG1C7E,EAAayD,EACf,CAAE,MAAOqB,GACPC,QAAQD,MAAM,oCAAqCA,GAEnD9E,EAAa,GACf,CAAC,QACCiC,GAAoB,EACtB,GAGIe,EAAcK,UAClB,IACEtB,GAAkB,GAClB,MAAMuB,QAAiBC,EAAAA,EAAWyB,WAAW,GAAI,EAAG,KAC9CC,EAAc3B,EAASI,SAAWJ,EAGlC4B,GAAsCC,MAAMC,QAAQH,GAAeA,EAAc,IAAItB,IAAK0B,IAAW,CACzGC,SAAUD,EAAOE,eAAiBF,EAAOG,QAAM,MAAAvB,OAAUoB,EAAOtB,IAChEnB,eAAgByC,EAAOI,kBAAoBJ,EAAOK,gBAAkB,SACpEC,cAAe,MACfC,WAAYC,KAAKC,SAAW,GAAM,IAAM,IACxCjD,OAAQ,OACRkD,UAAWV,EAAOW,YAAc,EAChCC,UAAW,GACXC,cAAUC,KAGZxE,EAAWuD,EACb,CAAE,MAAOJ,GACPC,QAAQD,MAAM,0BAA2BA,GACzCnD,EAAW,GACb,CAAC,QACCI,GAAkB,EACpB,GAGIkB,EAAkBI,UACtB,IACE,MAGM+C,SAHkB7C,EAAAA,EAAW8C,uBAGFC,KAAMC,GACxB,gBAAbA,EAAE1D,QAAyC,YAAb0D,EAAE1D,QAElCV,EAAoBiE,GAAkB,MAGlCA,SACII,EAA6BJ,EAEvC,CAAE,MAAOtB,GACPC,QAAQD,MAAM,8BAA+BA,EAC/C,GAGI0B,EAA+BnD,UACnC,IACE,MAAMoD,EAAwBC,GAAcxE,EAC5C,IAAKuE,EAAuB,OAG5B,MACME,GADkBF,EAAsBG,gBAAkB,IACtBjD,IAAKkD,IAAO,IAAAC,EAAA,OAAc,QAAdA,EAAKD,EAAGxB,cAAM,IAAAyB,OAAA,EAATA,EAAWvB,gBAAewB,OAAOC,SAE5F,GAAiC,IAA7BL,EAAkBM,OAAc,OAGpC,MAAMC,EAAcP,EAAkBhD,IAAIN,UACxC,IAAK,IAAD8D,EAAAC,EACF,MAAMC,QAAa9D,EAAAA,EAAW+D,oBAAoBhC,GAC5CiC,EAAYF,GAAQA,EAAKJ,OAAS,EAAII,EAAK,GAAK,KAEtD,IAAKE,EAAW,MAAO,CAAEjC,WAAUzC,OAAQ,QAE3C,MAAM2E,EAAgC,QAAnBL,EAAGI,EAAU1E,cAAM,IAAAsE,OAAA,EAAhBA,EAAkBM,cACxC,IAAI5E,EAAiC,OAErC,OAAQ2E,GACN,IAAK,UACL,IAAK,WACL,IAAK,YACH3E,EAAS,QACT,MACF,IAAK,cACHA,EAAS,cACT,MACF,IAAK,YACHA,EAAS,UACT,MACF,IAAK,SACHA,EAAS,SAIb,MAAO,CACLyC,WACAzC,SACAD,eAAgB2E,EAAUG,iBAC1B/B,cAAyC,QAA5ByB,EAAEG,EAAU9B,wBAAgB,IAAA2B,OAAA,EAA1BA,EAA4B/G,QAC3C4F,UAAsB,WAAXpD,EAAsB,gBAAkB,GAEvD,CAAE,MAAOiC,GAEP,OADAC,QAAQD,MAAM,0BAADb,OAA2BqB,EAAQ,KAAKR,GAC9C,CAAEQ,WAAUzC,OAAQ,OAC7B,IAGI8E,QAAsBC,QAAQC,IAAIX,GAGlCY,EAAY,IAAIC,IAAIJ,EAAchE,IAAIqE,GAAK,CAACA,EAAE1C,SAAU0C,KAG9DrG,EAAWsG,GACTA,EAAYtE,IAAI0B,IACd,MAAM6C,EAASJ,EAAUK,IAAI9C,EAAOC,UACpC,OAAK4C,GAELE,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACK/C,GAAM,IACTxC,OAAQqF,EAAOrF,OACfD,eAAgBsF,EAAOtF,gBAAkByC,EAAOzC,eAChD+C,cAAeuC,EAAOvC,eAAiBN,EAAOM,cAC9CM,UAAWiC,EAAOjC,WAAaZ,EAAOY,YAPpBZ,IAW1B,CAAE,MAAOP,GACPC,QAAQD,MAAM,6CAA8CA,EAC9D,GA6KIuD,EAAgB,CACpBC,MAAO5G,EAAQuF,OACfsB,WAAY7G,EAAQqF,OAAOyB,GAAK,CAAC,cAAe,WAAY,aAAaC,SAASD,EAAE3F,SAASoE,OAC7FyB,QAAShH,EAAQqF,OAAOyB,GAAkB,YAAbA,EAAE3F,QAAsBoE,OACrD0B,OAAQjH,EAAQqF,OAAOyB,GAAkB,WAAbA,EAAE3F,QAAqBoE,OACnD2B,WAAYlH,EAAQqF,OAAOyB,GAAkB,eAAbA,EAAE3F,QAAyBoE,QAiDvD4B,EAAwBvD,IAC5BjD,EAAgByG,IAAIV,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACfU,GAAI,IACPxG,gBAAiBwG,EAAKxG,gBAAgBmG,SAASnD,GAC3CwD,EAAKxG,gBAAgByE,OAAOhD,GAAMA,IAAOuB,GACzC,IAAIwD,EAAKxG,gBAAiBgD,OAI5ByD,EAA6BA,IAC1BrH,EAAQqF,OAAO1B,IACmB,QAAnC3C,EAAgBE,gBAA4ByC,EAAOzC,iBAAmBF,EAAgBE,kBAG3D,QAA3BF,EAAgBG,QAAoBwC,EAAOxC,SAAWH,EAAgBG,SAQxEmG,EAA2BA,KAC/B,MAAMC,EAAWF,IACjB1G,EAAgByG,IAAIV,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACfU,GAAI,IACPxG,gBAAiB2G,EAAStF,IAAI6E,GAAKA,EAAElD,cAInC4D,EAAqBA,KACzB7G,EAAgByG,IAAIV,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUU,GAAI,IAAExG,gBAAiB,OAGjD6G,EAAmC,QAAjBvH,EACpBF,EACAA,EAAQqF,OAAOyB,GAAKA,EAAE3F,SAAWjB,GAErC,OACEwH,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEC,QAAS,OAAQC,SAAU,SAAUC,OAAQ,SAAUC,WAAY5J,EAAS,UAAY,UAAW6J,UAAW,SAAUC,SAAA,EAEpIP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEO,aAAc,QAASD,SAAA,EACnCP,EAAAA,EAAAA,MAAA,MAAIC,MAAO,CACTQ,SAAU,OACVC,WAAY,MACZC,MAAOlK,EAAS,UAAY,UAC5B+J,aAAc,SACdI,QAAS,OACTC,WAAY,SACZC,IAAK,WACLP,SAAA,EACAP,EAAAA,EAAAA,MAAA,OAAKe,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,OAAO,eAAeC,YAAY,IAAGb,SAAA,EAC/Fc,EAAAA,EAAAA,KAAA,QAAMjC,EAAE,+HACRiC,EAAAA,EAAAA,KAAA,YAAUC,OAAO,mCACjBD,EAAAA,EAAAA,KAAA,QAAME,GAAG,KAAKC,GAAG,QAAQC,GAAG,KAAKC,GAAG,UAChC,8BAGRL,EAAAA,EAAAA,KAAA,KAAGpB,MAAO,CAAEU,MAAOlK,EAAS,UAAY,UAAW2J,OAAQ,GAAIG,SAAC,8EAMlEP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAY5J,EAAS,UAAY,QACjCkL,aAAc,OACdzB,QAAS,OACTM,aAAc,OACdoB,UAAWnL,EAAS,4BAA8B,6BAClDoL,OAAQpL,EAAS,oBAAsB,qBACvC8J,SAAA,EACAP,EAAAA,EAAAA,MAAA,MAAIC,MAAO,CACTQ,SAAU,SACVC,WAAY,MACZC,MAAOlK,EAAS,UAAY,UAC5B+J,aAAc,SACdsB,cAAe,UACfC,aAActL,EAAS,oBAAsB,oBAC7CmK,QAAS,OACTC,WAAY,SACZC,IAAK,UACLP,SAAA,EACAc,EAAAA,EAAAA,KAAA,QAAMpB,MAAO,CAAEQ,SAAU,WAAYF,SAAC,iBAAS,0BAKjDP,EAAAA,EAAAA,MAAA,QAAMgC,SAhSiB/H,UAE3B,GADAgI,EAAEC,iBACGpL,EAAWO,KAKhB,IAAK,IAAD8K,EAEF,MAAMC,EAAW,IAAIC,SACrBD,EAASE,OAAO,OAAQxL,EAAWO,MACnC+K,EAASE,OAAO,UAAWxL,EAAWG,SACtCmL,EAASE,OAAO,cAAexL,EAAWE,MAC1CoL,EAASE,OAAO,gBAAiBxL,EAAWM,cAC5CgL,EAASE,OAAO,YAAa,SAG7B,MAAMpI,QAAiBC,EAAAA,EAAWoI,sBAAsBH,GAExDI,MAAM,+CAAD3H,OAAgDX,EAASjD,QAAO,YAAA4D,QAAYX,EAASe,KAAO,MAAMwH,QAAQ,GAAE,mBAAA5H,OAAmC,QAAnCsH,EAAkBjI,EAASgB,gBAAQ,IAAAiH,OAAA,EAAjBA,EAAmBO,UAAU,EAAG,IAAG,oCAAA7H,OAAmCX,EAAS7C,MAAQ,QAG1NN,EAAc,CACZC,KAAM,GACNC,QAAS,GACTC,YAAa,WACbC,cAAe,QACfC,aAAc,GACdC,KAAM,OAGR,MAAMsL,EAAYC,SAASC,cAAc,sBACrCF,IAAWA,EAAUG,MAAQ,UAG3BnJ,GACR,CAAE,MAAO+B,GACPC,QAAQD,MAAM,0BAA2BA,GACzC8G,MAAM,kBAAD3H,OAAmBa,EAAMqH,SAAW,gBAAe,6HAC1D,MApCEP,MAAM,kCA6RkCvC,MAAO,CAC3CI,WAAY5J,EAAS,UAAY,UACjCyJ,QAAS,SACTyB,aAAc,MACdnB,aAAc,OACdqB,OAAQpL,EAAS,oBAAsB,qBACvC8J,SAAA,EACAP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEW,QAAS,OAAQoC,oBAAqB,uCAAwClC,IAAK,QAASP,SAAA,EACxGP,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEW,QAAS,QAASJ,aAAc,SAAUE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,UAAWF,SAAC,qBAG1Ic,EAAAA,EAAAA,KAAA,SACE4B,KAAK,OACLH,MAAOhM,EAAWE,KAClBkM,SAAWjB,GAAMlL,GAAaiI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIlI,GAAU,IAAEE,KAAMiL,EAAEkB,OAAOL,SAC/DM,YAAY,4BACZC,UAAQ,EACRpD,MAAO,CACLc,MAAO,OACPb,QAAS,UACTyB,aAAc,MACdE,OAAQpL,EAAS,oBAAsB,oBACvCgK,SAAU,UACVJ,WAAY5J,EAAS,UAAY,QACjCkK,MAAOlK,EAAS,UAAY,iBAKlCuJ,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEW,QAAS,QAASJ,aAAc,SAAUE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,UAAWF,SAAC,wBAG1Ic,EAAAA,EAAAA,KAAA,SACE4B,KAAK,OACLH,MAAOhM,EAAWG,QAClBiM,SAAWjB,GAAMlL,GAAaiI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIlI,GAAU,IAAEG,QAASgL,EAAEkB,OAAOL,SAClEM,YAAY,QACZC,UAAQ,EACRC,QAAQ,qBACRrD,MAAO,CACLc,MAAO,OACPb,QAAS,UACTyB,aAAc,MACdE,OAAQpL,EAAS,oBAAsB,oBACvCgK,SAAU,UACVJ,WAAY5J,EAAS,UAAY,QACjCkK,MAAOlK,EAAS,UAAY,iBAKlCuJ,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEW,QAAS,QAASJ,aAAc,SAAUE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,UAAWF,SAAC,kBAG1IP,EAAAA,EAAAA,MAAA,UACE8C,MAAOhM,EAAWI,YAClBgM,SAAWjB,GAAMlL,GAAaiI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIlI,GAAU,IAAEI,YAAa+K,EAAEkB,OAAOL,SACtE7C,MAAO,CACLc,MAAO,OACPb,QAAS,UACTyB,aAAc,MACdE,OAAQpL,EAAS,oBAAsB,oBACvCgK,SAAU,UACVJ,WAAY5J,EAAS,UAAY,QACjCkK,MAAOlK,EAAS,UAAY,WAC5B8J,SAAA,EAEFc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,WAAUvC,SAAC,cACzBc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,QAAOvC,SAAC,WACtBc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,QAAOvC,SAAC,WACtBc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,QAAOvC,SAAC,iBAI1BP,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEW,QAAS,QAASJ,aAAc,SAAUE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,UAAWF,SAAC,4BAG1Ic,EAAAA,EAAAA,KAAA,SACE4B,KAAK,OACLH,MAAOhM,EAAWK,cAClB+L,SAAWjB,GAAMlL,GAAaiI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIlI,GAAU,IAAEK,cAAe8K,EAAEkB,OAAOL,SACxEM,YAAY,QACZC,UAAQ,EACRpD,MAAO,CACLc,MAAO,OACPb,QAAS,UACTyB,aAAc,MACdE,OAAQpL,EAAS,oBAAsB,oBACvCgK,SAAU,UACVJ,WAAY5J,EAAS,UAAY,QACjCkK,MAAOlK,EAAS,UAAY,oBAMpCuJ,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEsD,UAAW,QAAShD,SAAA,EAChCc,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEW,QAAS,QAASJ,aAAc,SAAUE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,UAAWF,SAAC,mBAG1Ic,EAAAA,EAAAA,KAAA,YACEyB,MAAOhM,EAAWM,aAClB8L,SAAWjB,GAAMlL,GAAaiI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIlI,GAAU,IAAEM,aAAc6K,EAAEkB,OAAOL,SACvEM,YAAY,2CACZI,KAAM,EACNvD,MAAO,CACLc,MAAO,OACPb,QAAS,UACTyB,aAAc,MACdE,OAAQpL,EAAS,oBAAsB,oBACvCgK,SAAU,UACVgD,WAAY,UACZC,OAAQ,WACRrD,WAAY5J,EAAS,UAAY,QACjCkK,MAAOlK,EAAS,UAAY,iBAKlCuJ,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEsD,UAAW,OAAQ3C,QAAS,OAAQoC,oBAAqB,UAAWlC,IAAK,OAAQD,WAAY,OAAQN,SAAA,EACjHP,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEW,QAAS,QAASJ,aAAc,SAAUE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,UAAWF,SAAC,4BAG1Ic,EAAAA,EAAAA,KAAA,SACE4B,KAAK,OACLU,OAAO,OACPT,SAlbWjJ,UAAmD,IAAD2J,EACzE,GAAkB,QAAlBA,EAAI3B,EAAEkB,OAAOU,aAAK,IAAAD,GAAdA,EAAiB,GAAI,CACvB,MAAMvM,EAAO4K,EAAEkB,OAAOU,MAAM,GAC5B9M,GAAaiI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIlI,GAAU,IAAEO,UAG/B,IACE,MAAM6D,OAfYjB,WACtB,MAAM6J,QAAezM,EAAK0M,cACpBC,QAAmBC,OAAOC,OAAOC,OAAO,UAAWL,GAGzD,OAFkB/H,MAAMqI,KAAK,IAAIC,WAAWL,IAClBzJ,IAAI+J,GAAKA,EAAEC,SAAS,IAAIC,SAAS,EAAG,MAAMC,KAAK,KAW9CC,CAAgBrN,GACvCsE,QAAQgJ,IAAI,+BAAgCzJ,EAC9C,CAAE,MAAOQ,GACPC,QAAQD,MAAM,gCAAiCA,EACjD,CACF,GAuaY2H,UAAQ,EACRpD,MAAO,CACLc,MAAO,OACPb,QAAS,SACTyB,aAAc,MACdE,OAAQpL,EAAS,oBAAsB,oBACvCgK,SAAU,SACVJ,WAAY5J,EAAS,UAAY,QACjCkK,MAAOlK,EAAS,UAAY,aAG/BK,EAAWO,OACV2I,EAAAA,EAAAA,MAAA,SAAOC,MAAO,CAAEU,MAAOlK,EAAS,UAAY,UAAWmK,QAAS,QAAS2C,UAAW,WAAYhD,SAAA,CAC7FzJ,EAAWO,KAAKL,KAAK,MAAIF,EAAWO,KAAK4D,KAAO,MAAMwH,QAAQ,GAAG,cAKxEzC,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEW,QAAS,QAASJ,aAAc,SAAUE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,UAAWF,SAAC,8BAG1IP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVW,QAAS,OACTC,WAAY,SACZC,IAAK,SACLZ,QAAS,UACTG,WAAY5J,EAAS,UAAY,UACjCkL,aAAc,MACdE,OAAQpL,EAAS,oBAAsB,qBACvC8J,SAAA,EACAc,EAAAA,EAAAA,KAAA,SACE4B,KAAK,OACLH,MAAM,iBACN8B,UAAQ,EACR3E,MAAO,CACLc,MAAO,OACPc,OAAQ,OACRxB,WAAY,cACZI,SAAU,UACVgD,WAAY,YACZ9C,MAAOlK,EAAS,UAAY,cAGhC4K,EAAAA,EAAAA,KAAA,QAAMpB,MAAO,CACXI,WAAYvJ,EAAWO,KAAO,UAAY,UAC1CsJ,MAAO,QACPT,QAAS,iBACTyB,aAAc,MACdlB,SAAU,SACVC,WAAY,MACZmE,WAAY,UACZtE,SACCzJ,EAAWO,KAAO,QAAU,sBAMrC2I,EAAAA,EAAAA,MAAA,UACEiD,KAAK,SACLhD,MAAO,CACLsD,UAAW,SACXlD,WAAY,oDACZM,MAAO,QACPkB,OAAQ,OACR3B,QAAS,gBACTyB,aAAc,MACdlB,SAAU,OACVC,WAAY,MACZoE,OAAQ,UACRlE,QAAS,OACTC,WAAY,SACZC,IAAK,SACLc,UAAW,uCACXrB,SAAA,EAEFP,EAAAA,EAAAA,MAAA,OAAKe,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,OAAO,eAAeC,YAAY,IAAGb,SAAA,EAC/Fc,EAAAA,EAAAA,KAAA,QAAMjC,EAAE,+CACRiC,EAAAA,EAAAA,KAAA,YAAUC,OAAO,mBACjBD,EAAAA,EAAAA,KAAA,QAAME,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,UAC5B,yBAMV1B,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEQ,SAAU,WAAYC,WAAY,MAAOF,aAAc,OAAQG,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,iCAGrHc,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAE8E,UAAW,QAASxE,UAChCP,EAAAA,EAAAA,MAAA,SAAOC,MAAO,CAAEc,MAAO,OAAQiE,eAAgB,YAAazE,SAAA,EAC1Dc,EAAAA,EAAAA,KAAA,SAAAd,UACEP,EAAAA,EAAAA,MAAA,MAAIC,MAAO,CAAEI,WAAY5J,EAAS,UAAY,UAAWsL,aAActL,EAAS,oBAAsB,qBAAsB8J,SAAA,EAC1Hc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,WAAYF,SAAC,UACrIc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,WAAYF,SAAC,aACrIc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,WAAYF,SAAC,kBACrIc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,WAAYF,SAAC,eACrIc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,WAAYF,SAAC,iBACrIc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,WAAYF,SAAC,YACrIc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,SAAUvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,WAAYF,SAAC,kBAG3Ic,EAAAA,EAAAA,KAAA,SAAAd,SACG3H,GACCyI,EAAAA,EAAAA,KAAA,MAAAd,UACEc,EAAAA,EAAAA,KAAA,MAAI6D,QAAS,EAAGjF,MAAO,CAAEC,QAAS,OAAQ+E,UAAW,SAAUtE,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,WAAYF,UAC1HP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEW,QAAS,OAAQC,WAAY,SAAUsE,eAAgB,SAAUrE,IAAK,UAAWP,SAAA,EAC7FP,EAAAA,EAAAA,MAAA,OAAKe,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,OAAO,eAAeC,YAAY,IAAInB,MAAO,CAAEmF,UAAW,2BAA4B7E,SAAA,EAChJc,EAAAA,EAAAA,KAAA,UAAQgE,GAAG,KAAKC,GAAG,KAAKC,EAAE,KAAKC,QAAQ,UACvCnE,EAAAA,EAAAA,KAAA,QAAMjC,EAAE,0BAA0BoG,QAAQ,YACtC,sCAKW,IAArB7O,EAAUkH,QACZwD,EAAAA,EAAAA,KAAA,MAAAd,UACEc,EAAAA,EAAAA,KAAA,MAAI6D,QAAS,EAAGjF,MAAO,CAAEC,QAAS,OAAQ+E,UAAW,SAAUtE,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,WAAYF,SAAC,2FAK/H5J,EAAU4D,IAAIC,IACdwF,EAAAA,EAAAA,MAAA,MAAgBC,MAAO,CAAE8B,aAActL,EAAS,oBAAsB,qBAAsB8J,SAAA,EAC1FP,EAAAA,EAAAA,MAAA,MAAIC,MAAO,CAAEC,QAAS,gBAAiBK,SAAA,EACrCc,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAES,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAW+J,aAAc,WAAYD,SAAE/F,EAAGxD,OACtGwD,EAAGW,iBACF6E,EAAAA,EAAAA,MAAA,QAAMC,MAAO,CAAEQ,SAAU,UAAWE,MAAO,UAAWC,QAAS,OAAQC,WAAY,SAAUC,IAAK,WAAYP,SAAA,EAC5Gc,EAAAA,EAAAA,KAAA,OAAKN,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,OAAO,eAAeC,YAAY,IAAGb,UAC/Fc,EAAAA,EAAAA,KAAA,YAAUC,OAAO,qBACb,yBAKZD,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,eAAgBuD,WAAY,YAAahD,SAAU,SAAUC,WAAY,OAAQH,SAAE/F,EAAGvD,WAC5GoK,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,eAAgBO,SAAU,UAAWF,SAAE/F,EAAGtD,eAChE8I,EAAAA,EAAAA,MAAA,MAAIC,MAAO,CAAEC,QAAS,eAAgBO,SAAU,UAAWF,SAAA,EAAG/F,EAAGS,KAAO,MAAMwH,QAAQ,GAAG,UACzFpB,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,eAAgBO,SAAU,UAAWF,SACxD,IAAI/E,KAAKhB,EAAGc,YAAYmK,wBAE3BpE,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,gBAAiBK,UACrCc,EAAAA,EAAAA,KAAA,QAAMpB,MAAO,CACXI,WAA0B,WAAd7F,EAAGf,OAAsB,UAAY,UACjDkH,MAAqB,WAAdnG,EAAGf,OAAsB,UAAY,UAC5CyG,QAAS,kBACTyB,aAAc,OACdlB,SAAU,UACVC,WAAY,MACZgF,cAAe,aACfnF,SACe,WAAd/F,EAAGf,OAAsB,2BAAwB,aAGtD4H,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,eAAgB+E,UAAW,UAAW1E,UAC1DP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEW,QAAS,OAAQE,IAAK,SAAUqE,eAAgB,UAAW5E,SAAA,CACxD,UAAd/F,EAAGf,QACF4H,EAAAA,EAAAA,KAAA,UACEsE,QAASA,IA5gBR1L,WACzB,UACQE,EAAAA,EAAWyL,sBAAsBjL,EAAI,CAAES,WAAW,IACxDoH,MAAM,0CAEA7I,GACR,CAAE,MAAO+B,GACPC,QAAQD,MAAM,0BAA2BA,GACzC8G,MAAM,kBAAD3H,OAAmBa,EAAMqH,SAAW,iBAC3C,GAmgBuC8C,CAAmBrL,EAAGG,IACrCsF,MAAO,CACLI,WAAY,UACZM,MAAO,QACPkB,OAAQ,OACR3B,QAAS,iBACTyB,aAAc,MACdlB,SAAU,SACVqE,OAAQ,UACRpE,WAAY,OACZH,SACH,cAIDc,EAAAA,EAAAA,KAAA,UACEsE,QAASA,IAhhBF1L,WAC/B,GAAI6L,OAAOC,QAAQ,6EACjB,UACQ5L,EAAAA,EAAWyL,sBAAsBjL,EAAI,CAAES,WAAW,IACxDoH,MAAM,4CAEA7I,GACR,CAAE,MAAO+B,GACPC,QAAQD,MAAM,gCAAiCA,GAC/C8G,MAAM,wBAAD3H,OAAyBa,EAAMqH,SAAW,iBACjD,GAsgBqCiD,CAAyBxL,EAAGG,IAC3CsF,MAAO,CACLI,WAAY,UACZM,MAAO,OACPkB,OAAQ,OACR3B,QAAS,iBACTyB,aAAc,MACdlB,SAAU,SACVqE,OAAQ,UACRpE,WAAY,OACZH,SACH,gBAIHc,EAAAA,EAAAA,KAAA,UACEsE,QAASA,IA1jBJ1L,WAC3B,GAAI6L,OAAOC,QAAQ,8DACjB,UACQ5L,EAAAA,EAAW8L,sBAAsBtL,GACvC6H,MAAM,wCAEA7I,GACR,CAAE,MAAO+B,GACPC,QAAQD,MAAM,4BAA6BA,GAC3C8G,MAAM,oBAAD3H,OAAqBa,EAAMqH,SAAW,iBAC7C,GAgjBmCmD,CAAqB1L,EAAGG,IACvCsF,MAAO,CACLI,WAAY,UACZM,MAAO,QACPkB,OAAQ,OACR3B,QAAS,iBACTyB,aAAc,MACdlB,SAAU,SACVqE,OAAQ,UACRpE,WAAY,OACZH,SACH,kBA9EE/F,EAAGG,mBA6FxBqF,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAY5J,EAAS,UAAY,QACjCkL,aAAc,OACdzB,QAAS,OACTM,aAAc,OACdoB,UAAWnL,EAAS,4BAA8B,6BAClDoL,OAAiB,qBACjBtB,SAAA,EACAP,EAAAA,EAAAA,MAAA,MAAIC,MAAO,CACTQ,SAAU,SACVC,WAAY,MACZC,MAAOlK,EAAS,UAAY,UAC5B+J,aAAc,SACdsB,cAAe,UACfC,aAActL,EAAS,oBAAsB,oBAC7CmK,QAAS,OACTC,WAAY,SACZC,IAAK,UACLP,SAAA,EACAc,EAAAA,EAAAA,KAAA,QAAMpB,MAAO,CAAEQ,SAAU,WAAYF,SAAC,iBAAS,uBAIjDP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEW,QAAS,OAAQoC,oBAAqB,uCAAwClC,IAAK,UAAWP,SAAA,EAC1GP,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEW,QAAS,QAASJ,aAAc,SAAUE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,UAAWF,SAAC,+BAG1IP,EAAAA,EAAAA,MAAA,UACE8C,MAAOxL,EAAiBE,gBACxB0L,SAAWjB,GAAM1K,GAAmByH,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAI1H,GAAgB,IAAEE,gBAAiByK,EAAEkB,OAAOL,SACtF7C,MAAO,CACLc,MAAO,OACPb,QAAS,UACTyB,aAAc,MACdE,OAAQpL,EAAS,oBAAsB,oBACvCgK,SAAU,UACVJ,WAAY5J,EAAS,UAAY,QACjCkK,MAAOlK,EAAS,UAAY,WAC5B8J,SAAA,EAEFc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,GAAEvC,SAAC,yBAChB5J,EAAUgH,OAAOwI,GAAkB,WAAbA,EAAE1M,QAAqBc,IAAI4L,IAChDnG,EAAAA,EAAAA,MAAA,UAAmB8C,MAAOqD,EAAElP,QAAQsJ,SAAA,CACjC4F,EAAEnP,KAAK,OAAKmP,EAAElP,UADJkP,EAAExL,YAOrBqF,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEW,QAAS,QAASJ,aAAc,SAAUE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,UAAWF,SAAC,qBAG1IP,EAAAA,EAAAA,MAAA,UACE8C,MAAOxL,EAAiBI,KACxBwL,SAAWjB,GAAM1K,GAAmByH,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAI1H,GAAgB,IAAEI,KAAMuK,EAAEkB,OAAOL,SAC3E7C,MAAO,CACLc,MAAO,OACPb,QAAS,UACTyB,aAAc,MACdE,OAAQpL,EAAS,oBAAsB,oBACvCgK,SAAU,UACVJ,WAAY5J,EAAS,UAAY,QACjCkK,MAAOlK,EAAS,UAAY,WAC5B8J,SAAA,EAEFc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,YAAWvC,SAAC,qCAC1Bc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,SAAQvC,SAAC,oCAI3BP,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEW,QAAS,QAASJ,aAAc,SAAUE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,UAAWF,SAAC,2CAG1Ic,EAAAA,EAAAA,KAAA,SACE4B,KAAK,SACLH,MAAOxL,EAAiBM,cACxBsL,SAAWjB,GAAM1K,GAAmByH,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAI1H,GAAgB,IAAEM,cAAewO,SAASnE,EAAEkB,OAAOL,UAC7FuD,IAAI,KACJC,IAAI,OACJrG,MAAO,CACLc,MAAO,OACPb,QAAS,UACTyB,aAAc,MACdE,OAAQpL,EAAS,oBAAsB,oBACvCgK,SAAU,UACVJ,WAAY5J,EAAS,UAAY,QACjCkK,MAAOlK,EAAS,UAAY,iBAKlCuJ,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEW,QAAS,QAASJ,aAAc,SAAUE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,UAAWF,SAAC,2BAG1Ic,EAAAA,EAAAA,KAAA,SACE4B,KAAK,SACLH,MAAOxL,EAAiBO,iBACxBqL,SAAWjB,GAAM1K,GAAmByH,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAI1H,GAAgB,IAAEO,iBAAkBuO,SAASnE,EAAEkB,OAAOL,UAChGuD,IAAI,IACJC,IAAI,MACJrG,MAAO,CACLc,MAAO,OACPb,QAAS,UACTyB,aAAc,MACdE,OAAQpL,EAAS,oBAAsB,oBACvCgK,SAAU,UACVJ,WAAY5J,EAAS,UAAY,QACjCkK,MAAOlK,EAAS,UAAY,oBAMpCuJ,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEsD,UAAW,UAAWhD,SAAA,EAClCP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEW,QAAS,OAAQC,WAAY,SAAUC,IAAK,UAAWN,aAAc,UAAWD,SAAA,EAC5FP,EAAAA,EAAAA,MAAA,SAAOC,MAAO,CAAES,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,UAAWF,SAAA,CAAC,mBAC7EjJ,EAAiBG,cAAcoG,OAAO,iBAEzDmC,EAAAA,EAAAA,MAAA,UACE2F,QAhnBmBY,KAC7B,MAAMC,EAAclO,EAAQqF,OAAOyB,GAAkB,SAAbA,EAAE3F,QAC1ClC,GAAmByH,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAChB1H,GAAgB,IACnBG,cAAe+O,EAAYjM,IAAI6E,GAAKA,EAAElD,cA6mB9B+D,MAAO,CACLI,WAAY,cACZM,MAAO,UACPkB,OAAQ,oBACR3B,QAAS,kBACTyB,aAAc,MACdlB,SAAU,SACVqE,OAAQ,UACRpE,WAAY,OACZH,SAAA,CACH,oBACmBjI,EAAQqF,OAAOyB,GAAkB,SAAbA,EAAE3F,QAAmBoE,OAAO,WAGtEwD,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CACVwG,UAAW,QACXC,UAAW,OACX7E,OAAQpL,EAAS,oBAAsB,oBACvCkL,aAAc,MACdzB,QAAS,UACTG,WAAY5J,EAAS,UAAY,WACjC8J,SACC7H,GACC2I,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEgF,UAAW,SAAUtE,MAAOlK,EAAS,UAAY,UAAWyJ,QAAS,QAASK,SAAC,uBAGvC,IAApDjI,EAAQqF,OAAOyB,GAAkB,SAAbA,EAAE3F,QAAmBoE,QAC3CwD,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEgF,UAAW,SAAUtE,MAAOlK,EAAS,UAAY,UAAWyJ,QAAS,QAASK,SAAC,8CAI7Fc,EAAAA,EAAAA,KAAAsF,EAAAA,SAAA,CAAApG,SACGjI,EAAQqF,OAAOyB,GAAkB,SAAbA,EAAE3F,QAAmBc,IAAI0B,IAC5C+D,EAAAA,EAAAA,MAAA,SAA6BC,MAAO,CAClCW,QAAS,QACTJ,aAAc,SACdsE,OAAQ,UACRrE,SAAU,UACVF,SAAA,EACAc,EAAAA,EAAAA,KAAA,SACE4B,KAAK,WACL2D,QAAStP,EAAiBG,cAAc4H,SAASpD,EAAOC,UACxDgH,SAAWjB,IACT,MAAM4E,EAAa5E,EAAEkB,OAAOyD,QACxB,IAAItP,EAAiBG,cAAewE,EAAOC,UAC3C5E,EAAiBG,cAAckG,OAAOhD,GAAMA,IAAOsB,EAAOC,UAC9D3E,GAAmByH,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAI1H,GAAgB,IAAEG,cAAeoP,MAE5D5G,MAAO,CAAE6G,YAAa,YAEvB7K,EAAOC,SAAS,cAAYD,EAAOzC,eAAe,MAjBzCyC,EAAOC,mBAyB7B8D,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEsD,UAAW,SAAU3C,QAAS,OAAQC,WAAY,SAAUC,IAAK,WAAYP,SAAA,EACzFP,EAAAA,EAAAA,MAAA,SAAOC,MAAO,CACZW,QAAS,OACTC,WAAY,SACZC,IAAK,SACLgE,OAAQ,UACRpE,WAAY,MACZC,MAAOlK,EAAS,UAAY,WAC5B8J,SAAA,EACAc,EAAAA,EAAAA,KAAA,SACE4B,KAAK,WACL2D,QAAStP,EAAiBK,aAC1BuL,SAAWjB,GAAM1K,GAAmByH,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAI1H,GAAgB,IAAEK,aAAcsK,EAAEkB,OAAOyD,WACnF3G,MAAO,CAAEc,MAAO,OAAQC,OAAQ,OAAQ8D,OAAQ,aAChD,2BAGJzD,EAAAA,EAAAA,KAAA,QAAMpB,MAAO,CAAEQ,SAAU,UAAWE,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,4CAK/EP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEsD,UAAW,OAAQ3C,QAAS,OAAQE,IAAK,OAAQiG,SAAU,QAASxG,SAAA,EAChFP,EAAAA,EAAAA,MAAA,UACE2F,QAzvBgBqB,KACxB,IAAK1P,EAAiBE,gBAEpB,YADAgL,MAAM,oCAGR,GAA8C,IAA1ClL,EAAiBG,cAAcoG,OAEjC,YADA2E,MAAM,qCAIR,MAAMvK,EAAWtB,EAAUuG,KAAKiJ,GAAKA,EAAElP,UAAYK,EAAiBE,iBACpE,IAAKS,EAAU,OAEf,MACME,GADaF,EAASgD,KAAO3D,EAAiBG,cAAcoG,OAClC,SAAkB4E,QAAQ,GAAK,MAE/D1K,EAAgB,CACdC,MAAM,EACNC,SAAUA,EAAShB,QACnBiB,YAAaZ,EAAiBG,cAAcoG,OAC5C1F,kBAsuBMyM,SAAUxM,EACV6H,MAAO,CACLI,WAAYjI,EAAc,UAAY,oDACtCuI,MAAO,QACPkB,OAAQ,OACR3B,QAAS,cACTyB,aAAc,MACdlB,SAAU,WACVC,WAAY,MACZoE,OAAQ1M,EAAc,cAAgB,UACtCwI,QAAS,OACTC,WAAY,SACZC,IAAK,UACLc,UAAW,uCACXrB,SAAA,EAEFc,EAAAA,EAAAA,KAAA,OAAKN,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,OAAO,eAAeC,YAAY,IAAGb,UAC/Fc,EAAAA,EAAAA,KAAA,WAASC,OAAO,6CAEjBlJ,EAAc,eAAiB,qBAGjCA,IACC4H,EAAAA,EAAAA,MAAA2G,EAAAA,SAAA,CAAApG,SAAA,EACEc,EAAAA,EAAAA,KAAA,UACEpB,MAAO,CACLI,WAAY,UACZM,MAAO,OACPkB,OAAQ,OACR3B,QAAS,YACTyB,aAAc,MACdlB,SAAU,OACVC,WAAY,MACZoE,OAAQ,WACRvE,SACH,6BAGDc,EAAAA,EAAAA,KAAA,UACEpB,MAAO,CACLI,WAAY,UACZM,MAAO,QACPkB,OAAQ,OACR3B,QAAS,YACTyB,aAAc,MACdlB,SAAU,OACVC,WAAY,MACZoE,OAAQ,WACRvE,SACH,qCASRzI,EAAaE,OACZqJ,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CACVgH,SAAU,QACVC,IAAK,EACLC,KAAM,EACNC,MAAO,EACPC,OAAQ,EACRhH,WAAY,kBACZO,QAAS,OACTC,WAAY,SACZsE,eAAgB,SAChBmC,OAAQ,KACR/G,UACAP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAY5J,EAAS,UAAY,QACjCkL,aAAc,OACdzB,QAAS,OACTC,SAAU,QACVY,MAAO,MACPa,UAAWnL,EAAS,8BAAgC,8BACpDoL,OAAQpL,EAAS,oBAAsB,QACvC8J,SAAA,EACAc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEQ,SAAU,SAAUC,WAAY,MAAOF,aAAc,SAAUG,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,wBAGrHP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEO,aAAc,SAAUG,MAAOlK,EAAS,UAAY,UAAW8Q,WAAY,OAAQhH,SAAA,EAC/FP,EAAAA,EAAAA,MAAA,KAAAO,SAAA,EAAGc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,sBAA0B,IAAEzI,EAAaG,aACpD+H,EAAAA,EAAAA,MAAA,KAAAO,SAAA,EAAGc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,oBAAwB,IAAEzI,EAAaI,gBAClD8H,EAAAA,EAAAA,MAAA,KAAAO,SAAA,EAAGc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,6BAAiC,IAAEzI,EAAaK,iBAC3D6H,EAAAA,EAAAA,MAAA,KAAAO,SAAA,EAAGc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,mBAAuB,IAAEjJ,EAAiBK,aAAe,iBAAc,eAClFqI,EAAAA,EAAAA,MAAA,KAAAO,SAAA,EAAGc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,uBAA2B,IAAEjJ,EAAiBO,iBAAiB,WAE5EmI,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAY5J,EAAS,UAAY,UACjCoL,OAAQpL,EAAS,oBAAsB,oBACvCkL,aAAc,MACdzB,QAAS,OACTM,aAAc,SACdG,MAAOlK,EAAS,UAAY,WAC5B8J,SAAA,EACAc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,0BAAoB,uCAAqCzI,EAAaI,YAAY,gBAE5F8H,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEW,QAAS,OAAQE,IAAK,OAAQqE,eAAgB,YAAa5E,SAAA,EACvEc,EAAAA,EAAAA,KAAA,UACEsE,QAASA,IAAM5N,GAAeiH,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIlH,GAAY,IAAEE,MAAM,KACxDiI,MAAO,CACLI,WAAY,UACZM,MAAO,QACPkB,OAAQ,OACR3B,QAAS,iBACTyB,aAAc,MACdlB,SAAU,OACVC,WAAY,MACZoE,OAAQ,WACRvE,SACH,YAGDc,EAAAA,EAAAA,KAAA,UACEsE,QAv1BY1L,UACxBlC,GAAeiH,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIlH,GAAY,IAAEE,MAAM,KACzCK,GAAe,GAEf,IAEE,MAAMJ,EAAWtB,EAAUuG,KAAKiJ,GAAKA,EAAElP,UAAYK,EAAiBE,iBACpE,IAAKS,EACH,MAAM,IAAIuP,MAAM,+BAIlB,MAAMtN,QAAiBC,EAAAA,EAAWsN,eAChCxP,EAAS0C,GACTrD,EAAiBG,cAAc,eAADoD,OACf5C,EAAShB,QAAO,QAAA4D,OAAOvD,EAAiBG,cAAcoG,OAAM,eAG7ExF,GAAe,GACfmK,MAAM,6DAAD3H,OAA8DX,EAASS,IAAM,MAAK,eAAAE,OAAcX,EAASwN,eAAiBpQ,EAAiBG,cAAcoG,OAAM,gBAAAhD,OAAe5C,EAAShB,QAAO,sEAG7L4C,GACR,CAAE,MAAO6B,GACPrD,GAAe,GACfsD,QAAQD,MAAM,qBAAsBA,GACpC8G,MAAM,sBAAD3H,OAAuBa,EAAMqH,SAAW,gBAAe,6CAC9D,GA6zBY9C,MAAO,CACLI,WAAY,oDACZM,MAAO,QACPkB,OAAQ,OACR3B,QAAS,iBACTyB,aAAc,MACdlB,SAAU,OACVC,WAAY,MACZoE,OAAQ,WACRvE,SACH,4BASTP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAY5J,EAAS,UAAY,QACjCkL,aAAc,OACdzB,QAAS,OACTM,aAAc,OACdoB,UAAWnL,EAAS,4BAA8B,6BAClDoL,OAAQpL,EAAS,oBAAsB,qBACvC8J,SAAA,EACAP,EAAAA,EAAAA,MAAA,MAAIC,MAAO,CACTQ,SAAU,SACVC,WAAY,MACZC,MAAOlK,EAAS,UAAY,UAC5B+J,aAAc,SACdsB,cAAe,UACfC,aAActL,EAAS,oBAAsB,oBAC7CmK,QAAS,OACTC,WAAY,SACZC,IAAK,UACLP,SAAA,EACAc,EAAAA,EAAAA,KAAA,QAAMpB,MAAO,CAAEQ,SAAU,WAAYF,SAAC,iBAAS,yBAE9C7H,IACC2I,EAAAA,EAAAA,KAAA,QAAMpB,MAAO,CAAEQ,SAAU,UAAWE,MAAOlK,EAAS,UAAY,UAAWiK,WAAY,MAAOiH,WAAY,QAASpH,SAAC,0BAOvH7H,GACCsH,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVgF,UAAW,SACX/E,QAAS,YACTS,MAAOlK,EAAS,UAAY,WAC5B8J,SAAA,EACAc,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEQ,SAAU,OAAQD,aAAc,QAASD,SAAC,YACxDc,EAAAA,EAAAA,KAAA,KAAGpB,MAAO,CAAEQ,SAAU,UAAWF,SAAC,uCAEf,IAAnBjI,EAAQuF,QACVmC,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVgF,UAAW,SACX/E,QAAS,YACTS,MAAOlK,EAAS,UAAY,WAC5B8J,SAAA,EACAc,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEQ,SAAU,OAAQD,aAAc,QAASD,SAAC,kBACxDc,EAAAA,EAAAA,KAAA,KAAGpB,MAAO,CAAEQ,SAAU,SAAUD,aAAc,UAAWD,SAAC,+BAC1Dc,EAAAA,EAAAA,KAAA,KAAGpB,MAAO,CAAEQ,SAAU,UAAWF,SAAC,0CAGpCP,EAAAA,EAAAA,MAAA2G,EAAAA,SAAA,CAAApG,SAAA,CAEGzH,IACCkH,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAwC,gBAA5BvH,EAAiBW,OACzB,oDACAhD,EAAS,UAAY,UACzBkK,MAAmC,gBAA5B7H,EAAiBW,OAA2B,QAAUhD,EAAS,UAAY,UAClFyJ,QAAS,SACTyB,aAAc,OACdnB,aAAc,OACdqB,OAAoC,gBAA5B/I,EAAiBW,OACrB,OACAhD,EAAS,oBAAsB,qBACnC8J,SAAA,EACAP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEW,QAAS,OAAQC,WAAY,SAAUsE,eAAgB,gBAAiB3E,aAAc,WAAYD,SAAA,EAC9Gc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEQ,SAAU,SAAUC,WAAY,MAAON,OAAQ,GAAIG,SACjC,gBAA5BzH,EAAiBW,OAA2B,iCAAyB,iCAExEuG,EAAAA,EAAAA,MAAA,QAAMC,MAAO,CACXQ,SAAU,UACVP,QAAS,kBACTG,WAAY,wBACZsB,aAAc,QACdpB,SAAA,CAAC,OACIzH,EAAiB6B,UAG1BqF,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEW,QAAS,OAAQoC,oBAAqB,uCAAwClC,IAAK,OAAQL,SAAU,UAAWF,SAAA,EAC5HP,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,cAAkB,KAAkC,QAAhC/J,EAAAsC,EAAiB8O,uBAAe,IAAApR,OAAA,EAAhCA,EAAkCS,UAAW,UAE3E+I,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,mBAAuB,IAAEzH,EAAiB4O,eAAiB,MAErE1H,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,aAAiB,IAAEzH,EAAiB+O,iBAAmB,MAEjE7H,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,YAAgB,IAAEzH,EAAiBgP,gBAAkB,MAE/D9H,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,cAAkB,IAAEzH,EAAiB4O,cAAgB,EAAC,GAAA7M,OACvD4B,KAAKsL,MAAOjP,EAAiB+O,gBAAkB/O,EAAiB4O,cAAiB,KAAI,KACxF,SAEN1H,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,aAAiB,IAAE,IAAI/E,KAAK1C,EAAiByC,YAAYyM,uBAGpElP,EAAiBmP,QAChBjI,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEsD,UAAW,OAAQ9C,SAAU,UAAW+E,QAAS,IAAMjF,SAAA,EACnEc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,WAAe,IAAEzH,EAAiBmP,aAOtDjI,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVW,QAAS,OACToC,oBAAqB,uCACrBlC,IAAK,OACLN,aAAc,QACdD,SAAA,EACAP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAY,oDACZM,MAAO,QACPT,QAAS,UACTyB,aAAc,OACdsD,UAAW,UACX1E,SAAA,EACAc,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEQ,SAAU,OAAQC,WAAY,MAAOF,aAAc,WAAYD,SAAEtB,EAAcC,SAC7FmC,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEQ,SAAU,UAAW+E,QAAS,IAAMjF,SAAC,sBAGrDP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAY,UACZM,MAAO,QACPT,QAAS,UACTyB,aAAc,OACdsD,UAAW,UACX1E,SAAA,EACAc,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEQ,SAAU,OAAQC,WAAY,MAAOF,aAAc,WAAYD,SAAEtB,EAAcE,cAC7FkC,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEQ,SAAU,UAAW+E,QAAS,IAAMjF,SAAC,oBAGrDP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAY,UACZM,MAAO,QACPT,QAAS,UACTyB,aAAc,OACdsD,UAAW,UACX1E,SAAA,EACAc,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEQ,SAAU,OAAQC,WAAY,MAAOF,aAAc,WAAYD,SAAEtB,EAAcK,WAC7F+B,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEQ,SAAU,UAAW+E,QAAS,IAAMjF,SAAC,gBAGrDP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAY,UACZM,MAAO,QACPT,QAAS,UACTyB,aAAc,OACdsD,UAAW,UACX1E,SAAA,EACAc,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEQ,SAAU,OAAQC,WAAY,MAAOF,aAAc,WAAYD,SAAEtB,EAAcM,UAC7F8B,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEQ,SAAU,UAAW+E,QAAS,IAAMjF,SAAC,eAGrDP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAY,UACZM,MAAO,QACPT,QAAS,UACTyB,aAAc,OACdsD,UAAW,UACX1E,SAAA,EACAc,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEQ,SAAU,OAAQC,WAAY,MAAOF,aAAc,WAAYD,SAAEtB,EAAcO,cAC7F6B,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEQ,SAAU,UAAW+E,QAAS,IAAMjF,SAAC,uBAKvDc,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEO,aAAc,OAAQI,QAAS,OAAQE,IAAK,SAAUiG,SAAU,QAASxG,SACpF,CAAC,MAAO,OAAQ,cAAe,WAAY,YAAa,QAAS,UAAW,SAAU,cAAchG,IAAId,IACvG4H,EAAAA,EAAAA,KAAA,UAEEsE,QAASA,IAAMlN,EAAgBgB,GAC/BwG,MAAO,CACLI,WAAY7H,IAAiBiB,EAAS,UAAahD,EAAS,UAAY,UACxEkK,MAAOnI,IAAiBiB,EAAS,QAAWhD,EAAS,UAAY,UACjEoL,OAAQpL,EAAS,oBAAsB,oBACvCyJ,QAAS,cACTyB,aAAc,OACdlB,SAAU,UACVC,WAAY,MACZoE,OAAQ,UACRY,cAAe,cACfnF,SAED9G,GAdIA,OAoBX4H,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAE8E,UAAW,OAAQ0B,UAAW,QAASC,UAAW,QAASnG,UACvEP,EAAAA,EAAAA,MAAA,SAAOC,MAAO,CAAEc,MAAO,OAAQiE,eAAgB,WAAYvE,SAAU,UAAWF,SAAA,EAC9Ec,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEgH,SAAU,SAAUC,IAAK,EAAG7G,WAAY5J,EAAS,UAAY,UAAW6Q,OAAQ,GAAI/G,UAClGP,EAAAA,EAAAA,MAAA,MAAIC,MAAO,CAAE8B,aAActL,EAAS,oBAAsB,qBAAsB8J,SAAA,EAC9Ec,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,eAChHc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,aAChHc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,YAChHc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,SAAUvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,UAClHc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,YAChHc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,SAAUvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,gBAClHc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,qBAGpHc,EAAAA,EAAAA,KAAA,SAAAd,SACGR,EAAgBxF,IAAI0B,IACnB+D,SAAAA,EAAAA,MAAA,MAA0BC,MAAO,CAAE8B,aAActL,EAAS,oBAAsB,qBAAsB8J,SAAA,EACpGc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAWuD,WAAY,YAAa/C,WAAY,OAAQH,SAAEtE,EAAOC,YACvFmF,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAWuD,WAAY,YAAahD,SAAU,WAAYF,SAAEtE,EAAOzC,kBACzF6H,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAWuD,WAAY,YAAahD,SAAU,WAAYF,SAAEtE,EAAOM,iBACzF8E,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,UAAW1E,UACrDc,EAAAA,EAAAA,KAAA,QAAMpB,MAAO,CACXI,WAAkC,MAAtBpE,EAAOO,WAAqB,UAAY,UACpDmE,MAA6B,MAAtB1E,EAAOO,WAAqB,UAAY,UAC/C0D,QAAS,iBACTyB,aAAc,MACdjB,WAAY,MACZD,SAAU,WACVF,SACCtE,EAAOO,gBAGZwD,EAAAA,EAAAA,MAAA,MAAIC,MAAO,CAAEC,QAAS,WAAYK,SAAA,EAChCc,EAAAA,EAAAA,KAAA,QAAMpB,OA9hCKxG,EA8hCsBwC,EAAOxC,OAnhCjD,CACL4G,WAXqD,CACrD6H,KAAM,UACNC,YAAa,UACbC,SAAU,UACVC,UAAW,UACXC,MAAO,UACPhJ,QAAS,UACTC,OAAQ,UACRgJ,WAAY,WAGO9O,GACnBkH,MAAO,QACPT,QAAS,kBACTyB,aAAc,OACdlB,SAAU,UACVC,WAAY,MACZgF,cAAe,YACfb,WAAY,WA2gCkDtE,SAC7CtE,EAAOxC,cAEWsD,IAApBd,EAAOa,WACNkD,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEsD,UAAW,UAAW9C,SAAU,UAAWE,MAAOlK,EAAS,UAAY,WAAY8J,SAAA,CAC9FtE,EAAOa,SAAS2F,QAAQ,GAAG,WAIlCpB,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAW+E,UAAW,SAAUxE,SAAU,UAAWF,SAAEtE,EAAOU,aACpF0E,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,UAAWO,SAAU,UAAWE,MAAO1E,EAAOY,UAAY,UAAapG,EAAS,UAAY,WAAa8J,SAC5HtE,EAAOY,WAAa,QA5BhBZ,EAAOC,UA7gCDzC,sBAqjCzBuG,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAY5J,EAAS,UAAY,QACjCkL,aAAc,OACdzB,QAAS,OACT0B,UAAWnL,EAAS,4BAA8B,6BAClDoL,OAAiB,qBACjBtB,SAAA,EACAP,EAAAA,EAAAA,MAAA,MAAIC,MAAO,CACTQ,SAAU,SACVC,WAAY,MACZC,MAAO,UACPH,aAAc,OACdsB,cAAe,UACfC,aAActL,EAAS,oBAAsB,oBAC7CmK,QAAS,OACTC,WAAY,SACZC,IAAK,UACLP,SAAA,EACAc,EAAAA,EAAAA,KAAA,QAAMpB,MAAO,CAAEQ,SAAU,WAAYF,SAAC,iBAAS,yBAIjDP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAY5J,EAAS,UAAY,UACjCoL,OAAQpL,EAAS,oBAAsB,oBACvCkL,aAAc,MACdzB,QAAS,OACTM,aAAc,SACdG,MAAOlK,EAAS,UAAY,WAC5B8J,SAAA,EACAc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,0BAAoB,6IAG9BP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEO,aAAc,SAAUN,QAAS,OAAQG,WAAY5J,EAAS,UAAY,UAAWoL,OAAQpL,EAAS,oBAAsB,oBAAqBkL,aAAc,MAAOhB,MAAOlK,EAAS,UAAY,WAAY8J,SAAA,EAC1Nc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,+BAAyB,2BAAuBc,EAAAA,EAAAA,KAAA,QAAMpB,MAAO,CAAEI,WAAY5J,EAAS,UAAY,OAAQyJ,QAAS,gBAAiByB,aAAc,MAAO8B,WAAY,YAAa9C,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,iBAAmB,wBAAoBc,EAAAA,EAAAA,KAAA,QAAMpB,MAAO,CAAEI,WAAY5J,EAAS,UAAY,OAAQyJ,QAAS,gBAAiByB,aAAc,MAAO8B,WAAY,YAAa9C,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,MAAQ,wGAG3bc,EAAAA,EAAAA,KAAA,OAAAd,UACEP,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEW,QAAS,QAASJ,aAAc,SAAUE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,UAAWF,SAAC,uBAG1Ic,EAAAA,EAAAA,KAAA,YACEyB,MAAO9J,EAAaG,OACpB+J,SAAWjB,GAAMhJ,GAAe+F,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIhG,GAAY,IAAEG,OAAQ8I,EAAEkB,OAAOL,SACrEM,YAAY,mCACZI,KAAM,EACNvD,MAAO,CACLc,MAAO,OACPb,QAAS,UACTyB,aAAc,MACdE,OAAQpL,EAAS,oBAAsB,oBACvCgK,SAAU,UACVgD,WAAY,UACZC,OAAQ,WACRrD,WAAY5J,EAAS,UAAY,QACjCkK,MAAOlK,EAAS,UAAY,mBAOpCuJ,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEsD,UAAW,UAAWhD,SAAA,EAClCc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEQ,SAAU,WAAYC,WAAY,MAAOF,aAAc,OAAQG,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,gCAGrHP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEW,QAAS,OAAQoC,oBAAqB,uCAAwClC,IAAK,OAAQN,aAAc,QAASD,SAAA,EAC9HP,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEW,QAAS,QAASJ,aAAc,SAAUE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,WAAYF,SAAC,+BAG3IP,EAAAA,EAAAA,MAAA,UACE8C,MAAOxJ,EAAgBE,eACvB0J,SAAWjB,GAAM1I,GAAkByF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAI1F,GAAe,IAAEE,eAAgByI,EAAEkB,OAAOL,SACnF7C,MAAO,CACLc,MAAO,OACPb,QAAS,SACTyB,aAAc,MACdE,OAAQpL,EAAS,oBAAsB,oBACvCgK,SAAU,SACVJ,WAAY5J,EAAS,UAAY,QACjCkK,MAAOlK,EAAS,UAAY,WAC5B8J,SAAA,EAEFc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,MAAKvC,SAAC,iBACnBxE,MAAMqI,KAAK,IAAIoE,IAAIlQ,EAAQiC,IAAI6E,GAAKA,EAAE5F,kBAAkBe,IAAItD,IAC3DoK,EAAAA,EAAAA,KAAA,UAAsByB,MAAO7L,EAAQsJ,SAAEtJ,GAA1BA,WAKnB+I,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEW,QAAS,QAASJ,aAAc,SAAUE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,WAAYF,SAAC,sBAG3IP,EAAAA,EAAAA,MAAA,UACE8C,MAAOxJ,EAAgBG,OACvByJ,SAAWjB,GAAM1I,GAAkByF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAI1F,GAAe,IAAEG,OAAQwI,EAAEkB,OAAOL,SAC3E7C,MAAO,CACLc,MAAO,OACPb,QAAS,SACTyB,aAAc,MACdE,OAAQpL,EAAS,oBAAsB,oBACvCgK,SAAU,SACVJ,WAAY5J,EAAS,UAAY,QACjCkK,MAAOlK,EAAS,UAAY,WAC5B8J,SAAA,EAEFc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,MAAKvC,SAAC,kBACpBc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,SAAQvC,SAAC,YACvBc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,UAASvC,SAAC,aACxBc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,QAAOvC,SAAC,WACtBc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,cAAavC,SAAC,iBAC5Bc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,WAAUvC,SAAC,cACzBc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,YAAWvC,SAAC,eAC1Bc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,aAAYvC,SAAC,iBAC3Bc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,OAAMvC,SAAC,gBAIzBP,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEc,EAAAA,EAAAA,KAAA,SAAOpB,MAAO,CAAEW,QAAS,QAASJ,aAAc,SAAUE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,UAAWgK,SAAU,WAAYF,SAAC,8BAG3IP,EAAAA,EAAAA,MAAA,UACE8C,MAAOxJ,EAAgBpC,YACvBgM,SAAWjB,GAAM1I,GAAkByF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAI1F,GAAe,IAAEpC,YAAa+K,EAAEkB,OAAOL,SAChF7C,MAAO,CACLc,MAAO,OACPb,QAAS,SACTyB,aAAc,MACdE,OAAQpL,EAAS,oBAAsB,oBACvCgK,SAAU,SACVJ,WAAY5J,EAAS,UAAY,QACjCkK,MAAOlK,EAAS,UAAY,WAC5B8J,SAAA,EAEFc,EAAAA,EAAAA,KAAA,UAAQyB,MAAM,MAAKvC,SAAC,wBACnBxE,MAAMqI,KAAK,IAAIoE,IAAIlQ,EAAQiC,IAAI6E,GAAKA,EAAE7C,iBAAiBhC,IAAItD,IAC1DoK,EAAAA,EAAAA,KAAA,UAAsByB,MAAO7L,EAAQsJ,SAAEtJ,GAA1BA,cAOrB+I,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEW,QAAS,OAAQE,IAAK,UAAWiG,SAAU,OAAQvG,aAAc,QAASD,SAAA,EACtFP,EAAAA,EAAAA,MAAA,UACE2F,QAAS/F,EACTK,MAAO,CACLI,WAAY,UACZM,MAAO,QACPkB,OAAQ,OACR3B,QAAS,cACTyB,aAAc,MACdlB,SAAU,UACVC,WAAY,MACZoE,OAAQ,WACRvE,SAAA,CACH,wBACuBZ,IAA6B9B,OAAO,QAG5DwD,EAAAA,EAAAA,KAAA,UACEsE,QAAS7F,EACTG,MAAO,CACLI,WAAY,UACZM,MAAO,QACPkB,OAAQ,OACR3B,QAAS,cACTyB,aAAc,MACdlB,SAAU,UACVC,WAAY,MACZoE,OAAQ,WACRvE,SACH,kBAIDP,EAAAA,EAAAA,MAAA,UACE2F,QAASA,KACP,MAAM8C,EAAgBnQ,EAAQqF,OAAOyB,GAAkB,WAAbA,EAAE3F,QAAqBc,IAAI6E,GAAKA,EAAElD,UAC5EjD,GAAe+F,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIhG,GAAY,IAAEE,gBAAiBuP,MAEtDxI,MAAO,CACLI,WAAY,UACZM,MAAO,OACPkB,OAAQ,OACR3B,QAAS,cACTyB,aAAc,MACdlB,SAAU,UACVC,WAAY,MACZoE,OAAQ,WACRvE,SAAA,CACH,uBACsBjI,EAAQqF,OAAOyB,GAAkB,WAAbA,EAAE3F,QAAqBoE,OAAO,QAGzEmC,EAAAA,EAAAA,MAAA,UACE2F,QAASA,KACP,MAAM+C,EAAiBpQ,EAAQqF,OAAOyB,GAAK,CAAC,SAAU,cAAcC,SAASD,EAAE3F,SAASc,IAAI6E,GAAKA,EAAElD,UACnGjD,GAAe+F,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIhG,GAAY,IAAEE,gBAAiBwP,MAEtDzI,MAAO,CACLI,WAAY,UACZM,MAAO,QACPkB,OAAQ,OACR3B,QAAS,cACTyB,aAAc,MACdlB,SAAU,UACVC,WAAY,MACZoE,OAAQ,WACRvE,SAAA,CACH,2BAC0BjI,EAAQqF,OAAOyB,GAAK,CAAC,SAAU,cAAcC,SAASD,EAAE3F,SAASoE,OAAO,WAKrGmC,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAY5J,EAAS,UAAY,UACjCkL,aAAc,MACdzB,QAAS,OACT2B,OAAQpL,EAAS,oBAAsB,oBACvCgQ,UAAW,QACXC,UAAW,QACXnG,SAAA,EACAc,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEO,aAAc,UAAWI,QAAS,OAAQuE,eAAgB,gBAAiBtE,WAAY,UAAWN,UAC9GP,EAAAA,EAAAA,MAAA,UAAQC,MAAO,CAAEQ,SAAU,UAAWE,MAAOlK,EAAS,UAAY,WAAY8J,SAAA,CAAC,iBAC9DZ,IAA6B9B,OAAO,eAAa7E,EAAaE,gBAAgB2E,OAAO,kBAIvGnF,GACC2I,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEC,QAAS,OAAQ+E,UAAW,SAAUtE,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,uBAGnD,IAAxCZ,IAA6B9B,QAC/BwD,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEC,QAAS,OAAQ+E,UAAW,SAAUtE,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,0CAI7FP,EAAAA,EAAAA,MAAA,SAAOC,MAAO,CAAEc,MAAO,OAAQN,SAAU,WAAYF,SAAA,EACnDc,EAAAA,EAAAA,KAAA,SAAAd,UACEP,EAAAA,EAAAA,MAAA,MAAIC,MAAO,CAAE8B,aAActL,EAAS,oBAAsB,qBAAsB8J,SAAA,EAC9Ec,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,SAAU+E,UAAW,OAAQvE,WAAY,MAAOK,MAAO,OAAQJ,MAAOlK,EAAS,UAAY,WAAY8J,UAC3Hc,EAAAA,EAAAA,KAAA,SACE4B,KAAK,WACL2D,QAASjH,IAA6B9B,OAAS,GAAK8B,IAA6BgJ,MAAMvJ,GAAKpG,EAAaE,gBAAgBmG,SAASD,EAAElD,WACpIgH,SAAWjB,IACLA,EAAEkB,OAAOyD,QACXhH,IAEAE,KAGJG,MAAO,CAAE6E,OAAQ,UAAW/D,MAAO,OAAQC,OAAQ,aAGvDK,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,SAAU+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,eAC/Gc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,SAAU+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,qBAC/Gc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,SAAU+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,oBAC/Gc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,SAAU+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,YAC/Gc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,SAAU+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,gBAC/Gc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,SAAU+E,UAAW,OAAQvE,WAAY,MAAOC,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,qBAGnHc,EAAAA,EAAAA,KAAA,SAAAd,SACGZ,IAA6BpF,IAAI0B,IAChC+D,EAAAA,EAAAA,MAAA,MAEEC,MAAO,CACL8B,aAActL,EAAS,oBAAsB,oBAC7C4J,WAAYrH,EAAaE,gBAAgBmG,SAASpD,EAAOC,UAAazF,EAAS,UAAY,UAAa,cACxGqO,OAAQ,WAEVa,QAASA,IAAMlG,EAAqBxD,EAAOC,UAAUqE,SAAA,EAErDc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,kBAAmBK,UACvCc,EAAAA,EAAAA,KAAA,SACE4B,KAAK,WACL2D,QAAS5N,EAAaE,gBAAgBmG,SAASpD,EAAOC,UACtDgH,SAAUA,IAAMzD,EAAqBxD,EAAOC,UAC5CyJ,QAAU1D,GAAMA,EAAE2G,kBAClB3I,MAAO,CAAE6E,OAAQ,UAAW/D,MAAO,OAAQC,OAAQ,aAGvDK,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,iBAAkBuD,WAAY,YAAa/C,WAAY,OAAQH,SAAEtE,EAAOC,YAC9FmF,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,iBAAkBuD,WAAY,aAAclD,SAAEtE,EAAOzC,kBAC3E6H,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,iBAAkBuD,WAAY,aAAclD,SAAEtE,EAAOM,iBAC3E8E,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,kBAAmBK,UACvCc,EAAAA,EAAAA,KAAA,QAAMpB,MAAO,CACXC,QAAS,iBACTyB,aAAc,MACdlB,SAAU,UACVC,WAAY,MACZL,WAA8B,WAAlBpE,EAAOxC,OAAuBhD,EAAS,UAAY,UAClC,YAAlBwF,EAAOxC,OAAwBhD,EAAS,UAAY,UAClC,gBAAlBwF,EAAOxC,QAA8C,aAAlBwC,EAAOxC,OAAyBhD,EAAS,UAAY,UACtE,eAAlBwF,EAAOxC,OAA2BhD,EAAS,UAAY,UAAcA,EAAS,UAAY,UACrGkK,MAAyB,WAAlB1E,EAAOxC,OAAuBhD,EAAS,UAAY,UACjC,YAAlBwF,EAAOxC,OAAwBhD,EAAS,UAAY,UAClC,gBAAlBwF,EAAOxC,QAA8C,aAAlBwC,EAAOxC,OAAyBhD,EAAS,UAAY,UACtE,eAAlBwF,EAAOxC,OAA2BhD,EAAS,UAAY,UAAcA,EAAS,UAAY,WACjG8J,SACCtE,EAAOxC,YAGZ4H,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,kBAAmBK,SAAEtE,EAAOU,aAClD0E,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEC,QAAS,iBAAkBS,MAAO1E,EAAOY,UAAY,UAAapG,EAAS,UAAY,UAAYgK,SAAU,UAAWF,SAClItE,EAAOY,WAAa,WAxClBZ,EAAOC,uBAmD1BmF,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CAAEsD,UAAW,SAAU3C,QAAS,OAAQuE,eAAgB,YAAa5E,UAC/EP,EAAAA,EAAAA,MAAA,UACE2F,QAj2CsBkD,KAC9BxP,GAAqB,IAi2CbuL,SAAkD,IAAxC5L,EAAaE,gBAAgB2E,OACvCoC,MAAO,CACLI,WAAoD,IAAxCrH,EAAaE,gBAAgB2E,OAAe,UAAY,UACpE8C,MAAO,QACPkB,OAAQ,OACR3B,QAAS,eACTyB,aAAc,MACdlB,SAAU,OACVC,WAAY,MACZoE,OAAgD,IAAxC9L,EAAaE,gBAAgB2E,OAAe,cAAgB,UACpE+C,QAAS,OACTC,WAAY,SACZC,IAAK,SACL0E,QAAiD,IAAxCxM,EAAaE,gBAAgB2E,OAAe,GAAM,GAC3D0C,SAAA,EAEFP,EAAAA,EAAAA,MAAA,OAAKe,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,OAAO,eAAeC,YAAY,IAAGb,SAAA,EAC/Fc,EAAAA,EAAAA,KAAA,YAAUC,OAAO,mBACjBD,EAAAA,EAAAA,KAAA,QAAMjC,EAAE,yCACJ,YACIpG,EAAaE,gBAAgB2E,OAAO,UAAgD,IAAxC7E,EAAaE,gBAAgB2E,OAAe,IAAM,WAM7GzE,IACCiI,EAAAA,EAAAA,KAAA,OAAKpB,MAAO,CACVgH,SAAU,QACVC,IAAK,EACLC,KAAM,EACNC,MAAO,EACPC,OAAQ,EACRhH,WAAY,kBACZO,QAAS,OACTC,WAAY,SACZsE,eAAgB,SAChBmC,OAAQ,KACR/G,UACAP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAY5J,EAAS,UAAY,QACjCkL,aAAc,OACdzB,QAAS,OACTC,SAAU,QACVY,MAAO,MACPa,UAAWnL,EAAS,8BAAgC,8BACpDoL,OAAiB,qBACjBtB,SAAA,EACAc,EAAAA,EAAAA,KAAA,MAAIpB,MAAO,CAAEQ,SAAU,SAAUC,WAAY,MAAOF,aAAc,OAAQG,MAAO,WAAYJ,SAAC,6CAG9FP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CACVI,WAAY5J,EAAS,UAAY,UACjCoL,OAAQpL,EAAS,oBAAsB,oBACvCkL,aAAc,MACdzB,QAAS,OACTM,aAAc,SACdG,MAAOlK,EAAS,UAAY,UAC5BgK,SAAU,WACVF,SAAA,EACAc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,mCACRc,EAAAA,EAAAA,KAAA,KAAGpB,MAAO,CAAEG,OAAQ,gBAAiBG,SAAC,0EAIxCP,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEO,aAAc,SAAUG,MAAOlK,EAAS,UAAY,UAAW8Q,WAAY,OAAQhH,SAAA,EAC/FP,EAAAA,EAAAA,MAAA,KAAAO,SAAA,EAAGc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,aAAiB,KAACc,EAAAA,EAAAA,KAAA,QAAMpB,MAAO,CAAEI,WAAY5J,EAAS,UAAY,UAAWyJ,QAAS,gBAAiByB,aAAc,MAAO8B,WAAY,YAAa9C,MAAOlK,EAAS,UAAY,WAAY8J,SAAC,qBAAuB,gDAChOP,EAAAA,EAAAA,MAAA,KAAAO,SAAA,EAAGc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,yBAA6B,IAAEvH,EAAaE,gBAAgB2E,WACvEmC,EAAAA,EAAAA,MAAA,KAAAO,SAAA,EAAGc,EAAAA,EAAAA,KAAA,UAAAd,SAAQ,YAAgB,IAAEvH,EAAaG,QAAU,sBAEtD6G,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEW,QAAS,OAAQE,IAAK,OAAQqE,eAAgB,YAAa5E,SAAA,EACvEc,EAAAA,EAAAA,KAAA,UACEsE,QAASA,IAAMtM,GAAqB,GACpC4G,MAAO,CACLI,WAAY,UACZM,MAAO,QACPkB,OAAQ,OACR3B,QAAS,iBACTyB,aAAc,MACdlB,SAAU,OACVC,WAAY,MACZoE,OAAQ,WACRvE,SACH,YAGDc,EAAAA,EAAAA,KAAA,UACEsE,QAr7CUmD,KACsB,IAAxC9P,EAAaE,gBAAgB2E,OAI5B7E,EAAaG,OAAO4P,QAQzB1P,GAAqB,GACrBmJ,MAAM,gDAAD3H,OAAiD7B,EAAaE,gBAAgB2E,OAAM,eACzF5E,EAAgB,CAAEC,gBAAiB,GAAIC,OAAQ,MAT7CqJ,MAAM,wCAJNA,MAAM,sCAo7CIvC,MAAO,CACLI,WAAY,UACZM,MAAO,QACPkB,OAAQ,OACR3B,QAAS,iBACTyB,aAAc,MACdlB,SAAU,OACVC,WAAY,MACZoE,OAAQ,WACRvE,SACH,gC,6CCn4Df,MAAMyI,EAAaC,WAAAA,GAAA,KACTC,MAAiC,IAAIvK,IAAM,KAC3CwK,YAAmD,IAAIxK,GAAM,CASrEyK,GAAAA,CAAIC,EAAaC,GAAgF,IAArEC,EAAaC,UAAA3L,OAAA,QAAAd,IAAAyM,UAAA,GAAAA,UAAA,GAAGR,EAAaS,YAAaC,EAAkBF,UAAA3L,OAAA,EAAA2L,UAAA,QAAAzM,EACtF4M,KAAKT,MAAME,IAAIC,EAAK,CAClBC,OACAM,UAAWpO,KAAKqO,MAChBC,UAAWP,EACXG,UAAoB,OAATA,QAAS,IAATA,EAAAA,EAAajN,KAAK4J,IAAIkD,EAAQ,EAAGP,EAAae,cAI3DJ,KAAKK,kBAAkBX,EAAKC,EAC9B,CAKAvK,GAAAA,CAAIsK,GACF,MAAMY,EAAQN,KAAKT,MAAMnK,IAAIsK,GAC7B,IAAKY,EAAO,OAAO,KAInB,OADYzO,KAAKqO,MACPI,EAAML,UAAYK,EAAMH,WAChCH,KAAKT,MAAMgB,OAAOb,GACX,MAGFY,EAAMX,IACf,CAMAa,kBAAAA,CAAmBd,GAA0E,IAADe,EAC1F,MAAMH,EAAQN,KAAKT,MAAMnK,IAAIsK,GAC7B,IAAKY,EAAO,OAAO,KAEnB,MACMI,EADM7O,KAAKqO,MACCI,EAAML,UAClBU,EAAYD,EAAMJ,EAAMH,UACxBS,EAAUF,GAAsB,QAAnBD,EAAIH,EAAMP,iBAAS,IAAAU,EAAAA,EAAIH,EAAMH,UAAY,GAG5D,OAAIQ,GACFX,KAAKT,MAAMgB,OAAOb,GACX,MAGF,CACLC,KAAMW,EAAMX,KACZiB,UACAD,WAAW,EAEf,CAKAE,GAAAA,CAAInB,GACF,MAAMY,EAAQN,KAAKT,MAAMnK,IAAIsK,GAC7B,IAAKY,EAAO,OAAO,EAGnB,QADYzO,KAAKqO,MACPI,EAAML,UAAYK,EAAMH,aAChCH,KAAKT,MAAMgB,OAAOb,IACX,EAIX,CAKAkB,OAAAA,CAAQlB,GAAuB,IAADoB,EAC5B,MAAMR,EAAQN,KAAKT,MAAMnK,IAAIsK,GAC7B,IAAKY,EAAO,OAAO,EAInB,OAFYzO,KAAKqO,MACCI,EAAML,WACK,QAAnBa,EAAIR,EAAMP,iBAAS,IAAAe,EAAAA,EAAIR,EAAMH,UAAY,EACrD,CAKAY,KAAAA,CAAMrB,GACJM,KAAKT,MAAMgB,OAAOb,EACpB,CAKAsB,YAAAA,CAAarH,GACX,MAAMsH,EAA2B,kBAAZtH,EAAuB,IAAIuH,OAAOvH,GAAWA,EAC5DwH,EAAyB,GAE/BnB,KAAKT,MAAM6B,QAAQ,CAACC,EAAG3B,KACjBuB,EAAMK,KAAK5B,IACbyB,EAAaI,KAAK7B,KAItByB,EAAaC,QAAQ1B,GAAOM,KAAKT,MAAMgB,OAAOb,GAChD,CAKA8B,QAAAA,GACExB,KAAKT,MAAMwB,OACb,CAKAzP,IAAAA,GACE,OAAO0O,KAAKT,MAAMjO,IACpB,CAKAmQ,SAAAA,CAAU/B,EAAagC,GAChB1B,KAAKR,YAAYqB,IAAInB,IACxBM,KAAKR,YAAYC,IAAIC,EAAK,IAAIb,KAGhC,MAAM8C,EAAkC,CAAED,YAI1C,OAHA1B,KAAKR,YAAYpK,IAAIsK,GAAMkC,IAAID,GAGxB,KACL,MAAME,EAAO7B,KAAKR,YAAYpK,IAAIsK,GAC9BmC,IACFA,EAAKtB,OAAOoB,GACM,IAAdE,EAAKvQ,MACP0O,KAAKR,YAAYe,OAAOb,IAIhC,CAKAoC,gBAAAA,CAAiBnI,EAAiB+H,GAChC,MAAMhC,EAAG,cAAAxO,OAAiByI,EAAQoI,QAC7B/B,KAAKR,YAAYqB,IAAInB,IACxBM,KAAKR,YAAYC,IAAIC,EAAK,IAAIb,KAGhC,MAAM8C,EAAkC,CAAED,WAAU/H,WAGpD,OAFAqG,KAAKR,YAAYpK,IAAIsK,GAAMkC,IAAID,GAExB,KACL,MAAME,EAAO7B,KAAKR,YAAYpK,IAAIsK,GAC9BmC,IACFA,EAAKtB,OAAOoB,GACM,IAAdE,EAAKvQ,MACP0O,KAAKR,YAAYe,OAAOb,IAIhC,CAKQW,iBAAAA,CAAkBX,EAAaC,GAErC,MAAMqC,EAAahC,KAAKR,YAAYpK,IAAIsK,GACpCsC,GACFA,EAAWZ,QAAQa,IACjB,IACEA,EAAIP,SAAS/B,EACf,CAAE,MAAO5N,GACPC,QAAQD,MAAM,kCAADb,OAAmCwO,EAAG,KAAK3N,EAC1D,IAKJiO,KAAKR,YAAY4B,QAAQ,CAACS,EAAMK,KAC1BA,EAAOC,WAAW,gBACpBN,EAAKT,QAAQa,IACX,GAAIA,EAAItI,SAAWsI,EAAItI,QAAQ2H,KAAK5B,GAClC,IACEuC,EAAIP,SAAS/B,EACf,CAAE,MAAO5N,GACPC,QAAQD,MAAM,0CAADb,OAA2CwO,EAAG,KAAK3N,EAClE,KAKV,CAKAqQ,IAAAA,GACE,OAAOhQ,MAAMqI,KAAKuF,KAAKT,MAAM6C,OAC/B,CAKAC,QAAAA,GACE,MAAO,CACL/Q,KAAM0O,KAAKT,MAAMjO,KACjB8Q,KAAMpC,KAAKoC,OACX5C,YAAapN,MAAMqI,KAAKuF,KAAKR,YAAY8C,UAAUC,OAAO,CAACC,EAAK/C,IAAQ+C,EAAM/C,EAAInO,KAAM,GAE5F,CAKA,aAAOmR,GACL,OAD+C5C,UAAA3L,OAAA,QAAAd,IAAAyM,UAAA,GAAAA,UAAA,GAAG,SAEhD,IAAK,WACH,OAAOR,EAAaqD,aACtB,IAAK,OACH,OAAOrD,EAAasD,SACtB,QACE,OAAOtD,EAAaS,YAE1B,EA/OIT,EAGoBS,YAAc,IAHlCT,EAIoBsD,SAAW,KAJ/BtD,EAKoBqD,aAAe,IALnCrD,EAMoBe,WAAa,IA4OhC,MAAMwC,EAAe,IAAIvD,EACnBS,EAAc,ICtQrB+C,EAAeC,oDAykBd,MAAMtS,EAAa,IAvkB1B,MACUuS,cAAAA,GACN,MAAMC,EAASC,aAAaC,QAAQ,cACpC,GAAIF,EACF,IACE,MAAMG,EAAeC,KAAKC,MAAML,GAChC,MAAO,CACL,cAAgB,UAAD9R,OAAYiS,EAAaG,QACxC,eAAgB,mBAEpB,CAAE,MAAOvR,GACPC,QAAQD,MAAM,6BAA8BA,EAC9C,CAEF,MAAO,CACL,eAAgB,mBAEpB,CAEA,aAAcwR,CAAQC,GAA4D,IAA1CC,EAAoB5D,UAAA3L,OAAA,QAAAd,IAAAyM,UAAA,GAAAA,UAAA,GAAG,CAAC,EAC9D,MAAM6D,EAAG,GAAAxS,OAAM2R,GAAY3R,OAAGsS,GAC9B,IAAIG,EAAU3D,KAAK+C,iBAEfxS,QAAiBqT,MAAMF,GAAGrO,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACzBoO,GAAO,IACVE,SAAOtO,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACFsO,GACAF,EAAQE,YAIf,GAAwB,MAApBpT,EAAST,OAAgB,OAEEkQ,KAAK6D,iBAGhCF,EAAU3D,KAAK+C,iBACfxS,QAAiBqT,MAAMF,GAAGrO,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACrBoO,GAAO,IACVE,SAAOtO,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACFsO,GACAF,EAAQE,YAInB,CAEA,GAAwB,MAApBpT,EAAST,OAKX,MAHAmT,aAAaa,WAAW,cACxBb,aAAaa,WAAW,YACxB3H,OAAO4H,SAASC,KAAO,SACjB,IAAInG,MAAM,2BAGlB,IAAKtN,EAAS0T,GAAI,CAChB,MAAMC,QAAkB3T,EAAS4T,OACjC,MAAM,IAAItG,MAAM,uBAAD3M,OAAwBX,EAAST,OAAM,KAAAoB,OAAIX,EAAS6T,WAAU,OAAAlT,OAAMgT,GACrF,CAEA,OAAwB,MAApB3T,EAAST,OAAuB,KAC7BS,EAAS8T,MAClB,CAEA,kBAAcR,GACZ,MAAMb,EAASC,aAAaC,QAAQ,cACpC,IAAKF,EAAQ,OAAO,EAEpB,IACE,MAAMG,EAAeC,KAAKC,MAAML,GAC1BzS,QAAiBqT,MAAM,GAAD1S,OAAI2R,EAAY,wBAAwB,CAClEyB,OAAQ,OACRX,QAAS,CACP,eAAgB,oBAElBY,KAAMnB,KAAKoB,UAAU,CAAEC,QAAStB,EAAasB,YAG/C,GAAIlU,EAAS0T,GAAI,CACf,MACMS,EAAY,CAChBpB,cAFiB/S,EAAS8T,QAEbf,OACbmB,QAAStB,EAAasB,SAGxB,OADAxB,aAAa0B,QAAQ,aAAcvB,KAAKoB,UAAUE,KAC3C,CACT,CACF,CAAE,MAAO3S,GACPC,QAAQD,MAAM,wBAAyBA,EACzC,CACA,OAAO,CACT,CAEA,sBAAM6S,GACJ,OAAO5E,KAAKuD,QAAQ,WACtB,CAEA,kBAAMsB,GACJ,OAAO7E,KAAKuD,QAAQ,cACtB,CAEA,qBAAMuB,CAAgBnF,GACpB,MAAMpP,QAAiBqT,MAAM,GAAD1S,OAAI2R,EAAY,sBAAsB,CAChEyB,OAAQ,OACRX,QAAS,CACP,eAAgB,oBAElBY,KAAMnB,KAAKoB,UAAU7E,KAEvB,IAAKpP,EAAS0T,GACZ,MAAM,IAAIpG,MAAM,wBAAD3M,OAAyBX,EAAS6T,aAEnD,OAAO7T,EAAS8T,MAClB,CAEA,eAAMU,GACJ,MAAMC,EAAW,SACXC,EAASrC,EAAaxN,IAAI4P,GAChC,GAAIC,EAAQ,OAAOA,EAEnB,MAAMtF,QAAaK,KAAKuD,QAAQ,YAEhC,OADAX,EAAanD,IAAIuF,EAAUrF,EAAMG,GAC1BH,CACT,CAEA,qBAAMuF,GACJ,MAAMF,EAAW,gBACXC,EAASrC,EAAaxN,IAAI4P,GAChC,GAAIC,EAAQ,OAAOA,EAEnB,MAAMtF,QAAaK,KAAKuD,QAAQ,YAEhC,OADAX,EAAanD,IAAIuF,EAAUrF,EAAMG,GAC1BH,CACT,CAEA,aAAMwF,GACJ,MAAMH,EAAW,OACXC,EAASrC,EAAaxN,IAAI4P,GAChC,GAAIC,EAAQ,OAAOA,EAEnB,MAAMtF,QAAaK,KAAKuD,QAAQ,UAEhC,OADAX,EAAanD,IAAIuF,EAAUrF,EAAMG,GAC1BH,CACT,CAEA,cAAMyF,CAASC,GACb,MAAML,EAAQ,SAAA9T,OAAYmU,GAAU,OAC9BJ,EAASrC,EAAaxN,IAAI4P,GAChC,GAAIC,EAAQ,OAAOA,EAEnB,MAAMK,EAASD,EAAM,WAAAnU,OAAcqU,mBAAmBF,IAAY,GAC5D1F,QAAaK,KAAKuD,QAAQ,UAADrS,OAAWoU,IAE1C,OADA1C,EAAanD,IAAIuF,EAAUrF,EAAMG,GAC1BH,CACT,CAEA,gBAAM6F,CAAWC,GACf,MAAMC,QAAe1F,KAAKuD,QAAQ,iBAAkB,CAClDe,OAAQ,OACRC,KAAMnB,KAAKoB,UAAUiB,KAKvB,OAFA7C,EAAa7B,MAAM,aACnB6B,EAAapB,WACNkE,CACT,CAEA,oBAAMC,CAAeC,GACnB,MAAMF,QAAe1F,KAAKuD,QAAQ,iBAAkB,CAClDe,OAAQ,OACRC,KAAMnB,KAAKoB,WAASnP,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIuQ,GAAY,IAAEC,UAAU,OAGpD,OADAjD,EAAa7B,MAAM,aACZ2E,CACT,CAEA,oBAAMI,CAAeC,GACnB,OAAO/F,KAAKuD,QAAQ,UAADrS,OAAW6U,EAAM,aACtC,CAEA,iBAAMC,CAAYD,GAChB,OAAO/F,KAAKuD,QAAQ,UAADrS,OAAW6U,EAAM,UACtC,CAEA,oBAAME,CAAeF,EAAgBpG,GACnC,OAAOK,KAAKuD,QAAQ,UAADrS,OAAW6U,EAAM,UAAU,CAC5CzB,OAAQ,OACRC,KAAMnB,KAAKoB,UAAU7E,IAEzB,CAEA,oBAAMuG,CAAeH,EAAgBpG,GACnC,OAAOK,KAAKuD,QAAQ,UAADrS,OAAW6U,EAAM,iBAAiB,CACnDzB,OAAQ,MACRC,KAAMnB,KAAKoB,UAAU7E,IAEzB,CAEA,mBAAMwG,CAAc5T,GAClB,OAAOyN,KAAKuD,QAAQ,YAADrS,OAAaqB,EAAQ,UAC1C,CAEA,sBAAM6T,CAAiB7T,EAAkBoN,GACvC,OAAOK,KAAKuD,QAAQ,YAADrS,OAAaqB,EAAQ,UAAU,CAChD+R,OAAQ,OACRC,KAAMnB,KAAKoB,UAAU7E,IAEzB,CAEA,sBAAM0G,CAAiB9T,EAAkBoN,GACvC,OAAOK,KAAKuD,QAAQ,YAADrS,OAAaqB,EAAQ,iBAAiB,CACvD+R,OAAQ,MACRC,KAAMnB,KAAKoB,UAAU7E,IAEzB,CAGA,sBAAM2G,CAAiBC,EAAgBjB,GACrC,MAAMkB,EAAQ,IAAIC,gBACR,OAANnB,QAAM,IAANA,GAAAA,EAAQoB,YAAYF,EAAM7N,OAAO,aAAc2M,EAAOoB,YAChD,OAANpB,QAAM,IAANA,GAAAA,EAAQqB,UAAUH,EAAM7N,OAAO,WAAY2M,EAAOqB,UAC5C,OAANrB,QAAM,IAANA,GAAAA,EAAQsB,MAAMJ,EAAM7N,OAAO,OAAQ2M,EAAOsB,KAAKhM,YACnD,MAAM8I,EAAG,UAAAxS,OAAaqV,EAAM,eAAArV,OAAcsV,EAAM5L,WAAa,IAAM4L,EAAM5L,WAAa,IACtF,OAAOoF,KAAKuD,QAAQG,EACtB,CAEA,qBAAMmD,CAAgBN,EAAgBjB,GACpC,MAAMkB,EAAQ,IAAIC,gBACR,OAANnB,QAAM,IAANA,GAAAA,EAAQwB,MAAMN,EAAM7N,OAAO,OAAQ2M,EAAOwB,MACpC,OAANxB,QAAM,IAANA,GAAAA,EAAQoB,YAAYF,EAAM7N,OAAO,aAAc2M,EAAOoB,YAChD,OAANpB,QAAM,IAANA,GAAAA,EAAQqB,UAAUH,EAAM7N,OAAO,WAAY2M,EAAOqB,UACtD,MAAMjD,EAAG,UAAAxS,OAAaqV,EAAM,cAAArV,OAAasV,EAAM5L,WAAa,IAAM4L,EAAM5L,WAAa,IACrF,OAAOoF,KAAKuD,QAAQG,EACtB,CAEA,oBAAMqD,CAAeR,GACnB,OAAOvG,KAAKuD,QAAQ,UAADrS,OAAWqV,EAAM,aACtC,CAEA,gBAAMS,CAAWjB,EAAgBpG,GAC/B,MAAM+F,QAAe1F,KAAKuD,QAAQ,UAADrS,OAAW6U,EAAM,KAAK,CACrDzB,OAAQ,MACRC,KAAMnB,KAAKoB,UAAU7E,KAGvB,OADAiD,EAAa7B,MAAM,aACZ2E,CACT,CAEA,gBAAMuB,CAAWlB,GACf,MAAML,QAAe1F,KAAKuD,QAAQ,UAADrS,OAAW6U,EAAM,YAAY,CAC5DzB,OAAQ,WAGV,OADA1B,EAAa7B,MAAM,aACZ2E,CACT,CAGA,gBAAMwB,GACJ,OAAOlH,KAAKuD,QAAQ,YACtB,CAEA,mBAAM4D,CAAcxH,GAClB,OAAOK,KAAKuD,QAAQ,mBAAoB,CACtCe,OAAQ,MACRC,KAAMnB,KAAKoB,UAAU7E,IAEzB,CAEA,oBAAMyH,CAAezH,GACnB,OAAOK,KAAKuD,QAAQ,4BAA6B,CAC/Ce,OAAQ,OACRC,KAAMnB,KAAKoB,UAAU7E,IAEzB,CAGA,kBAAM0H,CAAahC,GACjB,MAAMC,EAASD,EAAM,WAAAnU,OAAcqU,mBAAmBF,IAAY,GAClE,OAAOrF,KAAKuD,QAAQ,cAADrS,OAAeoU,GACpC,CAEA,oBAAMgC,CAAeC,GACnB,OAAOvH,KAAKuD,QAAQ,qBAAsB,CACxCe,OAAQ,OACRC,KAAMnB,KAAKoB,UAAU+C,IAEzB,CAEA,iBAAMC,CAAYC,GAChB,OAAOzH,KAAKuD,QAAQ,cAADrS,OAAeuW,EAAU,KAC9C,CAEA,oBAAMC,CAAeD,EAAoB9H,GACvC,OAAOK,KAAKuD,QAAQ,cAADrS,OAAeuW,EAAU,YAAY,CACtDnD,OAAQ,MACRC,KAAMnB,KAAKoB,UAAU7E,IAEzB,CAEA,oBAAMgI,CAAeF,GACnB,OAAOzH,KAAKuD,QAAQ,cAADrS,OAAeuW,EAAU,YAAY,CACtDnD,OAAQ,UAEZ,CAEA,gBAAMsD,GACJ,MAAM5C,EAAW,UACXC,EAASrC,EAAaxN,IAAI4P,GAChC,GAAIC,EAAQ,OAAOA,EAEnB,MAAMtF,QAAaK,KAAKuD,QAAQ,aAGhC,OADAX,EAAanD,IAAIuF,EAAUrF,EAAM,MAC1BA,CACT,CAEA,kBAAMkI,CAAalI,GACjB,MAAM+F,QAAe1F,KAAKuD,QAAQ,mBAAoB,CACpDe,OAAQ,OACRC,KAAMnB,KAAKoB,UAAU7E,KAGvB,OADAiD,EAAa7B,MAAM,WACZ2E,CACT,CAEA,kBAAMoC,CAAa9W,EAAY2O,GAC7B,MAAM+F,QAAe1F,KAAKuD,QAAQ,YAADrS,OAAaF,EAAE,KAAK,CACnDsT,OAAQ,MACRC,KAAMnB,KAAKoB,UAAU7E,KAGvB,OADAiD,EAAa7B,MAAM,WACZ2E,CACT,CAEA,kBAAMqC,CAAa/W,GACjB,MAAM0U,QAAe1F,KAAKuD,QAAQ,YAADrS,OAAaF,EAAE,YAAY,CAC1DsT,OAAQ,WAGV,OADA1B,EAAa7B,MAAM,WACZ2E,CACT,CAEA,qBAAMsC,GACJ,OAAOhI,KAAKuD,QAAQ,WACtB,CAEA,uBAAM0E,CAAkBC,GACtB,OAAOlI,KAAKuD,QAAQ,kBAAmB,CACrCe,OAAQ,OACRC,KAAMnB,KAAKoB,UAAU0D,IAEzB,CAEA,uBAAMC,CAAkBC,EAAiBF,GACvC,OAAOlI,KAAKuD,QAAQ,WAADrS,OAAYkX,EAAO,KAAK,CACzC9D,OAAQ,MACRC,KAAMnB,KAAKoB,UAAU0D,IAEzB,CAEA,uBAAMG,CAAkBD,GACtB,OAAOpI,KAAKuD,QAAQ,WAADrS,OAAYkX,EAAO,YAAY,CAChD9D,OAAQ,UAEZ,CAEA,gBAAMrS,CAAWoT,GAAyE,IAAxDiD,EAAYzI,UAAA3L,OAAA,QAAAd,IAAAyM,UAAA,GAAAA,UAAA,GAAG,EAAG0I,EAAgB1I,UAAA3L,OAAA,QAAAd,IAAAyM,UAAA,GAAAA,UAAA,GAAG,GACrE,MAAMyF,EAAS,IAAImB,gBACfpB,GAAQC,EAAO3M,OAAO,SAAU0M,GACpCC,EAAO3M,OAAO,OAAQ2P,EAAK1N,YAC3B0K,EAAO3M,OAAO,YAAa4P,EAAS3N,YAEpC,MAAM4N,EAAclD,EAAO1K,WAC3B,OAAOoF,KAAKuD,QAAQ,aAADrS,OAAcsX,GACnC,CAEA,kBAAMC,CAAaC,GACjB,OAAO1I,KAAKuD,QAAQ,mBAAoB,CACtCe,OAAQ,OACRC,KAAMnB,KAAKoB,UAAUkE,IAEzB,CAEA,kBAAMC,CAAapW,EAAkBoN,GACnC,OAAOK,KAAKuD,QAAQ,YAADrS,OAAaqB,EAAQ,KAAK,CAC3C+R,OAAQ,MACRC,KAAMnB,KAAKoB,UAAU7E,IAEzB,CAEA,kBAAMiJ,CAAarW,GACjB,OAAOyN,KAAKuD,QAAQ,YAADrS,OAAaqB,EAAQ,YAAY,CAClD+R,OAAQ,UAEZ,CAEA,kBAAMuE,CAAatW,GACjB,OAAOyN,KAAKuD,QAAQ,YAADrS,OAAaqB,EAAQ,YAAY,CAClD+R,OAAQ,QAEZ,CAEA,qBAAMwE,CAAgBvW,GACpB,OAAOyN,KAAKuD,QAAQ,YAADrS,OAAaqB,EAAQ,gBAAgB,CACtD+R,OAAQ,QAEZ,CAEA,mBAAMyE,CAAcxW,GAA0E,IAAxDyW,EAAanJ,UAAA3L,OAAA,QAAAd,IAAAyM,UAAA,GAAAA,UAAA,GAAG,IAAKoJ,EAAcpJ,UAAA3L,OAAA,QAAAd,IAAAyM,UAAA,GAAAA,UAAA,GAAG,EAC1E,OAAOG,KAAKuD,QAAQ,YAADrS,OAAaqB,EAAQ,iBAAArB,OAAgB8X,EAAK,YAAA9X,OAAW+X,GAC1E,CAEA,sBAAMC,CAAiB3W,EAAkB4W,GACvC,OAAOnJ,KAAKuD,QAAQ,YAADrS,OAAaqB,EAAQ,iBAAiB,CACvD+R,OAAQ,OACRC,KAAMnB,KAAKoB,UAAU,CAAE2E,aAE3B,CAEA,uBAAMC,CAAkBC,GACtB,OAAOrJ,KAAKuD,QAAQ,wBAAyB,CAC3Ce,OAAQ,OACRC,KAAMnB,KAAKoB,UAAU,CAAE8E,WAAYD,KAEvC,CAEA,eAAME,CAAUC,GACd,OAAOxJ,KAAKuD,QAAQ,YAADrS,OAAasY,EAAQ,YAC1C,CAEA,iBAAMC,CAAYD,EAAkBtB,GAClC,OAAOlI,KAAKuD,QAAQ,YAADrS,OAAasY,EAAQ,mBAAmB,CACzDlF,OAAQ,OACRC,KAAMnB,KAAKoB,UAAU0D,IAEzB,CAEA,iBAAMwB,CAAYF,EAAkBpB,EAAiBF,GACnD,OAAOlI,KAAKuD,QAAQ,YAADrS,OAAasY,EAAQ,YAAAtY,OAAWkX,EAAO,KAAK,CAC7D9D,OAAQ,MACRC,KAAMnB,KAAKoB,UAAU0D,IAEzB,CAEA,iBAAMyB,CAAYH,EAAkBpB,GAClC,OAAOpI,KAAKuD,QAAQ,YAADrS,OAAasY,EAAQ,YAAAtY,OAAWkX,EAAO,YAAY,CACpE9D,OAAQ,UAEZ,CAEA,uBAAMsF,CAAkBJ,EAAkBK,GACxC,OAAO7J,KAAKuD,QAAQ,YAADrS,OAAasY,EAAQ,gBAAgB,CACtDlF,OAAQ,OACRC,KAAMnB,KAAKoB,UAAU,CAAEsF,UAAWD,KAEtC,CAEA,2BAAME,CAAsBP,EAAkBpB,GAC5C,OAAOpI,KAAKuD,QAAQ,YAADrS,OAAasY,EAAQ,YAAAtY,OAAWkX,EAAO,YAAY,CACpE9D,OAAQ,QAEZ,CAGA,yBAAM7T,GAA+D,IAA3CuZ,IAAmBnK,UAAA3L,OAAA,QAAAd,IAAAyM,UAAA,KAAAA,UAAA,GAC3C,MAAMyF,EAAS,IAAImB,gBAEnB,OADAnB,EAAO3M,OAAO,SAAUqR,EAAWpP,YAC5BoF,KAAKuD,QAAQ,kBAADrS,OAAmBoU,EAAO1K,YAC/C,CAEA,2BAAMhC,CAAsBH,GAC1B,MAAMiL,EAAG,GAAAxS,OAAM2R,EAAY,yBACrBG,EAASC,aAAaC,QAAQ,cAEpC,IAAKF,EACH,MAAM,IAAInF,MAAM,2BAGlB,MAAMsF,EAAeC,KAAKC,MAAML,GAChC,IAAIW,EAAuB,CACzB,cAAgB,UAADzS,OAAYiS,EAAaG,SAItC/S,QAAiBqT,MAAMF,EAAK,CAC9BY,OAAQ,OACRX,UACAY,KAAM9L,IAIR,GAAwB,MAApBlI,EAAST,OAAgB,CAE3B,SAD6BkQ,KAAK6D,eACd,CAClB,MAAMa,EAAYtB,KAAKC,MAAMJ,aAAaC,QAAQ,eAAiB,MACnES,EAAU,CACR,cAAgB,UAADzS,OAAYwT,EAAUpB,SAEvC/S,QAAiBqT,MAAMF,EAAK,CAC1BY,OAAQ,OACRX,UACAY,KAAM9L,GAEV,CACF,CAEA,GAAwB,MAApBlI,EAAST,OAIX,MAHAmT,aAAaa,WAAW,cACxBb,aAAaa,WAAW,YACxB3H,OAAO4H,SAASC,KAAO,SACjB,IAAInG,MAAM,2BAGlB,IAAKtN,EAAS0T,GAAI,CAChB,MAAMC,QAAkB3T,EAAS4T,OACjC,MAAM,IAAItG,MAAM,kBAAD3M,OAAmBX,EAAST,OAAM,KAAAoB,OAAIX,EAAS6T,WAAU,OAAAlT,OAAMgT,GAChF,CAEA,OAAO3T,EAAS8T,MAClB,CAEA,2BAAMpI,CAAsBgO,EAAoBtK,GAC9C,OAAOK,KAAKuD,QAAQ,iBAADrS,OAAkB+Y,EAAU,KAAK,CAClD3F,OAAQ,QACRC,KAAMnB,KAAKoB,UAAU7E,IAEzB,CAEA,2BAAMrD,CAAsB2N,GAC1B,OAAOjK,KAAKuD,QAAQ,iBAADrS,OAAkB+Y,EAAU,YAAY,CACzD3F,OAAQ,UAEZ,CAEA,yBAAM/P,CAAoBhC,GACxB,OAAOyN,KAAKuD,QAAQ,gBAADrS,OAAiBqB,EAAQ,SAC9C,CAEA,kBAAM2X,GACJ,OAAOlK,KAAKuD,QAAQ,eACtB,CAEA,qBAAM4G,CAAgBC,GACpB,OAAOpK,KAAKuD,QAAQ,sBAAuB,CACzCe,OAAQ,QACRC,KAAMnB,KAAKoB,UAAU4F,IAEzB,CAEA,kBAAMC,GACJ,OAAOrK,KAAKuD,QAAQ,eACtB,CAEA,qBAAM+G,CAAgBC,EAAsBjM,GAC1C,OAAO0B,KAAKuD,QAAQ,yBAA0B,CAC5Ce,OAAQ,OACRC,KAAMnB,KAAKoB,UAAU,CACnBhS,cAAe+X,EACfjM,MAAOA,GAAS,MAGtB,CAEA,oBAAMR,CAAemM,EAAoBO,EAAyBlM,GAChE,OAAO0B,KAAKuD,QAAQ,yBAA0B,CAC5Ce,OAAQ,OACRC,KAAMnB,KAAKoB,UAAU,CACnBiG,YAAaR,EACbS,eAAgBF,EAChBlM,MAAOA,GAAS,MAGtB,CAEA,yBAAMhL,GACJ,OAAO0M,KAAKuD,QAAQ,gBACtB,CAEA,uBAAMoH,CAAkBC,GACtB,OAAO5K,KAAKuD,QAAQ,gBAADrS,OAAiB0Z,EAAQ,KAC9C,E","sources":["components/OTA.tsx","services/cacheService.ts","services/api.ts"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { apiService } from '../services/api';\r\nimport { useTheme } from '../contexts/ThemeContext';\r\nimport '../App.css';\r\n\r\ninterface FirmwareVersion {\r\n  id: number;\r\n  name: string;\r\n  version: string;\r\n  deviceModel: string;\r\n  minBootloaderVersion: string;\r\n  file: File | null;\r\n  size: number;\r\n  checksum: string;\r\n  signatureValid: boolean;\r\n  releaseNotes: string;\r\n  status: 'draft' | 'stable';\r\n  uploadDate: string;\r\n}\r\n\r\ninterface DeviceStatus {\r\n  deviceId: string;\r\n  currentVersion: string;\r\n  targetVersion: string;\r\n  activeSlot: 'A' | 'B';\r\n  status: 'idle' | 'downloading' | 'flashing' | 'rebooting' | 'trial' | 'healthy' | 'failed' | 'rolledback';\r\n  bootCount: number;\r\n  lastError: string;\r\n  progress?: number;\r\n}\r\n\r\ninterface DeploymentConfig {\r\n  firmwareVersion: string;\r\n  targetDevices: string[];\r\n  mode: 'immediate' | 'canary';\r\n  autoRollback: boolean;\r\n  healthTimeout: number;\r\n  failureThreshold: number;\r\n}\r\n\r\ninterface DeploymentConfirmModal {\r\n  show: boolean;\r\n  firmware: string;\r\n  deviceCount: number;\r\n  dataTransfer: string;\r\n}\r\n\r\nexport const OTA: React.FC = () => {\r\n  const { isDark } = useTheme();\r\n  \r\n  // Section 1: Firmware Repository State\r\n  const [firmwares, setFirmwares] = useState<FirmwareVersion[]>([]);\r\n  const [uploadForm, setUploadForm] = useState({\r\n    name: '',\r\n    version: '',\r\n    deviceModel: 'ESP32-S3',\r\n    minBootloader: '1.0.0',\r\n    releaseNotes: '',\r\n    file: null as File | null,\r\n  });\r\n\r\n  // Section 2: Deployment Panel State\r\n  const [deploymentConfig, setDeploymentConfig] = useState<DeploymentConfig>({\r\n    firmwareVersion: '',\r\n    targetDevices: [],\r\n    mode: 'immediate',\r\n    autoRollback: true,\r\n    healthTimeout: 300,\r\n    failureThreshold: 10,\r\n  });\r\n  const [confirmModal, setConfirmModal] = useState<DeploymentConfirmModal>({\r\n    show: false,\r\n    firmware: '',\r\n    deviceCount: 0,\r\n    dataTransfer: '',\r\n  });\r\n  const [isDeploying, setIsDeploying] = useState(false);\r\n\r\n  // Section 3: Live Deployment Status State\r\n  const [devices, setDevices] = useState<DeviceStatus[]>([]);\r\n  const [statusFilter, setStatusFilter] = useState<'all' | DeviceStatus['status']>('all');\r\n  const [loadingDevices, setLoadingDevices] = useState(true);\r\n  const [loadingFirmwares, setLoadingFirmwares] = useState(true);\r\n  const [activeDeployment, setActiveDeployment] = useState<any>(null);\r\n\r\n  // Section 4: Emergency Rollback State\r\n  const [rollbackForm, setRollbackForm] = useState({\r\n    selectedDevices: [] as string[],\r\n    reason: '',\r\n  });\r\n  const [showRollbackModal, setShowRollbackModal] = useState(false);\r\n  const [rollbackFilters, setRollbackFilters] = useState({\r\n    currentVersion: 'all',\r\n    status: 'all',\r\n    deviceModel: 'all',\r\n  });\r\n\r\n  // Initial load - runs once on mount\r\n  useEffect(() => {\r\n    loadFirmwareData();\r\n    loadDevices();\r\n    loadDeployments();\r\n    \r\n    // Set up polling for deployment status updates\r\n    const interval = setInterval(() => {\r\n      loadDeployments(); // This will update activeDeployment and trigger status updates if needed\r\n    }, 10000);\r\n    \r\n    return () => clearInterval(interval);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const loadFirmwareData = async () => {\r\n    try {\r\n      setLoadingFirmwares(true);\r\n      const response = await apiService.getFirmwareVersions(false); // Get all firmware versions\r\n      \r\n      // Transform backend response to frontend FirmwareVersion interface\r\n      const transformedFirmwares: FirmwareVersion[] = (response.results || response || []).map((fw: any) => ({\r\n        id: fw.id,\r\n        name: fw.filename || `Firmware v${fw.version}`,\r\n        version: fw.version,\r\n        deviceModel: fw.description?.match(/(?:ESP32|STM32|[A-Z0-9-]+)/i)?.[0] || 'Unknown',\r\n        minBootloaderVersion: '1.0.0', // Default as backend doesn't provide this\r\n        file: null,\r\n        size: fw.size || 0,\r\n        checksum: fw.checksum || '',\r\n        signatureValid: fw.is_active !== false,\r\n        releaseNotes: fw.release_notes || fw.description || '',\r\n        status: fw.is_active ? 'stable' : 'draft',\r\n        uploadDate: fw.created_at || new Date().toISOString(),\r\n      }));\r\n      \r\n      setFirmwares(transformedFirmwares);\r\n    } catch (error) {\r\n      console.error('Failed to load firmware versions:', error);\r\n      // Set to empty on error - UI will show empty state\r\n      setFirmwares([]);\r\n    } finally {\r\n      setLoadingFirmwares(false);\r\n    }\r\n  };\r\n\r\n  const loadDevices = async () => {\r\n    try {\r\n      setLoadingDevices(true);\r\n      const response = await apiService.getDevices('', 1, 1000);\r\n      const realDevices = response.results || response;\r\n      \r\n      // Transform to simple device list - all start as 'idle'\r\n      const transformedDevices: DeviceStatus[] = (Array.isArray(realDevices) ? realDevices : []).map((device: any) => ({\r\n        deviceId: device.device_serial || device.serial || `DEV${device.id}`,\r\n        currentVersion: device.firmware_version || device.config_version || 'v1.0.0',\r\n        targetVersion: 'N/A',\r\n        activeSlot: Math.random() > 0.5 ? 'A' : 'B' as 'A' | 'B',\r\n        status: 'idle' as DeviceStatus['status'],\r\n        bootCount: device.boot_count || 0,\r\n        lastError: '',\r\n        progress: undefined,\r\n      }));\r\n      \r\n      setDevices(transformedDevices);\r\n    } catch (error) {\r\n      console.error('Failed to load devices:', error);\r\n      setDevices([]);\r\n    } finally {\r\n      setLoadingDevices(false);\r\n    }\r\n  };\r\n\r\n  const loadDeployments = async () => {\r\n    try {\r\n      const campaigns = await apiService.listTargetedUpdates();\r\n      \r\n      // Find the most recent in-progress deployment\r\n      const activeCampaign = campaigns.find((c: any) => \r\n        c.status === 'in_progress' || c.status === 'pending'\r\n      );\r\n      setActiveDeployment(activeCampaign || null);\r\n      \r\n      // If we have an active deployment, update status for those devices\r\n      if (activeCampaign) {\r\n        await updateDeployedDeviceStatuses(activeCampaign);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load deployments:', error);\r\n    }\r\n  };\r\n\r\n  const updateDeployedDeviceStatuses = async (deployment?: any) => {\r\n    try {\r\n      const activeDeploymentToUse = deployment || activeDeployment;\r\n      if (!activeDeploymentToUse) return;\r\n      \r\n      // Only fetch logs for devices in the active deployment\r\n      const targetedDevices = activeDeploymentToUse.device_targets || [];\r\n      const targetedDeviceIds = targetedDevices.map((dt: any) => dt.device?.device_serial).filter(Boolean);\r\n      \r\n      if (targetedDeviceIds.length === 0) return;\r\n      \r\n      // Fetch logs for all targeted devices in parallel\r\n      const logPromises = targetedDeviceIds.map(async (deviceId: string) => {\r\n        try {\r\n          const logs = await apiService.getDeviceUpdateLogs(deviceId);\r\n          const latestLog = logs && logs.length > 0 ? logs[0] : null;\r\n          \r\n          if (!latestLog) return { deviceId, status: 'idle' as DeviceStatus['status'] };\r\n          \r\n          const backendStatus = latestLog.status?.toLowerCase();\r\n          let status: DeviceStatus['status'] = 'idle';\r\n          \r\n          switch (backendStatus) {\r\n            case 'pending':\r\n            case 'checking':\r\n            case 'available':\r\n              status = 'trial';\r\n              break;\r\n            case 'downloading':\r\n              status = 'downloading';\r\n              break;\r\n            case 'completed':\r\n              status = 'healthy';\r\n              break;\r\n            case 'failed':\r\n              status = 'failed';\r\n              break;\r\n          }\r\n          \r\n          return {\r\n            deviceId,\r\n            status,\r\n            currentVersion: latestLog.current_firmware,\r\n            targetVersion: latestLog.firmware_version?.version,\r\n            lastError: status === 'failed' ? 'Update failed' : '',\r\n          };\r\n        } catch (error) {\r\n          console.error(`Failed to get logs for ${deviceId}:`, error);\r\n          return { deviceId, status: 'idle' as DeviceStatus['status'] };\r\n        }\r\n      });\r\n      \r\n      const deviceUpdates = await Promise.all(logPromises);\r\n      \r\n      // Create a map of device updates\r\n      const updateMap = new Map(deviceUpdates.map(u => [u.deviceId, u]));\r\n      \r\n      // Update devices state once with all changes\r\n      setDevices(prevDevices => \r\n        prevDevices.map(device => {\r\n          const update = updateMap.get(device.deviceId);\r\n          if (!update) return device;\r\n          \r\n          return {\r\n            ...device,\r\n            status: update.status,\r\n            currentVersion: update.currentVersion || device.currentVersion,\r\n            targetVersion: update.targetVersion || device.targetVersion,\r\n            lastError: update.lastError || device.lastError,\r\n          };\r\n        })\r\n      );\r\n    } catch (error) {\r\n      console.error('Failed to update deployed device statuses:', error);\r\n    }\r\n  };\r\n\r\n  // Section 1 handlers\r\n  const calculateSHA256 = async (file: File): Promise<string> => {\r\n    const buffer = await file.arrayBuffer();\r\n    const hashBuffer = await crypto.subtle.digest('SHA-256', buffer);\r\n    const hashArray = Array.from(new Uint8Array(hashBuffer));\r\n    const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');\r\n    return hashHex;\r\n  };\r\n\r\n  const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files?.[0]) {\r\n      const file = e.target.files[0];\r\n      setUploadForm({ ...uploadForm, file });\r\n      \r\n      // Calculate real SHA256 checksum\r\n      try {\r\n        const checksum = await calculateSHA256(file);\r\n        console.log('Calculated SHA-256 checksum:', checksum);\r\n      } catch (error) {\r\n        console.error('Failed to calculate checksum:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleUploadFirmware = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!uploadForm.file) {\r\n      alert('Please select a firmware file');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Create FormData for multipart upload\r\n      const formData = new FormData();\r\n      formData.append('file', uploadForm.file);\r\n      formData.append('version', uploadForm.version);\r\n      formData.append('description', uploadForm.name);\r\n      formData.append('release_notes', uploadForm.releaseNotes);\r\n      formData.append('is_active', 'false'); // Uploaded as draft by default\r\n\r\n      // Call backend API to upload to S3\r\n      const response = await apiService.uploadFirmwareVersion(formData);\r\n      \r\n      alert(`Firmware uploaded successfully!\\n\\nVersion: ${response.version}\\nSize: ${(response.size / 1024).toFixed(2)} KB\\nChecksum: ${response.checksum?.substring(0, 16)}...\\nStored in: S3\\n\\nFile URL: ${response.file || 'N/A'}`);\r\n      \r\n      // Reset form\r\n      setUploadForm({\r\n        name: '',\r\n        version: '',\r\n        deviceModel: 'ESP32-S3',\r\n        minBootloader: '1.0.0',\r\n        releaseNotes: '',\r\n        file: null,\r\n      });\r\n      \r\n      const fileInput = document.querySelector('input[type=\"file\"]') as HTMLInputElement;\r\n      if (fileInput) fileInput.value = '';\r\n      \r\n      // Reload firmware list from backend\r\n      await loadFirmwareData();\r\n    } catch (error: any) {\r\n      console.error('Firmware upload failed:', error);\r\n      alert(`Upload failed: ${error.message || 'Unknown error'}\\n\\nPlease check:\\n- File size is reasonable\\n- S3 credentials are configured (USE_S3=True)\\n- You have admin permissions`);\r\n    }\r\n  };\r\n\r\n  const handleDeleteFirmware = async (id: number) => {\r\n    if (window.confirm('Delete this firmware version? This will remove it from S3.')) {\r\n      try {\r\n        await apiService.deleteFirmwareVersion(id);\r\n        alert('Firmware deleted successfully!');\r\n        // Reload firmware list from backend\r\n        await loadFirmwareData();\r\n      } catch (error: any) {\r\n        console.error('Firmware deletion failed:', error);\r\n        alert(`Deletion failed: ${error.message || 'Unknown error'}`);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleMarkAsStable = async (id: number) => {\r\n    try {\r\n      await apiService.updateFirmwareVersion(id, { is_active: true });\r\n      alert('Firmware activated successfully!');\r\n      // Reload firmware list from backend\r\n      await loadFirmwareData();\r\n    } catch (error: any) {\r\n      console.error('Firmware update failed:', error);\r\n      alert(`Update failed: ${error.message || 'Unknown error'}`);\r\n    }\r\n  };\r\n\r\n  const handleDeactivateFirmware = async (id: number) => {\r\n    if (window.confirm('Deactivate this firmware? It will no longer be available for OTA updates.')) {\r\n      try {\r\n        await apiService.updateFirmwareVersion(id, { is_active: false });\r\n        alert('Firmware deactivated successfully!');\r\n        // Reload firmware list from backend\r\n        await loadFirmwareData();\r\n      } catch (error: any) {\r\n        console.error('Firmware deactivation failed:', error);\r\n        alert(`Deactivation failed: ${error.message || 'Unknown error'}`);\r\n      }\r\n    }\r\n  };\r\n\r\n  // Section 2 handlers\r\n  const handleDeployClick = () => {\r\n    if (!deploymentConfig.firmwareVersion) {\r\n      alert('Please select a firmware version');\r\n      return;\r\n    }\r\n    if (deploymentConfig.targetDevices.length === 0) {\r\n      alert('Please select at least one device');\r\n      return;\r\n    }\r\n\r\n    const firmware = firmwares.find(f => f.version === deploymentConfig.firmwareVersion);\r\n    if (!firmware) return;\r\n\r\n    const totalBytes = firmware.size * deploymentConfig.targetDevices.length;\r\n    const dataTransfer = (totalBytes / (1024 * 1024)).toFixed(2) + ' MB';\r\n\r\n    setConfirmModal({\r\n      show: true,\r\n      firmware: firmware.version,\r\n      deviceCount: deploymentConfig.targetDevices.length,\r\n      dataTransfer,\r\n    });\r\n  };\r\n\r\n  const confirmDeployment = async () => {\r\n    setConfirmModal({ ...confirmModal, show: false });\r\n    setIsDeploying(true);\r\n    \r\n    try {\r\n      // Find the selected firmware object to get its ID\r\n      const firmware = firmwares.find(f => f.version === deploymentConfig.firmwareVersion);\r\n      if (!firmware) {\r\n        throw new Error('Selected firmware not found');\r\n      }\r\n      \r\n      // Call backend API to create deployment campaign\r\n      const response = await apiService.deployFirmware(\r\n        firmware.id,\r\n        deploymentConfig.targetDevices,\r\n        `Deployment: ${firmware.version} to ${deploymentConfig.targetDevices.length} device(s)`\r\n      );\r\n      \r\n      setIsDeploying(false);\r\n      alert(`Deployment initiated successfully!\\n\\nTargeted Update ID: ${response.id || 'N/A'}\\nDevices: ${response.devices_total || deploymentConfig.targetDevices.length}\\nFirmware: ${firmware.version}\\n\\nDevices will receive the update on their next check-in.`);\r\n      \r\n      // Refresh device status and deployments after deployment\r\n      await loadDeployments();\r\n    } catch (error: any) {\r\n      setIsDeploying(false);\r\n      console.error('Deployment failed:', error);\r\n      alert(`Deployment failed: ${error.message || 'Unknown error'}\\n\\nPlease check the console for details.`);\r\n    }\r\n  };\r\n\r\n  const handleSelectAllDevices = () => {\r\n    const idleDevices = devices.filter(d => d.status === 'idle');\r\n    setDeploymentConfig({\r\n      ...deploymentConfig,\r\n      targetDevices: idleDevices.map(d => d.deviceId),\r\n    });\r\n  };\r\n\r\n  // Section 3 helpers\r\n  const statusMetrics = {\r\n    total: devices.length,\r\n    inProgress: devices.filter(d => ['downloading', 'flashing', 'rebooting'].includes(d.status)).length,\r\n    healthy: devices.filter(d => d.status === 'healthy').length,\r\n    failed: devices.filter(d => d.status === 'failed').length,\r\n    rolledBack: devices.filter(d => d.status === 'rolledback').length,\r\n  };\r\n\r\n  const getStatusBadgeStyle = (status: DeviceStatus['status']) => {\r\n    const styles: Record<DeviceStatus['status'], string> = {\r\n      idle: '#6c757d',\r\n      downloading: '#17a2b8',\r\n      flashing: '#ffc107',\r\n      rebooting: '#fd7e14',\r\n      trial: '#007bff',\r\n      healthy: '#28a745',\r\n      failed: '#dc3545',\r\n      rolledback: '#6610f2',\r\n    };\r\n    return {\r\n      background: styles[status],\r\n      color: 'white',\r\n      padding: '0.25rem 0.75rem',\r\n      borderRadius: '12px',\r\n      fontSize: '0.75rem',\r\n      fontWeight: '600' as const,\r\n      textTransform: 'uppercase' as const,\r\n      whiteSpace: 'nowrap' as const,\r\n    };\r\n  };\r\n\r\n  // Section 4 handlers\r\n  const handleEmergencyRollback = () => {\r\n    setShowRollbackModal(true);\r\n  };\r\n\r\n  const confirmRollback = () => {\r\n    if (rollbackForm.selectedDevices.length === 0) {\r\n      alert('Please select devices to rollback');\r\n      return;\r\n    }\r\n    if (!rollbackForm.reason.trim()) {\r\n      alert('Please provide a reason for rollback');\r\n      return;\r\n    }\r\n\r\n    // TODO: Send updateConfig command with value 2 to trigger rollback on selected devices\r\n    // This will instruct devices to rollback to their previous firmware version\r\n    \r\n    setShowRollbackModal(false);\r\n    alert(`Sending rollback command (updateConfig=2) to ${rollbackForm.selectedDevices.length} device(s)`);\r\n    setRollbackForm({ selectedDevices: [], reason: '' });\r\n  };\r\n\r\n  const toggleRollbackDevice = (deviceId: string) => {\r\n    setRollbackForm(prev => ({\r\n      ...prev,\r\n      selectedDevices: prev.selectedDevices.includes(deviceId)\r\n        ? prev.selectedDevices.filter(id => id !== deviceId)\r\n        : [...prev.selectedDevices, deviceId]\r\n    }));\r\n  };\r\n\r\n  const getFilteredRollbackDevices = () => {\r\n    return devices.filter(device => {\r\n      if (rollbackFilters.currentVersion !== 'all' && device.currentVersion !== rollbackFilters.currentVersion) {\r\n        return false;\r\n      }\r\n      if (rollbackFilters.status !== 'all' && device.status !== rollbackFilters.status) {\r\n        return false;\r\n      }\r\n      // Add more filter conditions as needed\r\n      return true;\r\n    });\r\n  };\r\n\r\n  const selectAllFilteredDevices = () => {\r\n    const filtered = getFilteredRollbackDevices();\r\n    setRollbackForm(prev => ({\r\n      ...prev,\r\n      selectedDevices: filtered.map(d => d.deviceId)\r\n    }));\r\n  };\r\n\r\n  const deselectAllDevices = () => {\r\n    setRollbackForm(prev => ({ ...prev, selectedDevices: [] }));\r\n  };\r\n\r\n  const filteredDevices = statusFilter === 'all' \r\n    ? devices \r\n    : devices.filter(d => d.status === statusFilter);\r\n\r\n  return (\r\n    <div style={{ padding: '2rem', maxWidth: '1600px', margin: '0 auto', background: isDark ? '#1a1a1a' : '#f5f6fa', minHeight: '100vh' }}>\r\n      {/* Header */}\r\n      <div style={{ marginBottom: '2rem' }}>\r\n        <h1 style={{ \r\n          fontSize: '2rem', \r\n          fontWeight: '700', \r\n          color: isDark ? '#e0e0e0' : '#2c3e50', \r\n          marginBottom: '0.5rem',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: '0.75rem'\r\n        }}>\r\n          <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n            <path d=\"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z\"/>\r\n            <polyline points=\"3.27 6.96 12 12.01 20.73 6.96\"/>\r\n            <line x1=\"12\" y1=\"22.08\" x2=\"12\" y2=\"12\"/>\r\n          </svg>\r\n          OTA Firmware Management\r\n        </h1>\r\n        <p style={{ color: isDark ? '#a0a0a0' : '#7f8c8d', margin: 0 }}>\r\n          Upload, deploy, and monitor firmware updates across your device fleet\r\n        </p>\r\n      </div>\r\n\r\n      {/* SECTION 1: Firmware Repository */}\r\n      <div style={{ \r\n        background: isDark ? '#2d2d2d' : 'white', \r\n        borderRadius: '12px', \r\n        padding: '2rem',\r\n        marginBottom: '2rem',\r\n        boxShadow: isDark ? '0 2px 8px rgba(0,0,0,0.3)' : '0 2px 8px rgba(0,0,0,0.08)',\r\n        border: isDark ? '1px solid #404040' : '1px solid #e1e8ed'\r\n      }}>\r\n        <h2 style={{ \r\n          fontSize: '1.5rem', \r\n          fontWeight: '600', \r\n          color: isDark ? '#e0e0e0' : '#2c3e50',\r\n          marginBottom: '1.5rem',\r\n          paddingBottom: '0.75rem',\r\n          borderBottom: isDark ? '2px solid #404040' : '2px solid #e1e8ed',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: '0.5rem'\r\n        }}>\r\n          <span style={{ fontSize: '1.25rem' }}></span>\r\n          Firmware Repository\r\n        </h2>\r\n\r\n        {/* Upload Form */}\r\n        <form onSubmit={handleUploadFirmware} style={{ \r\n          background: isDark ? '#242424' : '#f8f9fa', \r\n          padding: '1.5rem', \r\n          borderRadius: '8px',\r\n          marginBottom: '2rem',\r\n          border: isDark ? '1px solid #404040' : '1px solid #dee2e6'\r\n        }}>\r\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', gap: '1rem' }}>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n                Firmware Name *\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={uploadForm.name}\r\n                onChange={(e) => setUploadForm({ ...uploadForm, name: e.target.value })}\r\n                placeholder=\"Solar Controller Firmware\"\r\n                required\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.75rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.95rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n                Version (semver) *\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={uploadForm.version}\r\n                onChange={(e) => setUploadForm({ ...uploadForm, version: e.target.value })}\r\n                placeholder=\"1.4.0\"\r\n                required\r\n                pattern=\"\\d+\\.\\d+\\.\\d+\"\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.75rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.95rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n                Device Model\r\n              </label>\r\n              <select\r\n                value={uploadForm.deviceModel}\r\n                onChange={(e) => setUploadForm({ ...uploadForm, deviceModel: e.target.value })}\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.75rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.95rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              >\r\n                <option value=\"ESP32-S3\">ESP32-S3</option>\r\n                <option value=\"ESP32\">ESP32</option>\r\n                <option value=\"STM32\">STM32</option>\r\n                <option value=\"nRF52\">nRF52</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n                Min Bootloader Version\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={uploadForm.minBootloader}\r\n                onChange={(e) => setUploadForm({ ...uploadForm, minBootloader: e.target.value })}\r\n                placeholder=\"1.0.0\"\r\n                required\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.75rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.95rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div style={{ marginTop: '1rem' }}>\r\n            <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n              Release Notes\r\n            </label>\r\n            <textarea\r\n              value={uploadForm.releaseNotes}\r\n              onChange={(e) => setUploadForm({ ...uploadForm, releaseNotes: e.target.value })}\r\n              placeholder=\"Bug fixes, new features, improvements...\"\r\n              rows={3}\r\n              style={{ \r\n                width: '100%', \r\n                padding: '0.75rem', \r\n                borderRadius: '6px', \r\n                border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                fontSize: '0.95rem',\r\n                fontFamily: 'inherit',\r\n                resize: 'vertical',\r\n                background: isDark ? '#1a1a1a' : 'white',\r\n                color: isDark ? '#e0e0e0' : 'inherit'\r\n              }}\r\n            />\r\n          </div>\r\n\r\n          <div style={{ marginTop: '1rem', display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem', alignItems: 'end' }}>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n                Firmware File (.bin) *\r\n              </label>\r\n              <input\r\n                type=\"file\"\r\n                accept=\".bin\"\r\n                onChange={handleFileSelect}\r\n                required\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.5rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.9rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              />\r\n              {uploadForm.file && (\r\n                <small style={{ color: isDark ? '#a0a0a0' : '#6c757d', display: 'block', marginTop: '0.25rem' }}>\r\n                  {uploadForm.file.name} ({(uploadForm.file.size / 1024).toFixed(1)} KB)\r\n                </small>\r\n              )}\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n                SHA256 (auto-calculated)\r\n              </label>\r\n              <div style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '0.5rem',\r\n                padding: '0.75rem',\r\n                background: isDark ? '#242424' : '#e9ecef',\r\n                borderRadius: '6px',\r\n                border: isDark ? '1px solid #404040' : '1px solid #ced4da'\r\n              }}>\r\n                <input\r\n                  type=\"text\"\r\n                  value=\"Calculating...\"\r\n                  disabled\r\n                  style={{ \r\n                    width: '100%',\r\n                    border: 'none',\r\n                    background: 'transparent',\r\n                    fontSize: '0.85rem',\r\n                    fontFamily: 'monospace',\r\n                    color: isDark ? '#a0a0a0' : '#6c757d'\r\n                  }}\r\n                />\r\n                <span style={{\r\n                  background: uploadForm.file ? '#28a745' : '#6c757d',\r\n                  color: 'white',\r\n                  padding: '0.25rem 0.5rem',\r\n                  borderRadius: '4px',\r\n                  fontSize: '0.7rem',\r\n                  fontWeight: '600',\r\n                  whiteSpace: 'nowrap'\r\n                }}>\r\n                  {uploadForm.file ? 'Valid' : 'Pending'}\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <button\r\n            type=\"submit\"\r\n            style={{\r\n              marginTop: '1.5rem',\r\n              background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n              color: 'white',\r\n              border: 'none',\r\n              padding: '0.875rem 2rem',\r\n              borderRadius: '8px',\r\n              fontSize: '1rem',\r\n              fontWeight: '600',\r\n              cursor: 'pointer',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              boxShadow: '0 4px 12px rgba(102, 126, 234, 0.3)',\r\n            }}\r\n          >\r\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n              <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"/>\r\n              <polyline points=\"17 8 12 3 7 8\"/>\r\n              <line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\"/>\r\n            </svg>\r\n            Upload Firmware\r\n          </button>\r\n        </form>\r\n\r\n        {/* Firmware List Table */}\r\n        <div>\r\n          <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1rem', color: isDark ? '#e0e0e0' : '#495057' }}>\r\n            Available Firmware Versions\r\n          </h3>\r\n          <div style={{ overflowX: 'auto' }}>\r\n            <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n              <thead>\r\n                <tr style={{ background: isDark ? '#242424' : '#f8f9fa', borderBottom: isDark ? '2px solid #404040' : '2px solid #dee2e6' }}>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>Name</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>Version</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>Device Model</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>File Size</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>Upload Date</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>Status</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'center', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>Actions</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {loadingFirmwares ? (\r\n                  <tr>\r\n                    <td colSpan={7} style={{ padding: '2rem', textAlign: 'center', color: isDark ? '#a0a0a0' : '#6c757d', fontSize: '0.95rem' }}>\r\n                      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '0.5rem' }}>\r\n                        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" style={{ animation: 'spin 1s linear infinite' }}>\r\n                          <circle cx=\"12\" cy=\"12\" r=\"10\" opacity=\"0.25\"/>\r\n                          <path d=\"M12 2a10 10 0 0 1 10 10\" opacity=\"0.75\"/>\r\n                        </svg>\r\n                        Loading firmware versions...\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ) : firmwares.length === 0 ? (\r\n                  <tr>\r\n                    <td colSpan={7} style={{ padding: '2rem', textAlign: 'center', color: isDark ? '#a0a0a0' : '#6c757d', fontSize: '0.95rem' }}>\r\n                      No firmware versions uploaded yet. Use the form above to upload your first firmware.\r\n                    </td>\r\n                  </tr>\r\n                ) : (\r\n                  firmwares.map(fw => (\r\n                  <tr key={fw.id} style={{ borderBottom: isDark ? '1px solid #404040' : '1px solid #e9ecef' }}>\r\n                    <td style={{ padding: '1rem 0.75rem' }}>\r\n                      <div style={{ fontWeight: '500', color: isDark ? '#e0e0e0' : '#2c3e50', marginBottom: '0.25rem' }}>{fw.name}</div>\r\n                      {fw.signatureValid && (\r\n                        <span style={{ fontSize: '0.75rem', color: '#28a745', display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\r\n                          <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"3\">\r\n                            <polyline points=\"20 6 9 17 4 12\"/>\r\n                          </svg>\r\n                          Signature Valid\r\n                        </span>\r\n                      )}\r\n                    </td>\r\n                    <td style={{ padding: '1rem 0.75rem', fontFamily: 'monospace', fontSize: '0.9rem', fontWeight: '500' }}>{fw.version}</td>\r\n                    <td style={{ padding: '1rem 0.75rem', fontSize: '0.9rem' }}>{fw.deviceModel}</td>\r\n                    <td style={{ padding: '1rem 0.75rem', fontSize: '0.9rem' }}>{(fw.size / 1024).toFixed(0)} KB</td>\r\n                    <td style={{ padding: '1rem 0.75rem', fontSize: '0.9rem' }}>\r\n                      {new Date(fw.uploadDate).toLocaleDateString()}\r\n                    </td>\r\n                    <td style={{ padding: '1rem 0.75rem' }}>\r\n                      <span style={{\r\n                        background: fw.status === 'stable' ? '#d4edda' : '#fff3cd',\r\n                        color: fw.status === 'stable' ? '#155724' : '#856404',\r\n                        padding: '0.25rem 0.75rem',\r\n                        borderRadius: '12px',\r\n                        fontSize: '0.75rem',\r\n                        fontWeight: '600',\r\n                        textTransform: 'uppercase'\r\n                      }}>\r\n                        {fw.status === 'stable' ? ' Production Stable' : 'Draft'}\r\n                      </span>\r\n                    </td>\r\n                    <td style={{ padding: '1rem 0.75rem', textAlign: 'center' }}>\r\n                      <div style={{ display: 'flex', gap: '0.5rem', justifyContent: 'center' }}>\r\n                        {fw.status === 'draft' ? (\r\n                          <button\r\n                            onClick={() => handleMarkAsStable(fw.id)}\r\n                            style={{\r\n                              background: '#28a745',\r\n                              color: 'white',\r\n                              border: 'none',\r\n                              padding: '0.5rem 0.75rem',\r\n                              borderRadius: '6px',\r\n                              fontSize: '0.8rem',\r\n                              cursor: 'pointer',\r\n                              fontWeight: '500'\r\n                            }}\r\n                          >\r\n                            Activate\r\n                          </button>\r\n                        ) : (\r\n                          <button\r\n                            onClick={() => handleDeactivateFirmware(fw.id)}\r\n                            style={{\r\n                              background: '#ffc107',\r\n                              color: '#000',\r\n                              border: 'none',\r\n                              padding: '0.5rem 0.75rem',\r\n                              borderRadius: '6px',\r\n                              fontSize: '0.8rem',\r\n                              cursor: 'pointer',\r\n                              fontWeight: '500'\r\n                            }}\r\n                          >\r\n                            Deactivate\r\n                          </button>\r\n                        )}\r\n                        <button\r\n                          onClick={() => handleDeleteFirmware(fw.id)}\r\n                          style={{\r\n                            background: '#dc3545',\r\n                            color: 'white',\r\n                            border: 'none',\r\n                            padding: '0.5rem 0.75rem',\r\n                            borderRadius: '6px',\r\n                            fontSize: '0.8rem',\r\n                            cursor: 'pointer',\r\n                            fontWeight: '500'\r\n                          }}\r\n                        >\r\n                          Delete\r\n                        </button>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* SECTION 2: Deployment Panel */}\r\n      <div style={{ \r\n        background: isDark ? '#2d2d2d' : 'white', \r\n        borderRadius: '12px', \r\n        padding: '2rem',\r\n        marginBottom: '2rem',\r\n        boxShadow: isDark ? '0 2px 8px rgba(0,0,0,0.3)' : '0 2px 8px rgba(0,0,0,0.08)',\r\n        border: isDark ? '2px solid #667eea' : '2px solid #667eea'\r\n      }}>\r\n        <h2 style={{ \r\n          fontSize: '1.5rem', \r\n          fontWeight: '600', \r\n          color: isDark ? '#e0e0e0' : '#2c3e50',\r\n          marginBottom: '1.5rem',\r\n          paddingBottom: '0.75rem',\r\n          borderBottom: isDark ? '2px solid #404040' : '2px solid #e1e8ed',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: '0.5rem'\r\n        }}>\r\n          <span style={{ fontSize: '1.25rem' }}></span>\r\n          Deployment Panel\r\n        </h2>\r\n\r\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '1.5rem' }}>\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n              Select Firmware Version *\r\n            </label>\r\n            <select\r\n              value={deploymentConfig.firmwareVersion}\r\n              onChange={(e) => setDeploymentConfig({ ...deploymentConfig, firmwareVersion: e.target.value })}\r\n              style={{ \r\n                width: '100%', \r\n                padding: '0.75rem', \r\n                borderRadius: '6px', \r\n                border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                fontSize: '0.95rem',\r\n                background: isDark ? '#1a1a1a' : 'white',\r\n                color: isDark ? '#e0e0e0' : 'inherit'\r\n              }}\r\n            >\r\n              <option value=\"\">-- Select Version --</option>\r\n              {firmwares.filter(f => f.status === 'stable').map(f => (\r\n                <option key={f.id} value={f.version}>\r\n                  {f.name} - v{f.version}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n              Deployment Mode\r\n            </label>\r\n            <select\r\n              value={deploymentConfig.mode}\r\n              onChange={(e) => setDeploymentConfig({ ...deploymentConfig, mode: e.target.value as 'immediate' | 'canary' })}\r\n              style={{ \r\n                width: '100%', \r\n                padding: '0.75rem', \r\n                borderRadius: '6px', \r\n                border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                fontSize: '0.95rem',\r\n                background: isDark ? '#1a1a1a' : 'white',\r\n                color: isDark ? '#e0e0e0' : 'inherit'\r\n              }}\r\n            >\r\n              <option value=\"immediate\">Immediate (Push to all devices)</option>\r\n              <option value=\"canary\">Canary (Gradual rollout)</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n              Health Confirmation Timeout (seconds)\r\n            </label>\r\n            <input\r\n              type=\"number\"\r\n              value={deploymentConfig.healthTimeout}\r\n              onChange={(e) => setDeploymentConfig({ ...deploymentConfig, healthTimeout: parseInt(e.target.value) })}\r\n              min=\"30\"\r\n              max=\"3600\"\r\n              style={{ \r\n                width: '100%', \r\n                padding: '0.75rem', \r\n                borderRadius: '6px', \r\n                border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                fontSize: '0.95rem',\r\n                background: isDark ? '#1a1a1a' : 'white',\r\n                color: isDark ? '#e0e0e0' : 'inherit'\r\n              }}\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n              Failure Threshold (%)\r\n            </label>\r\n            <input\r\n              type=\"number\"\r\n              value={deploymentConfig.failureThreshold}\r\n              onChange={(e) => setDeploymentConfig({ ...deploymentConfig, failureThreshold: parseInt(e.target.value) })}\r\n              min=\"1\"\r\n              max=\"100\"\r\n              style={{ \r\n                width: '100%', \r\n                padding: '0.75rem', \r\n                borderRadius: '6px', \r\n                border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                fontSize: '0.95rem',\r\n                background: isDark ? '#1a1a1a' : 'white',\r\n                color: isDark ? '#e0e0e0' : 'inherit'\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ marginTop: '1.5rem' }}>\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '0.5rem' }}>\r\n            <label style={{ fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n              Target Devices ({deploymentConfig.targetDevices.length} selected)\r\n            </label>\r\n            <button\r\n              onClick={handleSelectAllDevices}\r\n              style={{\r\n                background: 'transparent',\r\n                color: '#667eea',\r\n                border: '1px solid #667eea',\r\n                padding: '0.25rem 0.75rem',\r\n                borderRadius: '6px',\r\n                fontSize: '0.8rem',\r\n                cursor: 'pointer',\r\n                fontWeight: '500'\r\n              }}\r\n            >\r\n              Select All Idle ({devices.filter(d => d.status === 'idle').length})\r\n            </button>\r\n          </div>\r\n          <div style={{\r\n            maxHeight: '150px',\r\n            overflowY: 'auto',\r\n            border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n            borderRadius: '6px',\r\n            padding: '0.75rem',\r\n            background: isDark ? '#242424' : '#f8f9fa'\r\n          }}>\r\n            {loadingDevices ? (\r\n              <div style={{ textAlign: 'center', color: isDark ? '#a0a0a0' : '#6c757d', padding: '1rem' }}>\r\n                Loading devices...\r\n              </div>\r\n            ) : devices.filter(d => d.status === 'idle').length === 0 ? (\r\n              <div style={{ textAlign: 'center', color: isDark ? '#a0a0a0' : '#6c757d', padding: '1rem' }}>\r\n                No idle devices available for deployment\r\n              </div>\r\n            ) : (\r\n              <>\r\n                {devices.filter(d => d.status === 'idle').map(device => (\r\n                  <label key={device.deviceId} style={{ \r\n                    display: 'block', \r\n                    marginBottom: '0.5rem',\r\n                    cursor: 'pointer',\r\n                    fontSize: '0.9rem'\r\n                  }}>\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={deploymentConfig.targetDevices.includes(device.deviceId)}\r\n                      onChange={(e) => {\r\n                        const newTargets = e.target.checked\r\n                          ? [...deploymentConfig.targetDevices, device.deviceId]\r\n                          : deploymentConfig.targetDevices.filter(id => id !== device.deviceId);\r\n                        setDeploymentConfig({ ...deploymentConfig, targetDevices: newTargets });\r\n                      }}\r\n                      style={{ marginRight: '0.5rem' }}\r\n                    />\r\n                    {device.deviceId} (Current: {device.currentVersion})\r\n                  </label>\r\n                ))}\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ marginTop: '1.5rem', display: 'flex', alignItems: 'center', gap: '0.75rem' }}>\r\n          <label style={{\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            gap: '0.5rem',\r\n            cursor: 'pointer',\r\n            fontWeight: '500',\r\n            color: isDark ? '#b0b0b0' : '#495057'\r\n          }}>\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={deploymentConfig.autoRollback}\r\n              onChange={(e) => setDeploymentConfig({ ...deploymentConfig, autoRollback: e.target.checked })}\r\n              style={{ width: '20px', height: '20px', cursor: 'pointer' }}\r\n            />\r\n            Enable Auto Rollback\r\n          </label>\r\n          <span style={{ fontSize: '0.85rem', color: isDark ? '#a0a0a0' : '#6c757d' }}>\r\n            (Automatically rollback on failure)\r\n          </span>\r\n        </div>\r\n\r\n        <div style={{ marginTop: '2rem', display: 'flex', gap: '1rem', flexWrap: 'wrap' }}>\r\n          <button\r\n            onClick={handleDeployClick}\r\n            disabled={isDeploying}\r\n            style={{\r\n              background: isDeploying ? '#6c757d' : 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n              color: 'white',\r\n              border: 'none',\r\n              padding: '1rem 2.5rem',\r\n              borderRadius: '8px',\r\n              fontSize: '1.125rem',\r\n              fontWeight: '600',\r\n              cursor: isDeploying ? 'not-allowed' : 'pointer',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.75rem',\r\n              boxShadow: '0 4px 12px rgba(102, 126, 234, 0.3)',\r\n            }}\r\n          >\r\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n              <polygon points=\"13 2 3 14 12 14 11 22 21 10 12 10 13 2\"/>\r\n            </svg>\r\n            {isDeploying ? 'Deploying...' : 'Deploy Firmware'}\r\n          </button>\r\n\r\n          {isDeploying && (\r\n            <>\r\n              <button\r\n                style={{\r\n                  background: '#ffc107',\r\n                  color: '#000',\r\n                  border: 'none',\r\n                  padding: '1rem 2rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '1rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer',\r\n                }}\r\n              >\r\n                 Pause Deployment\r\n              </button>\r\n              <button\r\n                style={{\r\n                  background: '#dc3545',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '1rem 2rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '1rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer',\r\n                }}\r\n              >\r\n                 Abort Deployment\r\n              </button>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Deployment Confirmation Modal */}\r\n      {confirmModal.show && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: 'rgba(0,0,0,0.6)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          zIndex: 1000\r\n        }}>\r\n          <div style={{\r\n            background: isDark ? '#2d2d2d' : 'white',\r\n            borderRadius: '12px',\r\n            padding: '2rem',\r\n            maxWidth: '500px',\r\n            width: '90%',\r\n            boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n            border: isDark ? '1px solid #404040' : 'none'\r\n          }}>\r\n            <h3 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1.5rem', color: isDark ? '#e0e0e0' : '#2c3e50' }}>\r\n              Confirm Deployment\r\n            </h3>\r\n            <div style={{ marginBottom: '1.5rem', color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.8' }}>\r\n              <p><strong>Firmware Version:</strong> {confirmModal.firmware}</p>\r\n              <p><strong>Target Devices:</strong> {confirmModal.deviceCount}</p>\r\n              <p><strong>Estimated Data Transfer:</strong> {confirmModal.dataTransfer}</p>\r\n              <p><strong>Auto Rollback:</strong> {deploymentConfig.autoRollback ? 'Enabled ' : 'Disabled'}</p>\r\n              <p><strong>Failure Threshold:</strong> {deploymentConfig.failureThreshold}%</p>\r\n            </div>\r\n            <div style={{\r\n              background: isDark ? '#3a2a00' : '#fff3cd',\r\n              border: isDark ? '1px solid #6b5300' : '1px solid #ffc107',\r\n              borderRadius: '8px',\r\n              padding: '1rem',\r\n              marginBottom: '1.5rem',\r\n              color: isDark ? '#ffd966' : '#856404'\r\n            }}>\r\n              <strong> Warning:</strong> This will push firmware updates to {confirmModal.deviceCount} devices.\r\n            </div>\r\n            <div style={{ display: 'flex', gap: '1rem', justifyContent: 'flex-end' }}>\r\n              <button\r\n                onClick={() => setConfirmModal({ ...confirmModal, show: false })}\r\n                style={{\r\n                  background: '#6c757d',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '0.75rem 1.5rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '1rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer'\r\n                }}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={confirmDeployment}\r\n                style={{\r\n                  background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '0.75rem 1.5rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '1rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer'\r\n                }}\r\n              >\r\n                Confirm Deploy\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* SECTION 3: Live Deployment Status */}\r\n      <div style={{ \r\n        background: isDark ? '#2d2d2d' : 'white', \r\n        borderRadius: '12px', \r\n        padding: '2rem',\r\n        marginBottom: '2rem',\r\n        boxShadow: isDark ? '0 2px 8px rgba(0,0,0,0.3)' : '0 2px 8px rgba(0,0,0,0.08)',\r\n        border: isDark ? '1px solid #404040' : '1px solid #e1e8ed'\r\n      }}>\r\n        <h2 style={{ \r\n          fontSize: '1.5rem', \r\n          fontWeight: '600', \r\n          color: isDark ? '#e0e0e0' : '#2c3e50',\r\n          marginBottom: '1.5rem',\r\n          paddingBottom: '0.75rem',\r\n          borderBottom: isDark ? '2px solid #404040' : '2px solid #e1e8ed',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: '0.5rem'\r\n        }}>\r\n          <span style={{ fontSize: '1.25rem' }}></span>\r\n          Live Deployment Status\r\n          {loadingDevices && (\r\n            <span style={{ fontSize: '0.85rem', color: isDark ? '#a0a0a0' : '#6c757d', fontWeight: '400', marginLeft: 'auto' }}>\r\n              Loading devices...\r\n            </span>\r\n          )}\r\n        </h2>\r\n\r\n        {/* Loading or No Devices State */}\r\n        {loadingDevices ? (\r\n          <div style={{\r\n            textAlign: 'center',\r\n            padding: '3rem 1rem',\r\n            color: isDark ? '#a0a0a0' : '#6c757d'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', marginBottom: '1rem' }}></div>\r\n            <p style={{ fontSize: '1.1rem' }}>Loading devices from backend...</p>\r\n          </div>\r\n        ) : devices.length === 0 ? (\r\n          <div style={{\r\n            textAlign: 'center',\r\n            padding: '3rem 1rem',\r\n            color: isDark ? '#a0a0a0' : '#6c757d'\r\n          }}>\r\n            <div style={{ fontSize: '3rem', marginBottom: '1rem' }}></div>\r\n            <p style={{ fontSize: '1.1rem', marginBottom: '0.5rem' }}>No devices registered yet</p>\r\n            <p style={{ fontSize: '0.9rem' }}>Register devices to see them here</p>\r\n          </div>\r\n        ) : (\r\n          <>\r\n            {/* Active Deployment Banner */}\r\n            {activeDeployment && (\r\n              <div style={{\r\n                background: activeDeployment.status === 'in_progress' \r\n                  ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' \r\n                  : isDark ? '#2a4a2a' : '#d4edda',\r\n                color: activeDeployment.status === 'in_progress' ? 'white' : isDark ? '#90ee90' : '#155724',\r\n                padding: '1.5rem',\r\n                borderRadius: '12px',\r\n                marginBottom: '2rem',\r\n                border: activeDeployment.status === 'in_progress' \r\n                  ? 'none' \r\n                  : isDark ? '1px solid #4a6a4a' : '1px solid #c3e6cb'\r\n              }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '0.75rem' }}>\r\n                  <h3 style={{ fontSize: '1.1rem', fontWeight: '600', margin: 0 }}>\r\n                    {activeDeployment.status === 'in_progress' ? ' Active Deployment' : ' Deployment Completed'}\r\n                  </h3>\r\n                  <span style={{ \r\n                    fontSize: '0.85rem', \r\n                    padding: '0.25rem 0.75rem', \r\n                    background: 'rgba(255,255,255,0.2)', \r\n                    borderRadius: '20px' \r\n                  }}>\r\n                    ID: {activeDeployment.id}\r\n                  </span>\r\n                </div>\r\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem', fontSize: '0.9rem' }}>\r\n                  <div>\r\n                    <strong>Firmware:</strong> {activeDeployment.target_firmware?.version || 'N/A'}\r\n                  </div>\r\n                  <div>\r\n                    <strong>Total Devices:</strong> {activeDeployment.devices_total || 0}\r\n                  </div>\r\n                  <div>\r\n                    <strong>Updated:</strong> {activeDeployment.devices_updated || 0}\r\n                  </div>\r\n                  <div>\r\n                    <strong>Failed:</strong> {activeDeployment.devices_failed || 0}\r\n                  </div>\r\n                  <div>\r\n                    <strong>Progress:</strong> {activeDeployment.devices_total > 0 \r\n                      ? `${Math.round((activeDeployment.devices_updated / activeDeployment.devices_total) * 100)}%`\r\n                      : '0%'}\r\n                  </div>\r\n                  <div>\r\n                    <strong>Started:</strong> {new Date(activeDeployment.created_at).toLocaleString()}\r\n                  </div>\r\n                </div>\r\n                {activeDeployment.notes && (\r\n                  <div style={{ marginTop: '1rem', fontSize: '0.85rem', opacity: 0.9 }}>\r\n                    <strong>Notes:</strong> {activeDeployment.notes}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n            \r\n            {/* Summary Metrics */}\r\n        <div style={{ \r\n          display: 'grid', \r\n          gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', \r\n          gap: '1rem',\r\n          marginBottom: '2rem'\r\n        }}>\r\n          <div style={{\r\n            background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n            color: 'white',\r\n            padding: '1.25rem',\r\n            borderRadius: '12px',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: '700', marginBottom: '0.25rem' }}>{statusMetrics.total}</div>\r\n            <div style={{ fontSize: '0.85rem', opacity: 0.9 }}>Total Devices</div>\r\n          </div>\r\n          \r\n          <div style={{\r\n            background: '#17a2b8',\r\n            color: 'white',\r\n            padding: '1.25rem',\r\n            borderRadius: '12px',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: '700', marginBottom: '0.25rem' }}>{statusMetrics.inProgress}</div>\r\n            <div style={{ fontSize: '0.85rem', opacity: 0.9 }}>In Progress</div>\r\n          </div>\r\n          \r\n          <div style={{\r\n            background: '#28a745',\r\n            color: 'white',\r\n            padding: '1.25rem',\r\n            borderRadius: '12px',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: '700', marginBottom: '0.25rem' }}>{statusMetrics.healthy}</div>\r\n            <div style={{ fontSize: '0.85rem', opacity: 0.9 }}>Healthy</div>\r\n          </div>\r\n          \r\n          <div style={{\r\n            background: '#dc3545',\r\n            color: 'white',\r\n            padding: '1.25rem',\r\n            borderRadius: '12px',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: '700', marginBottom: '0.25rem' }}>{statusMetrics.failed}</div>\r\n            <div style={{ fontSize: '0.85rem', opacity: 0.9 }}>Failed</div>\r\n          </div>\r\n          \r\n          <div style={{\r\n            background: '#6610f2',\r\n            color: 'white',\r\n            padding: '1.25rem',\r\n            borderRadius: '12px',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: '700', marginBottom: '0.25rem' }}>{statusMetrics.rolledBack}</div>\r\n            <div style={{ fontSize: '0.85rem', opacity: 0.9 }}>Rolled Back</div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Status Filter */}\r\n        <div style={{ marginBottom: '1rem', display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>\r\n          {['all', 'idle', 'downloading', 'flashing', 'rebooting', 'trial', 'healthy', 'failed', 'rolledback'].map(status => (\r\n            <button\r\n              key={status}\r\n              onClick={() => setStatusFilter(status as any)}\r\n              style={{\r\n                background: statusFilter === status ? '#667eea' : (isDark ? '#242424' : '#f8f9fa'),\r\n                color: statusFilter === status ? 'white' : (isDark ? '#e0e0e0' : '#495057'),\r\n                border: isDark ? '1px solid #404040' : '1px solid #dee2e6',\r\n                padding: '0.5rem 1rem',\r\n                borderRadius: '20px',\r\n                fontSize: '0.85rem',\r\n                fontWeight: '500',\r\n                cursor: 'pointer',\r\n                textTransform: 'capitalize'\r\n              }}\r\n            >\r\n              {status}\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Device Status Table */}\r\n        <div style={{ overflowX: 'auto', maxHeight: '500px', overflowY: 'auto' }}>\r\n          <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.9rem' }}>\r\n            <thead style={{ position: 'sticky', top: 0, background: isDark ? '#242424' : '#f8f9fa', zIndex: 1 }}>\r\n              <tr style={{ borderBottom: isDark ? '2px solid #404040' : '2px solid #dee2e6' }}>\r\n                <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057' }}>Device ID</th>\r\n                <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057' }}>Current</th>\r\n                <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057' }}>Target</th>\r\n                <th style={{ padding: '0.75rem', textAlign: 'center', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057' }}>Slot</th>\r\n                <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057' }}>Status</th>\r\n                <th style={{ padding: '0.75rem', textAlign: 'center', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057' }}>Boot Count</th>\r\n                <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057' }}>Last Error</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {filteredDevices.map(device => (\r\n                <tr key={device.deviceId} style={{ borderBottom: isDark ? '1px solid #404040' : '1px solid #e9ecef' }}>\r\n                  <td style={{ padding: '0.75rem', fontFamily: 'monospace', fontWeight: '500' }}>{device.deviceId}</td>\r\n                  <td style={{ padding: '0.75rem', fontFamily: 'monospace', fontSize: '0.85rem' }}>{device.currentVersion}</td>\r\n                  <td style={{ padding: '0.75rem', fontFamily: 'monospace', fontSize: '0.85rem' }}>{device.targetVersion}</td>\r\n                  <td style={{ padding: '0.75rem', textAlign: 'center' }}>\r\n                    <span style={{\r\n                      background: device.activeSlot === 'A' ? '#e3f2fd' : '#fff3e0',\r\n                      color: device.activeSlot === 'A' ? '#1976d2' : '#f57c00',\r\n                      padding: '0.25rem 0.5rem',\r\n                      borderRadius: '6px',\r\n                      fontWeight: '600',\r\n                      fontSize: '0.75rem'\r\n                    }}>\r\n                      {device.activeSlot}\r\n                    </span>\r\n                  </td>\r\n                  <td style={{ padding: '0.75rem' }}>\r\n                    <span style={getStatusBadgeStyle(device.status)}>\r\n                      {device.status}\r\n                    </span>\r\n                    {device.progress !== undefined && (\r\n                      <div style={{ marginTop: '0.25rem', fontSize: '0.75rem', color: isDark ? '#a0a0a0' : '#6c757d' }}>\r\n                        {device.progress.toFixed(0)}%\r\n                      </div>\r\n                    )}\r\n                  </td>\r\n                  <td style={{ padding: '0.75rem', textAlign: 'center', fontSize: '0.9rem' }}>{device.bootCount}</td>\r\n                  <td style={{ padding: '0.75rem', fontSize: '0.85rem', color: device.lastError ? '#dc3545' : (isDark ? '#a0a0a0' : '#6c757d') }}>\r\n                    {device.lastError || '-'}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n          </>\r\n        )}\r\n      </div>\r\n\r\n      {/* SECTION 4: Emergency Rollback */}\r\n      <div style={{ \r\n        background: isDark ? '#2d2d2d' : 'white', \r\n        borderRadius: '12px', \r\n        padding: '2rem',\r\n        boxShadow: isDark ? '0 2px 8px rgba(0,0,0,0.3)' : '0 2px 8px rgba(0,0,0,0.08)',\r\n        border: isDark ? '2px solid #dc3545' : '2px solid #dc3545'\r\n      }}>\r\n        <h2 style={{ \r\n          fontSize: '1.5rem', \r\n          fontWeight: '600', \r\n          color: '#dc3545',\r\n          marginBottom: '1rem',\r\n          paddingBottom: '0.75rem',\r\n          borderBottom: isDark ? '2px solid #5a1f24' : '2px solid #f8d7da',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: '0.5rem'\r\n        }}>\r\n          <span style={{ fontSize: '1.25rem' }}></span>\r\n          Emergency Rollback\r\n        </h2>\r\n        \r\n        <div style={{\r\n          background: isDark ? '#3d1a1a' : '#f8d7da',\r\n          border: isDark ? '1px solid #5a1f24' : '1px solid #f5c6cb',\r\n          borderRadius: '8px',\r\n          padding: '1rem',\r\n          marginBottom: '1.5rem',\r\n          color: isDark ? '#ff9999' : '#721c24'\r\n        }}>\r\n          <strong> Warning:</strong> Use this feature only in emergency situations. Rollback command will revert devices to their previous firmware version automatically.\r\n        </div>\r\n\r\n        <div style={{ marginBottom: '1.5rem', padding: '1rem', background: isDark ? '#1a2a3a' : '#e7f3ff', border: isDark ? '1px solid #2a4a6a' : '1px solid #b3d9ff', borderRadius: '8px', color: isDark ? '#66b2ff' : '#004085' }}>\r\n          <strong> How it works:</strong> The rollback sends an <code style={{ background: isDark ? '#0d1117' : '#fff', padding: '0.2rem 0.5rem', borderRadius: '4px', fontFamily: 'monospace', color: isDark ? '#e0e0e0' : 'inherit' }}>updateConfig</code> command with value <code style={{ background: isDark ? '#0d1117' : '#fff', padding: '0.2rem 0.5rem', borderRadius: '4px', fontFamily: 'monospace', color: isDark ? '#e0e0e0' : 'inherit' }}>2</code> to selected devices, triggering them to automatically revert to their previous firmware version.\r\n        </div>\r\n\r\n        <div>\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n              Rollback Reason *\r\n            </label>\r\n            <textarea\r\n              value={rollbackForm.reason}\r\n              onChange={(e) => setRollbackForm({ ...rollbackForm, reason: e.target.value })}\r\n              placeholder=\"Reason for emergency rollback...\"\r\n              rows={3}\r\n              style={{ \r\n                width: '100%', \r\n                padding: '0.75rem', \r\n                borderRadius: '6px', \r\n                border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                fontSize: '0.95rem',\r\n                fontFamily: 'inherit',\r\n                resize: 'vertical',\r\n                background: isDark ? '#1a1a1a' : 'white',\r\n                color: isDark ? '#e0e0e0' : 'inherit'\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Device Selection Filters */}\r\n        <div style={{ marginTop: '1.5rem' }}>\r\n          <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1rem', color: isDark ? '#e0e0e0' : '#495057' }}>\r\n            Device Selection & Filters\r\n          </h3>\r\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem', marginBottom: '1rem' }}>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>\r\n                Filter by Current Version\r\n              </label>\r\n              <select\r\n                value={rollbackFilters.currentVersion}\r\n                onChange={(e) => setRollbackFilters({ ...rollbackFilters, currentVersion: e.target.value })}\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.5rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.9rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              >\r\n                <option value=\"all\">All Versions</option>\r\n                {Array.from(new Set(devices.map(d => d.currentVersion))).map(version => (\r\n                  <option key={version} value={version}>{version}</option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>\r\n                Filter by Status\r\n              </label>\r\n              <select\r\n                value={rollbackFilters.status}\r\n                onChange={(e) => setRollbackFilters({ ...rollbackFilters, status: e.target.value })}\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.5rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.9rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              >\r\n                <option value=\"all\">All Statuses</option>\r\n                <option value=\"failed\">Failed</option>\r\n                <option value=\"healthy\">Healthy</option>\r\n                <option value=\"trial\">Trial</option>\r\n                <option value=\"downloading\">Downloading</option>\r\n                <option value=\"flashing\">Flashing</option>\r\n                <option value=\"rebooting\">Rebooting</option>\r\n                <option value=\"rolledback\">Rolled Back</option>\r\n                <option value=\"idle\">Idle</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>\r\n                Filter by Target Version\r\n              </label>\r\n              <select\r\n                value={rollbackFilters.deviceModel}\r\n                onChange={(e) => setRollbackFilters({ ...rollbackFilters, deviceModel: e.target.value })}\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.5rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.9rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              >\r\n                <option value=\"all\">All Target Versions</option>\r\n                {Array.from(new Set(devices.map(d => d.targetVersion))).map(version => (\r\n                  <option key={version} value={version}>{version}</option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Quick Selection Buttons */}\r\n          <div style={{ display: 'flex', gap: '0.75rem', flexWrap: 'wrap', marginBottom: '1rem' }}>\r\n            <button\r\n              onClick={selectAllFilteredDevices}\r\n              style={{\r\n                background: '#007bff',\r\n                color: 'white',\r\n                border: 'none',\r\n                padding: '0.5rem 1rem',\r\n                borderRadius: '6px',\r\n                fontSize: '0.85rem',\r\n                fontWeight: '600',\r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              Select All Filtered ({getFilteredRollbackDevices().length})\r\n            </button>\r\n\r\n            <button\r\n              onClick={deselectAllDevices}\r\n              style={{\r\n                background: '#6c757d',\r\n                color: 'white',\r\n                border: 'none',\r\n                padding: '0.5rem 1rem',\r\n                borderRadius: '6px',\r\n                fontSize: '0.85rem',\r\n                fontWeight: '600',\r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              Deselect All\r\n            </button>\r\n\r\n            <button\r\n              onClick={() => {\r\n                const failedDevices = devices.filter(d => d.status === 'failed').map(d => d.deviceId);\r\n                setRollbackForm({ ...rollbackForm, selectedDevices: failedDevices });\r\n              }}\r\n              style={{\r\n                background: '#ffc107',\r\n                color: '#000',\r\n                border: 'none',\r\n                padding: '0.5rem 1rem',\r\n                borderRadius: '6px',\r\n                fontSize: '0.85rem',\r\n                fontWeight: '600',\r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              Select Failed Only ({devices.filter(d => d.status === 'failed').length})\r\n            </button>\r\n\r\n            <button\r\n              onClick={() => {\r\n                const problemDevices = devices.filter(d => ['failed', 'rolledback'].includes(d.status)).map(d => d.deviceId);\r\n                setRollbackForm({ ...rollbackForm, selectedDevices: problemDevices });\r\n              }}\r\n              style={{\r\n                background: '#fd7e14',\r\n                color: 'white',\r\n                border: 'none',\r\n                padding: '0.5rem 1rem',\r\n                borderRadius: '6px',\r\n                fontSize: '0.85rem',\r\n                fontWeight: '600',\r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              Select Problem Devices ({devices.filter(d => ['failed', 'rolledback'].includes(d.status)).length})\r\n            </button>\r\n          </div>\r\n\r\n          {/* Device Selection Table */}\r\n          <div style={{ \r\n            background: isDark ? '#242424' : '#f8f9fa', \r\n            borderRadius: '8px', \r\n            padding: '1rem',\r\n            border: isDark ? '1px solid #404040' : '1px solid #dee2e6',\r\n            maxHeight: '400px',\r\n            overflowY: 'auto'\r\n          }}>\r\n            <div style={{ marginBottom: '0.75rem', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n              <strong style={{ fontSize: '0.95rem', color: isDark ? '#e0e0e0' : 'inherit' }}>\r\n                Devices List ({getFilteredRollbackDevices().length} available, {rollbackForm.selectedDevices.length} selected)\r\n              </strong>\r\n            </div>\r\n            \r\n            {loadingDevices ? (\r\n              <div style={{ padding: '2rem', textAlign: 'center', color: isDark ? '#a0a0a0' : '#6c757d' }}>\r\n                Loading devices...\r\n              </div>\r\n            ) : getFilteredRollbackDevices().length === 0 ? (\r\n              <div style={{ padding: '2rem', textAlign: 'center', color: isDark ? '#a0a0a0' : '#6c757d' }}>\r\n                No devices match the current filters\r\n              </div>\r\n            ) : (\r\n              <table style={{ width: '100%', fontSize: '0.85rem' }}>\r\n                <thead>\r\n                  <tr style={{ borderBottom: isDark ? '2px solid #404040' : '2px solid #dee2e6' }}>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', fontWeight: '600', width: '50px', color: isDark ? '#b0b0b0' : 'inherit' }}>\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={getFilteredRollbackDevices().length > 0 && getFilteredRollbackDevices().every(d => rollbackForm.selectedDevices.includes(d.deviceId))}\r\n                        onChange={(e) => {\r\n                          if (e.target.checked) {\r\n                            selectAllFilteredDevices();\r\n                          } else {\r\n                            deselectAllDevices();\r\n                          }\r\n                        }}\r\n                        style={{ cursor: 'pointer', width: '16px', height: '16px' }}\r\n                      />\r\n                    </th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : 'inherit' }}>Device ID</th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : 'inherit' }}>Current Version</th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : 'inherit' }}>Target Version</th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : 'inherit' }}>Status</th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : 'inherit' }}>Boot Count</th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : 'inherit' }}>Last Error</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {getFilteredRollbackDevices().map(device => (\r\n                    <tr \r\n                      key={device.deviceId} \r\n                      style={{ \r\n                        borderBottom: isDark ? '1px solid #404040' : '1px solid #e9ecef',\r\n                        background: rollbackForm.selectedDevices.includes(device.deviceId) ? (isDark ? '#3a2a00' : '#fff3cd') : 'transparent',\r\n                        cursor: 'pointer'\r\n                      }}\r\n                      onClick={() => toggleRollbackDevice(device.deviceId)}\r\n                    >\r\n                      <td style={{ padding: '0.75rem 0.5rem' }}>\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={rollbackForm.selectedDevices.includes(device.deviceId)}\r\n                          onChange={() => toggleRollbackDevice(device.deviceId)}\r\n                          onClick={(e) => e.stopPropagation()}\r\n                          style={{ cursor: 'pointer', width: '16px', height: '16px' }}\r\n                        />\r\n                      </td>\r\n                      <td style={{ padding: '0.75rem 0.5rem', fontFamily: 'monospace', fontWeight: '500' }}>{device.deviceId}</td>\r\n                      <td style={{ padding: '0.75rem 0.5rem', fontFamily: 'monospace' }}>{device.currentVersion}</td>\r\n                      <td style={{ padding: '0.75rem 0.5rem', fontFamily: 'monospace' }}>{device.targetVersion}</td>\r\n                      <td style={{ padding: '0.75rem 0.5rem' }}>\r\n                        <span style={{\r\n                          padding: '0.25rem 0.5rem',\r\n                          borderRadius: '4px',\r\n                          fontSize: '0.75rem',\r\n                          fontWeight: '600',\r\n                          background: device.status === 'failed' ? (isDark ? '#3d1a1a' : '#f8d7da') : \r\n                                     device.status === 'healthy' ? (isDark ? '#1a3d1a' : '#d4edda') : \r\n                                     device.status === 'downloading' || device.status === 'flashing' ? (isDark ? '#1a2a3a' : '#cce5ff') :\r\n                                     device.status === 'rolledback' ? (isDark ? '#3a2a00' : '#fff3cd') : (isDark ? '#2a2a2a' : '#e9ecef'),\r\n                          color: device.status === 'failed' ? (isDark ? '#ff9999' : '#721c24') : \r\n                                 device.status === 'healthy' ? (isDark ? '#99ff99' : '#155724') : \r\n                                 device.status === 'downloading' || device.status === 'flashing' ? (isDark ? '#66b2ff' : '#004085') :\r\n                                 device.status === 'rolledback' ? (isDark ? '#ffd966' : '#856404') : (isDark ? '#b0b0b0' : '#495057')\r\n                        }}>\r\n                          {device.status}\r\n                        </span>\r\n                      </td>\r\n                      <td style={{ padding: '0.75rem 0.5rem' }}>{device.bootCount}</td>\r\n                      <td style={{ padding: '0.75rem 0.5rem', color: device.lastError ? '#dc3545' : (isDark ? '#a0a0a0' : '#6c757d'), fontSize: '0.8rem' }}>\r\n                        {device.lastError || 'None'}\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Rollback Action Button */}\r\n        <div style={{ marginTop: '1.5rem', display: 'flex', justifyContent: 'flex-end' }}>\r\n          <button\r\n            onClick={handleEmergencyRollback}\r\n            disabled={rollbackForm.selectedDevices.length === 0}\r\n            style={{\r\n              background: rollbackForm.selectedDevices.length === 0 ? '#6c757d' : '#dc3545',\r\n              color: 'white',\r\n              border: 'none',\r\n              padding: '0.75rem 2rem',\r\n              borderRadius: '8px',\r\n              fontSize: '1rem',\r\n              fontWeight: '600',\r\n              cursor: rollbackForm.selectedDevices.length === 0 ? 'not-allowed' : 'pointer',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              opacity: rollbackForm.selectedDevices.length === 0 ? 0.6 : 1\r\n            }}\r\n          >\r\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n              <polyline points=\"1 4 1 10 7 10\"/>\r\n              <path d=\"M3.51 15a9 9 0 1 0 2.13-9.36L1 10\"/>\r\n            </svg>\r\n            Rollback {rollbackForm.selectedDevices.length} Device{rollbackForm.selectedDevices.length !== 1 ? 's' : ''}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Rollback Confirmation Modal */}\r\n      {showRollbackModal && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: 'rgba(0,0,0,0.6)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          zIndex: 1000\r\n        }}>\r\n          <div style={{\r\n            background: isDark ? '#2d2d2d' : 'white',\r\n            borderRadius: '12px',\r\n            padding: '2rem',\r\n            maxWidth: '500px',\r\n            width: '90%',\r\n            boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n            border: isDark ? '2px solid #dc3545' : '2px solid #dc3545'\r\n          }}>\r\n            <h3 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1rem', color: '#dc3545' }}>\r\n               Confirm Emergency Rollback\r\n            </h3>\r\n            <div style={{\r\n              background: isDark ? '#3d1a1a' : '#f8d7da',\r\n              border: isDark ? '1px solid #5a1f24' : '1px solid #f5c6cb',\r\n              borderRadius: '8px',\r\n              padding: '1rem',\r\n              marginBottom: '1.5rem',\r\n              color: isDark ? '#ff9999' : '#721c24',\r\n              fontSize: '0.95rem'\r\n            }}>\r\n              <strong>This action cannot be undone!</strong>\r\n              <p style={{ margin: '0.5rem 0 0 0' }}>\r\n                You are about to rollback devices to a previous firmware version.\r\n              </p>\r\n            </div>\r\n            <div style={{ marginBottom: '1.5rem', color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.8' }}>\r\n              <p><strong>Command:</strong> <code style={{ background: isDark ? '#1a1a1a' : '#f8f9fa', padding: '0.2rem 0.5rem', borderRadius: '4px', fontFamily: 'monospace', color: isDark ? '#e0e0e0' : 'inherit' }}>updateConfig = 2</code> (automatic rollback to previous version)</p>\r\n              <p><strong>Devices to Rollback:</strong> {rollbackForm.selectedDevices.length}</p>\r\n              <p><strong>Reason:</strong> {rollbackForm.reason || 'Not provided'}</p>\r\n            </div>\r\n            <div style={{ display: 'flex', gap: '1rem', justifyContent: 'flex-end' }}>\r\n              <button\r\n                onClick={() => setShowRollbackModal(false)}\r\n                style={{\r\n                  background: '#6c757d',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '0.75rem 1.5rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '1rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer'\r\n                }}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={confirmRollback}\r\n                style={{\r\n                  background: '#dc3545',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '0.75rem 1.5rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '1rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer'\r\n                }}\r\n              >\r\n                Confirm Rollback\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OTA;\r\n","/**\r\n * Enhanced in-memory cache service for API responses\r\n * Features:\r\n * - TTL-based expiration\r\n * - Stale-while-revalidate pattern support\r\n * - Subscription system for real-time updates\r\n * - Pattern-based cache invalidation\r\n */\r\n\r\ninterface CacheEntry {\r\n  data: any;\r\n  timestamp: number;\r\n  expiresIn: number; // milliseconds\r\n  staleTime?: number; // Time after which data is considered stale but usable\r\n}\r\n\r\ninterface CacheSubscription {\r\n  callback: (data: any) => void;\r\n  pattern?: RegExp;\r\n}\r\n\r\nclass CacheService {\r\n  private cache: Map<string, CacheEntry> = new Map();\r\n  private subscribers: Map<string, Set<CacheSubscription>> = new Map();\r\n  private static readonly DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes default\r\n  private static readonly LONG_TTL = 30 * 60 * 1000; // 30 minutes for static data\r\n  private static readonly REALTIME_TTL = 10 * 1000; // 10 seconds for real-time data\r\n  private static readonly STALE_TIME = 30 * 1000; // 30 seconds before data is stale\r\n\r\n  /**\r\n   * Set a cache entry and notify subscribers\r\n   */\r\n  set(key: string, data: any, ttlMs: number = CacheService.DEFAULT_TTL, staleTime?: number): void {\r\n    this.cache.set(key, {\r\n      data,\r\n      timestamp: Date.now(),\r\n      expiresIn: ttlMs,\r\n      staleTime: staleTime ?? Math.min(ttlMs / 2, CacheService.STALE_TIME),\r\n    });\r\n    \r\n    // Notify subscribers\r\n    this.notifySubscribers(key, data);\r\n  }\r\n\r\n  /**\r\n   * Get a cache entry if valid (returns null if expired)\r\n   */\r\n  get(key: string): any | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    // Check if expired\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return entry.data;\r\n  }\r\n\r\n  /**\r\n   * Get cache entry even if stale (for stale-while-revalidate pattern)\r\n   * Returns { data, isStale } or null if no entry exists\r\n   */\r\n  getWithStaleStatus(key: string): { data: any; isStale: boolean; isExpired: boolean } | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    const now = Date.now();\r\n    const age = now - entry.timestamp;\r\n    const isExpired = age > entry.expiresIn;\r\n    const isStale = age > (entry.staleTime ?? entry.expiresIn / 2);\r\n\r\n    // Remove if fully expired\r\n    if (isExpired) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      data: entry.data,\r\n      isStale,\r\n      isExpired: false,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Check if key exists and is not expired\r\n   */\r\n  has(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return false;\r\n\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Check if cached data is stale but usable\r\n   */\r\n  isStale(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return true;\r\n\r\n    const now = Date.now();\r\n    const age = now - entry.timestamp;\r\n    return age > (entry.staleTime ?? entry.expiresIn / 2);\r\n  }\r\n\r\n  /**\r\n   * Clear a specific cache entry\r\n   */\r\n  clear(key: string): void {\r\n    this.cache.delete(key);\r\n  }\r\n\r\n  /**\r\n   * Clear cache entries matching a pattern\r\n   */\r\n  clearPattern(pattern: string | RegExp): void {\r\n    const regex = typeof pattern === 'string' ? new RegExp(pattern) : pattern;\r\n    const keysToDelete: string[] = [];\r\n    \r\n    this.cache.forEach((_, key) => {\r\n      if (regex.test(key)) {\r\n        keysToDelete.push(key);\r\n      }\r\n    });\r\n    \r\n    keysToDelete.forEach(key => this.cache.delete(key));\r\n  }\r\n\r\n  /**\r\n   * Clear all cache entries\r\n   */\r\n  clearAll(): void {\r\n    this.cache.clear();\r\n  }\r\n\r\n  /**\r\n   * Get cache size\r\n   */\r\n  size(): number {\r\n    return this.cache.size;\r\n  }\r\n\r\n  /**\r\n   * Subscribe to cache updates for a specific key\r\n   */\r\n  subscribe(key: string, callback: (data: any) => void): () => void {\r\n    if (!this.subscribers.has(key)) {\r\n      this.subscribers.set(key, new Set());\r\n    }\r\n    \r\n    const subscription: CacheSubscription = { callback };\r\n    this.subscribers.get(key)!.add(subscription);\r\n\r\n    // Return unsubscribe function\r\n    return () => {\r\n      const subs = this.subscribers.get(key);\r\n      if (subs) {\r\n        subs.delete(subscription);\r\n        if (subs.size === 0) {\r\n          this.subscribers.delete(key);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Subscribe to cache updates matching a pattern\r\n   */\r\n  subscribePattern(pattern: RegExp, callback: (data: any) => void): () => void {\r\n    const key = `__pattern__${pattern.source}`;\r\n    if (!this.subscribers.has(key)) {\r\n      this.subscribers.set(key, new Set());\r\n    }\r\n    \r\n    const subscription: CacheSubscription = { callback, pattern };\r\n    this.subscribers.get(key)!.add(subscription);\r\n\r\n    return () => {\r\n      const subs = this.subscribers.get(key);\r\n      if (subs) {\r\n        subs.delete(subscription);\r\n        if (subs.size === 0) {\r\n          this.subscribers.delete(key);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Notify all subscribers of a cache update\r\n   */\r\n  private notifySubscribers(key: string, data: any): void {\r\n    // Direct key subscribers\r\n    const directSubs = this.subscribers.get(key);\r\n    if (directSubs) {\r\n      directSubs.forEach(sub => {\r\n        try {\r\n          sub.callback(data);\r\n        } catch (error) {\r\n          console.error(`Cache subscriber error for key ${key}:`, error);\r\n        }\r\n      });\r\n    }\r\n\r\n    // Pattern subscribers\r\n    this.subscribers.forEach((subs, subKey) => {\r\n      if (subKey.startsWith('__pattern__')) {\r\n        subs.forEach(sub => {\r\n          if (sub.pattern && sub.pattern.test(key)) {\r\n            try {\r\n              sub.callback(data);\r\n            } catch (error) {\r\n              console.error(`Cache pattern subscriber error for key ${key}:`, error);\r\n            }\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get all keys in cache\r\n   */\r\n  keys(): string[] {\r\n    return Array.from(this.cache.keys());\r\n  }\r\n\r\n  /**\r\n   * Get cache stats for debugging\r\n   */\r\n  getStats(): { size: number; keys: string[]; subscribers: number } {\r\n    return {\r\n      size: this.cache.size,\r\n      keys: this.keys(),\r\n      subscribers: Array.from(this.subscribers.values()).reduce((sum, set) => sum + set.size, 0),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get TTL constants\r\n   */\r\n  static getTTL(type: 'short' | 'long' | 'realtime' = 'short'): number {\r\n    switch (type) {\r\n      case 'realtime':\r\n        return CacheService.REALTIME_TTL;\r\n      case 'long':\r\n        return CacheService.LONG_TTL;\r\n      default:\r\n        return CacheService.DEFAULT_TTL;\r\n    }\r\n  }\r\n}\r\n\r\nexport const cacheService = new CacheService();\r\nexport const DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes\r\nexport const LONG_TTL = 30 * 60 * 1000; // 30 minutes\r\nexport const REALTIME_TTL = 10 * 1000; // 10 seconds\r\n","import { cacheService, DEFAULT_TTL } from './cacheService';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'https://smart-solar-django-backend.vercel.app/api';\r\n\r\nclass ApiService {\r\n  private getAuthHeaders(): HeadersInit {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (tokens) {\r\n      try {\r\n        const parsedTokens = JSON.parse(tokens);\r\n        return {\r\n          'Authorization': `Bearer ${parsedTokens.access}`,\r\n          'Content-Type': 'application/json',\r\n        };\r\n      } catch (error) {\r\n        console.error('Error parsing auth tokens:', error);\r\n      }\r\n    }\r\n    return {\r\n      'Content-Type': 'application/json',\r\n    };\r\n  }\r\n\r\n  private async request(endpoint: string, options: RequestInit = {}): Promise<any> {\r\n    const url = `${API_BASE_URL}${endpoint}`;\r\n    let headers = this.getAuthHeaders();\r\n\r\n    let response = await fetch(url, {\r\n      ...options,\r\n      headers: {\r\n        ...headers,\r\n        ...options.headers,\r\n      },\r\n    });\r\n\r\n    if (response.status === 401) {\r\n      // Try to refresh token\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        // Retry with new token\r\n        headers = this.getAuthHeaders();\r\n        response = await fetch(url, {\r\n          ...options,\r\n          headers: {\r\n            ...headers,\r\n            ...options.headers,\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      // Token refresh failed or not attempted, logout\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`API request failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n    }\r\n\r\n    if (response.status === 204) return null;\r\n    return response.json();\r\n  }\r\n\r\n  private async refreshToken(): Promise<boolean> {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (!tokens) return false;\r\n\r\n    try {\r\n      const parsedTokens = JSON.parse(tokens);\r\n      const response = await fetch(`${API_BASE_URL}/auth/token/refresh/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ refresh: parsedTokens.refresh }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        const newTokens = {\r\n          access: data.access,\r\n          refresh: parsedTokens.refresh, // Keep the same refresh token\r\n        };\r\n        localStorage.setItem('authTokens', JSON.stringify(newTokens));\r\n        return true;\r\n      }\r\n    } catch (error) {\r\n      console.error('Token refresh failed:', error);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  async getConfiguration(): Promise<any> {\r\n    return this.request('/config/');\r\n  }\r\n\r\n  async getTelemetry(): Promise<any[]> {\r\n    return this.request('/telemetry/');\r\n  }\r\n\r\n  async provisionDevice(data: any): Promise<any> {\r\n    const response = await fetch(`${API_BASE_URL}/devices/provision`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n    if (!response.ok) {\r\n      throw new Error(`Provisioning failed: ${response.statusText}`);\r\n    }\r\n    return response.json();\r\n  }\r\n\r\n  async getAlerts(): Promise<any[]> {\r\n    const cacheKey = 'alerts';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/alerts/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getSystemHealth(): Promise<any> {\r\n    const cacheKey = 'system_health';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/health/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getKPIs(): Promise<any> {\r\n    const cacheKey = 'kpis';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/kpis/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getUsers(search?: string): Promise<any[]> {\r\n    const cacheKey = `users_${search || 'all'}`;\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    const data = await this.request(`/users/${params}`);\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async createUser(userData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(userData),\r\n    });\r\n    // Invalidate users cache\r\n    cacheService.clear('users_all');\r\n    cacheService.clearAll(); // Clear all cache for safety\r\n    return result;\r\n  }\r\n\r\n  async createEmployee(employeeData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ ...employeeData, is_staff: true }),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async getUserDevices(userId: number): Promise<any[]> {\r\n    return this.request(`/users/${userId}/devices/`);\r\n  }\r\n\r\n  async getUserSite(userId: number): Promise<any> {\r\n    return this.request(`/users/${userId}/site/`);\r\n  }\r\n\r\n  async createUserSite(userId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/users/${userId}/site/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async updateUserSite(userId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/users/${userId}/site/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async getDeviceSite(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/`);\r\n  }\r\n\r\n  async createDeviceSite(deviceId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async updateDeviceSite(deviceId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // DynamoDB site data\r\n  async getSiteTelemetry(siteId: string, params?: { start_date?: string; end_date?: string; days?: number }): Promise<any[]> {\r\n    const query = new URLSearchParams();\r\n    if (params?.start_date) query.append('start_date', params.start_date);\r\n    if (params?.end_date) query.append('end_date', params.end_date);\r\n    if (params?.days) query.append('days', params.days.toString());\r\n    const url = `/sites/${siteId}/telemetry/${query.toString() ? '?' + query.toString() : ''}`;\r\n    return this.request(url);\r\n  }\r\n\r\n  async getSiteForecast(siteId: string, params?: { date?: string; start_date?: string; end_date?: string }): Promise<any[]> {\r\n    const query = new URLSearchParams();\r\n    if (params?.date) query.append('date', params.date);\r\n    if (params?.start_date) query.append('start_date', params.start_date);\r\n    if (params?.end_date) query.append('end_date', params.end_date);\r\n    const url = `/sites/${siteId}/forecast/${query.toString() ? '?' + query.toString() : ''}`;\r\n    return this.request(url);\r\n  }\r\n\r\n  async getSiteWeather(siteId: string): Promise<any> {\r\n    return this.request(`/sites/${siteId}/weather/`);\r\n  }\r\n\r\n  async updateUser(userId: number, data: any): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async deleteUser(userId: number): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  // Profile Management (for current logged-in user)\r\n  async getProfile(): Promise<any> {\r\n    return this.request('/profile/');\r\n  }\r\n\r\n  async updateProfile(data: any): Promise<any> {\r\n    return this.request('/profile/update/', {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async changePassword(data: { current_password: string; new_password: string }): Promise<any> {\r\n    return this.request('/profile/change-password/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // Customer Management (separate from staff users/employees)\r\n  async getCustomers(search?: string): Promise<any[]> {\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    return this.request(`/customers/${params}`);\r\n  }\r\n\r\n  async createCustomer(customerData: any): Promise<any> {\r\n    return this.request('/customers/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(customerData),\r\n    });\r\n  }\r\n\r\n  async getCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/`);\r\n  }\r\n\r\n  async updateCustomer(customerId: number, data: any): Promise<any> {\r\n    return this.request(`/customers/${customerId}/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getPresets(): Promise<any[]> {\r\n    const cacheKey = 'presets';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/presets/');\r\n    // Use longer TTL for presets as they change less frequently\r\n    cacheService.set(cacheKey, data, 30 * 60 * 1000); // 30 minutes\r\n    return data;\r\n  }\r\n\r\n  async createPreset(data: any): Promise<any> {\r\n    const result = await this.request('/presets/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async updatePreset(id: number, data: any): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async deletePreset(id: number): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async getGlobalSlaves(): Promise<any[]> {\r\n    return this.request('/slaves/');\r\n  }\r\n\r\n  async createGlobalSlave(slaveData: any): Promise<any> {\r\n    return this.request('/slaves/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateGlobalSlave(slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteGlobalSlave(slaveId: number): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getDevices(search?: string, page: number = 1, pageSize: number = 25): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    if (search) params.append('search', search);\r\n    params.append('page', page.toString());\r\n    params.append('page_size', pageSize.toString());\r\n    \r\n    const queryString = params.toString();\r\n    return this.request(`/devices/?${queryString}`);\r\n  }\r\n\r\n  async createDevice(deviceData: any): Promise<any> {\r\n    return this.request('/devices/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(deviceData),\r\n    });\r\n  }\r\n\r\n  async updateDevice(deviceId: number, data: any): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async rebootDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/reboot/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  async hardResetDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/hard-reset/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  async getDeviceLogs(deviceId: number, limit: number = 100, offset: number = 0): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/logs/?limit=${limit}&offset=${offset}`);\r\n  }\r\n\r\n  async toggleDeviceLogs(deviceId: number, enabled: boolean): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/logs/toggle/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ enabled }),\r\n    });\r\n  }\r\n\r\n  async deleteDevicesBulk(deviceIds: number[]): Promise<any> {\r\n    return this.request(`/devices/delete-bulk/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ device_ids: deviceIds }),\r\n    });\r\n  }\r\n\r\n  async getSlaves(configId: string): Promise<any[]> {\r\n    return this.request(`/presets/${configId}/slaves/`);\r\n  }\r\n\r\n  async createSlave(configId: string, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/create/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateSlave(configId: string, slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteSlave(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async addSlavesToPreset(configId: string, slaveIds: number[]): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/add/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ slave_ids: slaveIds }),\r\n    });\r\n  }\r\n\r\n  async detachSlaveFromPreset(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/detach/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  // OTA (Over-The-Air) Update Endpoints\r\n  async getFirmwareVersions(activeOnly: boolean = true): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    params.append('active', activeOnly.toString());\r\n    return this.request(`/ota/firmware/?${params.toString()}`);\r\n  }\r\n\r\n  async uploadFirmwareVersion(formData: FormData): Promise<any> {\r\n    const url = `${API_BASE_URL}/ota/firmware/create/`;\r\n    const tokens = localStorage.getItem('authTokens');\r\n    \r\n    if (!tokens) {\r\n      throw new Error('Authentication required');\r\n    }\r\n    \r\n    const parsedTokens = JSON.parse(tokens);\r\n    let headers: HeadersInit = {\r\n      'Authorization': `Bearer ${parsedTokens.access}`,\r\n    };\r\n    // Don't set Content-Type - let browser set it with boundary for multipart/form-data\r\n    \r\n    let response = await fetch(url, {\r\n      method: 'POST',\r\n      headers,\r\n      body: formData,\r\n    });\r\n\r\n    // Handle 401 with token refresh\r\n    if (response.status === 401) {\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        const newTokens = JSON.parse(localStorage.getItem('authTokens') || '{}');\r\n        headers = {\r\n          'Authorization': `Bearer ${newTokens.access}`,\r\n        };\r\n        response = await fetch(url, {\r\n          method: 'POST',\r\n          headers,\r\n          body: formData,\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`Upload failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  async updateFirmwareVersion(firmwareId: number, data: any): Promise<any> {\r\n    return this.request(`/ota/firmware/${firmwareId}/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteFirmwareVersion(firmwareId: number): Promise<any> {\r\n    return this.request(`/ota/firmware/${firmwareId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getDeviceUpdateLogs(deviceId: string): Promise<any> {\r\n    return this.request(`/ota/devices/${deviceId}/logs`);\r\n  }\r\n\r\n  async getOTAConfig(): Promise<any> {\r\n    return this.request(`/ota/config/`);\r\n  }\r\n\r\n  async updateOTAConfig(config: any): Promise<any> {\r\n    return this.request(`/ota/config/update/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(config),\r\n    });\r\n  }\r\n\r\n  async getOTAHealth(): Promise<any> {\r\n    return this.request(`/ota/health/`);\r\n  }\r\n\r\n  async triggerRollback(deviceSerial: string, notes?: string): Promise<any> {\r\n    return this.request(`/ota/updates/rollback/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        device_serial: deviceSerial,\r\n        notes: notes || ''\r\n      }),\r\n    });\r\n  }\r\n\r\n  async deployFirmware(firmwareId: number, deviceSerials: string[], notes?: string): Promise<any> {\r\n    return this.request(`/ota/updates/multiple/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        firmware_id: firmwareId,\r\n        device_serials: deviceSerials,\r\n        notes: notes || ''\r\n      }),\r\n    });\r\n  }\r\n\r\n  async listTargetedUpdates(): Promise<any> {\r\n    return this.request(`/ota/updates/`);\r\n  }\r\n\r\n  async getTargetedUpdate(updateId: number): Promise<any> {\r\n    return this.request(`/ota/updates/${updateId}/`);\r\n  }\r\n}\r\n\r\nexport const apiService = new ApiService();"],"names":["OTA","_activeDeployment$tar","isDark","useTheme","firmwares","setFirmwares","useState","uploadForm","setUploadForm","name","version","deviceModel","minBootloader","releaseNotes","file","deploymentConfig","setDeploymentConfig","firmwareVersion","targetDevices","mode","autoRollback","healthTimeout","failureThreshold","confirmModal","setConfirmModal","show","firmware","deviceCount","dataTransfer","isDeploying","setIsDeploying","devices","setDevices","statusFilter","setStatusFilter","loadingDevices","setLoadingDevices","loadingFirmwares","setLoadingFirmwares","activeDeployment","setActiveDeployment","rollbackForm","setRollbackForm","selectedDevices","reason","showRollbackModal","setShowRollbackModal","rollbackFilters","setRollbackFilters","currentVersion","status","useEffect","loadFirmwareData","loadDevices","loadDeployments","interval","setInterval","clearInterval","async","response","apiService","getFirmwareVersions","transformedFirmwares","results","map","fw","_fw$description","_fw$description$match","id","filename","concat","description","match","minBootloaderVersion","size","checksum","signatureValid","is_active","release_notes","uploadDate","created_at","Date","toISOString","error","console","getDevices","realDevices","transformedDevices","Array","isArray","device","deviceId","device_serial","serial","firmware_version","config_version","targetVersion","activeSlot","Math","random","bootCount","boot_count","lastError","progress","undefined","activeCampaign","listTargetedUpdates","find","c","updateDeployedDeviceStatuses","activeDeploymentToUse","deployment","targetedDeviceIds","device_targets","dt","_dt$device","filter","Boolean","length","logPromises","_latestLog$status","_latestLog$firmware_v","logs","getDeviceUpdateLogs","latestLog","backendStatus","toLowerCase","current_firmware","deviceUpdates","Promise","all","updateMap","Map","u","prevDevices","update","get","_objectSpread","statusMetrics","total","inProgress","d","includes","healthy","failed","rolledBack","toggleRollbackDevice","prev","getFilteredRollbackDevices","selectAllFilteredDevices","filtered","deselectAllDevices","filteredDevices","_jsxs","style","padding","maxWidth","margin","background","minHeight","children","marginBottom","fontSize","fontWeight","color","display","alignItems","gap","width","height","viewBox","fill","stroke","strokeWidth","_jsx","points","x1","y1","x2","y2","borderRadius","boxShadow","border","paddingBottom","borderBottom","onSubmit","e","preventDefault","_response$checksum","formData","FormData","append","uploadFirmwareVersion","alert","toFixed","substring","fileInput","document","querySelector","value","message","gridTemplateColumns","type","onChange","target","placeholder","required","pattern","marginTop","rows","fontFamily","resize","accept","_e$target$files","files","buffer","arrayBuffer","hashBuffer","crypto","subtle","digest","from","Uint8Array","b","toString","padStart","join","calculateSHA256","log","disabled","whiteSpace","cursor","overflowX","borderCollapse","textAlign","colSpan","justifyContent","animation","cx","cy","r","opacity","toLocaleDateString","textTransform","onClick","updateFirmwareVersion","handleMarkAsStable","window","confirm","handleDeactivateFirmware","deleteFirmwareVersion","handleDeleteFirmware","f","parseInt","min","max","handleSelectAllDevices","idleDevices","maxHeight","overflowY","_Fragment","checked","newTargets","marginRight","flexWrap","handleDeployClick","position","top","left","right","bottom","zIndex","lineHeight","Error","deployFirmware","devices_total","marginLeft","target_firmware","devices_updated","devices_failed","round","toLocaleString","notes","idle","downloading","flashing","rebooting","trial","rolledback","Set","failedDevices","problemDevices","every","stopPropagation","handleEmergencyRollback","confirmRollback","trim","CacheService","constructor","cache","subscribers","set","key","data","ttlMs","arguments","DEFAULT_TTL","staleTime","this","timestamp","now","expiresIn","STALE_TIME","notifySubscribers","entry","delete","getWithStaleStatus","_entry$staleTime","age","isExpired","isStale","has","_entry$staleTime2","clear","clearPattern","regex","RegExp","keysToDelete","forEach","_","test","push","clearAll","subscribe","callback","subscription","add","subs","subscribePattern","source","directSubs","sub","subKey","startsWith","keys","getStats","values","reduce","sum","getTTL","REALTIME_TTL","LONG_TTL","cacheService","API_BASE_URL","process","getAuthHeaders","tokens","localStorage","getItem","parsedTokens","JSON","parse","access","request","endpoint","options","url","headers","fetch","refreshToken","removeItem","location","href","ok","errorText","text","statusText","json","method","body","stringify","refresh","newTokens","setItem","getConfiguration","getTelemetry","provisionDevice","getAlerts","cacheKey","cached","getSystemHealth","getKPIs","getUsers","search","params","encodeURIComponent","createUser","userData","result","createEmployee","employeeData","is_staff","getUserDevices","userId","getUserSite","createUserSite","updateUserSite","getDeviceSite","createDeviceSite","updateDeviceSite","getSiteTelemetry","siteId","query","URLSearchParams","start_date","end_date","days","getSiteForecast","date","getSiteWeather","updateUser","deleteUser","getProfile","updateProfile","changePassword","getCustomers","createCustomer","customerData","getCustomer","customerId","updateCustomer","deleteCustomer","getPresets","createPreset","updatePreset","deletePreset","getGlobalSlaves","createGlobalSlave","slaveData","updateGlobalSlave","slaveId","deleteGlobalSlave","page","pageSize","queryString","createDevice","deviceData","updateDevice","deleteDevice","rebootDevice","hardResetDevice","getDeviceLogs","limit","offset","toggleDeviceLogs","enabled","deleteDevicesBulk","deviceIds","device_ids","getSlaves","configId","createSlave","updateSlave","deleteSlave","addSlavesToPreset","slaveIds","slave_ids","detachSlaveFromPreset","activeOnly","firmwareId","getOTAConfig","updateOTAConfig","config","getOTAHealth","triggerRollback","deviceSerial","deviceSerials","firmware_id","device_serials","getTargetedUpdate","updateId"],"sourceRoot":""}