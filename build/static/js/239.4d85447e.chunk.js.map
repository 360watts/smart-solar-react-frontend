{"version":3,"file":"static/js/239.4d85447e.chunk.js","mappings":"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","sources":["hooks/useDebounce.ts","components/SiteDataPanel.tsx","components/Devices.tsx"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\r\n\r\ninterface UseDebouncedValueOptions {\r\n  delay?: number;\r\n}\r\n\r\n/**\r\n * Custom hook to debounce a value with a delay\r\n * Useful for search inputs and other frequent updates\r\n */\r\nexport function useDebouncedValue<T>(\r\n  value: T,\r\n  options: UseDebouncedValueOptions = {}\r\n): T {\r\n  const { delay = 300 } = options;\r\n  const [debouncedValue, setDebouncedValue] = useState<T>(value);\r\n\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setDebouncedValue(value);\r\n    }, delay);\r\n\r\n    return () => clearTimeout(timer);\r\n  }, [value, delay]);\r\n\r\n  return debouncedValue;\r\n}\r\n\r\n/**\r\n * Custom hook to debounce a callback function\r\n * Useful for search, filtering, and other expensive operations\r\n */\r\nexport function useDebouncedCallback<T extends (...args: any[]) => any>(\r\n  callback: T,\r\n  delay: number = 300\r\n): (...args: Parameters<T>) => void {\r\n  const [timeoutId, setTimeoutId] = useState<NodeJS.Timeout | null>(null);\r\n\r\n  const debouncedCallback = useCallback(\r\n    (...args: Parameters<T>) => {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId);\r\n      }\r\n\r\n      const newTimeoutId = setTimeout(() => {\r\n        callback(...args);\r\n      }, delay);\r\n\r\n      setTimeoutId(newTimeoutId);\r\n    },\r\n    [callback, delay, timeoutId]\r\n  );\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId);\r\n      }\r\n    };\r\n  }, [timeoutId]);\r\n\r\n  return debouncedCallback;\r\n}\r\n\r\n/**\r\n * Custom hook for search input with debouncing\r\n * Returns a hook that handles search input changes with built-in debouncing\r\n */\r\nexport function useDebouncedSearch(\r\n  onSearch: (query: string) => void,\r\n  delay: number = 300\r\n) {\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const debouncedCallback = useDebouncedCallback(onSearch, delay);\r\n\r\n  const handleSearch = useCallback(\r\n    (query: string) => {\r\n      setSearchQuery(query);\r\n      debouncedCallback(query);\r\n    },\r\n    [debouncedCallback]\r\n  );\r\n\r\n  return {\r\n    searchQuery,\r\n    setSearchQuery,\r\n    handleSearch,\r\n  };\r\n}\r\n","/**\n * SiteDataPanel  solar site intelligence panel\n *\n * Sections:\n *  - 6 live KPI cards: PV power, Battery (SOC + charge state), Load,\n *    Energy Today, Grid (import/export), Inverter Temperature\n *  - Daily energy breakdown: PV yield, grid buy/sell, battery in/out, consumption\n *  - Current weather pills\n *  - 24 h weather outlook (hourly scrollable strip)\n *  - Power history area chart with Battery SOC on secondary axis\n *  - Solar forecast card: P10/P50/P90 + physics baseline, regime tags, % achieved\n */\nimport React, { useState, useEffect, useCallback } from 'react';\nimport {\n  AreaChart, Area, Line,\n  XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend, ReferenceLine,\n} from 'recharts';\nimport html2canvas from 'html2canvas';\nimport { apiService } from '../services/api';\n\n//  Custom forecast tooltip \n\nconst ForecastTooltip = ({ active, payload, label }: any) => {\n  if (!active || !payload || !payload.length) return null;\n  return (\n    <div style={{\n      background: 'rgba(255,255,255,0.97)', backdropFilter: 'blur(8px)',\n      border: '1px solid #f3f4f6', borderRadius: 12,\n      padding: '0.75rem 1rem',\n      boxShadow: '0 10px 15px -3px rgba(0,0,0,0.1)',\n      minWidth: 175,\n    }}>\n      <div style={{ fontFamily: 'Urbanist, sans-serif', fontWeight: 700, color: '#111827', fontSize: '0.85rem', marginBottom: '0.4rem', borderBottom: '1px solid #f3f4f6', paddingBottom: '0.25rem' }}>\n        {label}\n      </div>\n      <div style={{ display: 'flex', flexDirection: 'column', gap: '0.2rem' }}>\n        {payload.map((entry: any) => {\n          const unit = entry.name?.includes('Temp') ? 'C' : entry.name?.includes('GHI') ? 'W/m' : 'kW';\n          return (\n            <div key={entry.name} style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', gap: '1rem', fontSize: '0.78rem', fontFamily: 'Inter, sans-serif', color: '#374151' }}>\n              <div style={{ display: 'flex', alignItems: 'center', gap: '0.4rem' }}>\n                <span style={{ width: 7, height: 7, borderRadius: '50%', background: entry.color || entry.stroke || entry.fill, flexShrink: 0 }} />\n                <span style={{ fontWeight: 600 }}>{entry.name?.split(' ')[0]}</span>\n              </div>\n              <span style={{ fontFamily: 'JetBrains Mono, monospace', fontWeight: 600, color: '#111827' }}>\n                {Number(entry.value).toFixed(3)} {unit}\n              </span>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\n//  Helpers \n\nfunction fmt(ts: string, range: string): string {\n  try {\n    const d = new Date(ts);\n    if (range === '24h') return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    if (range === '7d')  return d.toLocaleDateString([], { weekday: 'short' }) + ' ' + d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    return d.toLocaleDateString([], { month: 'short', day: 'numeric' });\n  } catch { return ts; }\n}\n\nfunction fmtForecast(ts: string, forecastFor?: string): string {\n  const clean = forecastFor || ts.replace('FORECAST#', '');\n  try { return new Date(clean).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }); }\n  catch { return clean; }\n}\n\nfunction aggregateByPeriod(data: any[], range: string): any[] {\n  if (!data.length) return [];\n  if (range === '24h') return data.filter((_, i) => i % 2 === 0 || i === data.length - 1);\n\n  const isDay = range !== '7d';\n  const buckets = new Map<string, any[]>();\n  data.forEach(row => {\n    const d = new Date(row.timestamp);\n    const key = isDay\n      ? `${d.getFullYear()}-${d.getMonth()}-${d.getDate()}`\n      : `${d.getFullYear()}-${d.getMonth()}-${d.getDate()}-${d.getHours()}`;\n    if (!buckets.has(key)) buckets.set(key, []);\n    buckets.get(key)!.push(row);\n  });\n\n  return Array.from(buckets.values()).map(bucket => {\n    const avg = (field: string) => bucket.reduce((s, r) => s + (r[field] ?? 0), 0) / bucket.length;\n    const first = bucket[0];\n    return {\n      timestamp:            first.timestamp,\n      pv1_power_w:          avg('pv1_power_w'),\n      pv2_power_w:          avg('pv2_power_w'),\n      load_power_w:         avg('load_power_w'),\n      grid_power_w:         avg('grid_power_w'),\n      battery_soc_percent:  avg('battery_soc_percent'),\n      battery_power_w:      avg('battery_power_w'),\n      pv_today_kwh:         isDay ? Math.max(...bucket.map(r => r.pv_today_kwh ?? 0)) : first.pv_today_kwh,\n    };\n  });\n}\n\nconst TOOLTIP_STYLE = {\n  background: 'rgba(255,255,255,0.97)',\n  border: '1px solid rgba(0,166,62,0.15)',\n  borderRadius: 10, color: '#0a0a0a',\n  boxShadow: '0 8px 24px rgba(0,0,0,0.1)',\n  fontSize: 12,\n};\n\n//  Icons \n\nconst IconSun = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#F07522\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <circle cx=\"12\" cy=\"12\" r=\"5\" fill=\"#FFD600\" stroke=\"#F07522\" strokeWidth=\"1.5\"/>\n    <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\"/><line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"23\"/>\n    <line x1=\"4.22\" y1=\"4.22\" x2=\"5.64\" y2=\"5.64\"/><line x1=\"18.36\" y1=\"18.36\" x2=\"19.78\" y2=\"19.78\"/>\n    <line x1=\"1\" y1=\"12\" x2=\"3\" y2=\"12\"/><line x1=\"21\" y1=\"12\" x2=\"23\" y2=\"12\"/>\n  </svg>\n);\nconst IconBattery = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <rect x=\"1\" y=\"6\" width=\"18\" height=\"12\" rx=\"2\"/>\n    <line x1=\"23\" y1=\"13\" x2=\"23\" y2=\"11\"/>\n    <rect x=\"3\" y=\"8\" width=\"10\" height=\"8\" fill=\"currentColor\" rx=\"1\"/>\n  </svg>\n);\nconst IconLoad = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z\"/>\n    <polyline points=\"9 22 9 12 15 12 15 22\"/>\n  </svg>\n);\nconst IconEnergy = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M13 2L3 14h9l-1 8 10-12h-9l1-8z\"/>\n  </svg>\n);\nconst IconCloud = () => (\n  <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M18 10h-1.26A8 8 0 109 20h9a5 5 0 000-10z\"/>\n  </svg>\n);\nconst IconGrid = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <polyline points=\"22 12 18 12 15 21 9 3 6 12 2 12\"/>\n  </svg>\n);\nconst IconThermometer = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M14 14.76V3.5a2.5 2.5 0 0 0-5 0v11.26a4.5 4.5 0 1 0 5 0z\"/>\n  </svg>\n);\n\n//  KPI Card \n\ninterface KpiCardProps {\n  label: string; value: string; unit?: string; sub?: string;\n  accent: string; icon: React.ReactNode; badge?: React.ReactNode;\n}\nconst KpiCard: React.FC<KpiCardProps> = ({ label, value, unit, sub, accent, icon, badge }) => (\n  <div className=\"card\" style={{ padding: '1.1rem', flex: 1, minWidth: 140 }}>\n    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.4rem' }}>\n      <span style={{ fontSize: '0.7rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.06em', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>{label}</span>\n      <span style={{ width: 28, height: 28, borderRadius: '50%', background: `${accent}18`, display: 'flex', alignItems: 'center', justifyContent: 'center', color: accent, flexShrink: 0 }}>{icon}</span>\n    </div>\n    <p style={{ margin: 0, fontFamily: 'JetBrains Mono, monospace', fontSize: '1.5rem', fontWeight: 800, color: '#0a0a0a', lineHeight: 1 }}>\n      {value}{unit && <span style={{ fontSize: '0.78rem', fontWeight: 500, color: '#9ca3af', marginLeft: 4 }}>{unit}</span>}\n    </p>\n    {sub   && <p style={{ margin: '0.2rem 0 0', fontSize: '0.7rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>{sub}</p>}\n    {badge && <div style={{ marginTop: '0.3rem' }}>{badge}</div>}\n  </div>\n);\n\n//  Weather Hourly Forecast Strip \n\nconst WeatherHourlyStrip = ({ hourly }: { hourly: any[] }) => {\n  if (!hourly || hourly.length === 0) return null;\n  const icon = (cloud: number, ghi: number) =>\n    ghi < 10 ? '' : cloud > 75 ? '' : cloud > 40 ? '' : '';\n\n  return (\n    <div className=\"card\" style={{ padding: '1rem 1.25rem', marginBottom: '1rem' }}>\n      <p style={{ margin: '0 0 0.65rem', fontSize: '0.68rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.07em', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>\n        24 h Weather Outlook\n      </p>\n      <div style={{ overflowX: 'auto', paddingTop: 14, paddingBottom: 2 }}>\n        <div style={{ display: 'flex', gap: '0.45rem', minWidth: 'max-content' }}>\n          {hourly.map((h, i) => {\n            const time = (() => { try { return new Date(h.forecast_for).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }); } catch { return ''; } })();\n            const cloud    = h.cloud_cover_pct ?? 0;\n            const ghi      = h.ghi_wm2 ?? 0;\n            const temp     = Number(h.temperature_c ?? 0);\n            const wind     = Number(h.wind_speed_ms ?? 0);\n            const humidity = h.humidity_pct != null ? Number(h.humidity_pct) : null;\n            const ghiPct   = Math.min(100, (ghi / 900) * 100);\n            const humPct   = humidity != null ? Math.min(100, humidity) : null;\n            const isNow    = i === 0;\n            const wi       = icon(cloud, ghi);\n            const ghiColor = ghi > 600 ? '#F07522' : ghi > 200 ? '#f59e0b' : '#d1d5db';\n            const humColor = humidity == null ? '#d1d5db'\n              : humidity > 80 ? '#3b82f6'\n              : humidity > 50 ? '#60a5fa'\n              : '#93c5fd';\n            return (\n              <div key={i} style={{\n                display: 'flex', flexDirection: 'column', alignItems: 'center',\n                background: isNow ? 'rgba(0,166,62,0.09)' : 'rgba(0,0,0,0.025)',\n                border: `1px solid ${isNow ? 'rgba(0,166,62,0.28)' : 'rgba(0,0,0,0.07)'}`,\n                borderRadius: 10, padding: '0.45rem 0.65rem', minWidth: 64, gap: '0.1rem',\n                position: 'relative',\n              }}>\n                {isNow && (\n                  <span style={{ position: 'absolute', top: -9, fontSize: '0.55rem', fontWeight: 700, background: '#00a63e', color: '#fff', padding: '1px 5px', borderRadius: 4, fontFamily: 'Poppins, sans-serif' }}>NOW</span>\n                )}\n                <span style={{ fontSize: '0.65rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif', fontWeight: 600 }}>{time}</span>\n                <span style={{ fontSize: '1.1rem', lineHeight: 1.4 }}>{wi}</span>\n                <span style={{ fontSize: '0.8rem', fontFamily: 'JetBrains Mono, monospace', fontWeight: 700, color: '#111827' }}>{temp.toFixed(1)}</span>\n                {/* GHI mini-bar */}\n                <div title={`GHI ${Math.round(ghi)} W/m`} style={{ width: '100%', height: 3, background: 'rgba(0,0,0,0.08)', borderRadius: 2, overflow: 'hidden', margin: '2px 0' }}>\n                  <div style={{ width: `${ghiPct}%`, height: '100%', background: ghiColor, borderRadius: 2 }} />\n                </div>\n                <span style={{ fontSize: '0.6rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>{Math.round(ghi)} W/m</span>\n                {/* Humidity bar */}\n                {humPct != null && (\n                  <>\n                    <div title={`Humidity ${Math.round(humPct)}%`} style={{ width: '100%', height: 3, background: 'rgba(0,0,0,0.06)', borderRadius: 2, overflow: 'hidden', margin: '2px 0' }}>\n                      <div style={{ width: `${humPct}%`, height: '100%', background: humColor, borderRadius: 2 }} />\n                    </div>\n                    <span style={{ fontSize: '0.6rem', color: humColor, fontFamily: 'Poppins, sans-serif', fontWeight: 600 }}>{Math.round(humPct)}%</span>\n                  </>\n                )}\n                <span style={{ fontSize: '0.6rem', color: '#b0bec5', fontFamily: 'Poppins, sans-serif' }}>{wind.toFixed(1)} m/s</span>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n    </div>\n  );\n};\n\n//  Daily Energy Breakdown \n\nconst EnergyBreakdownRow = ({ latest }: { latest: any }) => {\n  if (!latest) return null;\n  const items = [\n    { label: 'PV Yield',    value: latest.pv_today_kwh,              color: '#F07522', bg: '#F0752212', icon: '' },\n    { label: 'Grid In',     value: latest.grid_buy_today_kwh,         color: '#3b82f6', bg: '#3b82f612', icon: '' },\n    { label: 'Grid Out',    value: latest.grid_sell_today_kwh,        color: '#10b981', bg: '#10b98112', icon: '' },\n    { label: 'Batt Chg',    value: latest.batt_charge_today_kwh,      color: '#8b5cf6', bg: '#8b5cf612', icon: '' },\n    { label: 'Batt Dchg',   value: latest.batt_discharge_today_kwh,   color: '#ec4899', bg: '#ec489912', icon: '' },\n    { label: 'Consumption', value: latest.load_today_kwh,             color: '#6b7280', bg: '#6b728012', icon: '' },\n  ].filter(e => e.value != null);\n  if (!items.length) return null;\n\n  return (\n    <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap', marginBottom: '1rem', alignItems: 'center' }}>\n      <span style={{ fontSize: '0.65rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.06em', color: '#9ca3af', fontFamily: 'Poppins, sans-serif', alignSelf: 'center', minWidth: 40 }}>Today</span>\n      {items.map(e => (\n        <span key={e.label} style={{\n          fontSize: '0.72rem', fontWeight: 600, fontFamily: 'Poppins, sans-serif',\n          padding: '0.2rem 0.65rem', borderRadius: 99,\n          background: e.bg, border: `1px solid ${e.color}28`,\n          color: e.color, display: 'flex', alignItems: 'center', gap: '0.3rem',\n        }}>\n          <span style={{ opacity: 0.85 }}>{e.icon}</span>\n          {e.label}:&nbsp;\n          <span style={{ fontFamily: 'JetBrains Mono, monospace', color: '#0a0a0a' }}>{Number(e.value).toFixed(2)}</span>\n          <span style={{ fontSize: '0.6rem', color: '#9ca3af' }}>kWh</span>\n        </span>\n      ))}\n    </div>\n  );\n};\n\n//  Solar Insights Row \n\nconst InsightsRow = ({ latest }: { latest: any }) => {\n  if (!latest) return null;\n\n  const pvKwh    = Number(latest.pv_today_kwh      ?? 0);\n  const loadKwh  = Number(latest.load_today_kwh    ?? 0);\n  const gridBuy  = Number(latest.grid_buy_today_kwh ?? 0);\n\n  // Only render if we have at least PV data\n  if (pvKwh === 0 && loadKwh === 0) return null;\n\n  const co2Kg       = pvKwh * 0.82;  // India grid factor ~0.82 kg CO/kWh\n  // Self-sufficiency = portion of load met by solar+battery (not from grid)\n  const selfSufPct2 = loadKwh > 0\n    ? Math.max(0, Math.min(100, Math.round(((loadKwh - gridBuy) / loadKwh) * 100)))\n    : null;\n  const gridDepPct  = loadKwh > 0\n    ? Math.max(0, Math.min(100, Math.round((gridBuy / loadKwh) * 100)))\n    : null;\n\n  const items: { icon: string; label: string; value: string; sub?: string; color: string; bg: string }[] = [];\n\n  if (pvKwh > 0) {\n    items.push({\n      icon: '', label: 'CO Avoided',\n      value: co2Kg >= 1 ? `${co2Kg.toFixed(2)} kg` : `${(co2Kg * 1000).toFixed(0)} g`,\n      sub: 'vs grid (0.82 kg/kWh)',\n      color: '#10b981', bg: '#10b98110',\n    });\n  }\n  if (selfSufPct2 != null) {\n    const color = selfSufPct2 >= 70 ? '#00a63e' : selfSufPct2 >= 40 ? '#f59e0b' : '#ef4444';\n    items.push({\n      icon: '', label: 'Self-Sufficiency',\n      value: `${selfSufPct2}%`,\n      sub: 'load met by solar+battery',\n      color, bg: `${color}10`,\n    });\n  }\n  if (gridDepPct != null) {\n    const color = gridDepPct <= 20 ? '#10b981' : gridDepPct <= 50 ? '#f59e0b' : '#ef4444';\n    items.push({\n      icon: '', label: 'Grid Dependency',\n      value: `${gridDepPct}%`,\n      sub: 'portion from grid',\n      color, bg: `${color}10`,\n    });\n  }\n\n  if (!items.length) return null;\n\n  return (\n    <div style={{ display: 'flex', gap: '0.6rem', flexWrap: 'wrap', marginBottom: '1rem' }}>\n      <span style={{ fontSize: '0.65rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.06em', color: '#9ca3af', fontFamily: 'Poppins, sans-serif', alignSelf: 'center', minWidth: 40 }}>\n        Insights\n      </span>\n      {items.map(item => (\n        <div key={item.label} style={{\n          display: 'flex', alignItems: 'center', gap: '0.55rem',\n          padding: '0.35rem 0.85rem', borderRadius: 10,\n          background: item.bg, border: `1px solid ${item.color}28`,\n          flexShrink: 0,\n        }}>\n          <span style={{ fontSize: '1rem', lineHeight: 1 }}>{item.icon}</span>\n          <div style={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n            <span style={{ fontSize: '0.62rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif', fontWeight: 600, textTransform: 'uppercase', letterSpacing: '0.04em' }}>{item.label}</span>\n            <span style={{ fontFamily: 'JetBrains Mono, monospace', fontWeight: 800, color: item.color, fontSize: '0.88rem', lineHeight: 1 }}>{item.value}</span>\n            {item.sub && <span style={{ fontSize: '0.58rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>{item.sub}</span>}\n          </div>\n        </div>\n      ))}\n    </div>\n  );\n};\n\n//  Forecast Table \n\nconst REGIME_STYLE: Record<string, { bg: string; color: string }> = {\n  night:  { bg: '#1e293b1a', color: '#475569' },\n  ramp:   { bg: '#f59e0b18', color: '#d97706' },\n  midday: { bg: '#F0752218', color: '#c2410c' },\n};\n\nconst ForecastTable = ({ data }: { data: any[] }) => (\n  <div style={{ maxHeight: 300, overflowY: 'auto' }}>\n    <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.8rem', fontFamily: 'Inter, sans-serif' }}>\n      <thead style={{ position: 'sticky', top: 0, background: '#f9fafb', zIndex: 1 }}>\n        <tr>\n          <th style={{ padding: '0.7rem 1rem', textAlign: 'left',   fontWeight: 600, color: '#4b5563',  borderBottom: '1px solid #e5e7eb' }}>Time</th>\n          <th style={{ padding: '0.7rem 0.6rem', textAlign: 'center', fontWeight: 600, color: '#6b7280',  borderBottom: '1px solid #e5e7eb' }}>Regime</th>\n          <th style={{ padding: '0.7rem 0.8rem', textAlign: 'right', fontWeight: 600, color: '#f59e0b',  borderBottom: '1px solid #e5e7eb' }}>P10 </th>\n          <th style={{ padding: '0.7rem 0.8rem', textAlign: 'right', fontWeight: 600, color: '#00a63e',  borderBottom: '1px solid #e5e7eb' }}>P50</th>\n          <th style={{ padding: '0.7rem 0.8rem', textAlign: 'right', fontWeight: 600, color: '#3b82f6',  borderBottom: '1px solid #e5e7eb' }}>P90 </th>\n          <th style={{ padding: '0.7rem 0.8rem', textAlign: 'right', fontWeight: 600, color: '#9ca3af',  borderBottom: '1px solid #e5e7eb' }}>Physics</th>\n          <th style={{ padding: '0.7rem 0.8rem', textAlign: 'right', fontWeight: 600, color: '#eab308',  borderBottom: '1px solid #e5e7eb' }}>GHI W/m</th>\n        </tr>\n      </thead>\n      <tbody>\n        {data.map((row, i) => {\n          const rc = row.regime ? (REGIME_STYLE[row.regime] ?? { bg: 'transparent', color: '#6b7280' }) : null;\n          return (\n            <tr key={i} style={{ borderBottom: '1px solid #f3f4f6' }}>\n              <td style={{ padding: '0.55rem 1rem', color: '#111827', fontFamily: 'JetBrains Mono, monospace' }}>{row.time}</td>\n              <td style={{ padding: '0.4rem 0.6rem', textAlign: 'center' }}>\n                {row.regime && rc && (\n                  <span style={{ fontSize: '0.62rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.04em', background: rc.bg, color: rc.color, padding: '2px 6px', borderRadius: 4, fontFamily: 'Poppins, sans-serif' }}>\n                    {row.regime}\n                  </span>\n                )}\n              </td>\n              <td style={{ padding: '0.55rem 0.8rem', textAlign: 'right', color: '#4b5563' }}>{row.p10?.toFixed(3) ?? ''}</td>\n              <td style={{ padding: '0.55rem 0.8rem', textAlign: 'right', fontWeight: 600, color: '#111827' }}>{row.p50?.toFixed(3) ?? ''}</td>\n              <td style={{ padding: '0.55rem 0.8rem', textAlign: 'right', color: '#4b5563' }}>{row.p90?.toFixed(3) ?? ''}</td>\n              <td style={{ padding: '0.55rem 0.8rem', textAlign: 'right', color: '#9ca3af', fontStyle: 'italic' }}>{row.physics?.toFixed(3) ?? ''}</td>\n              <td style={{ padding: '0.55rem 0.8rem', textAlign: 'right', color: '#4b5563' }}>{row.ghi?.toFixed(0) ?? ''}</td>\n            </tr>\n          );\n        })}\n      </tbody>\n    </table>\n  </div>\n);\n\n//  Main component \n\ninterface Props {\n  siteId: string;\n  autoRefresh?: boolean;\n}\n\nconst SiteDataPanel: React.FC<Props> = ({ siteId, autoRefresh = false }) => {\n  const [telemetry,  setTelemetry]  = useState<any[]>([]);\n  const [forecast,   setForecast]   = useState<any[]>([]);\n  const [weather,    setWeather]    = useState<any>(null);\n  const [loading,    setLoading]    = useState(true);\n  const [error,      setError]      = useState<string | null>(null);\n  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);\n\n  const [showBands,       setShowBands]       = useState<Record<string, boolean>>({ P10: true, P50: true, P90: true });\n  const [dateRange,       setDateRange]       = useState('24h');\n  const [customStartDate, setCustomStartDate] = useState('');\n  const [customEndDate,   setCustomEndDate]   = useState('');\n  const [forecastView,    setForecastView]    = useState<'chart' | 'table'>('chart');\n\n  const fetchAll = useCallback(async () => {\n    try {\n      let telemetryParams: any = {};\n      if      (dateRange === 'custom' && customStartDate && customEndDate) telemetryParams = { start_date: new Date(customStartDate).toISOString(), end_date: new Date(customEndDate).toISOString() };\n      else if (dateRange === '7d')  telemetryParams = { days: 7 };\n      else if (dateRange === '30d') telemetryParams = { days: 30 };\n\n      let forecastParams: any = {};\n      if (dateRange === 'custom' && customStartDate && customEndDate) {\n        forecastParams = { start_date: new Date(customStartDate).toISOString(), end_date: new Date(customEndDate).toISOString() };\n      } else if (dateRange === '7d' || dateRange === '30d') {\n        const days = dateRange === '7d' ? 6 : 29;\n        const end = new Date(), start = new Date();\n        start.setDate(end.getDate() - days);\n        forecastParams = {\n          start_date: start.toISOString().split('T')[0] + 'T00:00:00Z',\n          end_date:   end.toISOString().split('T')[0]   + 'T23:59:59Z',\n        };\n      }\n\n      const [tel, fcst, wth] = await Promise.all([\n        apiService.getSiteTelemetry(siteId, telemetryParams),\n        apiService.getSiteForecast(siteId, forecastParams),\n        apiService.getSiteWeather(siteId),\n      ]);\n\n      setTelemetry(Array.isArray(tel) ? tel : []);\n      setForecast(Array.isArray(fcst) ? fcst : []);\n      setWeather(wth || null);\n      setLastUpdated(new Date());\n      setError(null);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load site data');\n    } finally {\n      setLoading(false);\n    }\n  }, [siteId, dateRange, customStartDate, customEndDate]);\n\n  useEffect(() => {\n    setLoading(true);\n    fetchAll();\n    if (!autoRefresh) return;\n    const id = setInterval(fetchAll, 60_000);\n    return () => clearInterval(id);\n  }, [fetchAll, autoRefresh]);\n\n  //  Derived values \n  const latest = telemetry.length > 0 ? telemetry[telemetry.length - 1] : null;\n\n  const pvKw       = latest ? ((latest.pv1_power_w ?? 0) + (latest.pv2_power_w ?? 0)) / 1000 : null;\n  const batSoc     = latest?.battery_soc_percent ?? null;\n  const loadKw     = latest ? (latest.load_power_w    ?? 0) / 1000 : null;\n  const todayKwh   = latest?.pv_today_kwh ?? null;\n  const gridKw     = latest ? (latest.grid_power_w    ?? 0) / 1000 : null;\n  const batPowerKw = latest ? (latest.battery_power_w ?? 0) / 1000 : null;\n  const invTemp    = latest?.inverter_temp_c   ?? null;\n  const batVoltage = latest?.battery_voltage_v ?? null;\n  const runState   = latest?.run_state;\n\n  const gridImporting  = gridKw     != null && gridKw     > 0.01;\n  const gridExporting  = gridKw     != null && gridKw     < -0.01;\n  const batCharging    = batPowerKw != null && batPowerKw > 0.01;\n\n  const runStateBadge = runState != null ? (\n    runState === 0 ? { label: 'Standby', color: '#9ca3af' } :\n    runState === 1 ? { label: 'Online',  color: '#00a63e' } :\n    runState === 2 ? { label: 'Warning', color: '#f59e0b' } :\n    runState === 3 ? { label: 'Fault',   color: '#ef4444' } :\n                     { label: `State ${runState}`, color: '#6b7280' }\n  ) : null;\n\n  const invTempColor = invTemp == null ? '#9ca3af'\n    : invTemp > 60 ? '#ef4444'\n    : invTemp > 45 ? '#f59e0b'\n    : '#10b981';\n\n  //  Chart data \n  const aggregated  = aggregateByPeriod(telemetry, dateRange);\n  const historyData = aggregated.map(row => ({\n    time:           fmt(row.timestamp, dateRange),\n    'PV (kW)':      +((( row.pv1_power_w ?? 0) + (row.pv2_power_w ?? 0)) / 1000).toFixed(2),\n    'Load (kW)':    +((row.load_power_w ?? 0) / 1000).toFixed(2),\n    'Grid (kW)':    +((row.grid_power_w ?? 0) / 1000).toFixed(2),\n    'Batt SOC (%)': row.battery_soc_percent ?? null,\n  }));\n\n  const forecastData = forecast.map(row => {\n    let label = '';\n    if (dateRange !== '24h') {\n      const clean = row.forecast_for || row.timestamp.replace('FORECAST#', '');\n      const d = new Date(clean);\n      label = d.toLocaleDateString([], { month: 'short', day: 'numeric' }) + ' ' + d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    } else {\n      label = fmtForecast(row.timestamp, row.forecast_for);\n    }\n    return {\n      time:    label,\n      p50:     row.p50_kw            != null ? +Number(row.p50_kw).toFixed(3)            : null,\n      p10:     row.p10_kw            != null ? +Number(row.p10_kw).toFixed(3)            : null,\n      p90:     row.p90_kw            != null ? +Number(row.p90_kw).toFixed(3)            : null,\n      physics: row.physics_baseline_kw != null ? +Number(row.physics_baseline_kw).toFixed(3) : null,\n      ghi:     row.ghi_input_wm2     != null ? +row.ghi_input_wm2                       : null,\n      temp:    row.temperature_c     != null ? +row.temperature_c                        : null,\n      regime:  row.regime            ?? null,\n    };\n  });\n\n  // Trapezoidal energy integration\n  let fcastP10 = 0, fcastP50 = 0, fcastP90 = 0;\n  let forecastGeneratedAt: Date | null = null;\n  if (forecast.length > 1) {\n    const first = forecast[0];\n    if (first.generated_at) {\n      forecastGeneratedAt = new Date(first.generated_at);\n    } else if (first.timestamp) {\n      forecastGeneratedAt = new Date(first.timestamp.replace('FORECAST#', '').split('T')[0] + 'T00:00:00Z');\n    }\n    for (let i = 0; i < forecast.length - 1; i++) {\n      const h = Math.abs(\n        new Date(forecast[i+1].timestamp.replace('FORECAST#', '')).getTime() -\n        new Date(forecast[i].timestamp.replace('FORECAST#', '')).getTime()\n      ) / 3_600_000;\n      if (forecast[i].p10_kw != null && forecast[i+1].p10_kw != null) fcastP10 += (forecast[i].p10_kw + forecast[i+1].p10_kw) / 2 * h;\n      if (forecast[i].p50_kw != null && forecast[i+1].p50_kw != null) fcastP50 += (forecast[i].p50_kw + forecast[i+1].p50_kw) / 2 * h;\n      if (forecast[i].p90_kw != null && forecast[i+1].p90_kw != null) fcastP90 += (forecast[i].p90_kw + forecast[i+1].p90_kw) / 2 * h;\n    }\n  }\n\n  const achievedPct = todayKwh != null && fcastP50 > 0\n    ? Math.min(999, Math.round((todayKwh / fcastP50) * 100))\n    : null;\n\n  //  Render \n  if (loading) {\n    return (\n      <div style={{ padding: '1.5rem 0' }}>\n        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem', flexWrap: 'wrap' }}>\n          {[...Array(6)].map((_, i) => <div key={i} className=\"card skeleton\" style={{ flex: 1, minWidth: 140, height: 100 }} />)}\n        </div>\n        <div className=\"card skeleton\" style={{ height: 52, marginBottom: '0.75rem' }} />\n        <div className=\"card skeleton\" style={{ height: 130, marginBottom: '1rem' }} />\n        <div className=\"card skeleton\" style={{ height: 240, marginBottom: '1rem' }} />\n        <div className=\"card skeleton\" style={{ height: 200 }} />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div style={{ padding: '1.5rem', color: '#ef4444', fontSize: '0.85rem', background: 'rgba(239,68,68,0.06)', borderRadius: 10, marginTop: '1rem' }}>\n        Failed to load DynamoDB data for <strong>{siteId}</strong>: {error}\n      </div>\n    );\n  }\n\n  const noData = telemetry.length === 0 && forecast.length === 0 && !weather;\n\n  return (\n    <div style={{ marginTop: '1.5rem' }}>\n\n      {/*  Section header  */}\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '0.75rem', gap: '1rem', flexWrap: 'wrap' }}>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>\n          <p className=\"dash-section-label\" style={{ margin: 0 }}>\n            Live Site Intelligence  <span style={{ fontFamily: 'JetBrains Mono, monospace', color: '#00a63e' }}>{siteId}</span>\n          </p>\n          {runStateBadge && (\n            <span style={{\n              fontSize: '0.65rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.06em',\n              background: `${runStateBadge.color}18`, color: runStateBadge.color,\n              padding: '2px 8px', borderRadius: 99, fontFamily: 'Poppins, sans-serif',\n              border: `1px solid ${runStateBadge.color}30`,\n            }}>\n               {runStateBadge.label}\n            </span>\n          )}\n        </div>\n\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n            <select\n              value={dateRange}\n              onChange={e => setDateRange(e.target.value)}\n              style={{ background: 'var(--card-bg,#fff)', border: '1px solid rgba(0,166,62,0.2)', borderRadius: 8, padding: '0.3rem 0.6rem', fontSize: '0.72rem', color: 'var(--text-color,#0a0a0a)', cursor: 'pointer', fontFamily: 'Poppins, sans-serif', fontWeight: 600 }}\n            >\n              <option value=\"24h\">Today</option>\n              <option value=\"7d\">Last 7 days</option>\n              <option value=\"30d\">Last 30 days</option>\n              <option value=\"custom\">Custom range</option>\n            </select>\n            {dateRange === 'custom' && (<>\n              <input type=\"date\" value={customStartDate} onChange={e => setCustomStartDate(e.target.value)}\n                style={{ background: 'var(--card-bg,#fff)', border: '1px solid rgba(0,166,62,0.2)', borderRadius: 8, padding: '0.3rem 0.6rem', fontSize: '0.72rem', color: 'var(--text-color,#0a0a0a)', fontFamily: 'Poppins, sans-serif', fontWeight: 600 }} />\n              <span style={{ color: '#9ca3af', fontSize: '0.7rem' }}>to</span>\n              <input type=\"date\" value={customEndDate} onChange={e => setCustomEndDate(e.target.value)}\n                style={{ background: 'var(--card-bg,#fff)', border: '1px solid rgba(0,166,62,0.2)', borderRadius: 8, padding: '0.3rem 0.6rem', fontSize: '0.72rem', color: 'var(--text-color,#0a0a0a)', fontFamily: 'Poppins, sans-serif', fontWeight: 600 }} />\n            </>)}\n          </div>\n          {lastUpdated && (\n            <span style={{ fontSize: '0.7rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>\n              Updated {lastUpdated.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n            </span>\n          )}\n          <button\n            onClick={() => { setLoading(true); fetchAll(); }}\n            style={{ background: 'none', border: '1px solid rgba(0,166,62,0.2)', borderRadius: 8, padding: '0.2rem 0.6rem', fontSize: '0.72rem', color: '#00a63e', cursor: 'pointer', fontFamily: 'Poppins, sans-serif', fontWeight: 600 }}\n          > Refresh</button>\n        </div>\n      </div>\n\n      {noData ? (\n        <div style={{ padding: '2rem', textAlign: 'center', color: '#9ca3af', fontSize: '0.875rem', background: 'rgba(0,166,62,0.03)', borderRadius: 12, border: '1px dashed rgba(0,166,62,0.15)' }}>\n          No DynamoDB data found for site <strong style={{ color: '#00a63e' }}>{siteId}</strong> in the {\n            dateRange === '24h' ? 'today' : dateRange === '7d' ? 'last 7 days' : dateRange === '30d' ? 'last 30 days' : 'selected date range'\n          }.<br />\n          <span style={{ fontSize: '0.78rem' }}>Data is written by the ML forecast scheduler when the device is actively posting telemetry.</span>\n        </div>\n      ) : (<>\n\n        {/*  6-card KPI strip  */}\n        <div style={{ display: 'flex', gap: '0.75rem', flexWrap: 'wrap', marginBottom: '0.75rem' }}>\n          <KpiCard\n            label=\"PV Power\" value={pvKw != null ? pvKw.toFixed(2) : ''} unit=\"kW\"\n            sub={latest?.pv1_power_w != null && latest?.pv2_power_w != null\n              ? `S1: ${(latest.pv1_power_w/1000).toFixed(2)}  S2: ${(latest.pv2_power_w/1000).toFixed(2)} kW`\n              : 'Current generation'}\n            accent=\"#F07522\" icon={<IconSun />}\n          />\n          <KpiCard\n            label=\"Battery\" value={batSoc != null ? batSoc.toFixed(1) : ''} unit=\"%\"\n            sub={batVoltage != null ? `${batVoltage.toFixed(1)} V` : 'State of charge'}\n            accent=\"#00a63e\" icon={<IconBattery />}\n            badge={batPowerKw != null && Math.abs(batPowerKw) > 0.01 ? (\n              <span style={{ fontSize: '0.65rem', fontWeight: 700, color: batCharging ? '#00a63e' : '#ec4899', fontFamily: 'Poppins, sans-serif' }}>\n                {batCharging ? ' Charging' : ' Discharging'} {Math.abs(batPowerKw).toFixed(2)} kW\n              </span>\n            ) : <span style={{ fontSize: '0.65rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>Idle</span>}\n          />\n          <KpiCard\n            label=\"Load\" value={loadKw != null ? loadKw.toFixed(2) : ''} unit=\"kW\"\n            sub=\"Current consumption\" accent=\"#8b5cf6\" icon={<IconLoad />}\n          />\n          <KpiCard\n            label=\"Energy Today\" value={todayKwh != null ? todayKwh.toFixed(2) : ''} unit=\"kWh\"\n            sub=\"Solar yield today\" accent=\"#10b981\" icon={<IconEnergy />}\n          />\n          <KpiCard\n            label=\"Grid\" value={gridKw != null ? Math.abs(gridKw).toFixed(2) : ''} unit=\"kW\"\n            sub={latest?.grid_voltage_v != null\n              ? `${Number(latest.grid_voltage_v).toFixed(0)} V  ${Number(latest.grid_frequency_hz ?? 0).toFixed(1)} Hz`\n              : 'Grid power'}\n            accent=\"#3b82f6\" icon={<IconGrid />}\n            badge={gridKw != null ? (\n              <span style={{ fontSize: '0.65rem', fontWeight: 700, color: gridImporting ? '#3b82f6' : gridExporting ? '#10b981' : '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>\n                {gridImporting ? ' Importing' : gridExporting ? ' Exporting' : ' Standby'}\n              </span>\n            ) : undefined}\n          />\n          <KpiCard\n            label=\"Inv. Temp\" value={invTemp != null ? invTemp.toFixed(1) : ''} unit=\"C\"\n            sub={invTemp != null\n              ? invTemp > 60 ? ' Hot  check cooling' : invTemp > 45 ? ' Warm' : ' Normal'\n              : 'No data'}\n            accent={invTempColor} icon={<IconThermometer />}\n          />\n        </div>\n\n        {/*  Daily energy breakdown  */}\n        <EnergyBreakdownRow latest={latest} />\n        <InsightsRow latest={latest} />\n\n        {/*  Current weather pills  */}\n        {weather?.current && (\n          <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap', marginBottom: '0.75rem', alignItems: 'center' }}>\n            <span style={{ fontSize: '0.65rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.06em', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>Now</span>\n            {[\n              { label: 'Temp',     value: weather.current.temperature_c  != null ? `${Number(weather.current.temperature_c).toFixed(1)} C`  : null },\n              { label: 'Humidity', value: weather.current.humidity_pct   != null ? `${weather.current.humidity_pct} %`                        : null },\n              { label: 'Cloud',    value: weather.current.cloud_cover_pct != null ? `${weather.current.cloud_cover_pct} %`                    : null, icon: <IconCloud /> },\n              { label: 'Wind',     value: weather.current.wind_speed_ms  != null ? `${Number(weather.current.wind_speed_ms).toFixed(1)} m/s`  : null },\n              { label: 'GHI',      value: weather.current.ghi_wm2        != null ? `${Math.round(weather.current.ghi_wm2)} W/m`              : null },\n            ].filter(p => p.value).map(p => (\n              <span key={p.label} style={{\n                fontSize: '0.72rem', fontWeight: 600, fontFamily: 'Poppins, sans-serif',\n                padding: '0.2rem 0.65rem', borderRadius: 99,\n                background: 'rgba(0,166,62,0.07)', border: '1px solid rgba(0,166,62,0.12)',\n                color: '#007a55', display: 'flex', alignItems: 'center', gap: '0.3rem',\n              }}>\n                {(p as any).icon}{p.label}: <span style={{ fontFamily: 'JetBrains Mono, monospace', color: '#0a0a0a' }}>{p.value}</span>\n              </span>\n            ))}\n          </div>\n        )}\n\n        {/*  24 h weather outlook  */}\n        {weather?.hourly_forecast && weather.hourly_forecast.length > 0 && (\n          <WeatherHourlyStrip hourly={weather.hourly_forecast} />\n        )}\n\n        {/*  Power history chart  */}\n        {historyData.length > 0 && (\n          <div className=\"card\" style={{ padding: '1.25rem', marginBottom: '1rem' }}>\n            <div style={{ marginBottom: '0.75rem' }}>\n              <h3 style={{ margin: '0 0 0.2rem', fontSize: '0.9rem', fontFamily: 'Urbanist, sans-serif', color: '#0a0a0a' }}>\n                Power History  {\n                  dateRange === '24h'   ? 'Today' :\n                  dateRange === '7d'    ? 'Last 7 days' :\n                  dateRange === '30d'   ? 'Last 30 days' :\n                  customStartDate && customEndDate\n                    ? `${new Date(customStartDate).toLocaleDateString()}  ${new Date(customEndDate).toLocaleDateString()}`\n                    : 'Custom range'\n                }\n              </h3>\n              <p style={{ margin: 0, fontSize: '0.68rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>\n                {dateRange === '7d' ? 'Hourly aggregates' : dateRange !== '24h' ? 'Daily aggregates' : '30-min samples'}  Battery SOC on right axis\n              </p>\n            </div>\n            <div style={{ height: 240 }}>\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <AreaChart data={historyData} margin={{ top: 4, right: 44, left: 0, bottom: dateRange === '7d' || dateRange === '30d' ? 20 : 0 }}>\n                  <defs>\n                    <linearGradient id=\"pvGrad\"   x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                      <stop offset=\"5%\"  stopColor=\"#F07522\" stopOpacity={0.22}/>\n                      <stop offset=\"95%\" stopColor=\"#F07522\" stopOpacity={0}/>\n                    </linearGradient>\n                    <linearGradient id=\"loadGrad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                      <stop offset=\"5%\"  stopColor=\"#8b5cf6\" stopOpacity={0.18}/>\n                      <stop offset=\"95%\" stopColor=\"#8b5cf6\" stopOpacity={0}/>\n                    </linearGradient>\n                  </defs>\n                  <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(0,166,62,0.08)\" />\n                  <XAxis\n                    dataKey=\"time\" stroke=\"#9ca3af\"\n                    interval={dateRange === '24h' ? 'preserveStartEnd' : Math.ceil(historyData.length / 10)}\n                    angle={dateRange === '7d' || dateRange === '30d' ? -15 : 0}\n                    textAnchor={dateRange === '7d' || dateRange === '30d' ? 'end' : 'middle'}\n                    tick={{ fontSize: dateRange === '30d' ? 9 : 10, fill: '#9ca3af' }}\n                  />\n                  <YAxis yAxisId=\"power\" stroke=\"#9ca3af\" tickFormatter={(v: number) => `${v}kW`} tick={{ fontSize: 10, fill: '#9ca3af' }} />\n                  <YAxis yAxisId=\"soc\" orientation=\"right\" stroke=\"#9ca3af\" domain={[0, 100]} tickFormatter={(v: number) => `${v}%`} width={36} tick={{ fontSize: 10, fill: '#9ca3af' }} />\n                  <Tooltip contentStyle={TOOLTIP_STYLE} formatter={(v: any, name: any) => [`${v} ${String(name).includes('%') ? '%' : 'kW'}`, name]} />\n                  <Legend iconType=\"circle\" iconSize={8} wrapperStyle={{ fontSize: 11, fontFamily: 'Poppins, sans-serif' }} />\n                  <Area yAxisId=\"power\" type=\"monotone\" dataKey=\"PV (kW)\"   stroke=\"#F07522\" strokeWidth={2} fill=\"url(#pvGrad)\"   dot={false} />\n                  <Area yAxisId=\"power\" type=\"monotone\" dataKey=\"Load (kW)\" stroke=\"#8b5cf6\" strokeWidth={2} fill=\"url(#loadGrad)\" dot={false} />\n                  <Line  yAxisId=\"power\" type=\"monotone\" dataKey=\"Grid (kW)\"     stroke=\"#3b82f6\" strokeWidth={1.5} dot={false} strokeDasharray=\"4 3\" />\n                  <Line  yAxisId=\"soc\"   type=\"monotone\" dataKey=\"Batt SOC (%)\"  stroke=\"#00a63e\" strokeWidth={1.5} dot={false} strokeDasharray=\"2 3\" />\n                </AreaChart>\n              </ResponsiveContainer>\n            </div>\n          </div>\n        )}\n\n        {/*  Solar Forecast  */}\n        {forecastData.length > 0 && (\n          <div className=\"card\" style={{ padding: 0, boxShadow: '0 10px 30px -5px rgba(0,0,0,0.1)', border: '1px solid #e5e7eb', borderRadius: 16, background: '#ffffff', overflow: 'hidden' }}>\n\n            {/* Header */}\n            <div style={{ padding: '1.25rem 1.5rem', borderBottom: '1px solid #f3f4f6', display: 'flex', flexWrap: 'wrap', gap: '1rem', alignItems: 'center', justifyContent: 'space-between', background: 'linear-gradient(to right,#ffffff,#f9fafb)' }}>\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '0.25rem' }}>\n                <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n                  <div style={{ width: 32, height: 32, borderRadius: 8, background: 'rgba(0,166,62,0.1)', color: '#00a63e', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '1.1rem' }}></div>\n                  <h3 style={{ margin: 0, fontSize: '1.1rem', fontFamily: 'Urbanist, sans-serif', color: '#111827', fontWeight: 700 }}>Solar Forecast</h3>\n                </div>\n                {fcastP50 > 0 && (\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '0.6rem', marginLeft: '2.5rem', flexWrap: 'wrap' }}>\n                    <span style={{ fontSize: '0.82rem', color: '#6b7280', fontFamily: 'Inter, sans-serif' }}>Est. Yield:</span>\n                    <span style={{ fontFamily: 'JetBrains Mono, monospace', fontSize: '0.82rem', fontWeight: 600, color: '#111827', background: '#f3f4f6', padding: '2px 7px', borderRadius: 4 }}>\n                      {fcastP10.toFixed(1)} <span style={{ color: '#9ca3af' }}>/</span> <span style={{ color: '#00a63e' }}>{fcastP50.toFixed(1)}</span> <span style={{ color: '#9ca3af' }}>/</span> {fcastP90.toFixed(1)} kWh\n                    </span>\n                    {achievedPct != null && (\n                      <span style={{\n                        fontSize: '0.72rem', fontWeight: 700, fontFamily: 'Poppins, sans-serif',\n                        padding: '2px 8px', borderRadius: 99,\n                        background: achievedPct >= 80 ? '#10b98118' : achievedPct >= 40 ? '#f59e0b18' : '#e5e7eb',\n                        color:      achievedPct >= 80 ? '#059669'  : achievedPct >= 40 ? '#d97706'  : '#9ca3af',\n                        border:     `1px solid ${achievedPct >= 80 ? '#10b98128' : achievedPct >= 40 ? '#f59e0b28' : '#d1d5db'}`,\n                      }}>\n                        {achievedPct}% achieved\n                      </span>\n                    )}\n                  </div>\n                )}\n              </div>\n\n              {/* Controls */}\n              <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>\n                {/* Chart / Table toggle */}\n                <div style={{ display: 'flex', background: '#f3f4f6', borderRadius: 8, padding: 3 }}>\n                  {(['chart', 'table'] as const).map(v => (\n                    <button key={v} onClick={() => setForecastView(v)} style={{ border: 'none', background: forecastView === v ? '#fff' : 'transparent', color: forecastView === v ? '#00a63e' : '#6b7280', borderRadius: 6, padding: '0.35rem 0.75rem', fontSize: '0.75rem', fontWeight: 600, cursor: 'pointer', boxShadow: forecastView === v ? '0 1px 3px rgba(0,0,0,0.1)' : 'none', textTransform: 'capitalize' }}>\n                      {v}\n                    </button>\n                  ))}\n                </div>\n\n                {/* Band toggles */}\n                {forecastView === 'chart' && (\n                  <div style={{ display: 'flex', background: '#f3f4f6', padding: 3, borderRadius: 8 }}>\n                    {[{ label: 'P10', color: '#f59e0b' }, { label: 'P50', color: '#00a63e' }, { label: 'P90', color: '#3b82f6' }].map(b => (\n                      <button key={b.label} onClick={() => setShowBands(s => ({ ...s, [b.label]: !s[b.label] }))} style={{ border: 'none', background: showBands[b.label] ? '#ffffff' : 'transparent', color: showBands[b.label] ? b.color : '#9ca3af', boxShadow: showBands[b.label] ? '0 2px 4px rgba(0,0,0,0.05)' : 'none', borderRadius: 6, padding: '0.35rem 0.75rem', fontSize: '0.75rem', fontWeight: 600, cursor: 'pointer', transition: 'all 0.2s', display: 'flex', alignItems: 'center', gap: 4 }}>\n                        <span style={{ width: 6, height: 6, borderRadius: '50%', background: showBands[b.label] ? b.color : '#d1d5db' }} />\n                        {b.label}\n                      </button>\n                    ))}\n                  </div>\n                )}\n\n                {/* Export */}\n                <button\n                  onClick={async () => {\n                    const el = document.getElementById('forecast-chart-container');\n                    if (el) {\n                      const canvas = await html2canvas(el, { background: '#ffffff', scale: 2 } as any);\n                      const a = document.createElement('a');\n                      a.download = `solar-forecast-${new Date().toISOString().slice(0,10)}.png`;\n                      a.href = canvas.toDataURL(); a.click();\n                    }\n                  }}\n                  style={{ background: 'transparent', border: '1px solid #e5e7eb', color: '#374151', borderRadius: 8, padding: '0.4rem 0.8rem', fontSize: '0.8rem', fontWeight: 600, cursor: 'pointer', transition: 'all 0.2s', display: 'flex', alignItems: 'center', gap: 6 }}\n                  onMouseOver={e => e.currentTarget.style.background = '#f9fafb'}\n                  onMouseOut={e  => e.currentTarget.style.background = 'transparent'}\n                >\n                  <span></span><span>Save</span>\n                </button>\n              </div>\n            </div>\n\n            {/* Chart / Table area */}\n            <div id=\"forecast-chart-container\" style={{ padding: '0 1.5rem 1.5rem 0.5rem', background: '#ffffff', position: 'relative' }}>\n              {forecastView === 'chart' ? (\n                <div style={{ height: 300, width: '100%', userSelect: 'none' }}>\n                  <ResponsiveContainer>\n                    <AreaChart data={forecastData} margin={{ top: 20, right: 10, left: 0, bottom: 0 }}>\n                      <defs>\n                        <linearGradient id=\"p50Grad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                          <stop offset=\"5%\"  stopColor=\"#00a63e\" stopOpacity={0.2}/>\n                          <stop offset=\"95%\" stopColor=\"#00a63e\" stopOpacity={0}/>\n                        </linearGradient>\n                        <linearGradient id=\"p90Grad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                          <stop offset=\"5%\"  stopColor=\"#3b82f6\" stopOpacity={0.14}/>\n                          <stop offset=\"95%\" stopColor=\"#3b82f6\" stopOpacity={0}/>\n                        </linearGradient>\n                        <linearGradient id=\"p10Grad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                          <stop offset=\"5%\"  stopColor=\"#f59e0b\" stopOpacity={0.14}/>\n                          <stop offset=\"95%\" stopColor=\"#f59e0b\" stopOpacity={0}/>\n                        </linearGradient>\n                      </defs>\n                      <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#f3f4f6\" vertical={false} />\n                      <XAxis\n                        dataKey=\"time\" stroke=\"#9ca3af\"\n                        tickLine={false} axisLine={false} minTickGap={30} tickMargin={12}\n                        tick={{ fill: '#6b7280', fontSize: 11, fontFamily: 'Inter, sans-serif' }} textAnchor=\"middle\"\n                        allowDataOverflow type=\"category\"\n                        tickFormatter={(val: string) => {\n                          if (dateRange === '24h') return val;\n                          const p = val.split(' ');\n                          return p.length >= 3 ? `${p[0]} ${p[1]}` : val;\n                        }}\n                      />\n                      <YAxis\n                        stroke=\"#9ca3af\"\n                        tickLine={false} axisLine={false} width={40} allowDataOverflow\n                        tick={{ fontSize: 11, fontFamily: 'Inter, sans-serif', fill: '#9ca3af' }}\n                        label={{ value: 'kW', angle: -90, position: 'insideLeft', fill: '#9ca3af', fontSize: 10 }}\n                      />\n                      <Tooltip content={<ForecastTooltip />} cursor={{ stroke: '#00a63e', strokeWidth: 1, strokeDasharray: '4 4' }} animationDuration={300} wrapperStyle={{ pointerEvents: 'none' }} />\n                      <Legend verticalAlign=\"top\" height={36} iconType=\"circle\" iconSize={8} wrapperStyle={{ right: 0, top: 0, fontSize: 12, color: '#6b7280', fontFamily: 'Inter, sans-serif' }} />\n\n                      {showBands['P90'] && <Area type=\"monotone\" dataKey=\"p90\" stroke=\"#3b82f6\" strokeWidth={1} strokeDasharray=\"3 3\" fill=\"url(#p90Grad)\" activeDot={false} name=\"P90 (Optimistic)\" animationDuration={500} />}\n                      {showBands['P10'] && <Area type=\"monotone\" dataKey=\"p10\" stroke=\"#f59e0b\" strokeWidth={1} strokeDasharray=\"3 3\" fill=\"url(#p10Grad)\" activeDot={false} name=\"P10 (Conservative)\" animationDuration={500} />}\n                      {showBands['P50'] && <Area type=\"monotone\" dataKey=\"p50\" stroke=\"#00a63e\" strokeWidth={2.5} fill=\"url(#p50Grad)\" activeDot={{ r: 4, strokeWidth: 0 }} name=\"P50 (Median)\" animationDuration={800} />}\n                      <Line type=\"monotone\" dataKey=\"physics\" stroke=\"#d1d5db\" strokeWidth={1.5} strokeDasharray=\"5 3\" dot={false} name=\"Physics Baseline\" activeDot={false} />\n\n                      <ReferenceLine\n                        x={new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                        stroke=\"#ef4444\" strokeDasharray=\"3 3\"\n                        label={<span style={{ color: '#ef4444', fontSize: 10, fontWeight: 700 }}>NOW</span>}\n                      />\n                    </AreaChart>\n                  </ResponsiveContainer>\n                  <div style={{ position: 'absolute', bottom: 10, left: 24, fontSize: '0.62rem', color: '#9ca3af', background: 'rgba(255,255,255,0.85)', padding: '2px 6px', borderRadius: 4, pointerEvents: 'none' }}>\n                    Dashed grey = physics baseline (ideal clear-sky output)\n                  </div>\n                </div>\n              ) : (\n                <ForecastTable data={forecastData} />\n              )}\n              {forecastGeneratedAt && (\n                <div style={{ textAlign: 'right', fontSize: '0.7rem', color: '#9ca3af', marginTop: '0.5rem', fontFamily: 'Inter, sans-serif', padding: '0 1rem 1rem' }}>\n                  Forecast generated: {forecastGeneratedAt.toLocaleDateString()} {forecastGeneratedAt.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n\n      </>)}\n    </div>\n  );\n};\n\nexport default SiteDataPanel;\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport { apiService } from '../services/api';\r\nimport { useDebouncedCallback } from '../hooks/useDebounce';\r\nimport { useTheme } from '../contexts/ThemeContext';\r\nimport AuditTrail from './AuditTrail';\r\nimport SiteDataPanel from './SiteDataPanel';\r\n\r\ninterface User {\r\n  id: number;\r\n  username: string;\r\n  first_name: string;\r\n  last_name: string;\r\n  email: string;\r\n  is_staff: boolean;\r\n  is_superuser: boolean;\r\n}\r\n\r\ninterface Device {\r\n  id: number;\r\n  device_serial: string;\r\n  hw_id?: string;\r\n  model?: string;\r\n  user?: string;\r\n  provisioned_at: string;\r\n  config_version?: string;\r\n  is_online?: boolean;\r\n  last_heartbeat?: string;\r\n  logs_enabled?: boolean;\r\n  pending_config_update?: boolean;\r\n  config_ack_ver?: number | null;\r\n  config_downloaded_at?: string | null;\r\n  config_acked_at?: string | null;\r\n  created_by_username?: string;\r\n  created_at?: string;\r\n  updated_by_username?: string;\r\n  updated_at?: string;\r\n}\r\n\r\ninterface Preset {\r\n  id: number;\r\n  config_id?: string;\r\n  name: string;\r\n  description?: string;\r\n  slaves_count?: number;\r\n  version?: number;\r\n  updated_at?: string;\r\n  gateway_configuration?: {\r\n    general_settings?: {\r\n      config_id?: string;\r\n      last_updated?: string;\r\n    };\r\n  };\r\n}\r\n\r\ninterface SystemHealthData {\r\n  total_devices: number;\r\n  active_devices: number;\r\n  total_telemetry_points: number;\r\n  uptime_seconds: number;\r\n  database_status: string;\r\n  mqtt_status: string;\r\n  overall_health: string;\r\n}\r\n\r\ninterface TelemetryData {\r\n  deviceId: string;\r\n  timestamp: string;\r\n  data_type: string;\r\n  value: number;\r\n  unit: string;\r\n}\r\n\r\ninterface TelemetrySummary {\r\n  totalPoints: number;\r\n  deviceCount: number;\r\n  latestTimestamp: string | null;\r\n}\r\n\r\ninterface SolarSite {\r\n  id: number;\r\n  device_id: number;\r\n  site_id: string;\r\n  display_name: string;\r\n  latitude: number;\r\n  longitude: number;\r\n  capacity_kw: number;\r\n  tilt_deg: number;\r\n  azimuth_deg: number;\r\n  timezone: string;\r\n  is_active: boolean;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\ninterface SolarSiteForm {\r\n  site_id: string;\r\n  display_name: string;\r\n  latitude: string;\r\n  longitude: string;\r\n  capacity_kw: string;\r\n  tilt_deg: string;\r\n  azimuth_deg: string;\r\n  timezone: string;\r\n  is_active: boolean;\r\n}\r\n\r\nconst Devices: React.FC = () => {\r\n  const { isDark } = useTheme();\r\n  const [searchParams] = useSearchParams();\r\n  const [devices, setDevices] = useState<Device[]>([]);\r\n  const [filteredDevices, setFilteredDevices] = useState<Device[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [editingDevice, setEditingDevice] = useState<Device | null>(null);\r\n  const [creatingDevice, setCreatingDevice] = useState(false);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [userSearchTerm, setUserSearchTerm] = useState('');\r\n  const [filteredUsers, setFilteredUsers] = useState<User[]>([]);\r\n  const [showUserDropdown, setShowUserDropdown] = useState(false);\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [selectedDevices, setSelectedDevices] = useState<Set<number>>(new Set());\r\n  const [bulkDeleteLoading, setBulkDeleteLoading] = useState(false);\r\n  // Pagination state\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [pageSize, setPageSize] = useState(25);\r\n  const [totalCount, setTotalCount] = useState(0);\r\n  const [totalPages, setTotalPages] = useState(0);\r\n  const [presets, setPresets] = useState<Preset[]>([]);\r\n  const [presetsLoading, setPresetsLoading] = useState(true);\r\n  const [health, setHealth] = useState<SystemHealthData | null>(null);\r\n  const [telemetrySummary, setTelemetrySummary] = useState<TelemetrySummary | null>(null);\r\n  const [telemetryData, setTelemetryData] = useState<TelemetryData[]>([]);\r\n  const [dashboardError, setDashboardError] = useState<string | null>(null);\r\n  const [selectedDevice, setSelectedDevice] = useState<Device | null>(null);\r\n  const [deviceLogs, setDeviceLogs] = useState<any[]>([]);\r\n  const [logsLoading, setLogsLoading] = useState(false);\r\n  const [editForm, setEditForm] = useState({\r\n    device_serial: '',\r\n    user: '',\r\n    config_version: '',\r\n  });\r\n  const [createForm, setCreateForm] = useState({\r\n    device_serial: '',\r\n    user: '',\r\n    config_version: '',\r\n  });\r\n\r\n  // Site management state\r\n  const [siteDetails, setSiteDetails] = useState<SolarSite | null>(null);\r\n  const [siteLoading, setSiteLoading] = useState(false);\r\n  const [editingSite, setEditingSite] = useState(false);\r\n  const [siteForm, setSiteForm] = useState<SolarSiteForm>({\r\n    site_id: '', display_name: '', latitude: '', longitude: '',\r\n    capacity_kw: '', tilt_deg: '18', azimuth_deg: '180',\r\n    timezone: 'Asia/Kolkata', is_active: true,\r\n  });\r\n  const [siteSaving, setSiteSaving] = useState(false);\r\n  const [siteError, setSiteError] = useState<string | null>(null);\r\n  const [devicePreset, setDevicePreset] = useState<Preset | null>(null);\r\n\r\n  const fetchDevices = useCallback(async (page: number = 1, search: string = '') => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await apiService.getDevices(search || undefined, page, pageSize);\r\n      \r\n      // Handle paginated response\r\n      if (response.results) {\r\n        setDevices(response.results);\r\n        setFilteredDevices(response.results);\r\n        setTotalCount(response.count);\r\n        setTotalPages(response.total_pages);\r\n        setCurrentPage(response.current_page);\r\n      } else {\r\n        // Fallback for non-paginated response\r\n        setDevices(Array.isArray(response) ? response : []);\r\n        setFilteredDevices(Array.isArray(response) ? response : []);\r\n        setTotalCount(Array.isArray(response) ? response.length : 0);\r\n        setTotalPages(1);\r\n        setCurrentPage(1);\r\n      }\r\n      \r\n      setLoading(false);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'An error occurred');\r\n      setLoading(false);\r\n    }\r\n  }, [pageSize]);\r\n\r\n  const fetchUsers = async () => {\r\n    try {\r\n      const data: User[] = await apiService.getUsers();\r\n      // Filter out staff and superusers, only showing regular customers\r\n      const customers = data.filter(user => !user.is_staff && !user.is_superuser);\r\n      setUsers(customers);\r\n    } catch (err) {\r\n      console.error('Failed to fetch users:', err);\r\n      setError('Failed to load users for device assignment');\r\n    }\r\n  };\r\n\r\n  const fetchPresets = async () => {\r\n    try {\r\n      const data = await apiService.getPresets();\r\n      setPresets(Array.isArray(data) ? data : []);\r\n    } catch (err) {\r\n      console.error('Failed to fetch presets:', err);\r\n    } finally {\r\n      setPresetsLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchDashboardData = async () => {\r\n    try {\r\n      const [healthData, telemetryData] = await Promise.all([\r\n        apiService.getSystemHealth(),\r\n        apiService.getTelemetry(),\r\n      ]);\r\n\r\n      setHealth(healthData || null);\r\n\r\n      const telemetryArray = Array.isArray(telemetryData) ? telemetryData : [];\r\n      setTelemetryData(telemetryArray);\r\n      const latest = telemetryArray.reduce<string | null>((currentLatest, item) => {\r\n        if (!item?.timestamp) return currentLatest;\r\n        const itemDate = new Date(item.timestamp);\r\n        if (Number.isNaN(itemDate.getTime())) return currentLatest;\r\n        if (!currentLatest) return item.timestamp;\r\n        const currentDate = new Date(currentLatest);\r\n        return itemDate > currentDate ? item.timestamp : currentLatest;\r\n      }, null);\r\n\r\n      const deviceCount = new Set(telemetryArray.map((item: TelemetryData) => item.deviceId)).size;\r\n      setTelemetrySummary({\r\n        totalPoints: telemetryArray.length,\r\n        deviceCount,\r\n        latestTimestamp: latest,\r\n      });\r\n    } catch (err) {\r\n      console.error('Failed to fetch dashboard data:', err);\r\n      setDashboardError('Failed to load device dashboards');\r\n    }\r\n  };\r\n\r\n  const fetchDeviceLogs = useCallback(async (deviceId: number) => {\r\n    setLogsLoading(true);\r\n    try {\r\n      const response = await apiService.getDeviceLogs(deviceId, 50, 0);\r\n      setDeviceLogs(response.logs || []);\r\n    } catch (err) {\r\n      console.error('Failed to fetch device logs:', err);\r\n      setDeviceLogs([]);\r\n    } finally {\r\n      setLogsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const handleViewDevice = useCallback((device: Device) => {\r\n    setSelectedDevice(device);\r\n    setSiteDetails(null);\r\n    setSiteLoading(true);\r\n    setDeviceLogs([]);\r\n    \r\n    // Load preset details if device has config\r\n    if (device.config_version) {\r\n      const preset = presets.find(p => p.config_id === device.config_version);\r\n      setDevicePreset(preset || null);\r\n    } else {\r\n      setDevicePreset(null);\r\n    }\r\n    \r\n    // Fetch site details and logs in parallel\r\n    Promise.all([\r\n      apiService.getDeviceSite(device.id)\r\n        .then(data => setSiteDetails(data))\r\n        .catch((err) => {\r\n          console.error('Failed to fetch site for device', device.id, ':', err);\r\n          setSiteDetails(null);\r\n        }),\r\n      fetchDeviceLogs(device.id)\r\n    ]).finally(() => setSiteLoading(false));\r\n  }, [fetchDeviceLogs, presets]);\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n    fetchPresets();\r\n    fetchDashboardData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const deviceIdParam = searchParams.get('deviceId');\r\n    if (deviceIdParam) {\r\n      const deviceId = parseInt(deviceIdParam, 10);\r\n      if (!isNaN(deviceId)) {\r\n        const foundDevice = devices.find(d => d.id === deviceId);\r\n        if (foundDevice) {\r\n          handleViewDevice(foundDevice);\r\n        }\r\n      }\r\n    }\r\n  }, [searchParams, devices, handleViewDevice]);\r\n  \r\n  useEffect(() => {\r\n    fetchDevices(currentPage, searchTerm);\r\n  }, [currentPage, searchTerm, pageSize, fetchDevices]);\r\n  \r\n  useEffect(() => {\r\n    const handleClickOutside = () => {\r\n      setShowUserDropdown(false);\r\n    };\r\n\r\n    if (showUserDropdown) {\r\n      document.addEventListener('click', handleClickOutside);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('click', handleClickOutside);\r\n    };\r\n  }, [showUserDropdown]);\r\n\r\n  useEffect(() => {\r\n    if (userSearchTerm.trim() === '') {\r\n      setFilteredUsers(users);\r\n    } else {\r\n      const searchLower = userSearchTerm.toLowerCase();\r\n      const filtered = users.filter(user => {\r\n        const fullName = `${user.first_name} ${user.last_name}`.toLowerCase();\r\n        return (\r\n          user.username.toLowerCase().includes(searchLower) ||\r\n          user.first_name.toLowerCase().includes(searchLower) ||\r\n          user.last_name.toLowerCase().includes(searchLower) ||\r\n          fullName.includes(searchLower) ||\r\n          user.email.toLowerCase().includes(searchLower)\r\n        );\r\n      });\r\n      setFilteredUsers(filtered);\r\n    }\r\n  }, [users, userSearchTerm]);\r\n\r\n  // Debounced search function that runs the actual search after 300ms of inactivity\r\n  const debouncedSearch = useDebouncedCallback(\r\n    (query: string) => {\r\n      // The actual search happens via useEffect that watches currentPage and searchTerm\r\n      // This ensures we don't make too many API calls\r\n    },\r\n    300\r\n  );\r\n\r\n  const handleSearch = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const query = e.target.value;\r\n    setSearchTerm(query);\r\n    setCurrentPage(1);  // Reset to page 1 on new search\r\n    debouncedSearch(query);  // Debounce the search\r\n  };\r\n\r\n  const handleEdit = (device: Device) => {\r\n    setEditingDevice(device);\r\n    setEditForm({\r\n      device_serial: device.device_serial,\r\n      user: device.user || '',\r\n      config_version: device.config_version || '',\r\n    });\r\n    setUserSearchTerm(device.user ? `${users.find(u => u.username === device.user)?.first_name} ${users.find(u => u.username === device.user)?.last_name} (${device.user})` : '');\r\n    setShowUserDropdown(false);\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    if (!editingDevice) return;\r\n\r\n    try {\r\n      await apiService.updateDevice(editingDevice.id, editForm);\r\n      setEditingDevice(null);\r\n      // Refetch to get the updated device with all fields including audit trail\r\n      await fetchDevices(currentPage, searchTerm);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to update device');\r\n    }\r\n  };\r\n\r\n  const handleCreate = async () => {\r\n    try {\r\n      await apiService.createDevice(createForm);\r\n      setCreatingDevice(false);\r\n      setCreateForm({\r\n        device_serial: '',\r\n        user: '',\r\n        config_version: '',\r\n      });\r\n      // Refetch to get the new device with all fields including audit trail\r\n      await fetchDevices(currentPage, searchTerm);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to create device');\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (device: any) => {\r\n    if (window.confirm(`Are you sure you want to delete device ${device.device_serial}?`)) {\r\n      try {\r\n        await apiService.deleteDevice(device.id);\r\n        const updatedDevices = devices.filter(d => d.id !== device.id);\r\n        setDevices(updatedDevices);\r\n        setFilteredDevices(updatedDevices);\r\n      } catch (err) {\r\n        console.error('Delete error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to delete device');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleReboot = async (device: any) => {\r\n    if (window.confirm(`Are you sure you want to reboot device ${device.device_serial}? The device will restart on its next heartbeat.`)) {\r\n      try {\r\n        await apiService.rebootDevice(device.id);\r\n        alert(`Reboot command queued for ${device.device_serial}. Device will reboot on next heartbeat.`);\r\n      } catch (err) {\r\n        console.error('Reboot error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to queue reboot command');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleHardReset = async (device: any) => {\r\n    if (window.confirm(` WARNING: Hard reset will erase device configuration and restart it.\\n\\nAre you sure you want to hard reset device ${device.device_serial}?`)) {\r\n      try {\r\n        await apiService.hardResetDevice(device.id);\r\n        alert(`Hard reset command queued for ${device.device_serial}. Device will reset on next heartbeat.`);\r\n      } catch (err) {\r\n        console.error('Hard reset error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to queue hard reset command');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDeleteDevice = async (device: any) => {\r\n    if (window.confirm(` WARNING: This will permanently delete device ${device.device_serial} and all its data.\\n\\nAre you sure you want to delete this device?`)) {\r\n      try {\r\n        await apiService.deleteDevice(device.id);\r\n        alert(`Device ${device.device_serial} deleted successfully.`);\r\n        setSelectedDevice(null);\r\n        fetchDevices(); // Refresh device list\r\n      } catch (err) {\r\n        console.error('Delete device error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to delete device');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleToggleLogs = async (device: any, enabled: boolean) => {\r\n    try {\r\n      await apiService.toggleDeviceLogs(device.id, enabled);\r\n      setSelectedDevice({ ...device, logs_enabled: enabled });\r\n      fetchDevices(); // Refresh device list\r\n    } catch (err) {\r\n      console.error('Toggle logs error:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to toggle device logs');\r\n    }\r\n  };\r\n\r\n  const handleSelectDevice = (deviceId: number) => {\r\n    const newSelected = new Set(selectedDevices);\r\n    if (newSelected.has(deviceId)) {\r\n      newSelected.delete(deviceId);\r\n    } else {\r\n      newSelected.add(deviceId);\r\n    }\r\n    setSelectedDevices(newSelected);\r\n  };\r\n\r\n  const handleSelectAll = () => {\r\n    if (selectedDevices.size === filteredDevices.length) {\r\n      setSelectedDevices(new Set());\r\n    } else {\r\n      const allIds = new Set(filteredDevices.map(d => d.id));\r\n      setSelectedDevices(allIds);\r\n    }\r\n  };\r\n\r\n  const handleBulkDelete = async () => {\r\n    if (selectedDevices.size === 0) {\r\n      setError('No devices selected for deletion');\r\n      return;\r\n    }\r\n\r\n    const deviceList = Array.from(selectedDevices)\r\n      .map(id => devices.find(d => d.id === id))\r\n      .filter(Boolean);\r\n\r\n    const confirmMessage = `Are you sure you want to delete ${selectedDevices.size} device(s)?\\n\\n${deviceList.map(d => d?.device_serial).join(', ')}`;\r\n\r\n    if (window.confirm(confirmMessage)) {\r\n      try {\r\n        setBulkDeleteLoading(true);\r\n        await apiService.deleteDevicesBulk(Array.from(selectedDevices));\r\n        \r\n        const updatedDevices = devices.filter(d => !selectedDevices.has(d.id));\r\n        setDevices(updatedDevices);\r\n        setFilteredDevices(updatedDevices.filter(d => \r\n          d.device_serial.toLowerCase().includes(searchTerm.toLowerCase())\r\n        ));\r\n        setSelectedDevices(new Set());\r\n        setBulkDeleteLoading(false);\r\n      } catch (err) {\r\n        setBulkDeleteLoading(false);\r\n        console.error('Bulk delete error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to delete devices');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setEditingDevice(null);\r\n    setCreatingDevice(false);\r\n    setUserSearchTerm('');\r\n    setShowUserDropdown(false);\r\n  };\r\n\r\n  const handleBackToList = () => {\r\n    setSelectedDevice(null);\r\n    setSiteDetails(null);\r\n    setEditingSite(false);\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"loading\">Loading devices...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div className=\"error\">Error: {error}</div>;\r\n  }\r\n\r\n  const getPresetConfigId = (preset: Preset): string => {\r\n    return preset.gateway_configuration?.general_settings?.config_id || preset.config_id || '';\r\n  };\r\n\r\n  if (selectedDevice) {\r\n    const deviceTelemetry = telemetryData.filter((entry) => entry.deviceId === selectedDevice.device_serial);\r\n    const latestTelemetry = deviceTelemetry.reduce<string | null>((currentLatest, item) => {\r\n      if (!item?.timestamp) return currentLatest;\r\n      const itemDate = new Date(item.timestamp);\r\n      if (Number.isNaN(itemDate.getTime())) return currentLatest;\r\n      if (!currentLatest) return item.timestamp;\r\n      const currentDate = new Date(currentLatest);\r\n      return itemDate > currentDate ? item.timestamp : currentLatest;\r\n    }, null);\r\n\r\n    return (\r\n      <div>\r\n        <div style={{ display: 'flex', alignItems: 'center', marginBottom: '20px' }}>\r\n          <button\r\n            onClick={handleBackToList}\r\n            className=\"btn btn-secondary\"\r\n            style={{ marginRight: '15px' }}\r\n          >\r\n             Back to Devices\r\n          </button>\r\n          <h1 style={{ margin: 0 }}>{selectedDevice.device_serial} Dashboard</h1>\r\n        </div>\r\n\r\n        <div className=\"card\" style={{ marginBottom: '20px' }}>\r\n          <div className=\"card-header\">\r\n            <h2>Device Details</h2>\r\n            <div style={{ display: 'flex', gap: '10px' }}>\r\n              <button onClick={() => handleEdit(selectedDevice)} className=\"btn\">\r\n                Edit Device\r\n              </button>\r\n              <button \r\n                onClick={() => handleReboot(selectedDevice)} \r\n                className=\"btn\"\r\n                style={{ \r\n                  backgroundColor: '#f59e0b', \r\n                  color: 'white',\r\n                  border: 'none'\r\n                }}\r\n                title=\"Queue reboot command for device\"\r\n              >\r\n                 Reboot\r\n              </button>\r\n              <button \r\n                onClick={() => handleHardReset(selectedDevice)} \r\n                className=\"btn\"\r\n                style={{ \r\n                  backgroundColor: '#dc2626', \r\n                  color: 'white',\r\n                  border: 'none'\r\n                }}\r\n                title=\"Queue hard reset command for device (erases config)\"\r\n              >\r\n                 Hard Reset\r\n              </button>\r\n              <button \r\n                onClick={() => handleDeleteDevice(selectedDevice)} \r\n                className=\"btn\"\r\n                style={{ \r\n                  backgroundColor: '#7f1d1d', \r\n                  color: 'white',\r\n                  border: 'none'\r\n                }}\r\n                title=\"Permanently delete device and all its data\"\r\n              >\r\n                 Delete\r\n              </button>\r\n            </div>\r\n          </div>\r\n          <div style={{ padding: '20px' }}>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '15px' }}>\r\n              <div>\r\n                <strong>Status:</strong>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  <span style={{\r\n                    display: 'inline-block',\r\n                    padding: '4px 12px',\r\n                    borderRadius: '12px',\r\n                    fontSize: '0.875rem',\r\n                    fontWeight: '500',\r\n                    backgroundColor: selectedDevice.is_online ? '#dcfce7' : '#fee2e2',\r\n                    color: selectedDevice.is_online ? '#166534' : '#991b1b'\r\n                  }}>\r\n                    {selectedDevice.is_online ? ' Online' : ' Offline'}\r\n                  </span>\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <strong>Last Heartbeat:</strong>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  {selectedDevice.last_heartbeat\r\n                    ? new Date(selectedDevice.last_heartbeat).toLocaleString()\r\n                    : 'Never'}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <strong>MAC / HW ID:</strong>\r\n                <p style={{ margin: '5px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.9rem' }}>{selectedDevice.hw_id || ''}</p>\r\n              </div>\r\n              <div>\r\n                <strong>Model:</strong>\r\n                <p style={{ margin: '5px 0' }}>{selectedDevice.model || ''}</p>\r\n              </div>\r\n              <div>\r\n                <strong>Assigned User:</strong>\r\n                <p style={{ margin: '5px 0' }}>{selectedDevice.user || '-'}</p>\r\n              </div>\r\n              <div style={{ gridColumn: '1 / -1', padding: '15px', backgroundColor: 'transparent', borderRadius: '8px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-sync-card\">\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '12px' }}>\r\n                  <div>\r\n                    <strong style={{ fontSize: '0.95rem', color: 'inherit' }} className=\"config-heading\">Configuration</strong>\r\n                    {devicePreset && (\r\n                      <div style={{ fontSize: '0.875rem', color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginTop: '2px' }} className=\"config-label\">\r\n                        {devicePreset.name || selectedDevice.config_version}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  {!selectedDevice.config_version ? (\r\n                    <span style={{ color: isDark ? '#a0a0a0' : 'rgba(0, 0, 0, 0.5)', fontSize: '0.875rem' }} className=\"config-no-preset\">No preset assigned</span>\r\n                  ) : selectedDevice.pending_config_update ? (\r\n                    <span style={{\r\n                      display: 'inline-flex', alignItems: 'center', gap: '5px',\r\n                      padding: '4px 12px', borderRadius: '12px', fontSize: '0.8rem', fontWeight: '500',\r\n                      backgroundColor: '#fef9c3', color: '#854d0e'\r\n                    }}> Pending update</span>\r\n                  ) : (\r\n                    <span style={{\r\n                      display: 'inline-flex', alignItems: 'center', gap: '5px',\r\n                      padding: '4px 12px', borderRadius: '12px', fontSize: '0.8rem', fontWeight: '500',\r\n                      backgroundColor: '#dcfce7', color: '#166534'\r\n                    }}> Synced</span>\r\n                  )}\r\n                </div>\r\n                {selectedDevice.config_version && (\r\n                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '8px', fontSize: '0.8rem' }}>\r\n                    <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                      <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Preset ID</div>\r\n                      <div style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>{selectedDevice.config_version}</div>\r\n                    </div>\r\n                    {devicePreset?.slaves_count != null && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Slaves</div>\r\n                        <div style={{ fontWeight: '500', color: 'inherit' }}>{devicePreset.slaves_count} device{devicePreset.slaves_count !== 1 ? 's' : ''}</div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_ack_ver != null && devicePreset?.version != null && (\r\n                      <div style={{ \r\n                        padding: '8px', \r\n                        backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', \r\n                        borderRadius: '6px',\r\n                        gridColumn: '1 / -1',\r\n                        border: selectedDevice.config_ack_ver === devicePreset.version ? '2px solid #dcfce7' : '2px solid #fef9c3'\r\n                      }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '4px' }} className=\"config-label\">Version Status</div>\r\n                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                          <div>\r\n                            <span style={{ fontSize: '0.75rem', color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)' }} className=\"config-label\">Device: </span>\r\n                            <span style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>v{selectedDevice.config_ack_ver}</span>\r\n                            <span style={{ margin: '0 8px', color: isDark ? '#808080' : 'rgba(0, 0, 0, 0.4)' }} className=\"config-arrow\"></span>\r\n                            <span style={{ fontSize: '0.75rem', color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)' }} className=\"config-label\">Latest: </span>\r\n                            <span style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>v{devicePreset.version}</span>\r\n                          </div>\r\n                          {selectedDevice.config_ack_ver === devicePreset.version ? (\r\n                            <span style={{ color: '#166534', fontSize: '0.75rem', fontWeight: '500' }}> Up to date</span>\r\n                          ) : (\r\n                            <span style={{ color: '#854d0e', fontSize: '0.75rem', fontWeight: '500' }}> Update available</span>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_ack_ver != null && devicePreset?.version == null && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Device Version</div>\r\n                        <div style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>v{selectedDevice.config_ack_ver}</div>\r\n                      </div>\r\n                    )}\r\n                    {devicePreset?.gateway_configuration?.general_settings?.last_updated && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Last Modified</div>\r\n                        <div style={{ fontWeight: '500', fontSize: '0.75rem', color: 'inherit' }}>\r\n                          {new Date(devicePreset.gateway_configuration.general_settings.last_updated).toLocaleDateString()}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_acked_at && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)', gridColumn: '1 / -1' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Last Synced</div>\r\n                        <div style={{ fontWeight: '500', fontSize: '0.75rem', color: 'inherit' }}>\r\n                          {new Date(selectedDevice.config_acked_at).toLocaleString()}\r\n                          {(() => {\r\n                            const ackTime = new Date(selectedDevice.config_acked_at);\r\n                            const now = new Date();\r\n                            const diffMs = now.getTime() - ackTime.getTime();\r\n                            const diffMins = Math.floor(diffMs / 60000);\r\n                            const diffHours = Math.floor(diffMins / 60);\r\n                            const diffDays = Math.floor(diffHours / 24);\r\n                            if (diffMins < 1) return '  just now';\r\n                            if (diffMins < 60) return `  ${diffMins}m ago`;\r\n                            if (diffHours < 24) return `  ${diffHours}h ago`;\r\n                            return `  ${diffDays}d ago`;\r\n                          })()}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_downloaded_at && selectedDevice.config_acked_at && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)', gridColumn: '1 / -1' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Apply Duration</div>\r\n                        <div style={{ fontWeight: '500', color: 'inherit' }}>\r\n                          {Math.round((new Date(selectedDevice.config_acked_at).getTime() - new Date(selectedDevice.config_downloaded_at).getTime()) / 1000)} seconds\r\n                          <span style={{ color: isDark ? '#a0a0a0' : 'rgba(0, 0, 0, 0.5)', marginLeft: '8px', fontSize: '0.75rem' }} className=\"config-label\">\r\n                            (download  acknowledge)\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div>\r\n                <strong>Provisioned At:</strong>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  {selectedDevice.provisioned_at\r\n                    ? new Date(selectedDevice.provisioned_at).toLocaleDateString()\r\n                    : 'N/A'}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <strong>Created By:</strong>\r\n                <p style={{ margin: '5px 0' }}>{selectedDevice.created_by_username || '-'}</p>\r\n              </div>\r\n              <div style={{ gridColumn: '1 / -1' }}>\r\n                <label style={{ display: 'flex', alignItems: 'center', gap: '10px', cursor: 'pointer' }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedDevice.logs_enabled || false}\r\n                    onChange={(e) => handleToggleLogs(selectedDevice, e.target.checked)}\r\n                    style={{ background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                  />\r\n                  <strong>Enable Device Logs</strong>\r\n                  <span style={{ fontSize: '0.875rem', color: isDark ? '#b0b0b0' : '#9ca3af' }}>\r\n                    (Device will send logs when enabled)\r\n                  </span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-2\" style={{ gap: 'var(--space-6, 24px)', marginTop: '32px' }}>\r\n          <div className=\"card\">\r\n            <h2>System Health</h2>\r\n            {dashboardError && <p className=\"error\">{dashboardError}</p>}\r\n            {!dashboardError && !health && <p>Loading system health...</p>}\r\n            {health && (\r\n              <div>\r\n                <p><strong>Overall:</strong> {health.overall_health}</p>\r\n                <p><strong>Devices:</strong> {health.active_devices}/{health.total_devices} active</p>\r\n                <p><strong>Telemetry Points:</strong> {health.total_telemetry_points.toLocaleString()}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"card\">\r\n            <h2>Telemetry Snapshot</h2>\r\n            {dashboardError && <p className=\"error\">{dashboardError}</p>}\r\n            {!dashboardError && !telemetrySummary && <p>Loading telemetry...</p>}\r\n            {telemetrySummary && (\r\n              <div>\r\n                <p><strong>Total Points:</strong> {deviceTelemetry.length.toLocaleString()}</p>\r\n                <p><strong>Data Types:</strong> {new Set(deviceTelemetry.map((entry) => entry.data_type)).size}</p>\r\n                <p><strong>Latest:</strong> {latestTelemetry ? new Date(latestTelemetry).toLocaleString() : 'N/A'}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  Site Configuration  */}\r\n        <div className=\"card\" style={{ marginTop: '48px' }}>\r\n          <div className=\"card-header\">\r\n            <h2>Site Configuration</h2>\r\n            {!siteLoading && (\r\n              <button className=\"btn\" onClick={() => {\r\n                if (siteDetails) {\r\n                  setSiteForm({\r\n                    site_id: siteDetails.site_id,\r\n                    display_name: siteDetails.display_name,\r\n                    latitude: String(siteDetails.latitude),\r\n                    longitude: String(siteDetails.longitude),\r\n                    capacity_kw: String(siteDetails.capacity_kw),\r\n                    tilt_deg: String(siteDetails.tilt_deg),\r\n                    azimuth_deg: String(siteDetails.azimuth_deg),\r\n                    timezone: siteDetails.timezone,\r\n                    is_active: siteDetails.is_active,\r\n                  });\r\n                } else {\r\n                  setSiteForm({ site_id: '', display_name: '', latitude: '', longitude: '', capacity_kw: '', tilt_deg: '18', azimuth_deg: '180', timezone: 'Asia/Kolkata', is_active: true });\r\n                }\r\n                setSiteError(null);\r\n                setEditingSite(true);\r\n              }}>\r\n                {siteDetails ? 'Edit Site' : 'Add Site'}\r\n              </button>\r\n            )}\r\n          </div>\r\n          <div style={{ padding: '20px' }}>\r\n            {siteLoading ? (\r\n              <p style={{ color: 'var(--text-muted)' }}>Loading site details</p>\r\n            ) : !siteDetails ? (\r\n              <p style={{ color: 'var(--text-muted)', fontSize: '0.9rem' }}>No site configured for this device yet.</p>\r\n            ) : (\r\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '15px' }}>\r\n                <div><strong>Site ID:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.88rem', color: '#00a63e' }}>{siteDetails.site_id}</p></div>\r\n                <div><strong>Display Name:</strong><p style={{ margin: '4px 0' }}>{siteDetails.display_name || ''}</p></div>\r\n                <div><strong>Status:</strong><p style={{ margin: '4px 0' }}><span className={siteDetails.is_active ? 'status-badge status-badge-success' : 'status-badge status-badge-danger'}>{siteDetails.is_active ? 'Active' : 'Inactive'}</span></p></div>\r\n                <div><strong>Latitude:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.88rem' }}>{siteDetails.latitude}</p></div>\r\n                <div><strong>Longitude:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.88rem' }}>{siteDetails.longitude}</p></div>\r\n                <div><strong>Timezone:</strong><p style={{ margin: '4px 0' }}>{siteDetails.timezone}</p></div>\r\n                <div><strong>Capacity:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace' }}>{siteDetails.capacity_kw} kW</p></div>\r\n                <div><strong>Tilt:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace' }}>{siteDetails.tilt_deg}</p></div>\r\n                <div><strong>Azimuth:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace' }}>{siteDetails.azimuth_deg}</p></div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  Live Site Intelligence (DynamoDB)  */}\r\n        {siteDetails && (\r\n          <div style={{ marginTop: '48px' }}>\r\n            <SiteDataPanel siteId={siteDetails.site_id} autoRefresh />\r\n          </div>\r\n        )}\r\n\r\n        {/*  Device Logs  */}\r\n        <div className=\"card\" style={{ marginTop: '48px', marginBottom: '20px' }}>\r\n          <div className=\"card-header\">\r\n            <h2>Device Logs</h2>\r\n            <button onClick={() => fetchDeviceLogs(selectedDevice.id)} className=\"btn\" disabled={logsLoading}>\r\n              {logsLoading ? 'Loading...' : ' Refresh'}\r\n            </button>\r\n          </div>\r\n          <div style={{ padding: '20px' }}>\r\n            {!selectedDevice.logs_enabled && (\r\n              <p style={{ color: 'var(--text-muted, #9ca3af)', fontStyle: 'italic' }}>\r\n                Logging is disabled for this device. Enable it in Device Details to receive logs.\r\n              </p>\r\n            )}\r\n            {deviceLogs.length === 0 && selectedDevice.logs_enabled && !logsLoading && (\r\n              <p style={{ color: 'var(--text-muted, #9ca3af)' }}>\r\n                No logs available yet. Logs will appear when device sends them.\r\n              </p>\r\n            )}\r\n            {logsLoading && (\r\n              <p style={{ color: 'var(--text-muted, #9ca3af)' }}>\r\n                Loading logs...\r\n              </p>\r\n            )}\r\n            {deviceLogs.length > 0 && (\r\n              <div style={{ \r\n                maxHeight: '400px', \r\n                overflowY: 'auto', \r\n                fontFamily: 'JetBrains Mono, monospace', \r\n                fontSize: '0.85rem',\r\n                backgroundColor: '#1e1e1e',\r\n                padding: '10px',\r\n                borderRadius: '4px'\r\n              }}>\r\n                {deviceLogs.map((log) => (\r\n                  <div key={log.id} style={{ \r\n                    marginBottom: '8px', \r\n                    paddingBottom: '8px', \r\n                    borderBottom: '1px solid #333',\r\n                    color: log.level === 'ERROR' ? '#ff6b6b' : \r\n                           log.level === 'WARNING' ? '#ffa500' : \r\n                           log.level === 'INFO' ? '#4dabf7' : '#ced4da'\r\n                  }}>\r\n                    <span style={{ color: '#888' }}>[{new Date(log.timestamp).toLocaleString()}]</span>\r\n                    <span style={{ fontWeight: 'bold', marginLeft: '8px' }}>[{log.level}]</span>\r\n                    <span style={{ marginLeft: '8px' }}>{log.message}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  Site edit modal  */}\r\n        {editingSite && (\r\n          <div className=\"modal\">\r\n            <div className=\"modal-content\">\r\n              <h3>{siteDetails ? `Edit Site: ${siteDetails.site_id}` : 'Add Site Configuration'}</h3>\r\n              <form onSubmit={async (e) => {\r\n                e.preventDefault();\r\n                setSiteSaving(true);\r\n                setSiteError(null);\r\n                try {\r\n                  const payload = {\r\n                    site_id: siteForm.site_id.trim(),\r\n                    display_name: siteForm.display_name.trim(),\r\n                    latitude: parseFloat(siteForm.latitude),\r\n                    longitude: parseFloat(siteForm.longitude),\r\n                    capacity_kw: parseFloat(siteForm.capacity_kw),\r\n                    tilt_deg: parseFloat(siteForm.tilt_deg),\r\n                    azimuth_deg: parseFloat(siteForm.azimuth_deg),\r\n                    timezone: siteForm.timezone.trim(),\r\n                    is_active: siteForm.is_active,\r\n                  };\r\n\r\n                  let updated;\r\n                  if (siteDetails) {\r\n                    updated = await apiService.updateDeviceSite(selectedDevice.id, payload);\r\n                  } else {\r\n                    updated = await apiService.createDeviceSite(selectedDevice.id, payload);\r\n                  }\r\n\r\n                  if (!updated || !updated.site_id) {\r\n                    throw new Error('Invalid response from server  site data missing');\r\n                  }\r\n\r\n                  setSiteDetails(updated);\r\n                  setEditingSite(false);\r\n                  setSiteSaving(false);\r\n\r\n                  // Re-fetch after creation to get server-assigned fields\r\n                  if (!siteDetails) {\r\n                    setTimeout(() => {\r\n                      apiService.getDeviceSite(selectedDevice.id)\r\n                        .then(data => { if (data) setSiteDetails(data); })\r\n                        .catch(err => console.error('Failed to re-fetch site:', err));\r\n                    }, 500);\r\n                  }\r\n                } catch (err: any) {\r\n                  setSiteError(err.message || 'Failed to save site');\r\n                  setSiteSaving(false);\r\n                }\r\n              }}>\r\n                <div className=\"modal-body\">\r\n                  {siteError && (\r\n                    <p style={{ color: isDark ? '#fca5a5' : '#ef4444', fontSize: '0.875rem', marginBottom: '1rem' }}>{siteError}</p>\r\n                  )}\r\n\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Identification</h4>\r\n                    <div className=\"form-grid form-grid-2\">\r\n                      <div className=\"form-group\">\r\n                        <label>Site ID *</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          required\r\n                          value={siteForm.site_id}\r\n                          disabled={!!siteDetails}\r\n                          onChange={e => setSiteForm({ ...siteForm, site_id: e.target.value })}\r\n                          placeholder=\"e.g. site_mumbai_01\"\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                        {!!siteDetails && <small className=\"form-hint\">Site ID cannot be changed after creation.</small>}\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Display Name</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={siteForm.display_name}\r\n                          onChange={e => setSiteForm({ ...siteForm, display_name: e.target.value })}\r\n                          placeholder=\"e.g. Mumbai Rooftop\"\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Location</h4>\r\n                    <div className=\"form-grid form-grid-3\">\r\n                      <div className=\"form-group\">\r\n                        <label>Latitude *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          required\r\n                          step=\"any\"\r\n                          value={siteForm.latitude}\r\n                          onChange={e => setSiteForm({ ...siteForm, latitude: e.target.value })}\r\n                          placeholder=\"19.0760\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Longitude *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          required\r\n                          step=\"any\"\r\n                          value={siteForm.longitude}\r\n                          onChange={e => setSiteForm({ ...siteForm, longitude: e.target.value })}\r\n                          placeholder=\"72.8777\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Timezone</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={siteForm.timezone}\r\n                          onChange={e => setSiteForm({ ...siteForm, timezone: e.target.value })}\r\n                          placeholder=\"Asia/Kolkata\"\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Panel Configuration</h4>\r\n                    <div className=\"form-grid form-grid-3\">\r\n                      <div className=\"form-group\">\r\n                        <label>Capacity (kW) *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          required\r\n                          step=\"any\"\r\n                          value={siteForm.capacity_kw}\r\n                          onChange={e => setSiteForm({ ...siteForm, capacity_kw: e.target.value })}\r\n                          placeholder=\"5.0\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Tilt ()</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          step=\"any\"\r\n                          value={siteForm.tilt_deg}\r\n                          onChange={e => setSiteForm({ ...siteForm, tilt_deg: e.target.value })}\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Azimuth ()</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          step=\"any\"\r\n                          value={siteForm.azimuth_deg}\r\n                          onChange={e => setSiteForm({ ...siteForm, azimuth_deg: e.target.value })}\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label style={{ display: 'flex', alignItems: 'center', gap: '8px', cursor: 'pointer' }}>\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          id=\"dev-site-active\"\r\n                          checked={siteForm.is_active}\r\n                          onChange={e => setSiteForm({ ...siteForm, is_active: e.target.checked })}\r\n                          style={{ width: '16px', height: '16px', background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                        Active\r\n                      </label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"form-actions\" style={{ padding: '0 24px 24px 24px' }}>\r\n                  <button type=\"submit\" className=\"btn\" disabled={siteSaving}>\r\n                    {siteSaving ? 'Saving' : siteDetails ? 'Save Changes' : 'Add Site'}\r\n                  </button>\r\n                  <button type=\"button\" className=\"btn btn-secondary\" onClick={() => setEditingSite(false)} disabled={siteSaving}>\r\n                    Cancel\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {editingDevice && (\r\n          <div className=\"modal\">\r\n            <div className=\"modal-content\">\r\n              <h3>{editingDevice ? `Edit Device: ${editingDevice.device_serial}` : 'Register New Device'}</h3>\r\n              <form onSubmit={(e) => { e.preventDefault(); editingDevice ? handleSave() : handleCreate(); }}>\r\n                <div className=\"modal-body\">\r\n                  \r\n                  {/* Device Identity */}\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Device Identity</h4>\r\n                    <div className=\"form-grid\">\r\n                      <div className=\"form-group\">\r\n                        <label>Device Serial Number</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={editingDevice ? editForm.device_serial : createForm.device_serial}\r\n                          onChange={(e) => editingDevice ? setEditForm({...editForm, device_serial: e.target.value}) : setCreateForm({...createForm, device_serial: e.target.value})}\r\n                          required\r\n                          autoComplete=\"off\"\r\n                          placeholder=\"SN-12345678\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Ownership */}\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Ownership & Assignment</h4>\r\n                    <div className=\"form-grid\">\r\n                      <div className=\"form-group\">\r\n                        <label>Assigned User</label>\r\n                        <div style={{ position: 'relative' }} onClick={(e) => e.stopPropagation()}>\r\n                          <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search by name, username, or email...\"\r\n                            value={userSearchTerm}\r\n                            onChange={(e) => {\r\n                              setUserSearchTerm(e.target.value);\r\n                              setShowUserDropdown(true);\r\n                            }}\r\n                            onFocus={() => setShowUserDropdown(true)}\r\n                            autoComplete=\"off\"\r\n                            className=\"full-width\"\r\n                            style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                          />\r\n                          {showUserDropdown && (\r\n                            <div style={{\r\n                              position: 'absolute',\r\n                              top: '100%',\r\n                              left: '0',\r\n                              right: '0',\r\n                              background: 'var(--bg-secondary, #1e293b)',\r\n                              border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                              borderRadius: '6px',\r\n                              marginTop: '4px',\r\n                              maxHeight: '200px',\r\n                              overflowY: 'auto',\r\n                              zIndex: 10,\r\n                              boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)'\r\n                            }}>\r\n                              {filteredUsers.length > 0 ? (\r\n                                filteredUsers.map((user) => (\r\n                                  <div\r\n                                    key={user.id}\r\n                                    onClick={() => {\r\n                                      if (editingDevice) {\r\n                                        setEditForm({...editForm, user: user.username});\r\n                                      } else {\r\n                                        setCreateForm({...createForm, user: user.username});\r\n                                      }\r\n                                      setUserSearchTerm(`${user.first_name} ${user.last_name} (${user.username})`);\r\n                                      setShowUserDropdown(false);\r\n                                    }}\r\n                                    style={{\r\n                                      padding: '12px 16px',\r\n                                      cursor: 'pointer',\r\n                                      borderBottom: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n                                      background: (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent',\r\n                                      color: 'var(--text-primary, #f8fafc)',\r\n                                      transition: 'all 0.15s ease',\r\n                                      fontSize: '0.875rem'\r\n                                    }}\r\n                                    onMouseEnter={(e) => e.currentTarget.style.background = 'rgba(255, 255, 255, 0.06)'}\r\n                                    onMouseLeave={(e) => e.currentTarget.style.background = (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent'}\r\n                                  >\r\n                                    {user.first_name} {user.last_name} ({user.username}) <br/>\r\n                                    <span style={{ fontSize: '0.75rem', color: 'var(--text-secondary, #94a3b8)' }}>{user.email}</span>\r\n                                  </div>\r\n                                ))\r\n                              ) : (\r\n                                <div style={{ padding: '12px 16px', color: 'var(--text-muted, #64748b)', fontSize: '0.875rem' }}>\r\n                                  {userSearchTerm.trim() === '' ? 'Start typing to search users...' : 'No users found'}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Configuration */}\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Configuration</h4>\r\n                    <div className=\"form-grid form-grid-2\">\r\n                      <div className=\"form-group\">\r\n                        <label>Preset Template</label>\r\n                        <select\r\n                          value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                          onChange={(e) => editingDevice ? setEditForm({ ...editForm, config_version: e.target.value }) : setCreateForm({ ...createForm, config_version: e.target.value })}\r\n                          className=\"full-width\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        >\r\n                          <option value=\"\">-- Manual Configuration --</option>\r\n                          {presetsLoading && <option value=\"\" disabled>Loading presets...</option>}\r\n                          {!presetsLoading && presets.map((preset) => (\r\n                            <option key={preset.id} value={getPresetConfigId(preset)}>\r\n                              {preset.name} ({getPresetConfigId(preset) || 'no ID'})\r\n                            </option>\r\n                          ))}\r\n                        </select>\r\n                        <small className=\"form-hint\">Selecting a preset sets the Config Version ID below.</small>\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Config Version ID</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                          onChange={(e) => editingDevice ? setEditForm({...editForm, config_version: e.target.value}) : setCreateForm({...createForm, config_version: e.target.value})}\r\n                          autoComplete=\"off\"\r\n                          placeholder=\"Manual Config ID\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                </div>\r\n                {editingDevice && (\r\n                  <div style={{ padding: '0 24px' }}>\r\n                     <AuditTrail\r\n                       createdBy={editingDevice.created_by_username}\r\n                       createdAt={editingDevice.created_at}\r\n                       updatedBy={editingDevice.updated_by_username}\r\n                       updatedAt={editingDevice.updated_at}\r\n                     />\r\n                  </div>\r\n                )}\r\n                <div className=\"form-actions\" style={{ padding: '0 24px 24px 24px' }}>\r\n                  <button type=\"submit\" className=\"btn\">{editingDevice ? 'Save Changes' : 'Create Device'}</button>\r\n                  <button type=\"button\" onClick={handleCancel} className=\"btn btn-secondary\">Cancel</button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h1>Device Management</h1>\r\n\r\n      <div className=\"card\">\r\n        <div className=\"card-header\">\r\n          <h2>Devices ({filteredDevices.length})</h2>\r\n          <div className=\"card-actions\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search devices...\"\r\n              value={searchTerm}\r\n              onChange={handleSearch}\r\n              className=\"search-input\"\r\n              style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n            />\r\n            {selectedDevices.size > 0 && (\r\n              <button \r\n                onClick={handleBulkDelete}\r\n                disabled={bulkDeleteLoading}\r\n                style={{ \r\n                  background: 'var(--danger-color, #ef4444)',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '8px 16px',\r\n                  borderRadius: '6px',\r\n                  cursor: bulkDeleteLoading ? 'not-allowed' : 'pointer',\r\n                  fontSize: '0.875rem',\r\n                  fontWeight: '500',\r\n                  opacity: bulkDeleteLoading ? '0.6' : '1'\r\n                }}\r\n              >\r\n                {bulkDeleteLoading ? `Deleting ${selectedDevices.size}...` : `Delete Selected (${selectedDevices.size})`}\r\n              </button>\r\n            )}\r\n            <button onClick={() => {\r\n              setCreatingDevice(true);\r\n              setUserSearchTerm('');\r\n              setShowUserDropdown(false);\r\n            }} className=\"btn\">\r\n              Register New Device\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <table className=\"table\">\r\n          <thead>\r\n            <tr>\r\n              <th style={{ textAlign: 'center', width: '40px' }}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={selectedDevices.size === filteredDevices.length && filteredDevices.length > 0}\r\n                  onChange={handleSelectAll}\r\n                  title=\"Select all displayed devices\"\r\n                  style={{ background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                />\r\n              </th>\r\n              <th style={{ textAlign: 'center' }}>Device Serial</th>\r\n              <th style={{ textAlign: 'center' }}>Status</th>\r\n              <th style={{ textAlign: 'center' }}>MAC / HW ID</th>\r\n              <th style={{ textAlign: 'center' }}>Model</th>\r\n              <th style={{ textAlign: 'center' }}>Assigned To</th>\r\n              <th style={{ textAlign: 'center' }}>Config Version</th>\r\n              <th style={{ textAlign: 'center' }}>Provisioned At</th>\r\n              <th style={{ textAlign: 'center' }}>Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {filteredDevices.map((device) => (\r\n              <tr\r\n                key={device.id}\r\n                onClick={() => handleViewDevice(device)}\r\n                style={{\r\n                  background: selectedDevices.has(device.id) ? 'rgba(99, 102, 241, 0.1)' : 'transparent',\r\n                  cursor: 'pointer'\r\n                }}\r\n                className=\"clickable-row\"\r\n              >\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedDevices.has(device.id)}\r\n                    onChange={() => handleSelectDevice(device.id)}\r\n                    style={{ background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                  />\r\n                </td>\r\n                <td style={{ textAlign: 'center', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.85rem' }}>{device.device_serial}</td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <span style={{\r\n                    display: 'inline-block',\r\n                    padding: '4px 8px',\r\n                    borderRadius: '12px',\r\n                    fontSize: '0.75rem',\r\n                    fontWeight: '500',\r\n                    backgroundColor: device.is_online ? '#dcfce7' : '#fee2e2',\r\n                    color: device.is_online ? '#166534' : '#991b1b'\r\n                  }}>\r\n                    {device.is_online ? ' Online' : ' Offline'}\r\n                  </span>\r\n                </td>\r\n                <td style={{ textAlign: 'center', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.82rem', color: device.hw_id ? 'inherit' : 'var(--text-muted, #9ca3af)' }}>{device.hw_id || ''}</td>\r\n                <td style={{ textAlign: 'center', fontSize: '0.875rem' }}>{device.model || <span style={{ color: 'var(--text-muted, #9ca3af)' }}></span>}</td>\r\n                <td style={{ textAlign: 'center' }}>{device.user || '-'}</td>\r\n                <td style={{ textAlign: 'center' }}>{device.config_version || '-'}</td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  {(() => {\r\n                    if (!device.provisioned_at) return 'N/A';\r\n                    const date = new Date(device.provisioned_at);\r\n                    return isNaN(date.getTime()) ? 'Invalid Date' : date.toLocaleDateString();\r\n                  })()}\r\n                </td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <button\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleEdit(device);\r\n                    }}\r\n                    style={{ background: 'none', border: 'none', cursor: 'pointer', color: 'var(--text-secondary, #94a3b8)', margin: '0 6px' }}\r\n                    title=\"Edit\"\r\n                  >\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                      <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\r\n                      <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\r\n                    </svg>\r\n                  </button>\r\n                  <button\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleDelete(device);\r\n                    }}\r\n                    style={{ background: 'none', border: 'none', cursor: 'pointer', color: 'var(--danger-color, #ef4444)', margin: '0 6px' }}\r\n                    title=\"Delete\"\r\n                  >\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                      <polyline points=\"3,6 5,6 21,6\"></polyline>\r\n                      <path d=\"M19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2\"></path>\r\n                      <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\"></line>\r\n                      <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\"></line>\r\n                    </svg>\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n        \r\n        {/* Pagination Controls */}\r\n        {totalCount > 0 && (\r\n          <div style={{\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            padding: '16px',\r\n            borderTop: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n            gap: '16px'\r\n          }}>\r\n            <div style={{ fontSize: '0.875rem', color: 'var(--text-secondary, #94a3b8)' }}>\r\n              Showing {((currentPage - 1) * pageSize) + 1} - {Math.min(currentPage * pageSize, totalCount)} of {totalCount} devices\r\n            </div>\r\n            \r\n            <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>\r\n              <button\r\n                onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\r\n                disabled={currentPage === 1}\r\n                style={{\r\n                  padding: '8px 12px',\r\n                  border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                  borderRadius: '6px',\r\n                  background: currentPage === 1 ? 'rgba(148, 163, 184, 0.1)' : 'transparent',\r\n                  color: 'var(--text-primary, #f8fafc)',\r\n                  cursor: currentPage === 1 ? 'not-allowed' : 'pointer',\r\n                  opacity: currentPage === 1 ? '0.5' : '1'\r\n                }}\r\n              >\r\n                 Previous\r\n              </button>\r\n              \r\n              <div style={{ display: 'flex', gap: '4px', alignItems: 'center' }}>\r\n                {(() => {\r\n                  const pages = [];\r\n                  \r\n                  for (let i = 1; i <= totalPages; i++) {\r\n                    // Always show first page, last page, current page, and adjacent pages\r\n                    const showPage = i === 1 || i === totalPages || Math.abs(i - currentPage) <= 1;\r\n                    \r\n                    if (showPage) {\r\n                      pages.push(\r\n                        <button\r\n                          key={i}\r\n                          onClick={() => setCurrentPage(i)}\r\n                          style={{\r\n                            padding: '6px 10px',\r\n                            border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                            borderRadius: '4px',\r\n                            background: i === currentPage ? 'rgba(99, 102, 241, 0.2)' : 'transparent',\r\n                            color: 'var(--text-primary, #f8fafc)',\r\n                            cursor: 'pointer',\r\n                            fontWeight: i === currentPage ? 'bold' : 'normal',\r\n                            minWidth: '32px'\r\n                          }}\r\n                        >\r\n                          {i}\r\n                        </button>\r\n                      );\r\n                    } else if (pages[pages.length - 1]?.key !== 'ellipsis-' + Math.floor(i / 10)) {\r\n                      // Add ellipsis if we skipped pages and haven't added one recently\r\n                      pages.push(\r\n                        <span key={`ellipsis-${Math.floor(i / 10)}`} style={{ padding: '0 4px', color: 'var(--text-secondary, #94a3b8)' }}>\r\n                          ...\r\n                        </span>\r\n                      );\r\n                    }\r\n                  }\r\n                  \r\n                  return pages;\r\n                })()}\r\n              </div>\r\n              \r\n              <button\r\n                onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\r\n                disabled={currentPage === totalPages}\r\n                style={{\r\n                  padding: '8px 12px',\r\n                  border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                  borderRadius: '6px',\r\n                  background: currentPage === totalPages ? 'rgba(148, 163, 184, 0.1)' : 'transparent',\r\n                  color: 'var(--text-primary, #f8fafc)',\r\n                  cursor: currentPage === totalPages ? 'not-allowed' : 'pointer',\r\n                  opacity: currentPage === totalPages ? '0.5' : '1'\r\n                }}\r\n              >\r\n                Next \r\n              </button>\r\n            </div>\r\n            \r\n            <select\r\n              value={pageSize}\r\n              onChange={(e) => {\r\n                setPageSize(parseInt(e.target.value));\r\n                setCurrentPage(1);\r\n              }}\r\n              style={{\r\n                padding: '8px',\r\n                border: isDark ? '1px solid #404040' : '1px solid rgba(148, 163, 184, 0.2)',\r\n                borderRadius: '6px',\r\n                background: isDark ? '#1a1a1a' : '#0f172a',\r\n                color: isDark ? '#e0e0e0' : '#f8fafc',\r\n                cursor: 'pointer',\r\n                fontSize: '0.875rem'\r\n              }}\r\n            >\r\n              <option value={10}>10 per page</option>\r\n              <option value={25}>25 per page</option>\r\n              <option value={50}>50 per page</option>\r\n              <option value={100}>100 per page</option>\r\n            </select>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {(editingDevice || creatingDevice) && (\r\n        <div className=\"modal\">\r\n          <div className=\"modal-content\">\r\n            <h3>{editingDevice ? `Edit Device: ${editingDevice.device_serial}` : 'Register New Device'}</h3>\r\n            <form onSubmit={(e) => { e.preventDefault(); editingDevice ? handleSave() : handleCreate(); }}>\r\n              <div className=\"modal-body\">\r\n                \r\n                {/* Device Identity */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Device Identity</h4>\r\n                  <div className=\"form-grid\">\r\n                    <div className=\"form-group\">\r\n                      <label>Device Serial Number</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingDevice ? editForm.device_serial : createForm.device_serial}\r\n                        onChange={(e) => editingDevice ? setEditForm({...editForm, device_serial: e.target.value}) : setCreateForm({...createForm, device_serial: e.target.value})}\r\n                        required\r\n                        autoComplete=\"off\"\r\n                        placeholder=\"SN-12345678\"\r\n                        style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Ownership */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Ownership & Assignment</h4>\r\n                  <div className=\"form-grid\">\r\n                    <div className=\"form-group\">\r\n                      <label>Assigned User</label>\r\n                      <div style={{ position: 'relative' }} onClick={(e) => e.stopPropagation()}>\r\n                        <input\r\n                          type=\"text\"\r\n                          placeholder=\"Search and select user...\"\r\n                          value={userSearchTerm}\r\n                          onChange={(e) => {\r\n                            setUserSearchTerm(e.target.value);\r\n                            setShowUserDropdown(true);\r\n                          }}\r\n                          onFocus={() => setShowUserDropdown(true)}\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                        {(editingDevice ? editForm.user : createForm.user) && (\r\n                          <div style={{ marginTop: '8px', fontSize: '0.875rem', color: isDark ? '#b0b0b0' : '#94a3b8' }}>\r\n                            <strong>Selected:</strong> {users.find(u => u.username === (editingDevice ? editForm.user : createForm.user))?.first_name} {users.find(u => u.username === (editingDevice ? editForm.user : createForm.user))?.last_name} ({editingDevice ? editForm.user : createForm.user})\r\n                            <button\r\n                              type=\"button\"\r\n                              onClick={() => {\r\n                                if (editingDevice) {\r\n                                  setEditForm({...editForm, user: ''});\r\n                                } else {\r\n                                  setCreateForm({...createForm, user: ''});\r\n                                }\r\n                                setUserSearchTerm('');\r\n                              }}\r\n                              className=\"btn-icon btn-icon-danger\"\r\n                              style={{ marginLeft: '10px' }}\r\n                              title=\"Remove Assignment\"\r\n                            >\r\n                              \r\n                            </button>\r\n                          </div>\r\n                        )}\r\n                        {showUserDropdown && (\r\n                          <div style={{\r\n                            position: 'absolute',\r\n                            top: '100%',\r\n                            left: 0,\r\n                            right: 0,\r\n                            background: 'var(--bg-secondary, #0f172a)',\r\n                            border: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n                            borderRadius: '8px',\r\n                            maxHeight: '200px',\r\n                            overflowY: 'auto',\r\n                            zIndex: 1000,\r\n                            boxShadow: 'var(--shadow-xl)',\r\n                            marginTop: '4px'\r\n                          }}>\r\n                            {filteredUsers.length > 0 ? (\r\n                              filteredUsers.map((user) => (\r\n                                <div\r\n                                  key={user.id}\r\n                                  onClick={() => {\r\n                                    if (editingDevice) {\r\n                                      setEditForm({...editForm, user: user.username});\r\n                                    } else {\r\n                                      setCreateForm({...createForm, user: user.username});\r\n                                    }\r\n                                    setUserSearchTerm(`${user.first_name} ${user.last_name} (${user.username})`);\r\n                                    setShowUserDropdown(false);\r\n                                  }}\r\n                                  style={{\r\n                                    padding: '12px 16px',\r\n                                    cursor: 'pointer',\r\n                                    borderBottom: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n                                    background: (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent',\r\n                                    color: 'var(--text-primary, #f8fafc)',\r\n                                    transition: 'all 0.15s ease',\r\n                                    fontSize: '0.875rem'\r\n                                  }}\r\n                                  onMouseEnter={(e) => e.currentTarget.style.background = 'rgba(255, 255, 255, 0.06)'}\r\n                                  onMouseLeave={(e) => e.currentTarget.style.background = (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent'}\r\n                                >\r\n                                  {user.first_name} {user.last_name} ({user.username}) <br/>\r\n                                  <span style={{ fontSize: '0.75rem', color: 'var(--text-secondary, #94a3b8)' }}>{user.email}</span>\r\n                                </div>\r\n                              ))\r\n                            ) : (\r\n                              <div style={{ padding: '12px 16px', color: 'var(--text-muted, #64748b)', fontSize: '0.875rem' }}>\r\n                                {userSearchTerm.trim() === '' ? 'Start typing to search users...' : 'No users found'}\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Configuration */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Configuration</h4>\r\n                  <div className=\"form-grid form-grid-2\">\r\n                    <div className=\"form-group\">\r\n                      <label>Preset Template</label>\r\n                      <select\r\n                        value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                        onChange={(e) => editingDevice ? setEditForm({ ...editForm, config_version: e.target.value }) : setCreateForm({ ...createForm, config_version: e.target.value })}\r\n                        className=\"full-width\"\r\n                        style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                      >\r\n                        <option value=\"\">-- Manual Configuration --</option>\r\n                        {presetsLoading && <option value=\"\" disabled>Loading presets...</option>}\r\n                        {!presetsLoading && presets.map((preset) => (\r\n                          <option key={preset.id} value={getPresetConfigId(preset)}>\r\n                            {preset.name} ({getPresetConfigId(preset) || 'no ID'})\r\n                          </option>\r\n                        ))}\r\n                      </select>\r\n                      <small className=\"form-hint\">Selecting a preset sets the Config Version ID below.</small>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label>Config Version ID</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                        onChange={(e) => editingDevice ? setEditForm({...editForm, config_version: e.target.value}) : setCreateForm({...createForm, config_version: e.target.value})}\r\n                        autoComplete=\"off\"\r\n                        placeholder=\"Manual Config ID\"\r\n                        style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n              </div>\r\n              {editingDevice && (\r\n                <div style={{ padding: '0 24px' }}>\r\n                   <AuditTrail\r\n                     createdBy={editingDevice.created_by_username}\r\n                     createdAt={editingDevice.created_at}\r\n                     updatedBy={editingDevice.updated_by_username}\r\n                     updatedAt={editingDevice.updated_at}\r\n                   />\r\n                </div>\r\n              )}\r\n              <div className=\"form-actions\" style={{ padding: '24px' }}>\r\n                <button type=\"submit\" className=\"btn\">{editingDevice ? 'Save Changes' : 'Register Device'}</button>\r\n                <button type=\"button\" onClick={handleCancel} className=\"btn btn-secondary\">Cancel</button>\r\n              </div>\r\n            </form>\r\n        </div>\r\n      </div>\r\n    )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Devices;"],"names":["useDebouncedCallback","callback","delay","arguments","length","undefined","timeoutId","setTimeoutId","useState","debouncedCallback","useCallback","_len","args","Array","_key","clearTimeout","newTimeoutId","setTimeout","useEffect","ForecastTooltip","_ref","active","payload","label","_jsxs","style","background","backdropFilter","border","borderRadius","padding","boxShadow","minWidth","children","_jsx","fontFamily","fontWeight","color","fontSize","marginBottom","borderBottom","paddingBottom","display","flexDirection","gap","map","entry","_entry$name","_entry$name2","_entry$name3","unit","name","includes","alignItems","justifyContent","width","height","stroke","fill","flexShrink","split","Number","value","toFixed","fmt","ts","range","d","Date","toLocaleTimeString","hour","minute","toLocaleDateString","weekday","month","day","_unused","TOOLTIP_STYLE","IconSun","viewBox","strokeWidth","strokeLinecap","strokeLinejoin","cx","cy","r","x1","y1","x2","y2","IconBattery","x","y","rx","IconLoad","points","IconEnergy","IconCloud","IconGrid","IconThermometer","KpiCard","_ref2","sub","accent","icon","badge","className","flex","textTransform","letterSpacing","concat","margin","lineHeight","marginLeft","marginTop","WeatherHourlyStrip","_ref3","hourly","overflowX","paddingTop","h","i","_h$cloud_cover_pct","_h$ghi_wm","_h$temperature_c","_h$wind_speed_ms","time","forecast_for","_unused3","cloud","cloud_cover_pct","ghi","ghi_wm2","temp","temperature_c","wind","wind_speed_ms","humidity","humidity_pct","ghiPct","Math","min","humPct","isNow","wi","ghiColor","humColor","position","top","title","round","overflow","_Fragment","EnergyBreakdownRow","_ref4","latest","items","pv_today_kwh","bg","grid_buy_today_kwh","grid_sell_today_kwh","batt_charge_today_kwh","batt_discharge_today_kwh","load_today_kwh","filter","e","flexWrap","alignSelf","opacity","InsightsRow","_ref5","_latest$pv_today_kwh","_latest$load_today_kw","_latest$grid_buy_toda","pvKwh","loadKwh","gridBuy","co2Kg","selfSufPct2","max","gridDepPct","push","item","REGIME_STYLE","night","ramp","midday","ForecastTable","_ref6","data","maxHeight","overflowY","borderCollapse","zIndex","textAlign","row","_REGIME_STYLE$row$reg","_row$p10$toFixed","_row$p","_row$p50$toFixed","_row$p2","_row$p90$toFixed","_row$p3","_row$physics$toFixed","_row$physics","_row$ghi$toFixed","_row$ghi","rc","regime","p10","p50","p90","fontStyle","physics","_ref7","_latest$pv1_power_w","_latest$pv2_power_w","_latest$battery_soc_p","_latest$load_power_w","_latest$pv_today_kwh2","_latest$grid_power_w","_latest$battery_power","_latest$inverter_temp","_latest$battery_volta","_latest$grid_frequenc","siteId","autoRefresh","telemetry","setTelemetry","forecast","setForecast","weather","setWeather","loading","setLoading","error","setError","lastUpdated","setLastUpdated","showBands","setShowBands","P10","P50","P90","dateRange","setDateRange","customStartDate","setCustomStartDate","customEndDate","setCustomEndDate","forecastView","setForecastView","fetchAll","async","telemetryParams","start_date","toISOString","end_date","days","forecastParams","end","start","setDate","getDate","tel","fcst","wth","Promise","all","apiService","getSiteTelemetry","getSiteForecast","getSiteWeather","isArray","err","Error","message","id","setInterval","clearInterval","pvKw","pv1_power_w","pv2_power_w","batSoc","battery_soc_percent","loadKw","load_power_w","todayKwh","gridKw","grid_power_w","batPowerKw","battery_power_w","invTemp","inverter_temp_c","batVoltage","battery_voltage_v","runState","run_state","gridImporting","gridExporting","batCharging","runStateBadge","invTempColor","historyData","_","isDay","buckets","Map","forEach","timestamp","key","getFullYear","getMonth","getHours","has","set","get","from","values","bucket","avg","field","reduce","s","_r$field","first","_r$pv_today_kwh","aggregateByPeriod","_row$pv1_power_w","_row$pv2_power_w","_row$load_power_w","_row$grid_power_w","_row$battery_soc_perc","forecastData","_row$regime","clean","replace","forecastFor","_unused2","fmtForecast","p50_kw","p10_kw","p90_kw","physics_baseline_kw","ghi_input_wm2","fcastP10","fcastP50","fcastP90","forecastGeneratedAt","generated_at","abs","getTime","achievedPct","noData","onChange","target","cursor","type","onClick","grid_voltage_v","grid_frequency_hz","current","p","hourly_forecast","ResponsiveContainer","AreaChart","right","left","bottom","offset","stopColor","stopOpacity","CartesianGrid","strokeDasharray","XAxis","dataKey","interval","ceil","angle","textAnchor","tick","YAxis","yAxisId","tickFormatter","v","orientation","domain","Tooltip","contentStyle","formatter","String","Legend","iconType","iconSize","wrapperStyle","Area","dot","Line","b","_objectSpread","transition","el","document","getElementById","canvas","html2canvas","scale","a","createElement","download","slice","href","toDataURL","click","onMouseOver","currentTarget","onMouseOut","userSelect","vertical","tickLine","axisLine","minTickGap","tickMargin","allowDataOverflow","val","content","animationDuration","pointerEvents","verticalAlign","activeDot","ReferenceLine","Devices","_users$find3","_users$find4","isDark","useTheme","searchParams","useSearchParams","devices","setDevices","filteredDevices","setFilteredDevices","editingDevice","setEditingDevice","creatingDevice","setCreatingDevice","searchTerm","setSearchTerm","userSearchTerm","setUserSearchTerm","filteredUsers","setFilteredUsers","showUserDropdown","setShowUserDropdown","users","setUsers","selectedDevices","setSelectedDevices","Set","bulkDeleteLoading","setBulkDeleteLoading","currentPage","setCurrentPage","pageSize","setPageSize","totalCount","setTotalCount","totalPages","setTotalPages","presets","setPresets","presetsLoading","setPresetsLoading","health","setHealth","telemetrySummary","setTelemetrySummary","telemetryData","setTelemetryData","dashboardError","setDashboardError","selectedDevice","setSelectedDevice","deviceLogs","setDeviceLogs","logsLoading","setLogsLoading","editForm","setEditForm","device_serial","user","config_version","createForm","setCreateForm","siteDetails","setSiteDetails","siteLoading","setSiteLoading","editingSite","setEditingSite","siteForm","setSiteForm","site_id","display_name","latitude","longitude","capacity_kw","tilt_deg","azimuth_deg","timezone","is_active","siteSaving","setSiteSaving","siteError","setSiteError","devicePreset","setDevicePreset","fetchDevices","page","search","response","getDevices","results","count","total_pages","current_page","fetchDeviceLogs","getDeviceLogs","deviceId","logs","console","handleViewDevice","device","preset","find","config_id","getDeviceSite","then","catch","finally","customers","getUsers","is_staff","is_superuser","fetchUsers","getPresets","fetchPresets","healthData","getSystemHealth","getTelemetry","telemetryArray","currentLatest","itemDate","isNaN","deviceCount","size","totalPoints","latestTimestamp","fetchDashboardData","deviceIdParam","parseInt","foundDevice","handleClickOutside","addEventListener","removeEventListener","trim","searchLower","toLowerCase","filtered","fullName","first_name","last_name","username","email","debouncedSearch","query","handleEdit","_users$find","_users$find2","u","handleSave","updateDevice","handleCreate","createDevice","handleCancel","handleBackToList","getPresetConfigId","_preset$gateway_confi","_preset$gateway_confi2","gateway_configuration","general_settings","_devicePreset$gateway","_devicePreset$gateway2","deviceTelemetry","latestTelemetry","marginRight","window","confirm","rebootDevice","alert","handleReboot","backgroundColor","hardResetDevice","handleHardReset","deleteDevice","handleDeleteDevice","gridTemplateColumns","is_online","last_heartbeat","toLocaleString","hw_id","model","gridColumn","pending_config_update","slaves_count","config_ack_ver","version","last_updated","config_acked_at","ackTime","diffMs","diffMins","floor","diffHours","diffDays","config_downloaded_at","provisioned_at","created_by_username","checked","logs_enabled","enabled","toggleDeviceLogs","handleToggleLogs","overall_health","active_devices","total_devices","total_telemetry_points","data_type","SiteDataPanel","disabled","log","level","onSubmit","preventDefault","parseFloat","updated","updateDeviceSite","createDeviceSite","required","placeholder","autoComplete","step","stopPropagation","onFocus","onMouseEnter","onMouseLeave","AuditTrail","createdBy","createdAt","created_at","updatedBy","updated_by_username","updatedAt","updated_at","deviceList","Boolean","confirmMessage","join","deleteDevicesBulk","updatedDevices","handleSelectAll","allIds","newSelected","delete","add","handleSelectDevice","date","handleDelete","borderTop","pages","_pages"],"sourceRoot":""}