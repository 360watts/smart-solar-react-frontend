{"version":3,"file":"static/js/239.dcd1374c.chunk.js","mappings":"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","sources":["components/AuditTrail.tsx","hooks/useDebounce.ts","components/SiteDataPanel.tsx","components/Devices.tsx","services/cacheService.ts","services/api.ts"],"sourcesContent":["import React from 'react';\r\n\r\ninterface AuditTrailProps {\r\n  createdBy?: string | null;\r\n  createdAt?: string;\r\n  updatedBy?: string | null;\r\n  updatedAt?: string;\r\n  className?: string;\r\n}\r\n\r\nconst AuditTrail: React.FC<AuditTrailProps> = ({\r\n  createdBy,\r\n  createdAt,\r\n  updatedBy,\r\n  updatedAt,\r\n  className = 'audit-trail',\r\n}) => {\r\n  const formatDate = (dateString?: string) => {\r\n    if (!dateString) return 'N/A';\r\n    try {\r\n      return new Date(dateString).toLocaleString();\r\n    } catch {\r\n      return dateString;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={className}>\r\n      <div className=\"audit-row\">\r\n        <span className=\"audit-label\">Created:</span>\r\n        {createdBy ? (\r\n          <span className=\"audit-value\">\r\n            by <strong>{createdBy}</strong> on {formatDate(createdAt)}\r\n          </span>\r\n        ) : (\r\n          <span className=\"audit-value\">System</span>\r\n        )}\r\n      </div>\r\n\r\n      {updatedBy && (\r\n        <div className=\"audit-row\">\r\n          <span className=\"audit-label\">Last Updated:</span>\r\n          <span className=\"audit-value\">\r\n            by <strong>{updatedBy}</strong> on {formatDate(updatedAt)}\r\n          </span>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default React.memo(AuditTrail);\r\n","import { useState, useEffect, useCallback } from 'react';\r\n\r\ninterface UseDebouncedValueOptions {\r\n  delay?: number;\r\n}\r\n\r\n/**\r\n * Custom hook to debounce a value with a delay\r\n * Useful for search inputs and other frequent updates\r\n */\r\nexport function useDebouncedValue<T>(\r\n  value: T,\r\n  options: UseDebouncedValueOptions = {}\r\n): T {\r\n  const { delay = 300 } = options;\r\n  const [debouncedValue, setDebouncedValue] = useState<T>(value);\r\n\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setDebouncedValue(value);\r\n    }, delay);\r\n\r\n    return () => clearTimeout(timer);\r\n  }, [value, delay]);\r\n\r\n  return debouncedValue;\r\n}\r\n\r\n/**\r\n * Custom hook to debounce a callback function\r\n * Useful for search, filtering, and other expensive operations\r\n */\r\nexport function useDebouncedCallback<T extends (...args: any[]) => any>(\r\n  callback: T,\r\n  delay: number = 300\r\n): (...args: Parameters<T>) => void {\r\n  const [timeoutId, setTimeoutId] = useState<NodeJS.Timeout | null>(null);\r\n\r\n  const debouncedCallback = useCallback(\r\n    (...args: Parameters<T>) => {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId);\r\n      }\r\n\r\n      const newTimeoutId = setTimeout(() => {\r\n        callback(...args);\r\n      }, delay);\r\n\r\n      setTimeoutId(newTimeoutId);\r\n    },\r\n    [callback, delay, timeoutId]\r\n  );\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId);\r\n      }\r\n    };\r\n  }, [timeoutId]);\r\n\r\n  return debouncedCallback;\r\n}\r\n\r\n/**\r\n * Custom hook for search input with debouncing\r\n * Returns a hook that handles search input changes with built-in debouncing\r\n */\r\nexport function useDebouncedSearch(\r\n  onSearch: (query: string) => void,\r\n  delay: number = 300\r\n) {\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const debouncedCallback = useDebouncedCallback(onSearch, delay);\r\n\r\n  const handleSearch = useCallback(\r\n    (query: string) => {\r\n      setSearchQuery(query);\r\n      debouncedCallback(query);\r\n    },\r\n    [debouncedCallback]\r\n  );\r\n\r\n  return {\r\n    searchQuery,\r\n    setSearchQuery,\r\n    handleSearch,\r\n  };\r\n}\r\n","/**\n * SiteDataPanel  reusable panel that fetches and visualises DynamoDB data\n * for a solar site. Accepts a siteId prop and shows:\n *  - 4 live KPI cards (PV power, battery SOC, load, energy today)\n *  - 24 h power history area chart\n *  - Today's ML forecast with p10/p50/p90 confidence bands\n *  - Latest weather observation\n */\nimport React, { useState, useEffect, useCallback } from 'react';\nimport {\n  AreaChart, Area, Line, ReferenceArea,\n  XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend, Brush, ReferenceLine\n} from 'recharts';\nimport html2canvas from 'html2canvas';\nimport { apiService } from '../services/api';\n// Custom tooltip for forecast chart\nconst ForecastTooltip = ({ active, payload, label }: any) => {\n  if (active && payload && payload.length) {\n    return (\n      <div style={{ \n        background: 'rgba(255, 255, 255, 0.9)', \n        backdropFilter: 'blur(8px)',\n        border: '1px solid #f3f4f6', \n        borderRadius: 12, \n        padding: '0.75rem 1rem', \n        boxShadow: '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)', \n        minWidth: 160 \n      }}>\n        <div style={{ \n          fontFamily: 'Urbanist, sans-serif', \n          fontWeight: 700, \n          color: '#111827', \n          fontSize: '0.9rem',\n          marginBottom: '0.5rem',\n          borderBottom: '1px solid #f3f4f6',\n          paddingBottom: '0.25rem'\n        }}>\n          {label}\n        </div>\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '0.25rem' }}>\n          {payload.map((entry: any) => (\n            <div key={entry.name} style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', gap: '1rem', fontSize: '0.8rem', fontFamily: 'Inter, sans-serif', color: '#374151' }}>\n              <div style={{ display: 'flex', alignItems: 'center', gap: '0.4rem' }}>\n                <span style={{ width: 8, height: 8, borderRadius: '50%', background: entry.color || entry.stroke || entry.fill }}></span>\n                <span style={{ fontWeight: 600 }}>{entry.name.split(' ')[0]}</span>\n              </div>\n              <span style={{ fontFamily: 'JetBrains Mono, monospace', fontWeight: 600, color: '#111827' }}>\n                {Number(entry.value).toFixed(2)} kW\n              </span>\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n  return null;\n};\n\n//  helpers \n\nfunction fmt(ts: string, range: string): string {\n  // Format timestamp based on date range\n  try {\n    const date = new Date(ts);\n    if (range === '24h') {\n      // \"14:30\"\n      return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    } else if (range === '7d') {\n      // \"Mon 14:00\" for 7 days\n      return date.toLocaleDateString([], { weekday: 'short' }) + ' ' + \n             date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    } else {\n      // \"Feb 23\" for 30d or custom\n      return date.toLocaleDateString([], { month: 'short', day: 'numeric' });\n    }\n  } catch { return ts; }\n}\n\nfunction fmtForecast(ts: string, forecastFor?: string): string {\n  // Use forecast_for if available, otherwise parse from timestamp\n  // \"FORECAST#2026-02-23T14:30:00Z\"  \"14:30\"\n  const cleanTs = forecastFor || ts.replace('FORECAST#', '');\n  try {\n    return new Date(cleanTs).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n  } catch { return cleanTs; }\n}\n\nfunction aggregateByPeriod(data: any[], range: string): any[] {\n  // Aggregate telemetry data based on date range\n  if (!data || data.length === 0) return [];\n  \n  if (range === '24h') {\n    // 24h: downsample to ~48 points (every other 15-min = 30-min)\n    return data.filter((_, i) => i % 2 === 0 || i === data.length - 1);\n  } else if (range === '7d') {\n    // 7d: aggregate by hour (~168 points max)\n    const buckets = new Map<string, any[]>();\n    data.forEach(row => {\n      const date = new Date(row.timestamp);\n      const hourKey = `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}-${date.getHours()}`;\n      if (!buckets.has(hourKey)) buckets.set(hourKey, []);\n      buckets.get(hourKey)!.push(row);\n    });\n    \n    return Array.from(buckets.values()).map(bucket => {\n      const first = bucket[0];\n      return {\n        timestamp: first.timestamp,\n        pv1_power_w: bucket.reduce((sum, r) => sum + (r.pv1_power_w ?? 0), 0) / bucket.length,\n        pv2_power_w: bucket.reduce((sum, r) => sum + (r.pv2_power_w ?? 0), 0) / bucket.length,\n        load_power_w: bucket.reduce((sum, r) => sum + (r.load_power_w ?? 0), 0) / bucket.length,\n        grid_power_w: bucket.reduce((sum, r) => sum + (r.grid_power_w ?? 0), 0) / bucket.length,\n        battery_soc_percent: bucket.reduce((sum, r) => sum + (r.battery_soc_percent ?? 0), 0) / bucket.length,\n        pv_today_kwh: first.pv_today_kwh,\n      };\n    });\n  } else {\n    // 30d or custom: aggregate by day (max 30-90 points)\n    const buckets = new Map<string, any[]>();\n    data.forEach(row => {\n      const date = new Date(row.timestamp);\n      const dayKey = `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;\n      if (!buckets.has(dayKey)) buckets.set(dayKey, []);\n      buckets.get(dayKey)!.push(row);\n    });\n    \n    return Array.from(buckets.values()).map(bucket => {\n      const first = bucket[0];\n      // For daily aggregation, use averages for instantaneous values, max for daily energy\n      return {\n        timestamp: first.timestamp,\n        pv1_power_w: bucket.reduce((sum, r) => sum + (r.pv1_power_w ?? 0), 0) / bucket.length,\n        pv2_power_w: bucket.reduce((sum, r) => sum + (r.pv2_power_w ?? 0), 0) / bucket.length,\n        load_power_w: bucket.reduce((sum, r) => sum + (r.load_power_w ?? 0), 0) / bucket.length,\n        grid_power_w: bucket.reduce((sum, r) => sum + (r.grid_power_w ?? 0), 0) / bucket.length,\n        battery_soc_percent: bucket.reduce((sum, r) => sum + (r.battery_soc_percent ?? 0), 0) / bucket.length,\n        pv_today_kwh: Math.max(...bucket.map(r => r.pv_today_kwh ?? 0)),\n      };\n    });\n  }\n}\n\nconst TOOLTIP_STYLE = {\n  background: 'rgba(255,255,255,0.97)',\n  border: '1px solid rgba(0,166,62,0.15)',\n  borderRadius: 10,\n  color: '#0a0a0a',\n  boxShadow: '0 8px 24px rgba(0,0,0,0.1)',\n  fontSize: 12,\n};\n\n//  tiny inline icons \nconst IconSun = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#F07522\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <circle cx=\"12\" cy=\"12\" r=\"5\" fill=\"#FFD600\" stroke=\"#F07522\" strokeWidth=\"1.5\"/>\n    <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\"/>\n    <line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"23\"/>\n    <line x1=\"4.22\" y1=\"4.22\" x2=\"5.64\" y2=\"5.64\"/>\n    <line x1=\"18.36\" y1=\"18.36\" x2=\"19.78\" y2=\"19.78\"/>\n    <line x1=\"1\" y1=\"12\" x2=\"3\" y2=\"12\"/>\n    <line x1=\"21\" y1=\"12\" x2=\"23\" y2=\"12\"/>\n  </svg>\n);\nconst IconBattery = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <rect x=\"1\" y=\"6\" width=\"18\" height=\"12\" rx=\"2\"/>\n    <line x1=\"23\" y1=\"13\" x2=\"23\" y2=\"11\"/>\n    <rect x=\"3\" y=\"8\" width=\"10\" height=\"8\" fill=\"currentColor\" rx=\"1\"/>\n  </svg>\n);\nconst IconLoad = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z\"/>\n    <polyline points=\"9 22 9 12 15 12 15 22\"/>\n  </svg>\n);\nconst IconEnergy = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M13 2L3 14h9l-1 8 10-12h-9l1-8z\"/>\n  </svg>\n);\nconst IconCloud = () => (\n  <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M18 10h-1.26A8 8 0 109 20h9a5 5 0 000-10z\"/>\n  </svg>\n);\n\n//  sub-components \n\ninterface KpiCardProps {\n  label: string;\n  value: string;\n  unit?: string;\n  sub?: string;\n  accent: string;\n  icon: React.ReactNode;\n}\nconst KpiCard: React.FC<KpiCardProps> = ({ label, value, unit, sub, accent, icon }) => (\n  <div className=\"card\" style={{ padding: '1.1rem', flex: 1, minWidth: 130 }}>\n    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.4rem' }}>\n      <span style={{ fontSize: '0.7rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.06em', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>{label}</span>\n      <span style={{ width: 28, height: 28, borderRadius: '50%', background: `${accent}18`, display: 'flex', alignItems: 'center', justifyContent: 'center', color: accent, flexShrink: 0 }}>{icon}</span>\n    </div>\n    <p style={{ margin: 0, fontFamily: 'JetBrains Mono, monospace', fontSize: '1.55rem', fontWeight: 800, color: '#0a0a0a', lineHeight: 1 }}>\n      {value}\n      {unit && <span style={{ fontSize: '0.8rem', fontWeight: 500, color: '#9ca3af', marginLeft: 4 }}>{unit}</span>}\n    </p>\n    {sub && <p style={{ margin: '0.25rem 0 0', fontSize: '0.7rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>{sub}</p>}\n  </div>\n);\n\n//  data table component \n\nconst ForecastTable = ({ data }: { data: any[] }) => (\n  <div style={{ maxHeight: 300, overflowY: 'auto' }}>\n    <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.8rem', fontFamily: 'Inter, sans-serif' }}>\n      <thead style={{ position: 'sticky', top: 0, background: '#f9fafb', zIndex: 1 }}>\n        <tr>\n          <th style={{ padding: '0.75rem 1rem', textAlign: 'left', fontWeight: 600, color: '#4b5563', borderBottom: '1px solid #e5e7eb' }}>Time</th>\n          <th style={{ padding: '0.75rem 1rem', textAlign: 'right', fontWeight: 600, color: '#f59e0b', borderBottom: '1px solid #e5e7eb' }}>P10 (Low)</th>\n          <th style={{ padding: '0.75rem 1rem', textAlign: 'right', fontWeight: 600, color: '#00a63e', borderBottom: '1px solid #e5e7eb' }}>P50 (Median)</th>\n          <th style={{ padding: '0.75rem 1rem', textAlign: 'right', fontWeight: 600, color: '#3b82f6', borderBottom: '1px solid #e5e7eb' }}>P90 (High)</th>\n        </tr>\n      </thead>\n      <tbody>\n        {data.map((row, i) => (\n          <tr key={i} style={{ borderBottom: '1px solid #f3f4f6' }}>\n            <td style={{ padding: '0.6rem 1rem', color: '#111827', fontFamily: 'JetBrains Mono, monospace' }}>{row.time}</td>\n            <td style={{ padding: '0.6rem 1rem', textAlign: 'right', color: '#4b5563' }}>{row.p10?.toFixed(2) ?? '-'}</td>\n            <td style={{ padding: '0.6rem 1rem', textAlign: 'right', fontWeight: 600, color: '#111827' }}>{row.p50?.toFixed(2) ?? '-'}</td>\n            <td style={{ padding: '0.6rem 1rem', textAlign: 'right', color: '#4b5563' }}>{row.p90?.toFixed(2) ?? '-'}</td>\n          </tr>\n        ))}\n      </tbody>\n    </table>\n  </div>\n);\n\n//  main component \n\ninterface Props {\n  siteId: string;\n  /** If true, auto-refreshes every 60 s */\n  autoRefresh?: boolean;\n}\n\nconst SiteDataPanel: React.FC<Props> = ({ siteId, autoRefresh = false }) => {\n  const [telemetry, setTelemetry] = useState<any[]>([]);\n  const [forecast, setForecast] = useState<any[]>([]);\n  const [weather, setWeather] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);\n  \n  // Date range controls\n\n  // Interactive forecast band toggles\n  const [showBands, setShowBands] = useState<{ [key: string]: boolean }>({\n    P10: true,\n    P50: true,\n    P90: true,\n  });\n  const [dateRange, setDateRange] = useState<string>('24h'); // '24h' | '7d' | '30d' | 'custom'\n  const [customStartDate, setCustomStartDate] = useState<string>('');\n  const [customEndDate, setCustomEndDate] = useState<string>('');\n  const [forecastView, setForecastView] = useState<'chart' | 'table'>('chart');\n  const [zoomLeft, setZoomLeft] = useState<string | number>('dataMin');\n  const [zoomRight, setZoomRight] = useState<string | number>('dataMax');\n  const [refAreaLeft, setRefAreaLeft] = useState('');\n  const [refAreaRight, setRefAreaRight] = useState('');\n\n  const zoom = () => {\n    let left = refAreaLeft;\n    let right = refAreaRight;\n\n    if (left === right || right === '') {\n      setRefAreaLeft('');\n      setRefAreaRight('');\n      return;\n    }\n\n    // Ensure left is actually smaller than right (chronologically)\n    // Since XAxis dataKey=\"time\" is string, we rely on index order in data\n    // But Recharts passes the categorical value. \n    // Simplified: Just check if left != right. \n    // Limitation: String comparison might fail if time format rolls over (e.g. 23:00 -> 00:00)\n    // For this implementation, we will trust the user selection order or swap if needed.\n    \n    // Actually, Recharts onMouseDown gives the activeLabel.\n    \n    if (left > right) [left, right] = [right, left];\n\n    setZoomLeft(left);\n    setZoomRight(right);\n    setRefAreaLeft('');\n    setRefAreaRight('');\n  };\n\n  const zoomOut = () => {\n    setZoomLeft('dataMin');\n    setZoomRight('dataMax');\n    setRefAreaLeft('');\n    setRefAreaRight('');\n  };\n\n  const fetchAll = useCallback(async () => {\n    try {\n      // Calculate date range parameters for telemetry\n      let telemetryParams: any = {};\n      \n      if (dateRange === 'custom' && customStartDate && customEndDate) {\n        telemetryParams = {\n          start_date: new Date(customStartDate).toISOString(),\n          end_date: new Date(customEndDate).toISOString(),\n        };\n      } else if (dateRange === '7d') {\n        telemetryParams = { days: 7 };\n      } else if (dateRange === '30d') {\n        telemetryParams = { days: 30 };\n      } else {\n        // Default 24h\n        telemetryParams = {};\n      }\n      \n      // Fetch forecast for the correct date range\n      let forecastParams: any = {};\n      if (dateRange === 'custom' && customStartDate && customEndDate) {\n        forecastParams = {\n          start_date: new Date(customStartDate).toISOString(),\n          end_date: new Date(customEndDate).toISOString(),\n        };\n      } else if (dateRange === '7d') {\n        // Last 7 days: start_date = 6 days ago, end_date = today\n        const end = new Date();\n        const start = new Date();\n        start.setDate(end.getDate() - 6);\n        forecastParams = {\n          start_date: start.toISOString().split('T')[0] + 'T00:00:00Z',\n          end_date: end.toISOString().split('T')[0] + 'T23:59:59Z',\n        };\n      } else if (dateRange === '30d') {\n        // Last 30 days: start_date = 29 days ago, end_date = today\n        const end = new Date();\n        const start = new Date();\n        start.setDate(end.getDate() - 29);\n        forecastParams = {\n          start_date: start.toISOString().split('T')[0] + 'T00:00:00Z',\n          end_date: end.toISOString().split('T')[0] + 'T23:59:59Z',\n        };\n      } else {\n        // Default: today only\n        forecastParams = {};\n      }\n\n      const [tel, fcst, wth] = await Promise.all([\n        apiService.getSiteTelemetry(siteId, telemetryParams),\n        apiService.getSiteForecast(siteId, forecastParams),\n        apiService.getSiteWeather(siteId),\n      ]);\n      \n      // Debug logging\n      console.log('[SiteDataPanel] Forecast API response:', fcst);\n      console.log('[SiteDataPanel] Forecast count:', Array.isArray(fcst) ? fcst.length : 'not array');\n      if (Array.isArray(fcst) && fcst.length > 0) {\n        console.log('[SiteDataPanel] First forecast item:', fcst[0]);\n      }\n      \n      setTelemetry(Array.isArray(tel) ? tel : []);\n      setForecast(Array.isArray(fcst) ? fcst : []);\n      setWeather(wth || null);\n      setLastUpdated(new Date());\n      setError(null);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load site data');\n    } finally {\n      setLoading(false);\n    }\n  }, [siteId, dateRange, customStartDate, customEndDate]);\n\n  useEffect(() => {\n    setLoading(true);\n    fetchAll();\n    if (!autoRefresh) return;\n    const id = setInterval(fetchAll, 60_000);\n    return () => clearInterval(id);\n  }, [fetchAll, autoRefresh]);\n\n  //  derived values \n  const latest = telemetry.length > 0 ? telemetry[telemetry.length - 1] : null;\n\n  const pvKw    = latest ? ((latest.pv1_power_w ?? 0) + (latest.pv2_power_w ?? 0)) / 1000 : null;\n  const batSoc  = latest?.battery_soc_percent ?? null;\n  const loadKw  = latest ? (latest.load_power_w ?? 0) / 1000 : null;\n  const todayKwh = latest?.pv_today_kwh ?? null;\n\n  // History chart: aggregate based on date range\n  const aggregated = aggregateByPeriod(telemetry, dateRange);\n  const historyData = aggregated.map(row => ({\n    time: fmt(row.timestamp, dateRange),\n    'PV (kW)': +((( row.pv1_power_w ?? 0) + (row.pv2_power_w ?? 0)) / 1000).toFixed(2),\n    'Load (kW)': +((row.load_power_w ?? 0) / 1000).toFixed(2),\n    'Grid (kW)': +((row.grid_power_w ?? 0) / 1000).toFixed(2),\n    'Batt SOC (%)': row.battery_soc_percent ?? null,\n  }));\n\n  // Forecast chart\n  const forecastData = forecast.map(row => {\n    // For multi-day, show date + time; for 1 day, just time\n    let label = '';\n    if (dateRange === '7d' || dateRange === '30d' || dateRange === 'custom') {\n      const cleanTs = row.forecast_for || row.timestamp.replace('FORECAST#', '');\n      const d = new Date(cleanTs);\n      label = d.toLocaleDateString([], { month: 'short', day: 'numeric' }) + ' ' + d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    } else {\n      label = fmtForecast(row.timestamp, row.forecast_for);\n    }\n    return {\n      time: label,\n      p50: row.p50_kw != null ? +row.p50_kw.toFixed(3) : null,\n      p10: row.p10_kw != null ? +row.p10_kw.toFixed(3) : null,\n      p90: row.p90_kw != null ? +row.p90_kw.toFixed(3) : null,\n    };\n  });\n\n  // Calculate total forecasted energy for the day using trapezoidal integration\n  let forecastEnergyP10 = 0, forecastEnergyP50 = 0, forecastEnergyP90 = 0;\n  let forecastGeneratedAt: Date | null = null;\n  \n  if (forecast.length > 1) {\n    // Extract forecast generation time from first record (if available)\n    const firstForecast = forecast[0];\n    if (firstForecast.generated_at) {\n      forecastGeneratedAt = new Date(firstForecast.generated_at);\n    } else if (firstForecast.timestamp) {\n      // Use first timestamp as approximation\n      const ts = firstForecast.timestamp.replace('FORECAST#', '');\n      // Forecast is typically generated at midnight or early morning for the day\n      forecastGeneratedAt = new Date(ts.split('T')[0] + 'T00:00:00Z');\n    }\n    \n    // Use trapezoidal rule: energy = [(power[i] + power[i+1]) / 2  t]\n    for (let i = 0; i < forecast.length - 1; i++) {\n      const t1 = new Date(forecast[i].timestamp.replace('FORECAST#', '')).getTime();\n      const t2 = new Date(forecast[i + 1].timestamp.replace('FORECAST#', '')).getTime();\n      const intervalHours = Math.abs(t2 - t1) / (1000 * 60 * 60);\n      \n      // Trapezoidal integration: average of two consecutive power values  time interval\n      if (forecast[i].p10_kw != null && forecast[i + 1].p10_kw != null) {\n        forecastEnergyP10 += (forecast[i].p10_kw + forecast[i + 1].p10_kw) / 2 * intervalHours;\n      }\n      if (forecast[i].p50_kw != null && forecast[i + 1].p50_kw != null) {\n        forecastEnergyP50 += (forecast[i].p50_kw + forecast[i + 1].p50_kw) / 2 * intervalHours;\n      }\n      if (forecast[i].p90_kw != null && forecast[i + 1].p90_kw != null) {\n        forecastEnergyP90 += (forecast[i].p90_kw + forecast[i + 1].p90_kw) / 2 * intervalHours;\n      }\n    }\n  }\n\n  //  render \n\n  if (loading) {\n    return (\n      <div style={{ padding: '1.5rem 0' }}>\n        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem', flexWrap: 'wrap' }}>\n          {[...Array(4)].map((_, i) => (\n            <div key={i} className=\"card skeleton\" style={{ flex: 1, minWidth: 130, height: 96 }} />\n          ))}\n        </div>\n        <div className=\"card skeleton\" style={{ height: 220, marginBottom: '1rem' }} />\n        <div className=\"card skeleton\" style={{ height: 200 }} />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div style={{ padding: '1.5rem', color: '#ef4444', fontSize: '0.85rem', background: 'rgba(239,68,68,0.06)', borderRadius: 10, marginTop: '1rem' }}>\n        Failed to load DynamoDB data for <strong>{siteId}</strong>: {error}\n      </div>\n    );\n  }\n\n  // Check if we have any meaningful data (including forecast)\n  const noData = telemetry.length === 0 && forecast.length === 0 && !weather;\n\n  return (\n    <div style={{ marginTop: '1.5rem' }}>\n      {/* Section header */}\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '0.75rem', gap: '1rem', flexWrap: 'wrap' }}>\n        <p className=\"dash-section-label\" style={{ margin: 0 }}>Live Site Intelligence  <span style={{ fontFamily: 'JetBrains Mono, monospace', color: '#00a63e' }}>{siteId}</span></p>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>\n          {/* Date range selector */}\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n            <select\n              value={dateRange}\n              onChange={(e) => setDateRange(e.target.value)}\n              style={{\n                background: 'var(--card-bg, #fff)',\n                border: '1px solid rgba(0,166,62,0.2)',\n                borderRadius: 8,\n                padding: '0.3rem 0.6rem',\n                fontSize: '0.72rem',\n                color: 'var(--text-color, #0a0a0a)',\n                cursor: 'pointer',\n                fontFamily: 'Poppins, sans-serif',\n                fontWeight: 600,\n              }}\n            >\n              <option value=\"24h\">Today</option>\n              <option value=\"7d\">Last 7 days</option>\n              <option value=\"30d\">Last 30 days</option>\n              <option value=\"custom\">Custom range</option>\n            </select>\n            \n            {dateRange === 'custom' && (\n              <>\n                <input\n                  type=\"date\"\n                  value={customStartDate}\n                  onChange={(e) => setCustomStartDate(e.target.value)}\n                  style={{\n                    background: 'var(--card-bg, #fff)',\n                    border: '1px solid rgba(0,166,62,0.2)',\n                    borderRadius: 8,\n                    padding: '0.3rem 0.6rem',\n                    fontSize: '0.72rem',\n                    color: 'var(--text-color, #0a0a0a)',\n                    fontFamily: 'Poppins, sans-serif',\n                    fontWeight: 600,\n                  }}\n                />\n                <span style={{ color: '#9ca3af', fontSize: '0.7rem' }}>to</span>\n                <input\n                  type=\"date\"\n                  value={customEndDate}\n                  onChange={(e) => setCustomEndDate(e.target.value)}\n                  style={{\n                    background: 'var(--card-bg, #fff)',\n                    border: '1px solid rgba(0,166,62,0.2)',\n                    borderRadius: 8,\n                    padding: '0.3rem 0.6rem',\n                    fontSize: '0.72rem',\n                    color: 'var(--text-color, #0a0a0a)',\n                    fontFamily: 'Poppins, sans-serif',\n                    fontWeight: 600,\n                  }}\n                />\n              </>\n            )}\n          </div>\n          \n          {lastUpdated && (\n            <span style={{ fontSize: '0.7rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>\n              Updated {lastUpdated.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n            </span>\n          )}\n          <button\n            onClick={() => { setLoading(true); fetchAll(); }}\n            style={{ background: 'none', border: '1px solid rgba(0,166,62,0.2)', borderRadius: 8, padding: '0.2rem 0.6rem', fontSize: '0.72rem', color: '#00a63e', cursor: 'pointer', fontFamily: 'Poppins, sans-serif', fontWeight: 600 }}\n          >\n             Refresh\n          </button>\n        </div>\n      </div>\n\n      {noData ? (\n        <div style={{ padding: '2rem', textAlign: 'center', color: '#9ca3af', fontSize: '0.875rem', background: 'rgba(0,166,62,0.03)', borderRadius: 12, border: '1px dashed rgba(0,166,62,0.15)' }}>\n          No DynamoDB data found for site <strong style={{ color: '#00a63e' }}>{siteId}</strong> in the {\n            dateRange === '24h' ? 'today' :\n            dateRange === '7d' ? 'last 7 days' :\n            dateRange === '30d' ? 'last 30 days' : 'selected date range'\n          }.<br />\n          <span style={{ fontSize: '0.78rem' }}>Data is written by the ML forecast scheduler when the device is actively posting telemetry.</span>\n        </div>\n      ) : (\n        <>\n          {/*  KPI strip  */}\n          <div style={{ display: 'flex', gap: '0.75rem', flexWrap: 'wrap', marginBottom: '1rem' }}>\n            <KpiCard label=\"PV Power\"     value={pvKw != null ? pvKw.toFixed(2) : ''}         unit=\"kW\"  sub=\"Current generation\"   accent=\"#F07522\" icon={<IconSun />}     />\n            <KpiCard label=\"Battery SOC\"  value={batSoc != null ? batSoc.toFixed(1) : ''}      unit=\"%\"   sub=\"State of charge\"       accent=\"#00a63e\" icon={<IconBattery />} />\n            <KpiCard label=\"Load\"         value={loadKw != null ? loadKw.toFixed(2) : ''}      unit=\"kW\"  sub=\"Current consumption\"   accent=\"#8b5cf6\" icon={<IconLoad />}    />\n            <KpiCard label=\"Energy Today\" value={todayKwh != null ? todayKwh.toFixed(2) : ''}  unit=\"kWh\" sub=\"Solar yield today\"     accent=\"#10b981\" icon={<IconEnergy />}  />\n          </div>\n\n          {/*  Weather pill row  */}\n          {weather && (\n            <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap', marginBottom: '1rem' }}>\n              {[\n                { label: 'Temp', value: weather.temperature_c != null ? `${weather.temperature_c.toFixed(1)} C` : null },\n                { label: 'Humidity', value: weather.humidity_pct != null ? `${weather.humidity_pct} %` : null },\n                { label: 'Cloud', value: weather.cloud_cover_pct != null ? `${weather.cloud_cover_pct} %` : null, icon: <IconCloud /> },\n                { label: 'Wind', value: weather.wind_speed_ms != null ? `${weather.wind_speed_ms.toFixed(1)} m/s` : null },\n                { label: 'GHI', value: weather.ghi_wm2 != null ? `${Math.round(weather.ghi_wm2)} W/m` : null },\n              ].filter(p => p.value != null).map(p => (\n                <span key={p.label} style={{\n                  fontSize: '0.72rem', fontWeight: 600, fontFamily: 'Poppins, sans-serif',\n                  padding: '0.2rem 0.65rem', borderRadius: 99,\n                  background: 'rgba(0,166,62,0.07)', border: '1px solid rgba(0,166,62,0.12)',\n                  color: '#007a55', display: 'flex', alignItems: 'center', gap: '0.3rem',\n                }}>\n                  {p.icon}{p.label}: <span style={{ fontFamily: 'JetBrains Mono, monospace', color: '#0a0a0a' }}>{p.value}</span>\n                </span>\n              ))}\n            </div>\n          )}\n\n          {/*  History chart  */}\n          {historyData.length > 0 && (\n            <div className=\"card\" style={{ padding: '1.25rem', marginBottom: '1rem' }}>\n              <div style={{ marginBottom: '1rem' }}>\n                <h3 style={{ margin: '0 0 0.25rem', fontSize: '0.9rem', fontFamily: 'Urbanist, sans-serif', color: '#0a0a0a' }}>\n                  Power History  {\n                    dateRange === '24h' ? 'Today' :\n                    dateRange === '7d' ? 'Last 7 days' :\n                    dateRange === '30d' ? 'Last 30 days' :\n                    dateRange === 'custom' && customStartDate && customEndDate ? \n                      `${new Date(customStartDate).toLocaleDateString()} - ${new Date(customEndDate).toLocaleDateString()}` :\n                      'Custom range'\n                  }\n                </h3>\n                {(dateRange === '7d' || dateRange === '30d' || dateRange === 'custom') && (\n                  <p style={{ margin: 0, fontSize: '0.7rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>\n                    {dateRange === '7d' ? 'Data aggregated by hour' : 'Data aggregated by day'}\n                  </p>\n                )}\n              </div>\n              <div style={{ height: 220 }}>\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <AreaChart data={historyData} margin={{ top: 4, right: 8, left: 0, bottom: dateRange === '7d' || dateRange === '30d' ? 20 : 0 }}>\n                    <defs>\n                      <linearGradient id=\"pvGrad\"   x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                        <stop offset=\"5%\"  stopColor=\"#F07522\" stopOpacity={0.22}/>\n                        <stop offset=\"95%\" stopColor=\"#F07522\" stopOpacity={0}/>\n                      </linearGradient>\n                      <linearGradient id=\"loadGrad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                        <stop offset=\"5%\"  stopColor=\"#8b5cf6\" stopOpacity={0.18}/>\n                        <stop offset=\"95%\" stopColor=\"#8b5cf6\" stopOpacity={0}/>\n                      </linearGradient>\n                    </defs>\n                    <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(0,166,62,0.08)\" />\n                    <XAxis \n                      dataKey=\"time\" \n                      stroke=\"#9ca3af\" \n                      fontSize={dateRange === '30d' ? 9 : 10} \n                      interval={dateRange === '24h' ? 'preserveStartEnd' : Math.ceil(historyData.length / 10)}\n                      angle={dateRange === '7d' || dateRange === '30d' ? -15 : 0}\n                      textAnchor={dateRange === '7d' || dateRange === '30d' ? 'end' : 'middle'}\n                    />\n                    <YAxis stroke=\"#9ca3af\" fontSize={10} tickFormatter={v => `${v}kW`} />\n                    <Tooltip contentStyle={TOOLTIP_STYLE} formatter={(v: any, name: any) => [`${v} ${name && name.includes('%') ? '%' : 'kW'}`, name]} />\n                    <Legend iconType=\"circle\" iconSize={8} wrapperStyle={{ fontSize: 11, fontFamily: 'Poppins, sans-serif' }} />\n                    <Area type=\"monotone\" dataKey=\"PV (kW)\"   stroke=\"#F07522\" strokeWidth={2} fill=\"url(#pvGrad)\"   dot={false} />\n                    <Area type=\"monotone\" dataKey=\"Load (kW)\" stroke=\"#8b5cf6\" strokeWidth={2} fill=\"url(#loadGrad)\" dot={false} />\n                    <Line type=\"monotone\" dataKey=\"Grid (kW)\" stroke=\"#3b82f6\" strokeWidth={1.5} dot={false} strokeDasharray=\"4 3\" />\n                  </AreaChart>\n                </ResponsiveContainer>\n              </div>\n            </div>\n          )}\n\n          {forecastData.length > 0 && (\n            <div className=\"card\" style={{ padding: 0, boxShadow: '0 10px 30px -5px rgba(0, 0, 0, 0.1)', border: '1px solid #e5e7eb', borderRadius: 16, background: '#ffffff', overflow: 'hidden' }}>\n              {/* Header Bar */}\n              <div style={{ padding: '1.25rem 1.5rem', borderBottom: '1px solid #f3f4f6', display: 'flex', flexWrap: 'wrap', gap: '1rem', alignItems: 'center', justifyContent: 'space-between', background: 'linear-gradient(to right, #ffffff, #f9fafb)' }}>\n                {/* Left: Title & Stats */}\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '0.25rem' }}>\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n                      <div style={{ width: 32, height: 32, borderRadius: 8, background: 'rgba(0,166,62,0.1)', color: '#00a63e', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '1.1rem' }}></div>\n                      <h3 style={{ margin: 0, fontSize: '1.1rem', fontFamily: 'Urbanist, sans-serif', color: '#111827', fontWeight: 700 }}>Solar Forecast</h3>\n                    </div>\n                    {forecastEnergyP50 > 0 && (\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginLeft: '2.5rem' }}>\n                         <span style={{ fontSize: '0.85rem', color: '#6b7280', fontFamily: 'Inter, sans-serif' }}>Est. Yield:</span>\n                         <span style={{ fontFamily: 'JetBrains Mono, monospace', fontSize: '0.85rem', fontWeight: 600, color: '#111827', background: '#f3f4f6', padding: '2px 6px', borderRadius: 4 }}>\n                           {forecastEnergyP10.toFixed(1)} <span style={{color:'#9ca3af'}}>/</span> <span style={{color: '#00a63e'}}>{forecastEnergyP50.toFixed(1)}</span> <span style={{color:'#9ca3af'}}>/</span> {forecastEnergyP90.toFixed(1)} kWh\n                         </span>\n                      </div>\n                    )}\n                </div>\n\n                {/* Right: Controls */}\n                <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>\n                  {/* View Toggle */}\n                  <div style={{ display: 'flex', background: '#f3f4f6', borderRadius: 8, padding: 3 }}>\n                    <button \n                      onClick={() => setForecastView('chart')}\n                      style={{ \n                        border: 'none', background: forecastView === 'chart' ? '#fff' : 'transparent', \n                        color: forecastView === 'chart' ? '#00a63e' : '#6b7280', borderRadius: 6,\n                        padding: '0.35rem 0.75rem', fontSize: '0.75rem', fontWeight: 600, cursor: 'pointer',\n                        boxShadow: forecastView === 'chart' ? '0 1px 3px rgba(0,0,0,0.1)' : 'none'\n                      }}>\n                      Chart\n                    </button>\n                     <button \n                      onClick={() => setForecastView('table')}\n                      style={{ \n                        border: 'none', background: forecastView === 'table' ? '#fff' : 'transparent', \n                        color: forecastView === 'table' ? '#00a63e' : '#6b7280', borderRadius: 6,\n                        padding: '0.35rem 0.75rem', fontSize: '0.75rem', fontWeight: 600, cursor: 'pointer',\n                        boxShadow: forecastView === 'table' ? '0 1px 3px rgba(0,0,0,0.1)' : 'none'\n                      }}>\n                      Table\n                    </button>\n                  </div>\n\n                  {forecastView === 'chart' && (\n                    <>\n                      {/* Toggle Pills */}\n                      <div style={{ display: 'flex', background: '#f3f4f6', padding: 3, borderRadius: 8 }}>\n                        {[{ label: 'P10', color: '#f59e0b', tooltip: 'Conservative' }, { label: 'P50', color: '#00a63e', tooltip: 'Median' }, { label: 'P90', color: '#3b82f6', tooltip: 'Optimistic' }].map(b => (\n                           <button\n                             key={b.label}\n                             onClick={() => setShowBands(s => ({ ...s, [b.label]: !s[b.label] }))}\n                             style={{\n                               border: 'none',\n                               background: showBands[b.label] ? '#ffffff' : 'transparent',\n                               color: showBands[b.label] ? b.color : '#9ca3af',\n                               boxShadow: showBands[b.label] ? '0 2px 4px rgba(0,0,0,0.05)' : 'none',\n                               borderRadius: 6,\n                               padding: '0.35rem 0.75rem',\n                               fontSize: '0.75rem',\n                               fontWeight: 600,\n                               cursor: 'pointer',\n                               transition: 'all 0.2s ease',\n                               display: 'flex', alignItems: 'center', gap: 4\n                             }}\n                             title={`Toggle ${b.tooltip} Forecast`}\n                           >\n                             <span style={{ width: 6, height: 6, borderRadius: '50%', background: showBands[b.label] ? b.color : '#d1d5db' }} />\n                             {b.label}\n                           </button>\n                        ))}\n                      </div>\n\n                      {/* Zoom Controls */}\n                      <div style={{ display: 'flex', background: '#f3f4f6', padding: 3, borderRadius: 8 }}>\n                         <button onClick={zoomOut} disabled={zoomLeft === 'dataMin' && zoomRight === 'dataMax'} style={{ border: 'none', background: 'transparent', padding: '0.35rem 0.6rem', cursor: 'pointer', fontSize: '1rem', color: '#4b5563', opacity: zoomLeft === 'dataMin' ? 0.4 : 1 }} title=\"Reset Zoom\">\n                           \n                         </button>\n                      </div>\n                    </>\n                  )}\n\n                  {/* Export Button */}\n                  <button\n                    onClick={async () => {\n                      const chartDiv = document.getElementById('forecast-chart-container');\n                      if (chartDiv) {\n                        const canvas = await html2canvas(chartDiv, { background: '#ffffff', scale: 2 } as any); // Higher scale for better quality\n                        const link = document.createElement('a');\n                        link.download = `solar-forecast-${new Date().toISOString().slice(0,10)}.png`;\n                        link.href = canvas.toDataURL();\n                        link.click();\n                      }\n                    }}\n                    style={{\n                      background: 'transparent', border: '1px solid #e5e7eb', color: '#374151',\n                      borderRadius: 8, padding: '0.4rem 0.8rem', fontSize: '0.8rem', fontWeight: 600,\n                      cursor: 'pointer', transition: 'all 0.2s', display: 'flex', alignItems: 'center', gap: 6\n                    }}\n                    onMouseOver={(e) => e.currentTarget.style.background = '#f9fafb'}\n                    onMouseOut={(e) => e.currentTarget.style.background = 'transparent'}\n                  >\n                    <span></span> <span>Save</span>\n                  </button>\n                </div>\n              </div>\n\n              {/* Chart/Table Area */}\n              <div id=\"forecast-chart-container\" style={{ padding: '0 1.5rem 1.5rem 0.5rem', background: '#ffffff', position: 'relative' }}>\n                {forecastView === 'chart' ? (\n                <div style={{ height: 300, width: '100%', userSelect: 'none' }}>\n                  <ResponsiveContainer>\n                    <AreaChart \n                      data={forecastData} \n                      margin={{ top: 20, right: 10, left: 0, bottom: 0 }}\n                      onMouseDown={(e: any) => e && setRefAreaLeft(e.activeLabel)}\n                      onMouseMove={(e: any) => refAreaLeft && e && setRefAreaRight(e.activeLabel)}\n                      onMouseUp={zoom}\n                    >\n                      <defs>\n                        <linearGradient id=\"p50Grad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                          <stop offset=\"5%\"  stopColor=\"#00a63e\" stopOpacity={0.2}/>\n                          <stop offset=\"95%\" stopColor=\"#00a63e\" stopOpacity={0}/>\n                        </linearGradient>\n                         <linearGradient id=\"p90Grad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                          <stop offset=\"5%\"  stopColor=\"#3b82f6\" stopOpacity={0.15}/>\n                          <stop offset=\"95%\" stopColor=\"#3b82f6\" stopOpacity={0}/>\n                        </linearGradient>\n                         <linearGradient id=\"p10Grad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                          <stop offset=\"5%\"  stopColor=\"#f59e0b\" stopOpacity={0.15}/>\n                          <stop offset=\"95%\" stopColor=\"#f59e0b\" stopOpacity={0}/>\n                        </linearGradient>\n                      </defs>\n                      <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#f3f4f6\" vertical={false} />\n                      <XAxis \n                        dataKey=\"time\" \n                        stroke=\"#9ca3af\" \n                        fontSize={11}\n                        fontFamily=\"Inter, sans-serif\" \n                        tickLine={false}\n                        axisLine={false}\n                        minTickGap={30}\n                        tickMargin={12}\n                        tick={{ fill: '#6b7280', fontSize: 11 }}\n                        angle={0}\n                        textAnchor=\"middle\"\n                        allowDataOverflow\n                        domain={[zoomLeft, zoomRight]}\n                        type=\"category\"\n                        tickFormatter={(val, index) => {\n                          // Clean formatted ticks based on range\n                          if (dateRange === '24h') return val; // Already HH:MM\n                          // For longer ranges, maybe just show date if it changes, or time?\n                          // The 'val' is currently \"MMM D HH:MM\" from the map function. \n                          // Let's shorten it for axis ticks.\n                          const parts = val.split(' ');\n                          if (parts.length >= 3) {\n                             // \"Feb 25 14:00\" -> Show \"Feb 25\" if distinct, else time?\n                             // Simplest professional approach: show limited ticks\n                             return parts[0] + ' ' + parts[1]; \n                          }\n                          return val;\n                        }}\n                      />\n                      <YAxis \n                        stroke=\"#9ca3af\" \n                        fontSize={11}\n                        fontFamily=\"Inter, sans-serif\"\n                        tickLine={false} \n                        axisLine={false} \n                        width={40}\n                        tickFormatter={v => `${v}`} \n                        allowDataOverflow\n//                        domain={['auto', 'auto']}\n                        label={{ value: 'kW', angle: -90, position: 'insideLeft', fill: '#9ca3af', fontSize: 10, offset: 0 }}\n                      />\n                      <Tooltip content={<ForecastTooltip />} cursor={{ stroke: '#00a63e', strokeWidth: 1, strokeDasharray: '4 4' }} animationDuration={300} wrapperStyle={{ pointerEvents: 'none' }} />\n                      <Legend verticalAlign=\"top\" height={36} iconType=\"circle\" iconSize={8} wrapperStyle={{ right: 0, top: 0, fontSize: 12, color: '#6b7280', fontFamily: 'Inter, sans-serif' }} />\n                      \n                      {/* P90 (Optimistic) - Render first (back) */}\n                      {showBands['P90'] && <Area type=\"monotone\" dataKey=\"p90\" stroke=\"#3b82f6\" strokeWidth={1} strokeDasharray=\"3 3\" fill=\"url(#p90Grad)\" activeDot={false} name=\"P90 (Optimistic)\" animationDuration={500} />}\n                      \n                      {/* P10 (Pessimistic) */}\n                      {showBands['P10'] && <Area type=\"monotone\" dataKey=\"p10\" stroke=\"#f59e0b\" strokeWidth={1} strokeDasharray=\"3 3\" fill=\"url(#p10Grad)\" activeDot={false} name=\"P10 (Reference)\" animationDuration={500} />}\n\n                      {/* P50 (Median) - Render last (front, boldest) */}\n                      {showBands['P50'] && <Area type=\"monotone\" dataKey=\"p50\" stroke=\"#00a63e\" strokeWidth={2.5} fill=\"url(#p50Grad)\" activeDot={{r: 4, strokeWidth: 0}} name=\"P50 (Median)\" animationDuration={800} />}\n                      \n                      <ReferenceLine x={new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })} stroke=\"#ef4444\" strokeDasharray=\"3 3\" label={{ value: 'NOW', position: 'top', fill: '#ef4444', fontSize: 10, fontWeight: 700 }} />\n                      \n                      {/* Zoom Selection Area */}\n                      {refAreaLeft && refAreaRight ? (\n                        <ReferenceArea x1={refAreaLeft} x2={refAreaRight} strokeOpacity={0.3} fill=\"#00a63e\" fillOpacity={0.1} />\n                      ) : null}\n\n                      {/* Minimalist Brush (optional, user asked to remove slider bar but keep functionality, we keep minimal brush or rely on drag zoom. User said 'do all 3', so we keep brush but cleaner) \n                      <Brush \n                        dataKey=\"time\" \n                        height={10} \n                        stroke=\"#e5e7eb\" \n                        fill=\"#f9fafb\" \n                        travellerWidth={6}\n                        gap={1}\n                        startIndex={0}\n                        endIndex={forecastData.length - 1}\n                        onChange={(metrics: any) => {\n                           // Sync zoom state if brush moves\n                        }}\n                      />\n                      */}\n                    </AreaChart>\n                  </ResponsiveContainer>\n                  {/* Zoom Hint */}\n                  <div style={{ position: 'absolute', bottom: 10, left: 24, fontSize: '0.65rem', color: '#9ca3af', background: 'rgba(255,255,255,0.8)', padding: '2px 6px', borderRadius: 4, pointerEvents: 'none' }}>\n                    Tip: Click & drag on chart to zoom\n                  </div>\n                </div>\n                ) : (\n                  <ForecastTable data={forecastData} />\n                )}\n                {forecastGeneratedAt && (\n                   <div style={{ textAlign: 'right', fontSize: '0.7rem', color: '#9ca3af', marginTop: '0.5rem', fontFamily: 'Inter, sans-serif', padding: '0 1rem 1rem' }}>\n                     Forecast generated: {forecastGeneratedAt.toLocaleDateString()} {forecastGeneratedAt.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                   </div>\n                )}\n              </div>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default SiteDataPanel;\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport { apiService } from '../services/api';\r\nimport { useDebouncedCallback } from '../hooks/useDebounce';\r\nimport { useTheme } from '../contexts/ThemeContext';\r\nimport AuditTrail from './AuditTrail';\r\nimport SiteDataPanel from './SiteDataPanel';\r\n\r\ninterface User {\r\n  id: number;\r\n  username: string;\r\n  first_name: string;\r\n  last_name: string;\r\n  email: string;\r\n  is_staff: boolean;\r\n  is_superuser: boolean;\r\n}\r\n\r\ninterface Device {\r\n  id: number;\r\n  device_serial: string;\r\n  hw_id?: string;\r\n  model?: string;\r\n  user?: string;\r\n  provisioned_at: string;\r\n  config_version?: string;\r\n  is_online?: boolean;\r\n  last_heartbeat?: string;\r\n  logs_enabled?: boolean;\r\n  pending_config_update?: boolean;\r\n  config_ack_ver?: number | null;\r\n  config_downloaded_at?: string | null;\r\n  config_acked_at?: string | null;\r\n  created_by_username?: string;\r\n  created_at?: string;\r\n  updated_by_username?: string;\r\n  updated_at?: string;\r\n}\r\n\r\ninterface Preset {\r\n  id: number;\r\n  config_id?: string;\r\n  name: string;\r\n  description?: string;\r\n  slaves_count?: number;\r\n  version?: number;\r\n  updated_at?: string;\r\n  gateway_configuration?: {\r\n    general_settings?: {\r\n      config_id?: string;\r\n      last_updated?: string;\r\n    };\r\n  };\r\n}\r\n\r\ninterface SystemHealthData {\r\n  total_devices: number;\r\n  active_devices: number;\r\n  total_telemetry_points: number;\r\n  uptime_seconds: number;\r\n  database_status: string;\r\n  mqtt_status: string;\r\n  overall_health: string;\r\n}\r\n\r\ninterface TelemetryData {\r\n  deviceId: string;\r\n  timestamp: string;\r\n  data_type: string;\r\n  value: number;\r\n  unit: string;\r\n}\r\n\r\ninterface TelemetrySummary {\r\n  totalPoints: number;\r\n  deviceCount: number;\r\n  latestTimestamp: string | null;\r\n}\r\n\r\ninterface SolarSite {\r\n  id: number;\r\n  device_id: number;\r\n  site_id: string;\r\n  display_name: string;\r\n  latitude: number;\r\n  longitude: number;\r\n  capacity_kw: number;\r\n  tilt_deg: number;\r\n  azimuth_deg: number;\r\n  timezone: string;\r\n  is_active: boolean;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\ninterface SolarSiteForm {\r\n  site_id: string;\r\n  display_name: string;\r\n  latitude: string;\r\n  longitude: string;\r\n  capacity_kw: string;\r\n  tilt_deg: string;\r\n  azimuth_deg: string;\r\n  timezone: string;\r\n  is_active: boolean;\r\n}\r\n\r\nconst Devices: React.FC = () => {\r\n  const { isDark } = useTheme();\r\n  const [searchParams] = useSearchParams();\r\n  const [devices, setDevices] = useState<Device[]>([]);\r\n  const [filteredDevices, setFilteredDevices] = useState<Device[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [editingDevice, setEditingDevice] = useState<Device | null>(null);\r\n  const [creatingDevice, setCreatingDevice] = useState(false);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [userSearchTerm, setUserSearchTerm] = useState('');\r\n  const [filteredUsers, setFilteredUsers] = useState<User[]>([]);\r\n  const [showUserDropdown, setShowUserDropdown] = useState(false);\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [selectedDevices, setSelectedDevices] = useState<Set<number>>(new Set());\r\n  const [bulkDeleteLoading, setBulkDeleteLoading] = useState(false);\r\n  // Pagination state\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [pageSize, setPageSize] = useState(25);\r\n  const [totalCount, setTotalCount] = useState(0);\r\n  const [totalPages, setTotalPages] = useState(0);\r\n  const [presets, setPresets] = useState<Preset[]>([]);\r\n  const [presetsLoading, setPresetsLoading] = useState(true);\r\n  const [health, setHealth] = useState<SystemHealthData | null>(null);\r\n  const [telemetrySummary, setTelemetrySummary] = useState<TelemetrySummary | null>(null);\r\n  const [telemetryData, setTelemetryData] = useState<TelemetryData[]>([]);\r\n  const [dashboardError, setDashboardError] = useState<string | null>(null);\r\n  const [selectedDevice, setSelectedDevice] = useState<Device | null>(null);\r\n  const [deviceLogs, setDeviceLogs] = useState<any[]>([]);\r\n  const [logsLoading, setLogsLoading] = useState(false);\r\n  const [editForm, setEditForm] = useState({\r\n    device_serial: '',\r\n    user: '',\r\n    config_version: '',\r\n  });\r\n  const [createForm, setCreateForm] = useState({\r\n    device_serial: '',\r\n    user: '',\r\n    config_version: '',\r\n  });\r\n\r\n  // Site management state\r\n  const [siteDetails, setSiteDetails] = useState<SolarSite | null>(null);\r\n  const [siteLoading, setSiteLoading] = useState(false);\r\n  const [editingSite, setEditingSite] = useState(false);\r\n  const [siteForm, setSiteForm] = useState<SolarSiteForm>({\r\n    site_id: '', display_name: '', latitude: '', longitude: '',\r\n    capacity_kw: '', tilt_deg: '18', azimuth_deg: '180',\r\n    timezone: 'Asia/Kolkata', is_active: true,\r\n  });\r\n  const [siteSaving, setSiteSaving] = useState(false);\r\n  const [siteError, setSiteError] = useState<string | null>(null);\r\n  const [devicePreset, setDevicePreset] = useState<Preset | null>(null);\r\n\r\n  const fetchDevices = useCallback(async (page: number = 1, search: string = '') => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await apiService.getDevices(search || undefined, page, pageSize);\r\n      \r\n      // Handle paginated response\r\n      if (response.results) {\r\n        setDevices(response.results);\r\n        setFilteredDevices(response.results);\r\n        setTotalCount(response.count);\r\n        setTotalPages(response.total_pages);\r\n        setCurrentPage(response.current_page);\r\n      } else {\r\n        // Fallback for non-paginated response\r\n        setDevices(Array.isArray(response) ? response : []);\r\n        setFilteredDevices(Array.isArray(response) ? response : []);\r\n        setTotalCount(Array.isArray(response) ? response.length : 0);\r\n        setTotalPages(1);\r\n        setCurrentPage(1);\r\n      }\r\n      \r\n      setLoading(false);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'An error occurred');\r\n      setLoading(false);\r\n    }\r\n  }, [pageSize]);\r\n\r\n  const fetchUsers = async () => {\r\n    try {\r\n      const data: User[] = await apiService.getUsers();\r\n      // Filter out staff and superusers, only showing regular customers\r\n      const customers = data.filter(user => !user.is_staff && !user.is_superuser);\r\n      setUsers(customers);\r\n    } catch (err) {\r\n      console.error('Failed to fetch users:', err);\r\n      setError('Failed to load users for device assignment');\r\n    }\r\n  };\r\n\r\n  const fetchPresets = async () => {\r\n    try {\r\n      const data = await apiService.getPresets();\r\n      setPresets(Array.isArray(data) ? data : []);\r\n    } catch (err) {\r\n      console.error('Failed to fetch presets:', err);\r\n    } finally {\r\n      setPresetsLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchDashboardData = async () => {\r\n    try {\r\n      const [healthData, telemetryData] = await Promise.all([\r\n        apiService.getSystemHealth(),\r\n        apiService.getTelemetry(),\r\n      ]);\r\n\r\n      setHealth(healthData || null);\r\n\r\n      const telemetryArray = Array.isArray(telemetryData) ? telemetryData : [];\r\n      setTelemetryData(telemetryArray);\r\n      const latest = telemetryArray.reduce<string | null>((currentLatest, item) => {\r\n        if (!item?.timestamp) return currentLatest;\r\n        const itemDate = new Date(item.timestamp);\r\n        if (Number.isNaN(itemDate.getTime())) return currentLatest;\r\n        if (!currentLatest) return item.timestamp;\r\n        const currentDate = new Date(currentLatest);\r\n        return itemDate > currentDate ? item.timestamp : currentLatest;\r\n      }, null);\r\n\r\n      const deviceCount = new Set(telemetryArray.map((item: TelemetryData) => item.deviceId)).size;\r\n      setTelemetrySummary({\r\n        totalPoints: telemetryArray.length,\r\n        deviceCount,\r\n        latestTimestamp: latest,\r\n      });\r\n    } catch (err) {\r\n      console.error('Failed to fetch dashboard data:', err);\r\n      setDashboardError('Failed to load device dashboards');\r\n    }\r\n  };\r\n\r\n  const fetchDeviceLogs = useCallback(async (deviceId: number) => {\r\n    setLogsLoading(true);\r\n    try {\r\n      const response = await apiService.getDeviceLogs(deviceId, 50, 0);\r\n      setDeviceLogs(response.logs || []);\r\n    } catch (err) {\r\n      console.error('Failed to fetch device logs:', err);\r\n      setDeviceLogs([]);\r\n    } finally {\r\n      setLogsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const handleViewDevice = useCallback((device: Device) => {\r\n    setSelectedDevice(device);\r\n    setSiteDetails(null);\r\n    setSiteLoading(true);\r\n    setDeviceLogs([]);\r\n    \r\n    // Load preset details if device has config\r\n    if (device.config_version) {\r\n      const preset = presets.find(p => p.config_id === device.config_version);\r\n      setDevicePreset(preset || null);\r\n    } else {\r\n      setDevicePreset(null);\r\n    }\r\n    \r\n    // Fetch site details and logs in parallel\r\n    Promise.all([\r\n      apiService.getDeviceSite(device.id)\r\n        .then(data => setSiteDetails(data))\r\n        .catch((err) => {\r\n          console.error('Failed to fetch site for device', device.id, ':', err);\r\n          setSiteDetails(null);\r\n        }),\r\n      fetchDeviceLogs(device.id)\r\n    ]).finally(() => setSiteLoading(false));\r\n  }, [fetchDeviceLogs, presets]);\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n    fetchPresets();\r\n    fetchDashboardData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const deviceIdParam = searchParams.get('deviceId');\r\n    if (deviceIdParam) {\r\n      const deviceId = parseInt(deviceIdParam, 10);\r\n      if (!isNaN(deviceId)) {\r\n        const foundDevice = devices.find(d => d.id === deviceId);\r\n        if (foundDevice) {\r\n          handleViewDevice(foundDevice);\r\n        }\r\n      }\r\n    }\r\n  }, [searchParams, devices, handleViewDevice]);\r\n  \r\n  useEffect(() => {\r\n    fetchDevices(currentPage, searchTerm);\r\n  }, [currentPage, searchTerm, pageSize, fetchDevices]);\r\n  \r\n  useEffect(() => {\r\n    const handleClickOutside = () => {\r\n      setShowUserDropdown(false);\r\n    };\r\n\r\n    if (showUserDropdown) {\r\n      document.addEventListener('click', handleClickOutside);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('click', handleClickOutside);\r\n    };\r\n  }, [showUserDropdown]);\r\n\r\n  useEffect(() => {\r\n    if (userSearchTerm.trim() === '') {\r\n      setFilteredUsers(users);\r\n    } else {\r\n      const searchLower = userSearchTerm.toLowerCase();\r\n      const filtered = users.filter(user => {\r\n        const fullName = `${user.first_name} ${user.last_name}`.toLowerCase();\r\n        return (\r\n          user.username.toLowerCase().includes(searchLower) ||\r\n          user.first_name.toLowerCase().includes(searchLower) ||\r\n          user.last_name.toLowerCase().includes(searchLower) ||\r\n          fullName.includes(searchLower) ||\r\n          user.email.toLowerCase().includes(searchLower)\r\n        );\r\n      });\r\n      setFilteredUsers(filtered);\r\n    }\r\n  }, [users, userSearchTerm]);\r\n\r\n  // Debounced search function that runs the actual search after 300ms of inactivity\r\n  const debouncedSearch = useDebouncedCallback(\r\n    (query: string) => {\r\n      // The actual search happens via useEffect that watches currentPage and searchTerm\r\n      // This ensures we don't make too many API calls\r\n    },\r\n    300\r\n  );\r\n\r\n  const handleSearch = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const query = e.target.value;\r\n    setSearchTerm(query);\r\n    setCurrentPage(1);  // Reset to page 1 on new search\r\n    debouncedSearch(query);  // Debounce the search\r\n  };\r\n\r\n  const handleEdit = (device: Device) => {\r\n    setEditingDevice(device);\r\n    setEditForm({\r\n      device_serial: device.device_serial,\r\n      user: device.user || '',\r\n      config_version: device.config_version || '',\r\n    });\r\n    setUserSearchTerm(device.user ? `${users.find(u => u.username === device.user)?.first_name} ${users.find(u => u.username === device.user)?.last_name} (${device.user})` : '');\r\n    setShowUserDropdown(false);\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    if (!editingDevice) return;\r\n\r\n    try {\r\n      await apiService.updateDevice(editingDevice.id, editForm);\r\n      setEditingDevice(null);\r\n      // Refetch to get the updated device with all fields including audit trail\r\n      await fetchDevices(currentPage, searchTerm);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to update device');\r\n    }\r\n  };\r\n\r\n  const handleCreate = async () => {\r\n    try {\r\n      await apiService.createDevice(createForm);\r\n      setCreatingDevice(false);\r\n      setCreateForm({\r\n        device_serial: '',\r\n        user: '',\r\n        config_version: '',\r\n      });\r\n      // Refetch to get the new device with all fields including audit trail\r\n      await fetchDevices(currentPage, searchTerm);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to create device');\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (device: any) => {\r\n    if (window.confirm(`Are you sure you want to delete device ${device.device_serial}?`)) {\r\n      try {\r\n        await apiService.deleteDevice(device.id);\r\n        const updatedDevices = devices.filter(d => d.id !== device.id);\r\n        setDevices(updatedDevices);\r\n        setFilteredDevices(updatedDevices);\r\n      } catch (err) {\r\n        console.error('Delete error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to delete device');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleReboot = async (device: any) => {\r\n    if (window.confirm(`Are you sure you want to reboot device ${device.device_serial}? The device will restart on its next heartbeat.`)) {\r\n      try {\r\n        await apiService.rebootDevice(device.id);\r\n        alert(`Reboot command queued for ${device.device_serial}. Device will reboot on next heartbeat.`);\r\n      } catch (err) {\r\n        console.error('Reboot error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to queue reboot command');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleHardReset = async (device: any) => {\r\n    if (window.confirm(` WARNING: Hard reset will erase device configuration and restart it.\\n\\nAre you sure you want to hard reset device ${device.device_serial}?`)) {\r\n      try {\r\n        await apiService.hardResetDevice(device.id);\r\n        alert(`Hard reset command queued for ${device.device_serial}. Device will reset on next heartbeat.`);\r\n      } catch (err) {\r\n        console.error('Hard reset error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to queue hard reset command');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDeleteDevice = async (device: any) => {\r\n    if (window.confirm(` WARNING: This will permanently delete device ${device.device_serial} and all its data.\\n\\nAre you sure you want to delete this device?`)) {\r\n      try {\r\n        await apiService.deleteDevice(device.id);\r\n        alert(`Device ${device.device_serial} deleted successfully.`);\r\n        setSelectedDevice(null);\r\n        fetchDevices(); // Refresh device list\r\n      } catch (err) {\r\n        console.error('Delete device error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to delete device');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleToggleLogs = async (device: any, enabled: boolean) => {\r\n    try {\r\n      await apiService.toggleDeviceLogs(device.id, enabled);\r\n      setSelectedDevice({ ...device, logs_enabled: enabled });\r\n      fetchDevices(); // Refresh device list\r\n    } catch (err) {\r\n      console.error('Toggle logs error:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to toggle device logs');\r\n    }\r\n  };\r\n\r\n  const handleSelectDevice = (deviceId: number) => {\r\n    const newSelected = new Set(selectedDevices);\r\n    if (newSelected.has(deviceId)) {\r\n      newSelected.delete(deviceId);\r\n    } else {\r\n      newSelected.add(deviceId);\r\n    }\r\n    setSelectedDevices(newSelected);\r\n  };\r\n\r\n  const handleSelectAll = () => {\r\n    if (selectedDevices.size === filteredDevices.length) {\r\n      setSelectedDevices(new Set());\r\n    } else {\r\n      const allIds = new Set(filteredDevices.map(d => d.id));\r\n      setSelectedDevices(allIds);\r\n    }\r\n  };\r\n\r\n  const handleBulkDelete = async () => {\r\n    if (selectedDevices.size === 0) {\r\n      setError('No devices selected for deletion');\r\n      return;\r\n    }\r\n\r\n    const deviceList = Array.from(selectedDevices)\r\n      .map(id => devices.find(d => d.id === id))\r\n      .filter(Boolean);\r\n\r\n    const confirmMessage = `Are you sure you want to delete ${selectedDevices.size} device(s)?\\n\\n${deviceList.map(d => d?.device_serial).join(', ')}`;\r\n\r\n    if (window.confirm(confirmMessage)) {\r\n      try {\r\n        setBulkDeleteLoading(true);\r\n        await apiService.deleteDevicesBulk(Array.from(selectedDevices));\r\n        \r\n        const updatedDevices = devices.filter(d => !selectedDevices.has(d.id));\r\n        setDevices(updatedDevices);\r\n        setFilteredDevices(updatedDevices.filter(d => \r\n          d.device_serial.toLowerCase().includes(searchTerm.toLowerCase())\r\n        ));\r\n        setSelectedDevices(new Set());\r\n        setBulkDeleteLoading(false);\r\n      } catch (err) {\r\n        setBulkDeleteLoading(false);\r\n        console.error('Bulk delete error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to delete devices');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setEditingDevice(null);\r\n    setCreatingDevice(false);\r\n    setUserSearchTerm('');\r\n    setShowUserDropdown(false);\r\n  };\r\n\r\n  const handleBackToList = () => {\r\n    setSelectedDevice(null);\r\n    setSiteDetails(null);\r\n    setEditingSite(false);\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"loading\">Loading devices...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div className=\"error\">Error: {error}</div>;\r\n  }\r\n\r\n  const getPresetConfigId = (preset: Preset): string => {\r\n    return preset.gateway_configuration?.general_settings?.config_id || preset.config_id || '';\r\n  };\r\n\r\n  if (selectedDevice) {\r\n    const deviceTelemetry = telemetryData.filter((entry) => entry.deviceId === selectedDevice.device_serial);\r\n    const latestTelemetry = deviceTelemetry.reduce<string | null>((currentLatest, item) => {\r\n      if (!item?.timestamp) return currentLatest;\r\n      const itemDate = new Date(item.timestamp);\r\n      if (Number.isNaN(itemDate.getTime())) return currentLatest;\r\n      if (!currentLatest) return item.timestamp;\r\n      const currentDate = new Date(currentLatest);\r\n      return itemDate > currentDate ? item.timestamp : currentLatest;\r\n    }, null);\r\n\r\n    return (\r\n      <div>\r\n        <div style={{ display: 'flex', alignItems: 'center', marginBottom: '20px' }}>\r\n          <button\r\n            onClick={handleBackToList}\r\n            className=\"btn btn-secondary\"\r\n            style={{ marginRight: '15px' }}\r\n          >\r\n             Back to Devices\r\n          </button>\r\n          <h1 style={{ margin: 0 }}>{selectedDevice.device_serial} Dashboard</h1>\r\n        </div>\r\n\r\n        <div className=\"card\" style={{ marginBottom: '20px' }}>\r\n          <div className=\"card-header\">\r\n            <h2>Device Details</h2>\r\n            <div style={{ display: 'flex', gap: '10px' }}>\r\n              <button onClick={() => handleEdit(selectedDevice)} className=\"btn\">\r\n                Edit Device\r\n              </button>\r\n              <button \r\n                onClick={() => handleReboot(selectedDevice)} \r\n                className=\"btn\"\r\n                style={{ \r\n                  backgroundColor: '#f59e0b', \r\n                  color: 'white',\r\n                  border: 'none'\r\n                }}\r\n                title=\"Queue reboot command for device\"\r\n              >\r\n                 Reboot\r\n              </button>\r\n              <button \r\n                onClick={() => handleHardReset(selectedDevice)} \r\n                className=\"btn\"\r\n                style={{ \r\n                  backgroundColor: '#dc2626', \r\n                  color: 'white',\r\n                  border: 'none'\r\n                }}\r\n                title=\"Queue hard reset command for device (erases config)\"\r\n              >\r\n                 Hard Reset\r\n              </button>\r\n              <button \r\n                onClick={() => handleDeleteDevice(selectedDevice)} \r\n                className=\"btn\"\r\n                style={{ \r\n                  backgroundColor: '#7f1d1d', \r\n                  color: 'white',\r\n                  border: 'none'\r\n                }}\r\n                title=\"Permanently delete device and all its data\"\r\n              >\r\n                 Delete\r\n              </button>\r\n            </div>\r\n          </div>\r\n          <div style={{ padding: '20px' }}>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '15px' }}>\r\n              <div>\r\n                <strong>Status:</strong>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  <span style={{\r\n                    display: 'inline-block',\r\n                    padding: '4px 12px',\r\n                    borderRadius: '12px',\r\n                    fontSize: '0.875rem',\r\n                    fontWeight: '500',\r\n                    backgroundColor: selectedDevice.is_online ? '#dcfce7' : '#fee2e2',\r\n                    color: selectedDevice.is_online ? '#166534' : '#991b1b'\r\n                  }}>\r\n                    {selectedDevice.is_online ? ' Online' : ' Offline'}\r\n                  </span>\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <strong>Last Heartbeat:</strong>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  {selectedDevice.last_heartbeat\r\n                    ? new Date(selectedDevice.last_heartbeat).toLocaleString()\r\n                    : 'Never'}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <strong>MAC / HW ID:</strong>\r\n                <p style={{ margin: '5px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.9rem' }}>{selectedDevice.hw_id || ''}</p>\r\n              </div>\r\n              <div>\r\n                <strong>Model:</strong>\r\n                <p style={{ margin: '5px 0' }}>{selectedDevice.model || ''}</p>\r\n              </div>\r\n              <div>\r\n                <strong>Assigned User:</strong>\r\n                <p style={{ margin: '5px 0' }}>{selectedDevice.user || '-'}</p>\r\n              </div>\r\n              <div style={{ gridColumn: '1 / -1', padding: '15px', backgroundColor: 'transparent', borderRadius: '8px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-sync-card\">\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '12px' }}>\r\n                  <div>\r\n                    <strong style={{ fontSize: '0.95rem', color: 'inherit' }} className=\"config-heading\">Configuration</strong>\r\n                    {devicePreset && (\r\n                      <div style={{ fontSize: '0.875rem', color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginTop: '2px' }} className=\"config-label\">\r\n                        {devicePreset.name || selectedDevice.config_version}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  {!selectedDevice.config_version ? (\r\n                    <span style={{ color: isDark ? '#a0a0a0' : 'rgba(0, 0, 0, 0.5)', fontSize: '0.875rem' }} className=\"config-no-preset\">No preset assigned</span>\r\n                  ) : selectedDevice.pending_config_update ? (\r\n                    <span style={{\r\n                      display: 'inline-flex', alignItems: 'center', gap: '5px',\r\n                      padding: '4px 12px', borderRadius: '12px', fontSize: '0.8rem', fontWeight: '500',\r\n                      backgroundColor: '#fef9c3', color: '#854d0e'\r\n                    }}> Pending update</span>\r\n                  ) : (\r\n                    <span style={{\r\n                      display: 'inline-flex', alignItems: 'center', gap: '5px',\r\n                      padding: '4px 12px', borderRadius: '12px', fontSize: '0.8rem', fontWeight: '500',\r\n                      backgroundColor: '#dcfce7', color: '#166534'\r\n                    }}> Synced</span>\r\n                  )}\r\n                </div>\r\n                {selectedDevice.config_version && (\r\n                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '8px', fontSize: '0.8rem' }}>\r\n                    <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                      <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Preset ID</div>\r\n                      <div style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>{selectedDevice.config_version}</div>\r\n                    </div>\r\n                    {devicePreset?.slaves_count != null && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Slaves</div>\r\n                        <div style={{ fontWeight: '500', color: 'inherit' }}>{devicePreset.slaves_count} device{devicePreset.slaves_count !== 1 ? 's' : ''}</div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_ack_ver != null && devicePreset?.version != null && (\r\n                      <div style={{ \r\n                        padding: '8px', \r\n                        backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', \r\n                        borderRadius: '6px',\r\n                        gridColumn: '1 / -1',\r\n                        border: selectedDevice.config_ack_ver === devicePreset.version ? '2px solid #dcfce7' : '2px solid #fef9c3'\r\n                      }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '4px' }} className=\"config-label\">Version Status</div>\r\n                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                          <div>\r\n                            <span style={{ fontSize: '0.75rem', color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)' }} className=\"config-label\">Device: </span>\r\n                            <span style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>v{selectedDevice.config_ack_ver}</span>\r\n                            <span style={{ margin: '0 8px', color: isDark ? '#808080' : 'rgba(0, 0, 0, 0.4)' }} className=\"config-arrow\"></span>\r\n                            <span style={{ fontSize: '0.75rem', color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)' }} className=\"config-label\">Latest: </span>\r\n                            <span style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>v{devicePreset.version}</span>\r\n                          </div>\r\n                          {selectedDevice.config_ack_ver === devicePreset.version ? (\r\n                            <span style={{ color: '#166534', fontSize: '0.75rem', fontWeight: '500' }}> Up to date</span>\r\n                          ) : (\r\n                            <span style={{ color: '#854d0e', fontSize: '0.75rem', fontWeight: '500' }}> Update available</span>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_ack_ver != null && devicePreset?.version == null && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Device Version</div>\r\n                        <div style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>v{selectedDevice.config_ack_ver}</div>\r\n                      </div>\r\n                    )}\r\n                    {devicePreset?.gateway_configuration?.general_settings?.last_updated && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Last Modified</div>\r\n                        <div style={{ fontWeight: '500', fontSize: '0.75rem', color: 'inherit' }}>\r\n                          {new Date(devicePreset.gateway_configuration.general_settings.last_updated).toLocaleDateString()}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_acked_at && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)', gridColumn: '1 / -1' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Last Synced</div>\r\n                        <div style={{ fontWeight: '500', fontSize: '0.75rem', color: 'inherit' }}>\r\n                          {new Date(selectedDevice.config_acked_at).toLocaleString()}\r\n                          {(() => {\r\n                            const ackTime = new Date(selectedDevice.config_acked_at);\r\n                            const now = new Date();\r\n                            const diffMs = now.getTime() - ackTime.getTime();\r\n                            const diffMins = Math.floor(diffMs / 60000);\r\n                            const diffHours = Math.floor(diffMins / 60);\r\n                            const diffDays = Math.floor(diffHours / 24);\r\n                            if (diffMins < 1) return '  just now';\r\n                            if (diffMins < 60) return `  ${diffMins}m ago`;\r\n                            if (diffHours < 24) return `  ${diffHours}h ago`;\r\n                            return `  ${diffDays}d ago`;\r\n                          })()}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_downloaded_at && selectedDevice.config_acked_at && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)', gridColumn: '1 / -1' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Apply Duration</div>\r\n                        <div style={{ fontWeight: '500', color: 'inherit' }}>\r\n                          {Math.round((new Date(selectedDevice.config_acked_at).getTime() - new Date(selectedDevice.config_downloaded_at).getTime()) / 1000)} seconds\r\n                          <span style={{ color: isDark ? '#a0a0a0' : 'rgba(0, 0, 0, 0.5)', marginLeft: '8px', fontSize: '0.75rem' }} className=\"config-label\">\r\n                            (download  acknowledge)\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div>\r\n                <strong>Provisioned At:</strong>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  {selectedDevice.provisioned_at\r\n                    ? new Date(selectedDevice.provisioned_at).toLocaleDateString()\r\n                    : 'N/A'}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <strong>Created By:</strong>\r\n                <p style={{ margin: '5px 0' }}>{selectedDevice.created_by_username || '-'}</p>\r\n              </div>\r\n              <div style={{ gridColumn: '1 / -1' }}>\r\n                <label style={{ display: 'flex', alignItems: 'center', gap: '10px', cursor: 'pointer' }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedDevice.logs_enabled || false}\r\n                    onChange={(e) => handleToggleLogs(selectedDevice, e.target.checked)}\r\n                    style={{ background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                  />\r\n                  <strong>Enable Device Logs</strong>\r\n                  <span style={{ fontSize: '0.875rem', color: isDark ? '#b0b0b0' : '#9ca3af' }}>\r\n                    (Device will send logs when enabled)\r\n                  </span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-2\" style={{ gap: 'var(--space-6, 24px)', marginTop: '32px' }}>\r\n          <div className=\"card\">\r\n            <h2>System Health</h2>\r\n            {dashboardError && <p className=\"error\">{dashboardError}</p>}\r\n            {!dashboardError && !health && <p>Loading system health...</p>}\r\n            {health && (\r\n              <div>\r\n                <p><strong>Overall:</strong> {health.overall_health}</p>\r\n                <p><strong>Devices:</strong> {health.active_devices}/{health.total_devices} active</p>\r\n                <p><strong>Telemetry Points:</strong> {health.total_telemetry_points.toLocaleString()}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"card\">\r\n            <h2>Telemetry Snapshot</h2>\r\n            {dashboardError && <p className=\"error\">{dashboardError}</p>}\r\n            {!dashboardError && !telemetrySummary && <p>Loading telemetry...</p>}\r\n            {telemetrySummary && (\r\n              <div>\r\n                <p><strong>Total Points:</strong> {deviceTelemetry.length.toLocaleString()}</p>\r\n                <p><strong>Data Types:</strong> {new Set(deviceTelemetry.map((entry) => entry.data_type)).size}</p>\r\n                <p><strong>Latest:</strong> {latestTelemetry ? new Date(latestTelemetry).toLocaleString() : 'N/A'}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  Site Configuration  */}\r\n        <div className=\"card\" style={{ marginTop: '48px' }}>\r\n          <div className=\"card-header\">\r\n            <h2>Site Configuration</h2>\r\n            {!siteLoading && (\r\n              <button className=\"btn\" onClick={() => {\r\n                if (siteDetails) {\r\n                  setSiteForm({\r\n                    site_id: siteDetails.site_id,\r\n                    display_name: siteDetails.display_name,\r\n                    latitude: String(siteDetails.latitude),\r\n                    longitude: String(siteDetails.longitude),\r\n                    capacity_kw: String(siteDetails.capacity_kw),\r\n                    tilt_deg: String(siteDetails.tilt_deg),\r\n                    azimuth_deg: String(siteDetails.azimuth_deg),\r\n                    timezone: siteDetails.timezone,\r\n                    is_active: siteDetails.is_active,\r\n                  });\r\n                } else {\r\n                  setSiteForm({ site_id: '', display_name: '', latitude: '', longitude: '', capacity_kw: '', tilt_deg: '18', azimuth_deg: '180', timezone: 'Asia/Kolkata', is_active: true });\r\n                }\r\n                setSiteError(null);\r\n                setEditingSite(true);\r\n              }}>\r\n                {siteDetails ? 'Edit Site' : 'Add Site'}\r\n              </button>\r\n            )}\r\n          </div>\r\n          <div style={{ padding: '20px' }}>\r\n            {siteLoading ? (\r\n              <p style={{ color: 'var(--text-muted)' }}>Loading site details</p>\r\n            ) : !siteDetails ? (\r\n              <p style={{ color: 'var(--text-muted)', fontSize: '0.9rem' }}>No site configured for this device yet.</p>\r\n            ) : (\r\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '15px' }}>\r\n                <div><strong>Site ID:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.88rem', color: '#00a63e' }}>{siteDetails.site_id}</p></div>\r\n                <div><strong>Display Name:</strong><p style={{ margin: '4px 0' }}>{siteDetails.display_name || ''}</p></div>\r\n                <div><strong>Status:</strong><p style={{ margin: '4px 0' }}><span className={siteDetails.is_active ? 'status-badge status-badge-success' : 'status-badge status-badge-danger'}>{siteDetails.is_active ? 'Active' : 'Inactive'}</span></p></div>\r\n                <div><strong>Latitude:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.88rem' }}>{siteDetails.latitude}</p></div>\r\n                <div><strong>Longitude:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.88rem' }}>{siteDetails.longitude}</p></div>\r\n                <div><strong>Timezone:</strong><p style={{ margin: '4px 0' }}>{siteDetails.timezone}</p></div>\r\n                <div><strong>Capacity:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace' }}>{siteDetails.capacity_kw} kW</p></div>\r\n                <div><strong>Tilt:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace' }}>{siteDetails.tilt_deg}</p></div>\r\n                <div><strong>Azimuth:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace' }}>{siteDetails.azimuth_deg}</p></div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  Live Site Intelligence (DynamoDB)  */}\r\n        {siteDetails && (\r\n          <div style={{ marginTop: '48px' }}>\r\n            <SiteDataPanel siteId={siteDetails.site_id} autoRefresh />\r\n          </div>\r\n        )}\r\n\r\n        {/*  Device Logs  */}\r\n        <div className=\"card\" style={{ marginTop: '48px', marginBottom: '20px' }}>\r\n          <div className=\"card-header\">\r\n            <h2>Device Logs</h2>\r\n            <button onClick={() => fetchDeviceLogs(selectedDevice.id)} className=\"btn\" disabled={logsLoading}>\r\n              {logsLoading ? 'Loading...' : ' Refresh'}\r\n            </button>\r\n          </div>\r\n          <div style={{ padding: '20px' }}>\r\n            {!selectedDevice.logs_enabled && (\r\n              <p style={{ color: 'var(--text-muted, #9ca3af)', fontStyle: 'italic' }}>\r\n                Logging is disabled for this device. Enable it in Device Details to receive logs.\r\n              </p>\r\n            )}\r\n            {deviceLogs.length === 0 && selectedDevice.logs_enabled && !logsLoading && (\r\n              <p style={{ color: 'var(--text-muted, #9ca3af)' }}>\r\n                No logs available yet. Logs will appear when device sends them.\r\n              </p>\r\n            )}\r\n            {logsLoading && (\r\n              <p style={{ color: 'var(--text-muted, #9ca3af)' }}>\r\n                Loading logs...\r\n              </p>\r\n            )}\r\n            {deviceLogs.length > 0 && (\r\n              <div style={{ \r\n                maxHeight: '400px', \r\n                overflowY: 'auto', \r\n                fontFamily: 'JetBrains Mono, monospace', \r\n                fontSize: '0.85rem',\r\n                backgroundColor: '#1e1e1e',\r\n                padding: '10px',\r\n                borderRadius: '4px'\r\n              }}>\r\n                {deviceLogs.map((log) => (\r\n                  <div key={log.id} style={{ \r\n                    marginBottom: '8px', \r\n                    paddingBottom: '8px', \r\n                    borderBottom: '1px solid #333',\r\n                    color: log.level === 'ERROR' ? '#ff6b6b' : \r\n                           log.level === 'WARNING' ? '#ffa500' : \r\n                           log.level === 'INFO' ? '#4dabf7' : '#ced4da'\r\n                  }}>\r\n                    <span style={{ color: '#888' }}>[{new Date(log.timestamp).toLocaleString()}]</span>\r\n                    <span style={{ fontWeight: 'bold', marginLeft: '8px' }}>[{log.level}]</span>\r\n                    <span style={{ marginLeft: '8px' }}>{log.message}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  Site edit modal  */}\r\n        {editingSite && (\r\n          <div className=\"modal\">\r\n            <div className=\"modal-content\">\r\n              <h3>{siteDetails ? `Edit Site: ${siteDetails.site_id}` : 'Add Site Configuration'}</h3>\r\n              <form onSubmit={async (e) => {\r\n                e.preventDefault();\r\n                setSiteSaving(true);\r\n                setSiteError(null);\r\n                try {\r\n                  const payload = {\r\n                    site_id: siteForm.site_id.trim(),\r\n                    display_name: siteForm.display_name.trim(),\r\n                    latitude: parseFloat(siteForm.latitude),\r\n                    longitude: parseFloat(siteForm.longitude),\r\n                    capacity_kw: parseFloat(siteForm.capacity_kw),\r\n                    tilt_deg: parseFloat(siteForm.tilt_deg),\r\n                    azimuth_deg: parseFloat(siteForm.azimuth_deg),\r\n                    timezone: siteForm.timezone.trim(),\r\n                    is_active: siteForm.is_active,\r\n                  };\r\n\r\n                  let updated;\r\n                  if (siteDetails) {\r\n                    updated = await apiService.updateDeviceSite(selectedDevice.id, payload);\r\n                  } else {\r\n                    updated = await apiService.createDeviceSite(selectedDevice.id, payload);\r\n                  }\r\n\r\n                  if (!updated || !updated.site_id) {\r\n                    throw new Error('Invalid response from server  site data missing');\r\n                  }\r\n\r\n                  setSiteDetails(updated);\r\n                  setEditingSite(false);\r\n                  setSiteSaving(false);\r\n\r\n                  // Re-fetch after creation to get server-assigned fields\r\n                  if (!siteDetails) {\r\n                    setTimeout(() => {\r\n                      apiService.getDeviceSite(selectedDevice.id)\r\n                        .then(data => { if (data) setSiteDetails(data); })\r\n                        .catch(err => console.error('Failed to re-fetch site:', err));\r\n                    }, 500);\r\n                  }\r\n                } catch (err: any) {\r\n                  setSiteError(err.message || 'Failed to save site');\r\n                  setSiteSaving(false);\r\n                }\r\n              }}>\r\n                <div className=\"modal-body\">\r\n                  {siteError && (\r\n                    <p style={{ color: isDark ? '#fca5a5' : '#ef4444', fontSize: '0.875rem', marginBottom: '1rem' }}>{siteError}</p>\r\n                  )}\r\n\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Identification</h4>\r\n                    <div className=\"form-grid form-grid-2\">\r\n                      <div className=\"form-group\">\r\n                        <label>Site ID *</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          required\r\n                          value={siteForm.site_id}\r\n                          disabled={!!siteDetails}\r\n                          onChange={e => setSiteForm({ ...siteForm, site_id: e.target.value })}\r\n                          placeholder=\"e.g. site_mumbai_01\"\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                        {!!siteDetails && <small className=\"form-hint\">Site ID cannot be changed after creation.</small>}\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Display Name</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={siteForm.display_name}\r\n                          onChange={e => setSiteForm({ ...siteForm, display_name: e.target.value })}\r\n                          placeholder=\"e.g. Mumbai Rooftop\"\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Location</h4>\r\n                    <div className=\"form-grid form-grid-3\">\r\n                      <div className=\"form-group\">\r\n                        <label>Latitude *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          required\r\n                          step=\"any\"\r\n                          value={siteForm.latitude}\r\n                          onChange={e => setSiteForm({ ...siteForm, latitude: e.target.value })}\r\n                          placeholder=\"19.0760\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Longitude *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          required\r\n                          step=\"any\"\r\n                          value={siteForm.longitude}\r\n                          onChange={e => setSiteForm({ ...siteForm, longitude: e.target.value })}\r\n                          placeholder=\"72.8777\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Timezone</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={siteForm.timezone}\r\n                          onChange={e => setSiteForm({ ...siteForm, timezone: e.target.value })}\r\n                          placeholder=\"Asia/Kolkata\"\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Panel Configuration</h4>\r\n                    <div className=\"form-grid form-grid-3\">\r\n                      <div className=\"form-group\">\r\n                        <label>Capacity (kW) *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          required\r\n                          step=\"any\"\r\n                          value={siteForm.capacity_kw}\r\n                          onChange={e => setSiteForm({ ...siteForm, capacity_kw: e.target.value })}\r\n                          placeholder=\"5.0\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Tilt ()</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          step=\"any\"\r\n                          value={siteForm.tilt_deg}\r\n                          onChange={e => setSiteForm({ ...siteForm, tilt_deg: e.target.value })}\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Azimuth ()</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          step=\"any\"\r\n                          value={siteForm.azimuth_deg}\r\n                          onChange={e => setSiteForm({ ...siteForm, azimuth_deg: e.target.value })}\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label style={{ display: 'flex', alignItems: 'center', gap: '8px', cursor: 'pointer' }}>\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          id=\"dev-site-active\"\r\n                          checked={siteForm.is_active}\r\n                          onChange={e => setSiteForm({ ...siteForm, is_active: e.target.checked })}\r\n                          style={{ width: '16px', height: '16px', background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                        Active\r\n                      </label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"form-actions\" style={{ padding: '0 24px 24px 24px' }}>\r\n                  <button type=\"submit\" className=\"btn\" disabled={siteSaving}>\r\n                    {siteSaving ? 'Saving' : siteDetails ? 'Save Changes' : 'Add Site'}\r\n                  </button>\r\n                  <button type=\"button\" className=\"btn btn-secondary\" onClick={() => setEditingSite(false)} disabled={siteSaving}>\r\n                    Cancel\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {editingDevice && (\r\n          <div className=\"modal\">\r\n            <div className=\"modal-content\">\r\n              <h3>{editingDevice ? `Edit Device: ${editingDevice.device_serial}` : 'Register New Device'}</h3>\r\n              <form onSubmit={(e) => { e.preventDefault(); editingDevice ? handleSave() : handleCreate(); }}>\r\n                <div className=\"modal-body\">\r\n                  \r\n                  {/* Device Identity */}\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Device Identity</h4>\r\n                    <div className=\"form-grid\">\r\n                      <div className=\"form-group\">\r\n                        <label>Device Serial Number</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={editingDevice ? editForm.device_serial : createForm.device_serial}\r\n                          onChange={(e) => editingDevice ? setEditForm({...editForm, device_serial: e.target.value}) : setCreateForm({...createForm, device_serial: e.target.value})}\r\n                          required\r\n                          autoComplete=\"off\"\r\n                          placeholder=\"SN-12345678\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Ownership */}\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Ownership & Assignment</h4>\r\n                    <div className=\"form-grid\">\r\n                      <div className=\"form-group\">\r\n                        <label>Assigned User</label>\r\n                        <div style={{ position: 'relative' }} onClick={(e) => e.stopPropagation()}>\r\n                          <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search by name, username, or email...\"\r\n                            value={userSearchTerm}\r\n                            onChange={(e) => {\r\n                              setUserSearchTerm(e.target.value);\r\n                              setShowUserDropdown(true);\r\n                            }}\r\n                            onFocus={() => setShowUserDropdown(true)}\r\n                            autoComplete=\"off\"\r\n                            className=\"full-width\"\r\n                            style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                          />\r\n                          {showUserDropdown && (\r\n                            <div style={{\r\n                              position: 'absolute',\r\n                              top: '100%',\r\n                              left: '0',\r\n                              right: '0',\r\n                              background: 'var(--bg-secondary, #1e293b)',\r\n                              border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                              borderRadius: '6px',\r\n                              marginTop: '4px',\r\n                              maxHeight: '200px',\r\n                              overflowY: 'auto',\r\n                              zIndex: 10,\r\n                              boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)'\r\n                            }}>\r\n                              {filteredUsers.length > 0 ? (\r\n                                filteredUsers.map((user) => (\r\n                                  <div\r\n                                    key={user.id}\r\n                                    onClick={() => {\r\n                                      if (editingDevice) {\r\n                                        setEditForm({...editForm, user: user.username});\r\n                                      } else {\r\n                                        setCreateForm({...createForm, user: user.username});\r\n                                      }\r\n                                      setUserSearchTerm(`${user.first_name} ${user.last_name} (${user.username})`);\r\n                                      setShowUserDropdown(false);\r\n                                    }}\r\n                                    style={{\r\n                                      padding: '12px 16px',\r\n                                      cursor: 'pointer',\r\n                                      borderBottom: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n                                      background: (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent',\r\n                                      color: 'var(--text-primary, #f8fafc)',\r\n                                      transition: 'all 0.15s ease',\r\n                                      fontSize: '0.875rem'\r\n                                    }}\r\n                                    onMouseEnter={(e) => e.currentTarget.style.background = 'rgba(255, 255, 255, 0.06)'}\r\n                                    onMouseLeave={(e) => e.currentTarget.style.background = (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent'}\r\n                                  >\r\n                                    {user.first_name} {user.last_name} ({user.username}) <br/>\r\n                                    <span style={{ fontSize: '0.75rem', color: 'var(--text-secondary, #94a3b8)' }}>{user.email}</span>\r\n                                  </div>\r\n                                ))\r\n                              ) : (\r\n                                <div style={{ padding: '12px 16px', color: 'var(--text-muted, #64748b)', fontSize: '0.875rem' }}>\r\n                                  {userSearchTerm.trim() === '' ? 'Start typing to search users...' : 'No users found'}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Configuration */}\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Configuration</h4>\r\n                    <div className=\"form-grid form-grid-2\">\r\n                      <div className=\"form-group\">\r\n                        <label>Preset Template</label>\r\n                        <select\r\n                          value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                          onChange={(e) => editingDevice ? setEditForm({ ...editForm, config_version: e.target.value }) : setCreateForm({ ...createForm, config_version: e.target.value })}\r\n                          className=\"full-width\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        >\r\n                          <option value=\"\">-- Manual Configuration --</option>\r\n                          {presetsLoading && <option value=\"\" disabled>Loading presets...</option>}\r\n                          {!presetsLoading && presets.map((preset) => (\r\n                            <option key={preset.id} value={getPresetConfigId(preset)}>\r\n                              {preset.name} ({getPresetConfigId(preset) || 'no ID'})\r\n                            </option>\r\n                          ))}\r\n                        </select>\r\n                        <small className=\"form-hint\">Selecting a preset sets the Config Version ID below.</small>\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Config Version ID</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                          onChange={(e) => editingDevice ? setEditForm({...editForm, config_version: e.target.value}) : setCreateForm({...createForm, config_version: e.target.value})}\r\n                          autoComplete=\"off\"\r\n                          placeholder=\"Manual Config ID\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                </div>\r\n                {editingDevice && (\r\n                  <div style={{ padding: '0 24px' }}>\r\n                     <AuditTrail\r\n                       createdBy={editingDevice.created_by_username}\r\n                       createdAt={editingDevice.created_at}\r\n                       updatedBy={editingDevice.updated_by_username}\r\n                       updatedAt={editingDevice.updated_at}\r\n                     />\r\n                  </div>\r\n                )}\r\n                <div className=\"form-actions\" style={{ padding: '0 24px 24px 24px' }}>\r\n                  <button type=\"submit\" className=\"btn\">{editingDevice ? 'Save Changes' : 'Create Device'}</button>\r\n                  <button type=\"button\" onClick={handleCancel} className=\"btn btn-secondary\">Cancel</button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h1>Device Management</h1>\r\n\r\n      <div className=\"card\">\r\n        <div className=\"card-header\">\r\n          <h2>Devices ({filteredDevices.length})</h2>\r\n          <div className=\"card-actions\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search devices...\"\r\n              value={searchTerm}\r\n              onChange={handleSearch}\r\n              className=\"search-input\"\r\n              style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n            />\r\n            {selectedDevices.size > 0 && (\r\n              <button \r\n                onClick={handleBulkDelete}\r\n                disabled={bulkDeleteLoading}\r\n                style={{ \r\n                  background: 'var(--danger-color, #ef4444)',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '8px 16px',\r\n                  borderRadius: '6px',\r\n                  cursor: bulkDeleteLoading ? 'not-allowed' : 'pointer',\r\n                  fontSize: '0.875rem',\r\n                  fontWeight: '500',\r\n                  opacity: bulkDeleteLoading ? '0.6' : '1'\r\n                }}\r\n              >\r\n                {bulkDeleteLoading ? `Deleting ${selectedDevices.size}...` : `Delete Selected (${selectedDevices.size})`}\r\n              </button>\r\n            )}\r\n            <button onClick={() => {\r\n              setCreatingDevice(true);\r\n              setUserSearchTerm('');\r\n              setShowUserDropdown(false);\r\n            }} className=\"btn\">\r\n              Register New Device\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <table className=\"table\">\r\n          <thead>\r\n            <tr>\r\n              <th style={{ textAlign: 'center', width: '40px' }}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={selectedDevices.size === filteredDevices.length && filteredDevices.length > 0}\r\n                  onChange={handleSelectAll}\r\n                  title=\"Select all displayed devices\"\r\n                  style={{ background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                />\r\n              </th>\r\n              <th style={{ textAlign: 'center' }}>Device Serial</th>\r\n              <th style={{ textAlign: 'center' }}>Status</th>\r\n              <th style={{ textAlign: 'center' }}>MAC / HW ID</th>\r\n              <th style={{ textAlign: 'center' }}>Model</th>\r\n              <th style={{ textAlign: 'center' }}>Assigned To</th>\r\n              <th style={{ textAlign: 'center' }}>Config Version</th>\r\n              <th style={{ textAlign: 'center' }}>Provisioned At</th>\r\n              <th style={{ textAlign: 'center' }}>Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {filteredDevices.map((device) => (\r\n              <tr\r\n                key={device.id}\r\n                onClick={() => handleViewDevice(device)}\r\n                style={{\r\n                  background: selectedDevices.has(device.id) ? 'rgba(99, 102, 241, 0.1)' : 'transparent',\r\n                  cursor: 'pointer'\r\n                }}\r\n                className=\"clickable-row\"\r\n              >\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedDevices.has(device.id)}\r\n                    onChange={() => handleSelectDevice(device.id)}\r\n                    style={{ background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                  />\r\n                </td>\r\n                <td style={{ textAlign: 'center', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.85rem' }}>{device.device_serial}</td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <span style={{\r\n                    display: 'inline-block',\r\n                    padding: '4px 8px',\r\n                    borderRadius: '12px',\r\n                    fontSize: '0.75rem',\r\n                    fontWeight: '500',\r\n                    backgroundColor: device.is_online ? '#dcfce7' : '#fee2e2',\r\n                    color: device.is_online ? '#166534' : '#991b1b'\r\n                  }}>\r\n                    {device.is_online ? ' Online' : ' Offline'}\r\n                  </span>\r\n                </td>\r\n                <td style={{ textAlign: 'center', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.82rem', color: device.hw_id ? 'inherit' : 'var(--text-muted, #9ca3af)' }}>{device.hw_id || ''}</td>\r\n                <td style={{ textAlign: 'center', fontSize: '0.875rem' }}>{device.model || <span style={{ color: 'var(--text-muted, #9ca3af)' }}></span>}</td>\r\n                <td style={{ textAlign: 'center' }}>{device.user || '-'}</td>\r\n                <td style={{ textAlign: 'center' }}>{device.config_version || '-'}</td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  {(() => {\r\n                    if (!device.provisioned_at) return 'N/A';\r\n                    const date = new Date(device.provisioned_at);\r\n                    return isNaN(date.getTime()) ? 'Invalid Date' : date.toLocaleDateString();\r\n                  })()}\r\n                </td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <button\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleEdit(device);\r\n                    }}\r\n                    style={{ background: 'none', border: 'none', cursor: 'pointer', color: 'var(--text-secondary, #94a3b8)', margin: '0 6px' }}\r\n                    title=\"Edit\"\r\n                  >\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                      <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\r\n                      <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\r\n                    </svg>\r\n                  </button>\r\n                  <button\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleDelete(device);\r\n                    }}\r\n                    style={{ background: 'none', border: 'none', cursor: 'pointer', color: 'var(--danger-color, #ef4444)', margin: '0 6px' }}\r\n                    title=\"Delete\"\r\n                  >\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                      <polyline points=\"3,6 5,6 21,6\"></polyline>\r\n                      <path d=\"M19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2\"></path>\r\n                      <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\"></line>\r\n                      <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\"></line>\r\n                    </svg>\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n        \r\n        {/* Pagination Controls */}\r\n        {totalCount > 0 && (\r\n          <div style={{\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            padding: '16px',\r\n            borderTop: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n            gap: '16px'\r\n          }}>\r\n            <div style={{ fontSize: '0.875rem', color: 'var(--text-secondary, #94a3b8)' }}>\r\n              Showing {((currentPage - 1) * pageSize) + 1} - {Math.min(currentPage * pageSize, totalCount)} of {totalCount} devices\r\n            </div>\r\n            \r\n            <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>\r\n              <button\r\n                onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\r\n                disabled={currentPage === 1}\r\n                style={{\r\n                  padding: '8px 12px',\r\n                  border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                  borderRadius: '6px',\r\n                  background: currentPage === 1 ? 'rgba(148, 163, 184, 0.1)' : 'transparent',\r\n                  color: 'var(--text-primary, #f8fafc)',\r\n                  cursor: currentPage === 1 ? 'not-allowed' : 'pointer',\r\n                  opacity: currentPage === 1 ? '0.5' : '1'\r\n                }}\r\n              >\r\n                 Previous\r\n              </button>\r\n              \r\n              <div style={{ display: 'flex', gap: '4px', alignItems: 'center' }}>\r\n                {(() => {\r\n                  const pages = [];\r\n                  \r\n                  for (let i = 1; i <= totalPages; i++) {\r\n                    // Always show first page, last page, current page, and adjacent pages\r\n                    const showPage = i === 1 || i === totalPages || Math.abs(i - currentPage) <= 1;\r\n                    \r\n                    if (showPage) {\r\n                      pages.push(\r\n                        <button\r\n                          key={i}\r\n                          onClick={() => setCurrentPage(i)}\r\n                          style={{\r\n                            padding: '6px 10px',\r\n                            border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                            borderRadius: '4px',\r\n                            background: i === currentPage ? 'rgba(99, 102, 241, 0.2)' : 'transparent',\r\n                            color: 'var(--text-primary, #f8fafc)',\r\n                            cursor: 'pointer',\r\n                            fontWeight: i === currentPage ? 'bold' : 'normal',\r\n                            minWidth: '32px'\r\n                          }}\r\n                        >\r\n                          {i}\r\n                        </button>\r\n                      );\r\n                    } else if (pages[pages.length - 1]?.key !== 'ellipsis-' + Math.floor(i / 10)) {\r\n                      // Add ellipsis if we skipped pages and haven't added one recently\r\n                      pages.push(\r\n                        <span key={`ellipsis-${Math.floor(i / 10)}`} style={{ padding: '0 4px', color: 'var(--text-secondary, #94a3b8)' }}>\r\n                          ...\r\n                        </span>\r\n                      );\r\n                    }\r\n                  }\r\n                  \r\n                  return pages;\r\n                })()}\r\n              </div>\r\n              \r\n              <button\r\n                onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\r\n                disabled={currentPage === totalPages}\r\n                style={{\r\n                  padding: '8px 12px',\r\n                  border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                  borderRadius: '6px',\r\n                  background: currentPage === totalPages ? 'rgba(148, 163, 184, 0.1)' : 'transparent',\r\n                  color: 'var(--text-primary, #f8fafc)',\r\n                  cursor: currentPage === totalPages ? 'not-allowed' : 'pointer',\r\n                  opacity: currentPage === totalPages ? '0.5' : '1'\r\n                }}\r\n              >\r\n                Next \r\n              </button>\r\n            </div>\r\n            \r\n            <select\r\n              value={pageSize}\r\n              onChange={(e) => {\r\n                setPageSize(parseInt(e.target.value));\r\n                setCurrentPage(1);\r\n              }}\r\n              style={{\r\n                padding: '8px',\r\n                border: isDark ? '1px solid #404040' : '1px solid rgba(148, 163, 184, 0.2)',\r\n                borderRadius: '6px',\r\n                background: isDark ? '#1a1a1a' : '#0f172a',\r\n                color: isDark ? '#e0e0e0' : '#f8fafc',\r\n                cursor: 'pointer',\r\n                fontSize: '0.875rem'\r\n              }}\r\n            >\r\n              <option value={10}>10 per page</option>\r\n              <option value={25}>25 per page</option>\r\n              <option value={50}>50 per page</option>\r\n              <option value={100}>100 per page</option>\r\n            </select>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {(editingDevice || creatingDevice) && (\r\n        <div className=\"modal\">\r\n          <div className=\"modal-content\">\r\n            <h3>{editingDevice ? `Edit Device: ${editingDevice.device_serial}` : 'Register New Device'}</h3>\r\n            <form onSubmit={(e) => { e.preventDefault(); editingDevice ? handleSave() : handleCreate(); }}>\r\n              <div className=\"modal-body\">\r\n                \r\n                {/* Device Identity */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Device Identity</h4>\r\n                  <div className=\"form-grid\">\r\n                    <div className=\"form-group\">\r\n                      <label>Device Serial Number</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingDevice ? editForm.device_serial : createForm.device_serial}\r\n                        onChange={(e) => editingDevice ? setEditForm({...editForm, device_serial: e.target.value}) : setCreateForm({...createForm, device_serial: e.target.value})}\r\n                        required\r\n                        autoComplete=\"off\"\r\n                        placeholder=\"SN-12345678\"\r\n                        style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Ownership */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Ownership & Assignment</h4>\r\n                  <div className=\"form-grid\">\r\n                    <div className=\"form-group\">\r\n                      <label>Assigned User</label>\r\n                      <div style={{ position: 'relative' }} onClick={(e) => e.stopPropagation()}>\r\n                        <input\r\n                          type=\"text\"\r\n                          placeholder=\"Search and select user...\"\r\n                          value={userSearchTerm}\r\n                          onChange={(e) => {\r\n                            setUserSearchTerm(e.target.value);\r\n                            setShowUserDropdown(true);\r\n                          }}\r\n                          onFocus={() => setShowUserDropdown(true)}\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                        {(editingDevice ? editForm.user : createForm.user) && (\r\n                          <div style={{ marginTop: '8px', fontSize: '0.875rem', color: isDark ? '#b0b0b0' : '#94a3b8' }}>\r\n                            <strong>Selected:</strong> {users.find(u => u.username === (editingDevice ? editForm.user : createForm.user))?.first_name} {users.find(u => u.username === (editingDevice ? editForm.user : createForm.user))?.last_name} ({editingDevice ? editForm.user : createForm.user})\r\n                            <button\r\n                              type=\"button\"\r\n                              onClick={() => {\r\n                                if (editingDevice) {\r\n                                  setEditForm({...editForm, user: ''});\r\n                                } else {\r\n                                  setCreateForm({...createForm, user: ''});\r\n                                }\r\n                                setUserSearchTerm('');\r\n                              }}\r\n                              className=\"btn-icon btn-icon-danger\"\r\n                              style={{ marginLeft: '10px' }}\r\n                              title=\"Remove Assignment\"\r\n                            >\r\n                              \r\n                            </button>\r\n                          </div>\r\n                        )}\r\n                        {showUserDropdown && (\r\n                          <div style={{\r\n                            position: 'absolute',\r\n                            top: '100%',\r\n                            left: 0,\r\n                            right: 0,\r\n                            background: 'var(--bg-secondary, #0f172a)',\r\n                            border: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n                            borderRadius: '8px',\r\n                            maxHeight: '200px',\r\n                            overflowY: 'auto',\r\n                            zIndex: 1000,\r\n                            boxShadow: 'var(--shadow-xl)',\r\n                            marginTop: '4px'\r\n                          }}>\r\n                            {filteredUsers.length > 0 ? (\r\n                              filteredUsers.map((user) => (\r\n                                <div\r\n                                  key={user.id}\r\n                                  onClick={() => {\r\n                                    if (editingDevice) {\r\n                                      setEditForm({...editForm, user: user.username});\r\n                                    } else {\r\n                                      setCreateForm({...createForm, user: user.username});\r\n                                    }\r\n                                    setUserSearchTerm(`${user.first_name} ${user.last_name} (${user.username})`);\r\n                                    setShowUserDropdown(false);\r\n                                  }}\r\n                                  style={{\r\n                                    padding: '12px 16px',\r\n                                    cursor: 'pointer',\r\n                                    borderBottom: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n                                    background: (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent',\r\n                                    color: 'var(--text-primary, #f8fafc)',\r\n                                    transition: 'all 0.15s ease',\r\n                                    fontSize: '0.875rem'\r\n                                  }}\r\n                                  onMouseEnter={(e) => e.currentTarget.style.background = 'rgba(255, 255, 255, 0.06)'}\r\n                                  onMouseLeave={(e) => e.currentTarget.style.background = (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent'}\r\n                                >\r\n                                  {user.first_name} {user.last_name} ({user.username}) <br/>\r\n                                  <span style={{ fontSize: '0.75rem', color: 'var(--text-secondary, #94a3b8)' }}>{user.email}</span>\r\n                                </div>\r\n                              ))\r\n                            ) : (\r\n                              <div style={{ padding: '12px 16px', color: 'var(--text-muted, #64748b)', fontSize: '0.875rem' }}>\r\n                                {userSearchTerm.trim() === '' ? 'Start typing to search users...' : 'No users found'}\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Configuration */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Configuration</h4>\r\n                  <div className=\"form-grid form-grid-2\">\r\n                    <div className=\"form-group\">\r\n                      <label>Preset Template</label>\r\n                      <select\r\n                        value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                        onChange={(e) => editingDevice ? setEditForm({ ...editForm, config_version: e.target.value }) : setCreateForm({ ...createForm, config_version: e.target.value })}\r\n                        className=\"full-width\"\r\n                        style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                      >\r\n                        <option value=\"\">-- Manual Configuration --</option>\r\n                        {presetsLoading && <option value=\"\" disabled>Loading presets...</option>}\r\n                        {!presetsLoading && presets.map((preset) => (\r\n                          <option key={preset.id} value={getPresetConfigId(preset)}>\r\n                            {preset.name} ({getPresetConfigId(preset) || 'no ID'})\r\n                          </option>\r\n                        ))}\r\n                      </select>\r\n                      <small className=\"form-hint\">Selecting a preset sets the Config Version ID below.</small>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label>Config Version ID</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                        onChange={(e) => editingDevice ? setEditForm({...editForm, config_version: e.target.value}) : setCreateForm({...createForm, config_version: e.target.value})}\r\n                        autoComplete=\"off\"\r\n                        placeholder=\"Manual Config ID\"\r\n                        style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n              </div>\r\n              {editingDevice && (\r\n                <div style={{ padding: '0 24px' }}>\r\n                   <AuditTrail\r\n                     createdBy={editingDevice.created_by_username}\r\n                     createdAt={editingDevice.created_at}\r\n                     updatedBy={editingDevice.updated_by_username}\r\n                     updatedAt={editingDevice.updated_at}\r\n                   />\r\n                </div>\r\n              )}\r\n              <div className=\"form-actions\" style={{ padding: '24px' }}>\r\n                <button type=\"submit\" className=\"btn\">{editingDevice ? 'Save Changes' : 'Register Device'}</button>\r\n                <button type=\"button\" onClick={handleCancel} className=\"btn btn-secondary\">Cancel</button>\r\n              </div>\r\n            </form>\r\n        </div>\r\n      </div>\r\n    )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Devices;","/**\r\n * Enhanced in-memory cache service for API responses\r\n * Features:\r\n * - TTL-based expiration\r\n * - Stale-while-revalidate pattern support\r\n * - Subscription system for real-time updates\r\n * - Pattern-based cache invalidation\r\n */\r\n\r\ninterface CacheEntry {\r\n  data: any;\r\n  timestamp: number;\r\n  expiresIn: number; // milliseconds\r\n  staleTime?: number; // Time after which data is considered stale but usable\r\n}\r\n\r\ninterface CacheSubscription {\r\n  callback: (data: any) => void;\r\n  pattern?: RegExp;\r\n}\r\n\r\nclass CacheService {\r\n  private cache: Map<string, CacheEntry> = new Map();\r\n  private subscribers: Map<string, Set<CacheSubscription>> = new Map();\r\n  private static readonly DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes default\r\n  private static readonly LONG_TTL = 30 * 60 * 1000; // 30 minutes for static data\r\n  private static readonly REALTIME_TTL = 10 * 1000; // 10 seconds for real-time data\r\n  private static readonly STALE_TIME = 30 * 1000; // 30 seconds before data is stale\r\n\r\n  /**\r\n   * Set a cache entry and notify subscribers\r\n   */\r\n  set(key: string, data: any, ttlMs: number = CacheService.DEFAULT_TTL, staleTime?: number): void {\r\n    this.cache.set(key, {\r\n      data,\r\n      timestamp: Date.now(),\r\n      expiresIn: ttlMs,\r\n      staleTime: staleTime ?? Math.min(ttlMs / 2, CacheService.STALE_TIME),\r\n    });\r\n    \r\n    // Notify subscribers\r\n    this.notifySubscribers(key, data);\r\n  }\r\n\r\n  /**\r\n   * Get a cache entry if valid (returns null if expired)\r\n   */\r\n  get(key: string): any | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    // Check if expired\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return entry.data;\r\n  }\r\n\r\n  /**\r\n   * Get cache entry even if stale (for stale-while-revalidate pattern)\r\n   * Returns { data, isStale } or null if no entry exists\r\n   */\r\n  getWithStaleStatus(key: string): { data: any; isStale: boolean; isExpired: boolean } | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    const now = Date.now();\r\n    const age = now - entry.timestamp;\r\n    const isExpired = age > entry.expiresIn;\r\n    const isStale = age > (entry.staleTime ?? entry.expiresIn / 2);\r\n\r\n    // Remove if fully expired\r\n    if (isExpired) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      data: entry.data,\r\n      isStale,\r\n      isExpired: false,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Check if key exists and is not expired\r\n   */\r\n  has(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return false;\r\n\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Check if cached data is stale but usable\r\n   */\r\n  isStale(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return true;\r\n\r\n    const now = Date.now();\r\n    const age = now - entry.timestamp;\r\n    return age > (entry.staleTime ?? entry.expiresIn / 2);\r\n  }\r\n\r\n  /**\r\n   * Clear a specific cache entry\r\n   */\r\n  clear(key: string): void {\r\n    this.cache.delete(key);\r\n  }\r\n\r\n  /**\r\n   * Clear cache entries matching a pattern\r\n   */\r\n  clearPattern(pattern: string | RegExp): void {\r\n    const regex = typeof pattern === 'string' ? new RegExp(pattern) : pattern;\r\n    const keysToDelete: string[] = [];\r\n    \r\n    this.cache.forEach((_, key) => {\r\n      if (regex.test(key)) {\r\n        keysToDelete.push(key);\r\n      }\r\n    });\r\n    \r\n    keysToDelete.forEach(key => this.cache.delete(key));\r\n  }\r\n\r\n  /**\r\n   * Clear all cache entries\r\n   */\r\n  clearAll(): void {\r\n    this.cache.clear();\r\n  }\r\n\r\n  /**\r\n   * Get cache size\r\n   */\r\n  size(): number {\r\n    return this.cache.size;\r\n  }\r\n\r\n  /**\r\n   * Subscribe to cache updates for a specific key\r\n   */\r\n  subscribe(key: string, callback: (data: any) => void): () => void {\r\n    if (!this.subscribers.has(key)) {\r\n      this.subscribers.set(key, new Set());\r\n    }\r\n    \r\n    const subscription: CacheSubscription = { callback };\r\n    this.subscribers.get(key)!.add(subscription);\r\n\r\n    // Return unsubscribe function\r\n    return () => {\r\n      const subs = this.subscribers.get(key);\r\n      if (subs) {\r\n        subs.delete(subscription);\r\n        if (subs.size === 0) {\r\n          this.subscribers.delete(key);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Subscribe to cache updates matching a pattern\r\n   */\r\n  subscribePattern(pattern: RegExp, callback: (data: any) => void): () => void {\r\n    const key = `__pattern__${pattern.source}`;\r\n    if (!this.subscribers.has(key)) {\r\n      this.subscribers.set(key, new Set());\r\n    }\r\n    \r\n    const subscription: CacheSubscription = { callback, pattern };\r\n    this.subscribers.get(key)!.add(subscription);\r\n\r\n    return () => {\r\n      const subs = this.subscribers.get(key);\r\n      if (subs) {\r\n        subs.delete(subscription);\r\n        if (subs.size === 0) {\r\n          this.subscribers.delete(key);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Notify all subscribers of a cache update\r\n   */\r\n  private notifySubscribers(key: string, data: any): void {\r\n    // Direct key subscribers\r\n    const directSubs = this.subscribers.get(key);\r\n    if (directSubs) {\r\n      directSubs.forEach(sub => {\r\n        try {\r\n          sub.callback(data);\r\n        } catch (error) {\r\n          console.error(`Cache subscriber error for key ${key}:`, error);\r\n        }\r\n      });\r\n    }\r\n\r\n    // Pattern subscribers\r\n    this.subscribers.forEach((subs, subKey) => {\r\n      if (subKey.startsWith('__pattern__')) {\r\n        subs.forEach(sub => {\r\n          if (sub.pattern && sub.pattern.test(key)) {\r\n            try {\r\n              sub.callback(data);\r\n            } catch (error) {\r\n              console.error(`Cache pattern subscriber error for key ${key}:`, error);\r\n            }\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get all keys in cache\r\n   */\r\n  keys(): string[] {\r\n    return Array.from(this.cache.keys());\r\n  }\r\n\r\n  /**\r\n   * Get cache stats for debugging\r\n   */\r\n  getStats(): { size: number; keys: string[]; subscribers: number } {\r\n    return {\r\n      size: this.cache.size,\r\n      keys: this.keys(),\r\n      subscribers: Array.from(this.subscribers.values()).reduce((sum, set) => sum + set.size, 0),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get TTL constants\r\n   */\r\n  static getTTL(type: 'short' | 'long' | 'realtime' = 'short'): number {\r\n    switch (type) {\r\n      case 'realtime':\r\n        return CacheService.REALTIME_TTL;\r\n      case 'long':\r\n        return CacheService.LONG_TTL;\r\n      default:\r\n        return CacheService.DEFAULT_TTL;\r\n    }\r\n  }\r\n}\r\n\r\nexport const cacheService = new CacheService();\r\nexport const DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes\r\nexport const LONG_TTL = 30 * 60 * 1000; // 30 minutes\r\nexport const REALTIME_TTL = 10 * 1000; // 10 seconds\r\n","import { cacheService, DEFAULT_TTL } from './cacheService';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'https://smart-solar-django-backend.vercel.app/api';\r\n\r\nclass ApiService {\r\n  private getAuthHeaders(): HeadersInit {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (tokens) {\r\n      try {\r\n        const parsedTokens = JSON.parse(tokens);\r\n        return {\r\n          'Authorization': `Bearer ${parsedTokens.access}`,\r\n          'Content-Type': 'application/json',\r\n        };\r\n      } catch (error) {\r\n        console.error('Error parsing auth tokens:', error);\r\n      }\r\n    }\r\n    return {\r\n      'Content-Type': 'application/json',\r\n    };\r\n  }\r\n\r\n  private async request(endpoint: string, options: RequestInit = {}): Promise<any> {\r\n    const url = `${API_BASE_URL}${endpoint}`;\r\n    let headers = this.getAuthHeaders();\r\n\r\n    let response = await fetch(url, {\r\n      ...options,\r\n      headers: {\r\n        ...headers,\r\n        ...options.headers,\r\n      },\r\n    });\r\n\r\n    if (response.status === 401) {\r\n      // Try to refresh token\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        // Retry with new token\r\n        headers = this.getAuthHeaders();\r\n        response = await fetch(url, {\r\n          ...options,\r\n          headers: {\r\n            ...headers,\r\n            ...options.headers,\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      // Token refresh failed or not attempted, logout\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`API request failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n    }\r\n\r\n    if (response.status === 204) return null;\r\n    return response.json();\r\n  }\r\n\r\n  private async refreshToken(): Promise<boolean> {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (!tokens) return false;\r\n\r\n    try {\r\n      const parsedTokens = JSON.parse(tokens);\r\n      const response = await fetch(`${API_BASE_URL}/auth/token/refresh/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ refresh: parsedTokens.refresh }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        const newTokens = {\r\n          access: data.access,\r\n          refresh: parsedTokens.refresh, // Keep the same refresh token\r\n        };\r\n        localStorage.setItem('authTokens', JSON.stringify(newTokens));\r\n        return true;\r\n      }\r\n    } catch (error) {\r\n      console.error('Token refresh failed:', error);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  async getConfiguration(): Promise<any> {\r\n    return this.request('/config/');\r\n  }\r\n\r\n  async getTelemetry(): Promise<any[]> {\r\n    return this.request('/telemetry/');\r\n  }\r\n\r\n  async provisionDevice(data: any): Promise<any> {\r\n    const response = await fetch(`${API_BASE_URL}/devices/provision`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n    if (!response.ok) {\r\n      throw new Error(`Provisioning failed: ${response.statusText}`);\r\n    }\r\n    return response.json();\r\n  }\r\n\r\n  async getAlerts(): Promise<any[]> {\r\n    const cacheKey = 'alerts';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/alerts/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getSystemHealth(): Promise<any> {\r\n    const cacheKey = 'system_health';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/health/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getKPIs(): Promise<any> {\r\n    const cacheKey = 'kpis';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/kpis/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getUsers(search?: string): Promise<any[]> {\r\n    const cacheKey = `users_${search || 'all'}`;\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    const data = await this.request(`/users/${params}`);\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async createUser(userData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(userData),\r\n    });\r\n    // Invalidate users cache\r\n    cacheService.clear('users_all');\r\n    cacheService.clearAll(); // Clear all cache for safety\r\n    return result;\r\n  }\r\n\r\n  async createEmployee(employeeData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ ...employeeData, is_staff: true }),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async getUserDevices(userId: number): Promise<any[]> {\r\n    return this.request(`/users/${userId}/devices/`);\r\n  }\r\n\r\n  async getUserSite(userId: number): Promise<any> {\r\n    return this.request(`/users/${userId}/site/`);\r\n  }\r\n\r\n  async createUserSite(userId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/users/${userId}/site/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async updateUserSite(userId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/users/${userId}/site/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async getDeviceSite(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/`);\r\n  }\r\n\r\n  async createDeviceSite(deviceId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async updateDeviceSite(deviceId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // DynamoDB site data\r\n  async getSiteTelemetry(siteId: string, params?: { start_date?: string; end_date?: string; days?: number }): Promise<any[]> {\r\n    const query = new URLSearchParams();\r\n    if (params?.start_date) query.append('start_date', params.start_date);\r\n    if (params?.end_date) query.append('end_date', params.end_date);\r\n    if (params?.days) query.append('days', params.days.toString());\r\n    const url = `/sites/${siteId}/telemetry/${query.toString() ? '?' + query.toString() : ''}`;\r\n    return this.request(url);\r\n  }\r\n\r\n  async getSiteForecast(siteId: string, params?: { date?: string; start_date?: string; end_date?: string }): Promise<any[]> {\r\n    const query = new URLSearchParams();\r\n    if (params?.date) query.append('date', params.date);\r\n    if (params?.start_date) query.append('start_date', params.start_date);\r\n    if (params?.end_date) query.append('end_date', params.end_date);\r\n    const url = `/sites/${siteId}/forecast/${query.toString() ? '?' + query.toString() : ''}`;\r\n    return this.request(url);\r\n  }\r\n\r\n  async getSiteWeather(siteId: string): Promise<any> {\r\n    return this.request(`/sites/${siteId}/weather/`);\r\n  }\r\n\r\n  async updateUser(userId: number, data: any): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async deleteUser(userId: number): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  // Profile Management (for current logged-in user)\r\n  async getProfile(): Promise<any> {\r\n    return this.request('/profile/');\r\n  }\r\n\r\n  async updateProfile(data: any): Promise<any> {\r\n    return this.request('/profile/update/', {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async changePassword(data: { current_password: string; new_password: string }): Promise<any> {\r\n    return this.request('/profile/change-password/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // Customer Management (separate from staff users/employees)\r\n  async getCustomers(search?: string): Promise<any[]> {\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    return this.request(`/customers/${params}`);\r\n  }\r\n\r\n  async createCustomer(customerData: any): Promise<any> {\r\n    return this.request('/customers/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(customerData),\r\n    });\r\n  }\r\n\r\n  async getCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/`);\r\n  }\r\n\r\n  async updateCustomer(customerId: number, data: any): Promise<any> {\r\n    return this.request(`/customers/${customerId}/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getPresets(): Promise<any[]> {\r\n    const cacheKey = 'presets';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/presets/');\r\n    // Use longer TTL for presets as they change less frequently\r\n    cacheService.set(cacheKey, data, 30 * 60 * 1000); // 30 minutes\r\n    return data;\r\n  }\r\n\r\n  async createPreset(data: any): Promise<any> {\r\n    const result = await this.request('/presets/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async updatePreset(id: number, data: any): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async deletePreset(id: number): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async getGlobalSlaves(): Promise<any[]> {\r\n    return this.request('/slaves/');\r\n  }\r\n\r\n  async createGlobalSlave(slaveData: any): Promise<any> {\r\n    return this.request('/slaves/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateGlobalSlave(slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteGlobalSlave(slaveId: number): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getDevices(search?: string, page: number = 1, pageSize: number = 25): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    if (search) params.append('search', search);\r\n    params.append('page', page.toString());\r\n    params.append('page_size', pageSize.toString());\r\n    \r\n    const queryString = params.toString();\r\n    return this.request(`/devices/?${queryString}`);\r\n  }\r\n\r\n  async createDevice(deviceData: any): Promise<any> {\r\n    return this.request('/devices/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(deviceData),\r\n    });\r\n  }\r\n\r\n  async updateDevice(deviceId: number, data: any): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async rebootDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/reboot/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  async hardResetDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/hard-reset/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  async getDeviceLogs(deviceId: number, limit: number = 100, offset: number = 0): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/logs/?limit=${limit}&offset=${offset}`);\r\n  }\r\n\r\n  async toggleDeviceLogs(deviceId: number, enabled: boolean): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/logs/toggle/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ enabled }),\r\n    });\r\n  }\r\n\r\n  async deleteDevicesBulk(deviceIds: number[]): Promise<any> {\r\n    return this.request(`/devices/delete-bulk/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ device_ids: deviceIds }),\r\n    });\r\n  }\r\n\r\n  async getSlaves(configId: string): Promise<any[]> {\r\n    return this.request(`/presets/${configId}/slaves/`);\r\n  }\r\n\r\n  async createSlave(configId: string, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/create/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateSlave(configId: string, slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteSlave(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async addSlavesToPreset(configId: string, slaveIds: number[]): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/add/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ slave_ids: slaveIds }),\r\n    });\r\n  }\r\n\r\n  async detachSlaveFromPreset(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/detach/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  // OTA (Over-The-Air) Update Endpoints\r\n  async getFirmwareVersions(activeOnly: boolean = true): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    params.append('active', activeOnly.toString());\r\n    return this.request(`/ota/firmware/?${params.toString()}`);\r\n  }\r\n\r\n  async uploadFirmwareVersion(formData: FormData): Promise<any> {\r\n    const url = `${API_BASE_URL}/ota/firmware/create/`;\r\n    const tokens = localStorage.getItem('authTokens');\r\n    \r\n    if (!tokens) {\r\n      throw new Error('Authentication required');\r\n    }\r\n    \r\n    const parsedTokens = JSON.parse(tokens);\r\n    let headers: HeadersInit = {\r\n      'Authorization': `Bearer ${parsedTokens.access}`,\r\n    };\r\n    // Don't set Content-Type - let browser set it with boundary for multipart/form-data\r\n    \r\n    let response = await fetch(url, {\r\n      method: 'POST',\r\n      headers,\r\n      body: formData,\r\n    });\r\n\r\n    // Handle 401 with token refresh\r\n    if (response.status === 401) {\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        const newTokens = JSON.parse(localStorage.getItem('authTokens') || '{}');\r\n        headers = {\r\n          'Authorization': `Bearer ${newTokens.access}`,\r\n        };\r\n        response = await fetch(url, {\r\n          method: 'POST',\r\n          headers,\r\n          body: formData,\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`Upload failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  async updateFirmwareVersion(firmwareId: number, data: any): Promise<any> {\r\n    return this.request(`/ota/firmware/${firmwareId}/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteFirmwareVersion(firmwareId: number): Promise<any> {\r\n    return this.request(`/ota/firmware/${firmwareId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getDeviceUpdateLogs(deviceId: string): Promise<any> {\r\n    return this.request(`/ota/devices/${deviceId}/logs`);\r\n  }\r\n\r\n  async getOTAConfig(): Promise<any> {\r\n    return this.request(`/ota/config/`);\r\n  }\r\n\r\n  async updateOTAConfig(config: any): Promise<any> {\r\n    return this.request(`/ota/config/update/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(config),\r\n    });\r\n  }\r\n\r\n  async getOTAHealth(): Promise<any> {\r\n    return this.request(`/ota/health/`);\r\n  }\r\n\r\n  async triggerRollback(deviceSerial: string, notes?: string): Promise<any> {\r\n    return this.request(`/ota/updates/rollback/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        device_serial: deviceSerial,\r\n        notes: notes || ''\r\n      }),\r\n    });\r\n  }\r\n\r\n  async deployFirmware(firmwareId: number, deviceSerials: string[], notes?: string): Promise<any> {\r\n    return this.request(`/ota/updates/multiple/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        firmware_id: firmwareId,\r\n        device_serials: deviceSerials,\r\n        notes: notes || ''\r\n      }),\r\n    });\r\n  }\r\n\r\n  async listTargetedUpdates(): Promise<any> {\r\n    return this.request(`/ota/updates/`);\r\n  }\r\n\r\n  async getTargetedUpdate(updateId: number): Promise<any> {\r\n    return this.request(`/ota/updates/${updateId}/`);\r\n  }\r\n}\r\n\r\nexport const apiService = new ApiService();"],"names":["AuditTrail","_ref","createdBy","createdAt","updatedBy","updatedAt","className","formatDate","dateString","Date","toLocaleString","_unused","_jsxs","children","_jsx","React","useDebouncedCallback","callback","delay","arguments","length","undefined","timeoutId","setTimeoutId","useState","debouncedCallback","useCallback","_len","args","Array","_key","clearTimeout","newTimeoutId","setTimeout","useEffect","ForecastTooltip","active","payload","label","style","background","backdropFilter","border","borderRadius","padding","boxShadow","minWidth","fontFamily","fontWeight","color","fontSize","marginBottom","borderBottom","paddingBottom","display","flexDirection","gap","map","entry","alignItems","justifyContent","width","height","stroke","fill","name","split","Number","value","toFixed","fmt","ts","range","date","toLocaleTimeString","hour","minute","toLocaleDateString","weekday","month","day","TOOLTIP_STYLE","IconSun","viewBox","strokeWidth","strokeLinecap","strokeLinejoin","cx","cy","r","x1","y1","x2","y2","IconBattery","x","y","rx","IconLoad","d","points","IconEnergy","IconCloud","KpiCard","_ref2","unit","sub","accent","icon","flex","textTransform","letterSpacing","concat","flexShrink","margin","lineHeight","marginLeft","ForecastTable","_ref3","data","maxHeight","overflowY","borderCollapse","position","top","zIndex","textAlign","row","i","_row$p10$toFixed","_row$p","_row$p50$toFixed","_row$p2","_row$p90$toFixed","_row$p3","time","p10","p50","p90","_ref4","_latest$pv1_power_w","_latest$pv2_power_w","_latest$battery_soc_p","_latest$load_power_w","_latest$pv_today_kwh","siteId","autoRefresh","telemetry","setTelemetry","forecast","setForecast","weather","setWeather","loading","setLoading","error","setError","lastUpdated","setLastUpdated","showBands","setShowBands","P10","P50","P90","dateRange","setDateRange","customStartDate","setCustomStartDate","customEndDate","setCustomEndDate","forecastView","setForecastView","zoomLeft","setZoomLeft","zoomRight","setZoomRight","refAreaLeft","setRefAreaLeft","refAreaRight","setRefAreaRight","fetchAll","async","telemetryParams","start_date","toISOString","end_date","days","forecastParams","end","start","setDate","getDate","tel","fcst","wth","Promise","all","apiService","getSiteTelemetry","getSiteForecast","getSiteWeather","console","log","isArray","err","Error","message","id","setInterval","clearInterval","latest","pvKw","pv1_power_w","pv2_power_w","batSoc","battery_soc_percent","loadKw","load_power_w","todayKwh","pv_today_kwh","historyData","filter","_","buckets","Map","forEach","timestamp","hourKey","getFullYear","getMonth","getHours","has","set","get","push","from","values","bucket","first","reduce","sum","_r$pv1_power_w","_r$pv2_power_w","_r$load_power_w","grid_power_w","_r$grid_power_w","_r$battery_soc_percen","dayKey","_r$pv1_power_w2","_r$pv2_power_w2","_r$load_power_w2","_r$grid_power_w2","_r$battery_soc_percen2","Math","max","_r$pv_today_kwh","aggregateByPeriod","_row$pv1_power_w","_row$pv2_power_w","_row$load_power_w","_row$grid_power_w","_row$battery_soc_perc","forecastData","cleanTs","forecast_for","replace","forecastFor","_unused2","fmtForecast","p50_kw","p10_kw","p90_kw","forecastEnergyP10","forecastEnergyP50","forecastEnergyP90","forecastGeneratedAt","firstForecast","generated_at","t1","getTime","t2","intervalHours","abs","flexWrap","marginTop","noData","onChange","e","target","cursor","_Fragment","type","onClick","temperature_c","humidity_pct","cloud_cover_pct","wind_speed_ms","ghi_wm2","round","p","ResponsiveContainer","AreaChart","right","left","bottom","offset","stopColor","stopOpacity","CartesianGrid","strokeDasharray","XAxis","dataKey","interval","ceil","angle","textAnchor","YAxis","tickFormatter","v","Tooltip","contentStyle","formatter","includes","Legend","iconType","iconSize","wrapperStyle","Area","dot","Line","overflow","tooltip","b","s","_objectSpread","transition","title","zoomOut","disabled","opacity","chartDiv","document","getElementById","canvas","html2canvas","scale","link","createElement","download","slice","href","toDataURL","click","onMouseOver","currentTarget","onMouseOut","userSelect","onMouseDown","activeLabel","onMouseMove","onMouseUp","zoom","vertical","tickLine","axisLine","minTickGap","tickMargin","tick","allowDataOverflow","domain","val","index","parts","content","animationDuration","pointerEvents","verticalAlign","activeDot","ReferenceLine","ReferenceArea","strokeOpacity","fillOpacity","Devices","_users$find3","_users$find4","isDark","useTheme","searchParams","useSearchParams","devices","setDevices","filteredDevices","setFilteredDevices","editingDevice","setEditingDevice","creatingDevice","setCreatingDevice","searchTerm","setSearchTerm","userSearchTerm","setUserSearchTerm","filteredUsers","setFilteredUsers","showUserDropdown","setShowUserDropdown","users","setUsers","selectedDevices","setSelectedDevices","Set","bulkDeleteLoading","setBulkDeleteLoading","currentPage","setCurrentPage","pageSize","setPageSize","totalCount","setTotalCount","totalPages","setTotalPages","presets","setPresets","presetsLoading","setPresetsLoading","health","setHealth","telemetrySummary","setTelemetrySummary","telemetryData","setTelemetryData","dashboardError","setDashboardError","selectedDevice","setSelectedDevice","deviceLogs","setDeviceLogs","logsLoading","setLogsLoading","editForm","setEditForm","device_serial","user","config_version","createForm","setCreateForm","siteDetails","setSiteDetails","siteLoading","setSiteLoading","editingSite","setEditingSite","siteForm","setSiteForm","site_id","display_name","latitude","longitude","capacity_kw","tilt_deg","azimuth_deg","timezone","is_active","siteSaving","setSiteSaving","siteError","setSiteError","devicePreset","setDevicePreset","fetchDevices","page","search","response","getDevices","results","count","total_pages","current_page","fetchDeviceLogs","getDeviceLogs","deviceId","logs","handleViewDevice","device","preset","find","config_id","getDeviceSite","then","catch","finally","customers","getUsers","is_staff","is_superuser","fetchUsers","getPresets","fetchPresets","healthData","getSystemHealth","getTelemetry","telemetryArray","currentLatest","item","itemDate","isNaN","deviceCount","size","totalPoints","latestTimestamp","fetchDashboardData","deviceIdParam","parseInt","foundDevice","handleClickOutside","addEventListener","removeEventListener","trim","searchLower","toLowerCase","filtered","fullName","first_name","last_name","username","email","debouncedSearch","query","handleEdit","_users$find","_users$find2","u","handleSave","updateDevice","handleCreate","createDevice","handleCancel","handleBackToList","getPresetConfigId","_preset$gateway_confi","_preset$gateway_confi2","gateway_configuration","general_settings","_devicePreset$gateway","_devicePreset$gateway2","deviceTelemetry","latestTelemetry","marginRight","window","confirm","rebootDevice","alert","handleReboot","backgroundColor","hardResetDevice","handleHardReset","deleteDevice","handleDeleteDevice","gridTemplateColumns","is_online","last_heartbeat","hw_id","model","gridColumn","pending_config_update","slaves_count","config_ack_ver","version","last_updated","config_acked_at","ackTime","diffMs","diffMins","floor","diffHours","diffDays","config_downloaded_at","provisioned_at","created_by_username","checked","logs_enabled","enabled","toggleDeviceLogs","handleToggleLogs","overall_health","active_devices","total_devices","total_telemetry_points","data_type","String","SiteDataPanel","fontStyle","level","onSubmit","preventDefault","parseFloat","updated","updateDeviceSite","createDeviceSite","required","placeholder","autoComplete","step","stopPropagation","onFocus","onMouseEnter","onMouseLeave","created_at","updated_by_username","updated_at","deviceList","Boolean","confirmMessage","join","deleteDevicesBulk","updatedDevices","handleSelectAll","allIds","newSelected","delete","add","handleSelectDevice","handleDelete","borderTop","min","pages","_pages","key","CacheService","constructor","cache","subscribers","ttlMs","DEFAULT_TTL","staleTime","this","now","expiresIn","STALE_TIME","notifySubscribers","getWithStaleStatus","_entry$staleTime","age","isExpired","isStale","_entry$staleTime2","clear","clearPattern","pattern","regex","RegExp","keysToDelete","test","clearAll","subscribe","subscription","subs","subscribePattern","source","directSubs","subKey","startsWith","keys","getStats","getTTL","REALTIME_TTL","LONG_TTL","cacheService","API_BASE_URL","process","getAuthHeaders","tokens","localStorage","getItem","parsedTokens","JSON","parse","access","request","endpoint","options","url","headers","fetch","status","refreshToken","removeItem","location","ok","errorText","text","statusText","json","method","body","stringify","refresh","newTokens","setItem","getConfiguration","provisionDevice","getAlerts","cacheKey","cached","getKPIs","params","encodeURIComponent","createUser","userData","result","createEmployee","employeeData","getUserDevices","userId","getUserSite","createUserSite","updateUserSite","URLSearchParams","append","toString","updateUser","deleteUser","getProfile","updateProfile","changePassword","getCustomers","createCustomer","customerData","getCustomer","customerId","updateCustomer","deleteCustomer","createPreset","updatePreset","deletePreset","getGlobalSlaves","createGlobalSlave","slaveData","updateGlobalSlave","slaveId","deleteGlobalSlave","queryString","deviceData","limit","deviceIds","device_ids","getSlaves","configId","createSlave","updateSlave","deleteSlave","addSlavesToPreset","slaveIds","slave_ids","detachSlaveFromPreset","getFirmwareVersions","activeOnly","uploadFirmwareVersion","formData","updateFirmwareVersion","firmwareId","deleteFirmwareVersion","getDeviceUpdateLogs","getOTAConfig","updateOTAConfig","config","getOTAHealth","triggerRollback","deviceSerial","notes","deployFirmware","deviceSerials","firmware_id","device_serials","listTargetedUpdates","getTargetedUpdate","updateId"],"sourceRoot":""}