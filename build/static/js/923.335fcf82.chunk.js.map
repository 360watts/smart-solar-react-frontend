{"version":3,"file":"static/js/923.335fcf82.chunk.js","mappings":"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","sources":["components/OTA.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { apiService } from '../services/api';\r\nimport { useTheme } from '../contexts/ThemeContext';\r\nimport '../App.css';\r\n\r\ninterface FirmwareVersion {\r\n  id: number;\r\n  name: string;\r\n  version: string;\r\n  deviceModel: string;\r\n  minBootloaderVersion: string;\r\n  file: File | null;\r\n  size: number;\r\n  checksum: string;\r\n  signatureValid: boolean;\r\n  releaseNotes: string;\r\n  status: 'draft' | 'stable';\r\n  uploadDate: string;\r\n}\r\n\r\ninterface DeviceStatus {\r\n  deviceId: string;\r\n  currentVersion: string;\r\n  targetVersion: string;\r\n  activeSlot: 'A' | 'B';\r\n  status: 'idle' | 'downloading' | 'flashing' | 'rebooting' | 'trial' | 'healthy' | 'failed' | 'rolledback';\r\n  bootCount: number;\r\n  lastError: string;\r\n  progress?: number;\r\n  lastCheckedAt?: string;\r\n}\r\n\r\ninterface DeploymentConfig {\r\n  firmwareVersion: string;\r\n  targetDevices: string[];\r\n  mode: 'immediate' | 'canary';\r\n  autoRollback: boolean;\r\n  healthTimeout: number;\r\n  failureThreshold: number;\r\n}\r\n\r\ninterface DeploymentConfirmModal {\r\n  show: boolean;\r\n  firmware: string;\r\n  deviceCount: number;\r\n  dataTransfer: string;\r\n}\r\n\r\nexport const OTA: React.FC = () => {\r\n  const { isDark } = useTheme();\r\n  \r\n  // Section 1: Firmware Repository State\r\n  const [firmwares, setFirmwares] = useState<FirmwareVersion[]>([]);\r\n  const [uploadForm, setUploadForm] = useState({\r\n    name: '',\r\n    version: '',\r\n    deviceModel: 'ESP32-S3',\r\n    minBootloader: '1.0.0',\r\n    releaseNotes: '',\r\n    file: null as File | null,\r\n  });\r\n\r\n  // Section 2: Deployment Panel State\r\n  const [deploymentConfig, setDeploymentConfig] = useState<DeploymentConfig>({\r\n    firmwareVersion: '',\r\n    targetDevices: [],\r\n    mode: 'immediate',\r\n    autoRollback: true,\r\n    healthTimeout: 300,\r\n    failureThreshold: 10,\r\n  });\r\n  const [confirmModal, setConfirmModal] = useState<DeploymentConfirmModal>({\r\n    show: false,\r\n    firmware: '',\r\n    deviceCount: 0,\r\n    dataTransfer: '',\r\n  });\r\n  const [isDeploying, setIsDeploying] = useState(false);\r\n\r\n  // Section 3: Live Deployment Status State\r\n  const [devices, setDevices] = useState<DeviceStatus[]>([]);\r\n  const [statusFilter, setStatusFilter] = useState<'all' | DeviceStatus['status']>('all');\r\n  const [loadingDevices, setLoadingDevices] = useState(true);\r\n  const [loadingFirmwares, setLoadingFirmwares] = useState(true);\r\n  const [activeDeployment, setActiveDeployment] = useState<any>(null);\r\n\r\n  // Section 4: Emergency Rollback State\r\n  const [rollbackForm, setRollbackForm] = useState({\r\n    selectedDevices: [] as string[],\r\n    reason: '',\r\n  });\r\n  const [showRollbackModal, setShowRollbackModal] = useState(false);\r\n  const [rollbackFilters, setRollbackFilters] = useState({\r\n    currentVersion: 'all',\r\n    status: 'all',\r\n    deviceModel: 'all',\r\n  });\r\n\r\n  // Generic destructive-action confirmation modal (replaces deleteFirmwareModal + deactivateFirmwareModal)\r\n  const [confirmActionModal, setConfirmActionModal] = useState<{\r\n    show: boolean;\r\n    title: string;\r\n    message: string;\r\n    warningText: string;\r\n    confirmLabel: string;\r\n    accentColor: string;\r\n    icon: string;\r\n    onConfirm: () => Promise<void>;\r\n  }>({ show: false, title: '', message: '', warningText: '', confirmLabel: 'Confirm', accentColor: '#dc3545', icon: '', onConfirm: async () => {} });\r\n\r\n  const [successModal, setSuccessModal] = useState<{ show: boolean; message: string }>({ show: false, message: '' });\r\n  const [errorModal, setErrorModal] = useState<{ show: boolean; message: string }>({ show: false, message: '' });\r\n\r\n  // Initial load - runs once on mount\r\n  useEffect(() => {\r\n    loadFirmwareData();\r\n    loadDevices();\r\n    loadDeployments();\r\n    \r\n    // Set up polling for deployment status updates\r\n    const interval = setInterval(() => {\r\n      loadDeployments(); // This will update activeDeployment and trigger status updates if needed\r\n    }, 10000);\r\n    \r\n    return () => clearInterval(interval);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const loadFirmwareData = async () => {\r\n    try {\r\n      setLoadingFirmwares(true);\r\n      const response = await apiService.getFirmwareVersions(false); // Get all firmware versions\r\n      \r\n      // Transform backend response to frontend FirmwareVersion interface\r\n      const transformedFirmwares: FirmwareVersion[] = (response.results || response || []).map((fw: any) => ({\r\n        id: fw.id,\r\n        name: fw.filename || `Firmware v${fw.version}`,\r\n        version: fw.version,\r\n        deviceModel: fw.description?.match(/(?:ESP32|STM32|[A-Z0-9-]+)/i)?.[0] || 'Unknown',\r\n        minBootloaderVersion: '1.0.0', // Default as backend doesn't provide this\r\n        file: null,\r\n        size: fw.size || 0,\r\n        checksum: fw.checksum || '',\r\n        signatureValid: fw.is_active !== false,\r\n        releaseNotes: fw.release_notes || fw.description || '',\r\n        status: fw.is_active ? 'stable' : 'draft',\r\n        uploadDate: fw.created_at || new Date().toISOString(),\r\n      }));\r\n      \r\n      setFirmwares(transformedFirmwares);\r\n    } catch (error) {\r\n      console.error('Failed to load firmware versions:', error);\r\n      // Set to empty on error - UI will show empty state\r\n      setFirmwares([]);\r\n    } finally {\r\n      setLoadingFirmwares(false);\r\n    }\r\n  };\r\n\r\n  const loadDevices = async () => {\r\n    try {\r\n      setLoadingDevices(true);\r\n      const response = await apiService.getDevices('', 1, 1000);\r\n      const realDevices = response.results || response;\r\n      \r\n      // Transform to simple device list - all start as 'idle'\r\n      const transformedDevices: DeviceStatus[] = (Array.isArray(realDevices) ? realDevices : []).map((device: any) => ({\r\n        deviceId: device.device_serial || device.serial || `DEV${device.id}`,\r\n        currentVersion: device.firmware_version || device.config_version || 'v1.0.0',\r\n        targetVersion: 'N/A',\r\n        activeSlot: Math.random() > 0.5 ? 'A' : 'B' as 'A' | 'B',\r\n        status: 'idle' as DeviceStatus['status'],\r\n        bootCount: device.boot_count || 0,\r\n        lastError: '',\r\n        progress: undefined,\r\n      }));\r\n      \r\n      setDevices(transformedDevices);\r\n    } catch (error) {\r\n      console.error('Failed to load devices:', error);\r\n      setDevices([]);\r\n    } finally {\r\n      setLoadingDevices(false);\r\n    }\r\n  };\r\n\r\n  const loadDeployments = async () => {\r\n    try {\r\n      const campaigns = await apiService.listTargetedUpdates();\r\n\r\n      // Active campaign: the most recent in_progress or pending one\r\n      const activeCampaign = campaigns.find((c: any) =>\r\n        c.status === 'in_progress' || c.status === 'pending'\r\n      );\r\n      // Fall back to the most recent completed/failed campaign so the banner\r\n      // still shows useful status after a campaign finishes.\r\n      const displayCampaign = activeCampaign || campaigns[0] || null;\r\n      setActiveDeployment(displayCampaign);\r\n\r\n      if (displayCampaign) {\r\n        await updateDeployedDeviceStatuses(displayCampaign);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load deployments:', error);\r\n    }\r\n  };\r\n\r\n  const updateDeployedDeviceStatuses = async (deployment?: any) => {\r\n    try {\r\n      const activeDeploymentToUse = deployment || activeDeployment;\r\n      if (!activeDeploymentToUse) return;\r\n\r\n      // Fetch enriched campaign detail  includes per-device log_status, log_error,\r\n      // log_last_checked_at, log_bytes_downloaded from a single API call.\r\n      const campaignDetail = await apiService.getTargetedUpdate(activeDeploymentToUse.id);\r\n      const targetedDevices: any[] = campaignDetail.device_targets || [];\r\n      if (targetedDevices.length === 0) return;\r\n\r\n      const firmwareSize: number = campaignDetail.target_firmware?.size || 0;\r\n      const targetVersion: string = campaignDetail.target_firmware?.version || '';\r\n\r\n      const mapBackendStatus = (backendStatus: string | null): DeviceStatus['status'] => {\r\n        switch (backendStatus?.toLowerCase()) {\r\n          case 'pending':   return 'idle';      // Queued  device hasn't checked in yet\r\n          case 'checking':  return 'trial';     // Device is actively checking\r\n          case 'available': return 'trial';     // Device notified, download imminent\r\n          case 'downloading': return 'downloading';\r\n          case 'completed': return 'healthy';\r\n          case 'failed':    return 'failed';\r\n          case 'skipped':   return 'idle';\r\n          default:          return 'idle';\r\n        }\r\n      };\r\n\r\n      const updateMap = new Map<string, Partial<DeviceStatus>>(\r\n        targetedDevices\r\n          .map((dt: any) => {\r\n            const deviceSerial: string = dt.device?.device_serial;\r\n            if (!deviceSerial) return null;\r\n            const mappedStatus = mapBackendStatus(dt.log_status);\r\n            const bytesDownloaded: number = dt.log_bytes_downloaded || 0;\r\n            const progress = mappedStatus === 'downloading' && firmwareSize > 0\r\n              ? Math.round((bytesDownloaded / firmwareSize) * 100)\r\n              : undefined;\r\n            return [deviceSerial, {\r\n              status: mappedStatus,\r\n              targetVersion,\r\n              lastError: mappedStatus === 'failed' ? (dt.log_error || 'Update failed') : '',\r\n              progress,\r\n              lastCheckedAt: dt.log_last_checked_at,\r\n            }] as [string, Partial<DeviceStatus>];\r\n          })\r\n          .filter((entry): entry is [string, Partial<DeviceStatus>] => entry !== null)\r\n      );\r\n\r\n      setDevices(prevDevices =>\r\n        prevDevices.map(device => {\r\n          const update = updateMap.get(device.deviceId);\r\n          return update ? { ...device, ...update } : device;\r\n        })\r\n      );\r\n    } catch (error) {\r\n      console.error('Failed to update deployed device statuses:', error);\r\n    }\r\n  };\r\n\r\n  // Section 1 handlers\r\n  const calculateSHA256 = async (file: File): Promise<string> => {\r\n    const buffer = await file.arrayBuffer();\r\n    const hashBuffer = await crypto.subtle.digest('SHA-256', buffer);\r\n    const hashArray = Array.from(new Uint8Array(hashBuffer));\r\n    const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');\r\n    return hashHex;\r\n  };\r\n\r\n  const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files?.[0]) {\r\n      const file = e.target.files[0];\r\n      setUploadForm({ ...uploadForm, file });\r\n      \r\n      // Calculate real SHA256 checksum\r\n      try {\r\n        const checksum = await calculateSHA256(file);\r\n        console.log('Calculated SHA-256 checksum:', checksum);\r\n      } catch (error) {\r\n        console.error('Failed to calculate checksum:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleUploadFirmware = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!uploadForm.file) {\r\n      setErrorModal({ show: true, message: 'Please select a firmware file before uploading.' });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Create FormData for multipart upload\r\n      const formData = new FormData();\r\n      formData.append('file', uploadForm.file);\r\n      formData.append('version', uploadForm.version);\r\n      formData.append('description', uploadForm.name);\r\n      formData.append('release_notes', uploadForm.releaseNotes);\r\n      formData.append('is_active', 'false'); // Uploaded as draft by default\r\n\r\n      // Call backend API to upload to S3\r\n      const response = await apiService.uploadFirmwareVersion(formData);\r\n      \r\n      setSuccessModal({ \r\n        show: true, \r\n        message: `Firmware uploaded successfully!\\n\\nVersion: ${response.version}\\nSize: ${(response.size / 1024).toFixed(2)} KB\\nChecksum: ${response.checksum?.substring(0, 16)}...\\nStored in: S3` \r\n      });\r\n      \r\n      // Reset form\r\n      setUploadForm({\r\n        name: '',\r\n        version: '',\r\n        deviceModel: 'ESP32-S3',\r\n        minBootloader: '1.0.0',\r\n        releaseNotes: '',\r\n        file: null,\r\n      });\r\n      \r\n      const fileInput = document.querySelector('input[type=\"file\"]') as HTMLInputElement;\r\n      if (fileInput) fileInput.value = '';\r\n      \r\n      // Reload firmware list from backend\r\n      await loadFirmwareData();\r\n    } catch (error: any) {\r\n      console.error('Firmware upload failed:', error);\r\n      setErrorModal({ \r\n        show: true, \r\n        message: `Upload failed: ${error.message || 'Unknown error'}\\n\\nPlease check:\\n- File size is reasonable\\n- S3 credentials are configured (USE_S3=True)\\n- You have admin permissions` \r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDeleteFirmware = (firmware: FirmwareVersion) => {\r\n    setConfirmActionModal({\r\n      show: true,\r\n      title: 'Delete Firmware',\r\n      message: `Are you sure you want to delete firmware version ${firmware.version}?`,\r\n      warningText: ' Warning: This will permanently remove the firmware file from S3. This action cannot be undone.',\r\n      confirmLabel: 'Yes, Delete',\r\n      accentColor: '#7f1d1d',\r\n      icon: '',\r\n      onConfirm: async () => {\r\n        await apiService.deleteFirmwareVersion(firmware.id);\r\n        setSuccessModal({ show: true, message: 'Firmware deleted successfully!' });\r\n        await loadFirmwareData();\r\n      },\r\n    });\r\n  };\r\n\r\n  const handleMarkAsStable = async (id: number) => {\r\n    try {\r\n      await apiService.updateFirmwareVersion(id, { is_active: true });\r\n      setSuccessModal({ show: true, message: 'Firmware activated successfully!' });\r\n      await loadFirmwareData();\r\n    } catch (error: any) {\r\n      console.error('Firmware update failed:', error);\r\n      setErrorModal({ show: true, message: `Activation failed: ${error.message || 'Unknown error'}` });\r\n    }\r\n  };\r\n\r\n  const handleDeactivateFirmware = (firmware: FirmwareVersion) => {\r\n    setConfirmActionModal({\r\n      show: true,\r\n      title: 'Deactivate Firmware',\r\n      message: `Are you sure you want to deactivate firmware version ${firmware.version}?`,\r\n      warningText: ' Note: This firmware will no longer be offered for OTA updates. You can reactivate it later.',\r\n      confirmLabel: 'Yes, Deactivate',\r\n      accentColor: '#ff9800',\r\n      icon: '',\r\n      onConfirm: async () => {\r\n        await apiService.updateFirmwareVersion(firmware.id, { is_active: false });\r\n        setSuccessModal({ show: true, message: 'Firmware deactivated successfully!' });\r\n        await loadFirmwareData();\r\n      },\r\n    });\r\n  };\r\n\r\n  // Section 2 handlers\r\n  const handleDeployClick = () => {\r\n    if (!deploymentConfig.firmwareVersion) {\r\n      setErrorModal({ show: true, message: 'Please select a firmware version before deploying.' });\r\n      return;\r\n    }\r\n    if (deploymentConfig.targetDevices.length === 0) {\r\n      setErrorModal({ show: true, message: 'Please select at least one device to deploy to.' });\r\n      return;\r\n    }\r\n\r\n    const firmware = firmwares.find(f => f.version === deploymentConfig.firmwareVersion);\r\n    if (!firmware) return;\r\n\r\n    const totalBytes = firmware.size * deploymentConfig.targetDevices.length;\r\n    const dataTransfer = (totalBytes / (1024 * 1024)).toFixed(2) + ' MB';\r\n\r\n    setConfirmModal({\r\n      show: true,\r\n      firmware: firmware.version,\r\n      deviceCount: deploymentConfig.targetDevices.length,\r\n      dataTransfer,\r\n    });\r\n  };\r\n\r\n  const confirmDeployment = async () => {\r\n    setConfirmModal({ ...confirmModal, show: false });\r\n    setIsDeploying(true);\r\n    \r\n    try {\r\n      // Find the selected firmware object to get its ID\r\n      const firmware = firmwares.find(f => f.version === deploymentConfig.firmwareVersion);\r\n      if (!firmware) {\r\n        throw new Error('Selected firmware not found');\r\n      }\r\n      \r\n      // Call backend API to create deployment campaign\r\n      const response = await apiService.deployFirmware(\r\n        firmware.id,\r\n        deploymentConfig.targetDevices,\r\n        `Deployment: ${firmware.version} to ${deploymentConfig.targetDevices.length} device(s)`\r\n      );\r\n      \r\n      setIsDeploying(false);\r\n      setSuccessModal({\r\n        show: true,\r\n        message: `Deployment initiated!\\n\\nID: ${response.id || 'N/A'}  Devices: ${response.devices_total || deploymentConfig.targetDevices.length}  Firmware: ${firmware.version}\\n\\nDevices will receive the update on their next check-in.`,\r\n      });\r\n      await loadDeployments();\r\n    } catch (error: any) {\r\n      setIsDeploying(false);\r\n      console.error('Deployment failed:', error);\r\n      setErrorModal({ show: true, message: `Deployment failed: ${error.message || 'Unknown error'}` });\r\n    }\r\n  };\r\n\r\n  const handleSelectAllDevices = () => {\r\n    const idleDevices = devices.filter(d => d.status === 'idle');\r\n    setDeploymentConfig({\r\n      ...deploymentConfig,\r\n      targetDevices: idleDevices.map(d => d.deviceId),\r\n    });\r\n  };\r\n\r\n  // Section 3 helpers\r\n  const statusMetrics = {\r\n    total: devices.length,\r\n    // 'trial' = checking/available, 'downloading' = actively downloading\r\n    inProgress: devices.filter(d => ['downloading', 'flashing', 'rebooting', 'trial'].includes(d.status)).length,\r\n    healthy: devices.filter(d => d.status === 'healthy').length,\r\n    // Prefer the authoritative campaign counter when available\r\n    failed: activeDeployment?.devices_failed ?? devices.filter(d => d.status === 'failed').length,\r\n    rolledBack: devices.filter(d => d.status === 'rolledback').length,\r\n  };\r\n\r\n  const getStatusBadgeStyle = (status: DeviceStatus['status']) => {\r\n    const styles: Record<DeviceStatus['status'], string> = {\r\n      idle: '#6c757d',\r\n      downloading: '#17a2b8',\r\n      flashing: '#ffc107',\r\n      rebooting: '#fd7e14',\r\n      trial: '#007bff',\r\n      healthy: '#28a745',\r\n      failed: '#dc3545',\r\n      rolledback: '#6610f2',\r\n    };\r\n    return {\r\n      background: styles[status],\r\n      color: 'white',\r\n      padding: '0.25rem 0.75rem',\r\n      borderRadius: '12px',\r\n      fontSize: '0.75rem',\r\n      fontWeight: '600' as const,\r\n      textTransform: 'uppercase' as const,\r\n      whiteSpace: 'nowrap' as const,\r\n    };\r\n  };\r\n\r\n  // Section 4 handlers\r\n  const handleEmergencyRollback = () => {\r\n    setShowRollbackModal(true);\r\n  };\r\n\r\n  const confirmRollback = async () => {\r\n    if (rollbackForm.selectedDevices.length === 0) {\r\n      setErrorModal({ show: true, message: 'Please select at least one device to rollback.' });\r\n      return;\r\n    }\r\n    if (!rollbackForm.reason.trim()) {\r\n      setErrorModal({ show: true, message: 'Please provide a reason for rollback.' });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Queue rollback command for each selected device.\r\n      // Device will receive updateFirmware: 2 on its next heartbeat.\r\n      await Promise.all(\r\n        rollbackForm.selectedDevices.map(serial =>\r\n          apiService.triggerRollback(serial, rollbackForm.reason)\r\n        )\r\n      );\r\n      setShowRollbackModal(false);\r\n      setSuccessModal({\r\n        show: true,\r\n        message: `Rollback queued for ${rollbackForm.selectedDevices.length} device(s). They will revert on their next heartbeat.`,\r\n      });\r\n      setRollbackForm({ selectedDevices: [], reason: '' });\r\n    } catch (error: any) {\r\n      setErrorModal({ show: true, message: `Rollback failed: ${error.message || 'Unknown error'}` });\r\n    }\r\n  };\r\n\r\n  const toggleRollbackDevice = (deviceId: string) => {\r\n    setRollbackForm(prev => ({\r\n      ...prev,\r\n      selectedDevices: prev.selectedDevices.includes(deviceId)\r\n        ? prev.selectedDevices.filter(id => id !== deviceId)\r\n        : [...prev.selectedDevices, deviceId]\r\n    }));\r\n  };\r\n\r\n  const getFilteredRollbackDevices = () => {\r\n    return devices.filter(device => {\r\n      if (rollbackFilters.currentVersion !== 'all' && device.currentVersion !== rollbackFilters.currentVersion) {\r\n        return false;\r\n      }\r\n      if (rollbackFilters.status !== 'all' && device.status !== rollbackFilters.status) {\r\n        return false;\r\n      }\r\n      // Add more filter conditions as needed\r\n      return true;\r\n    });\r\n  };\r\n\r\n  const selectAllFilteredDevices = () => {\r\n    const filtered = getFilteredRollbackDevices();\r\n    setRollbackForm(prev => ({\r\n      ...prev,\r\n      selectedDevices: filtered.map(d => d.deviceId)\r\n    }));\r\n  };\r\n\r\n  const deselectAllDevices = () => {\r\n    setRollbackForm(prev => ({ ...prev, selectedDevices: [] }));\r\n  };\r\n\r\n  const filteredDevices = statusFilter === 'all' \r\n    ? devices \r\n    : devices.filter(d => d.status === statusFilter);\r\n\r\n  return (\r\n    <div style={{ padding: '2rem', maxWidth: '1600px', margin: '0 auto', background: isDark ? '#1a1a1a' : '#f5f6fa', minHeight: '100vh' }}>\r\n      {/* Header */}\r\n      <div style={{ marginBottom: '2rem' }}>\r\n        <h1 style={{ \r\n          fontSize: '2rem', \r\n          fontWeight: '700', \r\n          color: isDark ? '#e0e0e0' : '#2c3e50', \r\n          marginBottom: '0.5rem',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: '0.75rem'\r\n        }}>\r\n          <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n            <path d=\"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z\"/>\r\n            <polyline points=\"3.27 6.96 12 12.01 20.73 6.96\"/>\r\n            <line x1=\"12\" y1=\"22.08\" x2=\"12\" y2=\"12\"/>\r\n          </svg>\r\n          OTA Firmware Management\r\n        </h1>\r\n        <p style={{ color: isDark ? '#a0a0a0' : '#7f8c8d', margin: 0 }}>\r\n          Upload, deploy, and monitor firmware updates across your device fleet\r\n        </p>\r\n      </div>\r\n\r\n      {/* SECTION 1: Firmware Repository */}\r\n      <div style={{ \r\n        background: isDark ? '#2d2d2d' : 'white', \r\n        borderRadius: '12px', \r\n        padding: '2rem',\r\n        marginBottom: '2rem',\r\n        boxShadow: isDark ? '0 2px 8px rgba(0,0,0,0.3)' : '0 2px 8px rgba(0,0,0,0.08)',\r\n        border: isDark ? '1px solid #404040' : '1px solid #e1e8ed'\r\n      }}>\r\n        <h2 style={{ \r\n          fontSize: '1.5rem', \r\n          fontWeight: '600', \r\n          color: isDark ? '#e0e0e0' : '#2c3e50',\r\n          marginBottom: '1.5rem',\r\n          paddingBottom: '0.75rem',\r\n          borderBottom: isDark ? '2px solid #404040' : '2px solid #e1e8ed',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: '0.5rem'\r\n        }}>\r\n          <span style={{ fontSize: '1.25rem' }}></span>\r\n          Firmware Repository\r\n        </h2>\r\n\r\n        {/* Upload Form */}\r\n        <form onSubmit={handleUploadFirmware} style={{ \r\n          background: isDark ? '#242424' : '#f8f9fa', \r\n          padding: '1.5rem', \r\n          borderRadius: '8px',\r\n          marginBottom: '2rem',\r\n          border: isDark ? '1px solid #404040' : '1px solid #dee2e6'\r\n        }}>\r\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', gap: '1rem' }}>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n                Firmware Name *\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={uploadForm.name}\r\n                onChange={(e) => setUploadForm({ ...uploadForm, name: e.target.value })}\r\n                placeholder=\"Solar Controller Firmware\"\r\n                required\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.75rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.95rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n                Version (semver) *\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={uploadForm.version}\r\n                onChange={(e) => setUploadForm({ ...uploadForm, version: e.target.value })}\r\n                placeholder=\"1.4.0\"\r\n                required\r\n                pattern=\"\\d+\\.\\d+\\.\\d+\"\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.75rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.95rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n                Device Model\r\n              </label>\r\n              <select\r\n                value={uploadForm.deviceModel}\r\n                onChange={(e) => setUploadForm({ ...uploadForm, deviceModel: e.target.value })}\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.75rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.95rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              >\r\n                <option value=\"ESP32-S3\">ESP32-S3</option>\r\n                <option value=\"ESP32\">ESP32</option>\r\n                <option value=\"STM32\">STM32</option>\r\n                <option value=\"nRF52\">nRF52</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n                Min Bootloader Version\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={uploadForm.minBootloader}\r\n                onChange={(e) => setUploadForm({ ...uploadForm, minBootloader: e.target.value })}\r\n                placeholder=\"1.0.0\"\r\n                required\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.75rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.95rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div style={{ marginTop: '1rem' }}>\r\n            <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n              Release Notes\r\n            </label>\r\n            <textarea\r\n              value={uploadForm.releaseNotes}\r\n              onChange={(e) => setUploadForm({ ...uploadForm, releaseNotes: e.target.value })}\r\n              placeholder=\"Bug fixes, new features, improvements...\"\r\n              rows={3}\r\n              style={{ \r\n                width: '100%', \r\n                padding: '0.75rem', \r\n                borderRadius: '6px', \r\n                border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                fontSize: '0.95rem',\r\n                fontFamily: 'inherit',\r\n                resize: 'vertical',\r\n                background: isDark ? '#1a1a1a' : 'white',\r\n                color: isDark ? '#e0e0e0' : 'inherit'\r\n              }}\r\n            />\r\n          </div>\r\n\r\n          <div style={{ marginTop: '1rem', display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem', alignItems: 'end' }}>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n                Firmware File (.bin) *\r\n              </label>\r\n              <input\r\n                type=\"file\"\r\n                accept=\".bin\"\r\n                onChange={handleFileSelect}\r\n                required\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.5rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.9rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              />\r\n              {uploadForm.file && (\r\n                <small style={{ color: isDark ? '#a0a0a0' : '#6c757d', display: 'block', marginTop: '0.25rem' }}>\r\n                  {uploadForm.file.name} ({(uploadForm.file.size / 1024).toFixed(1)} KB)\r\n                </small>\r\n              )}\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n                SHA256 (auto-calculated)\r\n              </label>\r\n              <div style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '0.5rem',\r\n                padding: '0.75rem',\r\n                background: isDark ? '#242424' : '#e9ecef',\r\n                borderRadius: '6px',\r\n                border: isDark ? '1px solid #404040' : '1px solid #ced4da'\r\n              }}>\r\n                <input\r\n                  type=\"text\"\r\n                  value=\"Calculating...\"\r\n                  disabled\r\n                  style={{ \r\n                    width: '100%',\r\n                    border: 'none',\r\n                    background: 'transparent',\r\n                    fontSize: '0.85rem',\r\n                    fontFamily: 'monospace',\r\n                    color: isDark ? '#a0a0a0' : '#6c757d'\r\n                  }}\r\n                />\r\n                <span style={{\r\n                  background: uploadForm.file ? '#28a745' : '#6c757d',\r\n                  color: 'white',\r\n                  padding: '0.25rem 0.5rem',\r\n                  borderRadius: '4px',\r\n                  fontSize: '0.7rem',\r\n                  fontWeight: '600',\r\n                  whiteSpace: 'nowrap'\r\n                }}>\r\n                  {uploadForm.file ? 'Valid' : 'Pending'}\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <button\r\n            type=\"submit\"\r\n            style={{\r\n              marginTop: '1.5rem',\r\n              background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n              color: 'white',\r\n              border: 'none',\r\n              padding: '0.875rem 2rem',\r\n              borderRadius: '8px',\r\n              fontSize: '1rem',\r\n              fontWeight: '600',\r\n              cursor: 'pointer',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              boxShadow: '0 4px 12px rgba(102, 126, 234, 0.3)',\r\n            }}\r\n          >\r\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n              <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"/>\r\n              <polyline points=\"17 8 12 3 7 8\"/>\r\n              <line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\"/>\r\n            </svg>\r\n            Upload Firmware\r\n          </button>\r\n        </form>\r\n\r\n        {/* Firmware List Table */}\r\n        <div>\r\n          <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1rem', color: isDark ? '#e0e0e0' : '#495057' }}>\r\n            Available Firmware Versions\r\n          </h3>\r\n          <div style={{ overflowX: 'auto' }}>\r\n            <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n              <thead>\r\n                <tr style={{ background: isDark ? '#242424' : '#f8f9fa', borderBottom: isDark ? '2px solid #404040' : '2px solid #dee2e6' }}>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>Name</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>Version</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>Device Model</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>File Size</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>Upload Date</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>Status</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'center', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>Actions</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {loadingFirmwares ? (\r\n                  <tr>\r\n                    <td colSpan={7} style={{ padding: '2rem', textAlign: 'center', color: isDark ? '#a0a0a0' : '#6c757d', fontSize: '0.95rem' }}>\r\n                      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '0.5rem' }}>\r\n                        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" style={{ animation: 'spin 1s linear infinite' }}>\r\n                          <circle cx=\"12\" cy=\"12\" r=\"10\" opacity=\"0.25\"/>\r\n                          <path d=\"M12 2a10 10 0 0 1 10 10\" opacity=\"0.75\"/>\r\n                        </svg>\r\n                        Loading firmware versions...\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ) : firmwares.length === 0 ? (\r\n                  <tr>\r\n                    <td colSpan={7} style={{ padding: '2rem', textAlign: 'center', color: isDark ? '#a0a0a0' : '#6c757d', fontSize: '0.95rem' }}>\r\n                      No firmware versions uploaded yet. Use the form above to upload your first firmware.\r\n                    </td>\r\n                  </tr>\r\n                ) : (\r\n                  firmwares.map(fw => (\r\n                  <tr key={fw.id} style={{ borderBottom: isDark ? '1px solid #404040' : '1px solid #e9ecef' }}>\r\n                    <td style={{ padding: '1rem 0.75rem' }}>\r\n                      <div style={{ fontWeight: '500', color: isDark ? '#e0e0e0' : '#2c3e50', marginBottom: '0.25rem' }}>{fw.name}</div>\r\n                      {fw.signatureValid && (\r\n                        <span style={{ fontSize: '0.75rem', color: '#28a745', display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\r\n                          <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"3\">\r\n                            <polyline points=\"20 6 9 17 4 12\"/>\r\n                          </svg>\r\n                          Signature Valid\r\n                        </span>\r\n                      )}\r\n                    </td>\r\n                    <td style={{ padding: '1rem 0.75rem', fontFamily: 'monospace', fontSize: '0.9rem', fontWeight: '500' }}>{fw.version}</td>\r\n                    <td style={{ padding: '1rem 0.75rem', fontSize: '0.9rem' }}>{fw.deviceModel}</td>\r\n                    <td style={{ padding: '1rem 0.75rem', fontSize: '0.9rem' }}>{(fw.size / 1024).toFixed(0)} KB</td>\r\n                    <td style={{ padding: '1rem 0.75rem', fontSize: '0.9rem' }}>\r\n                      {new Date(fw.uploadDate).toLocaleDateString()}\r\n                    </td>\r\n                    <td style={{ padding: '1rem 0.75rem' }}>\r\n                      <span style={{\r\n                        background: fw.status === 'stable' ? '#d4edda' : '#fff3cd',\r\n                        color: fw.status === 'stable' ? '#155724' : '#856404',\r\n                        padding: '0.25rem 0.75rem',\r\n                        borderRadius: '12px',\r\n                        fontSize: '0.75rem',\r\n                        fontWeight: '600',\r\n                        textTransform: 'uppercase'\r\n                      }}>\r\n                        {fw.status === 'stable' ? ' Production Stable' : 'Draft'}\r\n                      </span>\r\n                    </td>\r\n                    <td style={{ padding: '1rem 0.75rem', textAlign: 'center' }}>\r\n                      <div style={{ display: 'flex', gap: '0.5rem', justifyContent: 'center' }}>\r\n                        {fw.status === 'draft' ? (\r\n                          <button\r\n                            onClick={() => handleMarkAsStable(fw.id)}\r\n                            style={{\r\n                              background: '#28a745',\r\n                              color: 'white',\r\n                              border: 'none',\r\n                              padding: '0.5rem 0.75rem',\r\n                              borderRadius: '6px',\r\n                              fontSize: '0.8rem',\r\n                              cursor: 'pointer',\r\n                              fontWeight: '500'\r\n                            }}\r\n                          >\r\n                            Activate\r\n                          </button>\r\n                        ) : (\r\n                          <button\r\n                            onClick={() => handleDeactivateFirmware(fw)}\r\n                            style={{\r\n                              background: '#ffc107',\r\n                              color: '#000',\r\n                              border: 'none',\r\n                              padding: '0.5rem 0.75rem',\r\n                              borderRadius: '6px',\r\n                              fontSize: '0.8rem',\r\n                              cursor: 'pointer',\r\n                              fontWeight: '500'\r\n                            }}\r\n                          >\r\n                            Deactivate\r\n                          </button>\r\n                        )}\r\n                        <button\r\n                          onClick={() => handleDeleteFirmware(fw)}\r\n                          style={{\r\n                            background: '#dc3545',\r\n                            color: 'white',\r\n                            border: 'none',\r\n                            padding: '0.5rem 0.75rem',\r\n                            borderRadius: '6px',\r\n                            fontSize: '0.8rem',\r\n                            cursor: 'pointer',\r\n                            fontWeight: '500'\r\n                          }}\r\n                        >\r\n                          Delete\r\n                        </button>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* SECTION 2: Deployment Panel */}\r\n      <div style={{ \r\n        background: isDark ? '#2d2d2d' : 'white', \r\n        borderRadius: '12px', \r\n        padding: '2rem',\r\n        marginBottom: '2rem',\r\n        boxShadow: isDark ? '0 2px 8px rgba(0,0,0,0.3)' : '0 2px 8px rgba(0,0,0,0.08)',\r\n        border: isDark ? '2px solid #667eea' : '2px solid #667eea'\r\n      }}>\r\n        <h2 style={{ \r\n          fontSize: '1.5rem', \r\n          fontWeight: '600', \r\n          color: isDark ? '#e0e0e0' : '#2c3e50',\r\n          marginBottom: '1.5rem',\r\n          paddingBottom: '0.75rem',\r\n          borderBottom: isDark ? '2px solid #404040' : '2px solid #e1e8ed',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: '0.5rem'\r\n        }}>\r\n          <span style={{ fontSize: '1.25rem' }}></span>\r\n          Deployment Panel\r\n        </h2>\r\n\r\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '1.5rem' }}>\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n              Select Firmware Version *\r\n            </label>\r\n            <select\r\n              value={deploymentConfig.firmwareVersion}\r\n              onChange={(e) => setDeploymentConfig({ ...deploymentConfig, firmwareVersion: e.target.value })}\r\n              style={{ \r\n                width: '100%', \r\n                padding: '0.75rem', \r\n                borderRadius: '6px', \r\n                border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                fontSize: '0.95rem',\r\n                background: isDark ? '#1a1a1a' : 'white',\r\n                color: isDark ? '#e0e0e0' : 'inherit'\r\n              }}\r\n            >\r\n              <option value=\"\">-- Select Version --</option>\r\n              {firmwares.filter(f => f.status === 'stable').map(f => (\r\n                <option key={f.id} value={f.version}>\r\n                  {f.name} - v{f.version}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n              Deployment Mode\r\n            </label>\r\n            <select\r\n              value={deploymentConfig.mode}\r\n              onChange={(e) => setDeploymentConfig({ ...deploymentConfig, mode: e.target.value as 'immediate' | 'canary' })}\r\n              style={{ \r\n                width: '100%', \r\n                padding: '0.75rem', \r\n                borderRadius: '6px', \r\n                border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                fontSize: '0.95rem',\r\n                background: isDark ? '#1a1a1a' : 'white',\r\n                color: isDark ? '#e0e0e0' : 'inherit'\r\n              }}\r\n            >\r\n              <option value=\"immediate\">Immediate (Push to all devices)</option>\r\n              <option value=\"canary\">Canary (Gradual rollout)</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n              Health Confirmation Timeout (seconds)\r\n            </label>\r\n            <input\r\n              type=\"number\"\r\n              value={deploymentConfig.healthTimeout}\r\n              onChange={(e) => setDeploymentConfig({ ...deploymentConfig, healthTimeout: parseInt(e.target.value) })}\r\n              min=\"30\"\r\n              max=\"3600\"\r\n              style={{ \r\n                width: '100%', \r\n                padding: '0.75rem', \r\n                borderRadius: '6px', \r\n                border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                fontSize: '0.95rem',\r\n                background: isDark ? '#1a1a1a' : 'white',\r\n                color: isDark ? '#e0e0e0' : 'inherit'\r\n              }}\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n              Failure Threshold (%)\r\n            </label>\r\n            <input\r\n              type=\"number\"\r\n              value={deploymentConfig.failureThreshold}\r\n              onChange={(e) => setDeploymentConfig({ ...deploymentConfig, failureThreshold: parseInt(e.target.value) })}\r\n              min=\"1\"\r\n              max=\"100\"\r\n              style={{ \r\n                width: '100%', \r\n                padding: '0.75rem', \r\n                borderRadius: '6px', \r\n                border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                fontSize: '0.95rem',\r\n                background: isDark ? '#1a1a1a' : 'white',\r\n                color: isDark ? '#e0e0e0' : 'inherit'\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ marginTop: '1.5rem' }}>\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '0.5rem' }}>\r\n            <label style={{ fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n              Target Devices ({deploymentConfig.targetDevices.length} selected)\r\n            </label>\r\n            <button\r\n              onClick={handleSelectAllDevices}\r\n              style={{\r\n                background: 'transparent',\r\n                color: '#667eea',\r\n                border: '1px solid #667eea',\r\n                padding: '0.25rem 0.75rem',\r\n                borderRadius: '6px',\r\n                fontSize: '0.8rem',\r\n                cursor: 'pointer',\r\n                fontWeight: '500'\r\n              }}\r\n            >\r\n              Select All Idle ({devices.filter(d => d.status === 'idle').length})\r\n            </button>\r\n          </div>\r\n          <div style={{\r\n            maxHeight: '150px',\r\n            overflowY: 'auto',\r\n            border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n            borderRadius: '6px',\r\n            padding: '0.75rem',\r\n            background: isDark ? '#242424' : '#f8f9fa'\r\n          }}>\r\n            {loadingDevices ? (\r\n              <div style={{ textAlign: 'center', color: isDark ? '#a0a0a0' : '#6c757d', padding: '1rem' }}>\r\n                Loading devices...\r\n              </div>\r\n            ) : devices.filter(d => d.status === 'idle').length === 0 ? (\r\n              <div style={{ textAlign: 'center', color: isDark ? '#a0a0a0' : '#6c757d', padding: '1rem' }}>\r\n                No idle devices available for deployment\r\n              </div>\r\n            ) : (\r\n              <>\r\n                {devices.filter(d => d.status === 'idle').map(device => (\r\n                  <label key={device.deviceId} style={{ \r\n                    display: 'block', \r\n                    marginBottom: '0.5rem',\r\n                    cursor: 'pointer',\r\n                    fontSize: '0.9rem'\r\n                  }}>\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={deploymentConfig.targetDevices.includes(device.deviceId)}\r\n                      onChange={(e) => {\r\n                        const newTargets = e.target.checked\r\n                          ? [...deploymentConfig.targetDevices, device.deviceId]\r\n                          : deploymentConfig.targetDevices.filter(id => id !== device.deviceId);\r\n                        setDeploymentConfig({ ...deploymentConfig, targetDevices: newTargets });\r\n                      }}\r\n                      style={{ marginRight: '0.5rem' }}\r\n                    />\r\n                    {device.deviceId} (Current: {device.currentVersion})\r\n                  </label>\r\n                ))}\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ marginTop: '1.5rem', display: 'flex', alignItems: 'center', gap: '0.75rem' }}>\r\n          <label style={{\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            gap: '0.5rem',\r\n            cursor: 'pointer',\r\n            fontWeight: '500',\r\n            color: isDark ? '#b0b0b0' : '#495057'\r\n          }}>\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={deploymentConfig.autoRollback}\r\n              onChange={(e) => setDeploymentConfig({ ...deploymentConfig, autoRollback: e.target.checked })}\r\n              style={{ width: '20px', height: '20px', cursor: 'pointer' }}\r\n            />\r\n            Enable Auto Rollback\r\n          </label>\r\n          <span style={{ fontSize: '0.85rem', color: isDark ? '#a0a0a0' : '#6c757d' }}>\r\n            (Automatically rollback on failure)\r\n          </span>\r\n        </div>\r\n\r\n        <div style={{ marginTop: '2rem', display: 'flex', gap: '1rem', flexWrap: 'wrap' }}>\r\n          <button\r\n            onClick={handleDeployClick}\r\n            disabled={isDeploying}\r\n            style={{\r\n              background: isDeploying ? '#6c757d' : 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n              color: 'white',\r\n              border: 'none',\r\n              padding: '1rem 2.5rem',\r\n              borderRadius: '8px',\r\n              fontSize: '1.125rem',\r\n              fontWeight: '600',\r\n              cursor: isDeploying ? 'not-allowed' : 'pointer',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.75rem',\r\n              boxShadow: '0 4px 12px rgba(102, 126, 234, 0.3)',\r\n            }}\r\n          >\r\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n              <polygon points=\"13 2 3 14 12 14 11 22 21 10 12 10 13 2\"/>\r\n            </svg>\r\n            {isDeploying ? 'Deploying...' : 'Deploy Firmware'}\r\n          </button>\r\n\r\n          {isDeploying && (\r\n            <>\r\n              <button\r\n                style={{\r\n                  background: '#ffc107',\r\n                  color: '#000',\r\n                  border: 'none',\r\n                  padding: '1rem 2rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '1rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer',\r\n                }}\r\n              >\r\n                 Pause Deployment\r\n              </button>\r\n              <button\r\n                style={{\r\n                  background: '#dc3545',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '1rem 2rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '1rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer',\r\n                }}\r\n              >\r\n                 Abort Deployment\r\n              </button>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Deployment Confirmation Modal */}\r\n      {confirmModal.show && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: 'rgba(0,0,0,0.6)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          zIndex: 1000\r\n        }}>\r\n          <div style={{\r\n            background: isDark ? '#2d2d2d' : 'white',\r\n            borderRadius: '12px',\r\n            padding: '2rem',\r\n            maxWidth: '500px',\r\n            width: '90%',\r\n            boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n            border: isDark ? '1px solid #404040' : 'none'\r\n          }}>\r\n            <h3 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1.5rem', color: isDark ? '#e0e0e0' : '#2c3e50' }}>\r\n              Confirm Deployment\r\n            </h3>\r\n            <div style={{ marginBottom: '1.5rem', color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.8' }}>\r\n              <p><strong>Firmware Version:</strong> {confirmModal.firmware}</p>\r\n              <p><strong>Target Devices:</strong> {confirmModal.deviceCount}</p>\r\n              <p><strong>Estimated Data Transfer:</strong> {confirmModal.dataTransfer}</p>\r\n              <p><strong>Auto Rollback:</strong> {deploymentConfig.autoRollback ? 'Enabled ' : 'Disabled'}</p>\r\n              <p><strong>Failure Threshold:</strong> {deploymentConfig.failureThreshold}%</p>\r\n            </div>\r\n            <div style={{\r\n              background: isDark ? '#3a2a00' : '#fff3cd',\r\n              border: isDark ? '1px solid #6b5300' : '1px solid #ffc107',\r\n              borderRadius: '8px',\r\n              padding: '1rem',\r\n              marginBottom: '1.5rem',\r\n              color: isDark ? '#ffd966' : '#856404'\r\n            }}>\r\n              <strong> Warning:</strong> This will push firmware updates to {confirmModal.deviceCount} devices.\r\n            </div>\r\n            <div style={{ display: 'flex', gap: '1rem', justifyContent: 'flex-end' }}>\r\n              <button\r\n                onClick={() => setConfirmModal({ ...confirmModal, show: false })}\r\n                style={{\r\n                  background: '#6c757d',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '0.75rem 1.5rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '1rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer'\r\n                }}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={confirmDeployment}\r\n                style={{\r\n                  background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '0.75rem 1.5rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '1rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer'\r\n                }}\r\n              >\r\n                Confirm Deploy\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* SECTION 3: Live Deployment Status */}\r\n      <div style={{ \r\n        background: isDark ? '#2d2d2d' : 'white', \r\n        borderRadius: '12px', \r\n        padding: '2rem',\r\n        marginBottom: '2rem',\r\n        boxShadow: isDark ? '0 2px 8px rgba(0,0,0,0.3)' : '0 2px 8px rgba(0,0,0,0.08)',\r\n        border: isDark ? '1px solid #404040' : '1px solid #e1e8ed'\r\n      }}>\r\n        <h2 style={{ \r\n          fontSize: '1.5rem', \r\n          fontWeight: '600', \r\n          color: isDark ? '#e0e0e0' : '#2c3e50',\r\n          marginBottom: '1.5rem',\r\n          paddingBottom: '0.75rem',\r\n          borderBottom: isDark ? '2px solid #404040' : '2px solid #e1e8ed',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: '0.5rem'\r\n        }}>\r\n          <span style={{ fontSize: '1.25rem' }}></span>\r\n          Live Deployment Status\r\n          {loadingDevices && (\r\n            <span style={{ fontSize: '0.85rem', color: isDark ? '#a0a0a0' : '#6c757d', fontWeight: '400', marginLeft: 'auto' }}>\r\n              Loading devices...\r\n            </span>\r\n          )}\r\n        </h2>\r\n\r\n        {/* Loading or No Devices State */}\r\n        {loadingDevices ? (\r\n          <div style={{\r\n            textAlign: 'center',\r\n            padding: '3rem 1rem',\r\n            color: isDark ? '#a0a0a0' : '#6c757d'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', marginBottom: '1rem' }}></div>\r\n            <p style={{ fontSize: '1.1rem' }}>Loading devices from backend...</p>\r\n          </div>\r\n        ) : devices.length === 0 ? (\r\n          <div style={{\r\n            textAlign: 'center',\r\n            padding: '3rem 1rem',\r\n            color: isDark ? '#a0a0a0' : '#6c757d'\r\n          }}>\r\n            <div style={{ fontSize: '3rem', marginBottom: '1rem' }}></div>\r\n            <p style={{ fontSize: '1.1rem', marginBottom: '0.5rem' }}>No devices registered yet</p>\r\n            <p style={{ fontSize: '0.9rem' }}>Register devices to see them here</p>\r\n          </div>\r\n        ) : (\r\n          <>\r\n            {/* Active Deployment Banner */}\r\n            {activeDeployment && (\r\n              <div style={{\r\n                background: activeDeployment.status === 'in_progress' \r\n                  ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' \r\n                  : isDark ? '#2a4a2a' : '#d4edda',\r\n                color: activeDeployment.status === 'in_progress' ? 'white' : isDark ? '#90ee90' : '#155724',\r\n                padding: '1.5rem',\r\n                borderRadius: '12px',\r\n                marginBottom: '2rem',\r\n                border: activeDeployment.status === 'in_progress' \r\n                  ? 'none' \r\n                  : isDark ? '1px solid #4a6a4a' : '1px solid #c3e6cb'\r\n              }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '0.75rem' }}>\r\n                  <h3 style={{ fontSize: '1.1rem', fontWeight: '600', margin: 0 }}>\r\n                    {activeDeployment.status === 'in_progress' ? ' Active Deployment' : ' Deployment Completed'}\r\n                  </h3>\r\n                  <span style={{ \r\n                    fontSize: '0.85rem', \r\n                    padding: '0.25rem 0.75rem', \r\n                    background: 'rgba(255,255,255,0.2)', \r\n                    borderRadius: '20px' \r\n                  }}>\r\n                    ID: {activeDeployment.id}\r\n                  </span>\r\n                </div>\r\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem', fontSize: '0.9rem' }}>\r\n                  <div>\r\n                    <strong>Firmware:</strong> {activeDeployment.target_firmware?.version || 'N/A'}\r\n                  </div>\r\n                  <div>\r\n                    <strong>Total Devices:</strong> {activeDeployment.devices_total || 0}\r\n                  </div>\r\n                  <div>\r\n                    <strong>Updated:</strong> {activeDeployment.devices_updated || 0}\r\n                  </div>\r\n                  <div>\r\n                    <strong>Failed:</strong> {activeDeployment.devices_failed || 0}\r\n                  </div>\r\n                  <div>\r\n                    <strong>Progress:</strong> {activeDeployment.devices_total > 0 \r\n                      ? `${Math.round((activeDeployment.devices_updated / activeDeployment.devices_total) * 100)}%`\r\n                      : '0%'}\r\n                  </div>\r\n                  <div>\r\n                    <strong>Started:</strong> {new Date(activeDeployment.created_at).toLocaleString()}\r\n                  </div>\r\n                </div>\r\n                {activeDeployment.notes && (\r\n                  <div style={{ marginTop: '1rem', fontSize: '0.85rem', opacity: 0.9 }}>\r\n                    <strong>Notes:</strong> {activeDeployment.notes}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n            \r\n            {/* Summary Metrics */}\r\n        <div style={{ \r\n          display: 'grid', \r\n          gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', \r\n          gap: '1rem',\r\n          marginBottom: '2rem'\r\n        }}>\r\n          <div style={{\r\n            background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n            color: 'white',\r\n            padding: '1.25rem',\r\n            borderRadius: '12px',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: '700', marginBottom: '0.25rem' }}>{statusMetrics.total}</div>\r\n            <div style={{ fontSize: '0.85rem', opacity: 0.9 }}>Total Devices</div>\r\n          </div>\r\n          \r\n          <div style={{\r\n            background: '#17a2b8',\r\n            color: 'white',\r\n            padding: '1.25rem',\r\n            borderRadius: '12px',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: '700', marginBottom: '0.25rem' }}>{statusMetrics.inProgress}</div>\r\n            <div style={{ fontSize: '0.85rem', opacity: 0.9 }}>In Progress</div>\r\n          </div>\r\n          \r\n          <div style={{\r\n            background: '#28a745',\r\n            color: 'white',\r\n            padding: '1.25rem',\r\n            borderRadius: '12px',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: '700', marginBottom: '0.25rem' }}>{statusMetrics.healthy}</div>\r\n            <div style={{ fontSize: '0.85rem', opacity: 0.9 }}>Healthy</div>\r\n          </div>\r\n          \r\n          <div style={{\r\n            background: '#dc3545',\r\n            color: 'white',\r\n            padding: '1.25rem',\r\n            borderRadius: '12px',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: '700', marginBottom: '0.25rem' }}>{statusMetrics.failed}</div>\r\n            <div style={{ fontSize: '0.85rem', opacity: 0.9 }}>Failed</div>\r\n          </div>\r\n          \r\n          <div style={{\r\n            background: '#6610f2',\r\n            color: 'white',\r\n            padding: '1.25rem',\r\n            borderRadius: '12px',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: '700', marginBottom: '0.25rem' }}>{statusMetrics.rolledBack}</div>\r\n            <div style={{ fontSize: '0.85rem', opacity: 0.9 }}>Rolled Back</div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Status Filter */}\r\n        <div style={{ marginBottom: '1rem', display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>\r\n          {['all', 'idle', 'downloading', 'flashing', 'rebooting', 'trial', 'healthy', 'failed', 'rolledback'].map(status => (\r\n            <button\r\n              key={status}\r\n              onClick={() => setStatusFilter(status as any)}\r\n              style={{\r\n                background: statusFilter === status ? '#667eea' : (isDark ? '#242424' : '#f8f9fa'),\r\n                color: statusFilter === status ? 'white' : (isDark ? '#e0e0e0' : '#495057'),\r\n                border: isDark ? '1px solid #404040' : '1px solid #dee2e6',\r\n                padding: '0.5rem 1rem',\r\n                borderRadius: '20px',\r\n                fontSize: '0.85rem',\r\n                fontWeight: '500',\r\n                cursor: 'pointer',\r\n                textTransform: 'capitalize'\r\n              }}\r\n            >\r\n              {status}\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Device Status Table */}\r\n        <div style={{ overflowX: 'auto', maxHeight: '500px', overflowY: 'auto' }}>\r\n          <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.9rem' }}>\r\n            <thead style={{ position: 'sticky', top: 0, background: isDark ? '#242424' : '#f8f9fa', zIndex: 1 }}>\r\n              <tr style={{ borderBottom: isDark ? '2px solid #404040' : '2px solid #dee2e6' }}>\r\n                <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057' }}>Device ID</th>\r\n                <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057' }}>Current</th>\r\n                <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057' }}>Target</th>\r\n                <th style={{ padding: '0.75rem', textAlign: 'center', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057' }}>Slot</th>\r\n                <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057' }}>Status</th>\r\n                <th style={{ padding: '0.75rem', textAlign: 'center', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057' }}>Boot Count</th>\r\n                <th style={{ padding: '0.75rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : '#495057' }}>Last Error</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {filteredDevices.map(device => (\r\n                <tr key={device.deviceId} style={{ borderBottom: isDark ? '1px solid #404040' : '1px solid #e9ecef' }}>\r\n                  <td style={{ padding: '0.75rem', fontFamily: 'monospace', fontWeight: '500' }}>{device.deviceId}</td>\r\n                  <td style={{ padding: '0.75rem', fontFamily: 'monospace', fontSize: '0.85rem' }}>{device.currentVersion}</td>\r\n                  <td style={{ padding: '0.75rem', fontFamily: 'monospace', fontSize: '0.85rem' }}>{device.targetVersion}</td>\r\n                  <td style={{ padding: '0.75rem', textAlign: 'center' }}>\r\n                    <span style={{\r\n                      background: device.activeSlot === 'A' ? '#e3f2fd' : '#fff3e0',\r\n                      color: device.activeSlot === 'A' ? '#1976d2' : '#f57c00',\r\n                      padding: '0.25rem 0.5rem',\r\n                      borderRadius: '6px',\r\n                      fontWeight: '600',\r\n                      fontSize: '0.75rem'\r\n                    }}>\r\n                      {device.activeSlot}\r\n                    </span>\r\n                  </td>\r\n                  <td style={{ padding: '0.75rem' }}>\r\n                    <span style={getStatusBadgeStyle(device.status)}>\r\n                      {device.status === 'trial' ? 'Notified' : device.status}\r\n                    </span>\r\n                    {device.status === 'downloading' && device.progress !== undefined && (\r\n                      <div style={{ marginTop: '0.35rem' }}>\r\n                        <div style={{ background: isDark ? '#404040' : '#e9ecef', borderRadius: 4, height: 6, overflow: 'hidden' }}>\r\n                          <div style={{ width: `${device.progress}%`, background: '#17a2b8', height: '100%', transition: 'width 0.3s ease' }} />\r\n                        </div>\r\n                        <span style={{ fontSize: '0.7rem', color: isDark ? '#a0a0a0' : '#6c757d' }}>{device.progress}%</span>\r\n                      </div>\r\n                    )}\r\n                    {device.lastCheckedAt && (\r\n                      <div style={{ fontSize: '0.7rem', color: isDark ? '#888' : '#999', marginTop: 2 }}>\r\n                        {new Date(device.lastCheckedAt).toLocaleTimeString()}\r\n                      </div>\r\n                    )}\r\n                  </td>\r\n                  <td style={{ padding: '0.75rem', textAlign: 'center', fontSize: '0.9rem' }}>{device.bootCount}</td>\r\n                  <td style={{ padding: '0.75rem', fontSize: '0.85rem', color: device.lastError ? '#dc3545' : (isDark ? '#a0a0a0' : '#6c757d') }}>\r\n                    {device.lastError || '-'}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n          </>\r\n        )}\r\n      </div>\r\n\r\n      {/* SECTION 4: Emergency Rollback */}\r\n      <div style={{ \r\n        background: isDark ? '#2d2d2d' : 'white', \r\n        borderRadius: '12px', \r\n        padding: '2rem',\r\n        boxShadow: isDark ? '0 2px 8px rgba(0,0,0,0.3)' : '0 2px 8px rgba(0,0,0,0.08)',\r\n        border: isDark ? '2px solid #dc3545' : '2px solid #dc3545'\r\n      }}>\r\n        <h2 style={{ \r\n          fontSize: '1.5rem', \r\n          fontWeight: '600', \r\n          color: '#dc3545',\r\n          marginBottom: '1rem',\r\n          paddingBottom: '0.75rem',\r\n          borderBottom: isDark ? '2px solid #5a1f24' : '2px solid #f8d7da',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: '0.5rem'\r\n        }}>\r\n          <span style={{ fontSize: '1.25rem' }}></span>\r\n          Emergency Rollback\r\n        </h2>\r\n        \r\n        <div style={{\r\n          background: isDark ? '#3d1a1a' : '#f8d7da',\r\n          border: isDark ? '1px solid #5a1f24' : '1px solid #f5c6cb',\r\n          borderRadius: '8px',\r\n          padding: '1rem',\r\n          marginBottom: '1.5rem',\r\n          color: isDark ? '#ff9999' : '#721c24'\r\n        }}>\r\n          <strong> Warning:</strong> Use this feature only in emergency situations. Rollback command will revert devices to their previous firmware version automatically.\r\n        </div>\r\n\r\n        <div style={{ marginBottom: '1.5rem', padding: '1rem', background: isDark ? '#1a2a3a' : '#e7f3ff', border: isDark ? '1px solid #2a4a6a' : '1px solid #b3d9ff', borderRadius: '8px', color: isDark ? '#66b2ff' : '#004085' }}>\r\n          <strong> How it works:</strong> The rollback sends an <code style={{ background: isDark ? '#0d1117' : '#fff', padding: '0.2rem 0.5rem', borderRadius: '4px', fontFamily: 'monospace', color: isDark ? '#e0e0e0' : 'inherit' }}>updateConfig</code> command with value <code style={{ background: isDark ? '#0d1117' : '#fff', padding: '0.2rem 0.5rem', borderRadius: '4px', fontFamily: 'monospace', color: isDark ? '#e0e0e0' : 'inherit' }}>2</code> to selected devices, triggering them to automatically revert to their previous firmware version.\r\n        </div>\r\n\r\n        <div>\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.9rem' }}>\r\n              Rollback Reason *\r\n            </label>\r\n            <textarea\r\n              value={rollbackForm.reason}\r\n              onChange={(e) => setRollbackForm({ ...rollbackForm, reason: e.target.value })}\r\n              placeholder=\"Reason for emergency rollback...\"\r\n              rows={3}\r\n              style={{ \r\n                width: '100%', \r\n                padding: '0.75rem', \r\n                borderRadius: '6px', \r\n                border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                fontSize: '0.95rem',\r\n                fontFamily: 'inherit',\r\n                resize: 'vertical',\r\n                background: isDark ? '#1a1a1a' : 'white',\r\n                color: isDark ? '#e0e0e0' : 'inherit'\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Device Selection Filters */}\r\n        <div style={{ marginTop: '1.5rem' }}>\r\n          <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1rem', color: isDark ? '#e0e0e0' : '#495057' }}>\r\n            Device Selection & Filters\r\n          </h3>\r\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem', marginBottom: '1rem' }}>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>\r\n                Filter by Current Version\r\n              </label>\r\n              <select\r\n                value={rollbackFilters.currentVersion}\r\n                onChange={(e) => setRollbackFilters({ ...rollbackFilters, currentVersion: e.target.value })}\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.5rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.9rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              >\r\n                <option value=\"all\">All Versions</option>\r\n                {Array.from(new Set(devices.map(d => d.currentVersion))).map(version => (\r\n                  <option key={version} value={version}>{version}</option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>\r\n                Filter by Status\r\n              </label>\r\n              <select\r\n                value={rollbackFilters.status}\r\n                onChange={(e) => setRollbackFilters({ ...rollbackFilters, status: e.target.value })}\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.5rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.9rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              >\r\n                <option value=\"all\">All Statuses</option>\r\n                <option value=\"failed\">Failed</option>\r\n                <option value=\"healthy\">Healthy</option>\r\n                <option value=\"trial\">Trial</option>\r\n                <option value=\"downloading\">Downloading</option>\r\n                <option value=\"flashing\">Flashing</option>\r\n                <option value=\"rebooting\">Rebooting</option>\r\n                <option value=\"rolledback\">Rolled Back</option>\r\n                <option value=\"idle\">Idle</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500', color: isDark ? '#b0b0b0' : '#495057', fontSize: '0.85rem' }}>\r\n                Filter by Target Version\r\n              </label>\r\n              <select\r\n                value={rollbackFilters.deviceModel}\r\n                onChange={(e) => setRollbackFilters({ ...rollbackFilters, deviceModel: e.target.value })}\r\n                style={{ \r\n                  width: '100%', \r\n                  padding: '0.5rem', \r\n                  borderRadius: '6px', \r\n                  border: isDark ? '1px solid #404040' : '1px solid #ced4da',\r\n                  fontSize: '0.9rem',\r\n                  background: isDark ? '#1a1a1a' : 'white',\r\n                  color: isDark ? '#e0e0e0' : 'inherit'\r\n                }}\r\n              >\r\n                <option value=\"all\">All Target Versions</option>\r\n                {Array.from(new Set(devices.map(d => d.targetVersion))).map(version => (\r\n                  <option key={version} value={version}>{version}</option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Quick Selection Buttons */}\r\n          <div style={{ display: 'flex', gap: '0.75rem', flexWrap: 'wrap', marginBottom: '1rem' }}>\r\n            <button\r\n              onClick={selectAllFilteredDevices}\r\n              style={{\r\n                background: '#007bff',\r\n                color: 'white',\r\n                border: 'none',\r\n                padding: '0.5rem 1rem',\r\n                borderRadius: '6px',\r\n                fontSize: '0.85rem',\r\n                fontWeight: '600',\r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              Select All Filtered ({getFilteredRollbackDevices().length})\r\n            </button>\r\n\r\n            <button\r\n              onClick={deselectAllDevices}\r\n              style={{\r\n                background: '#6c757d',\r\n                color: 'white',\r\n                border: 'none',\r\n                padding: '0.5rem 1rem',\r\n                borderRadius: '6px',\r\n                fontSize: '0.85rem',\r\n                fontWeight: '600',\r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              Deselect All\r\n            </button>\r\n\r\n            <button\r\n              onClick={() => {\r\n                const failedDevices = devices.filter(d => d.status === 'failed').map(d => d.deviceId);\r\n                setRollbackForm({ ...rollbackForm, selectedDevices: failedDevices });\r\n              }}\r\n              style={{\r\n                background: '#ffc107',\r\n                color: '#000',\r\n                border: 'none',\r\n                padding: '0.5rem 1rem',\r\n                borderRadius: '6px',\r\n                fontSize: '0.85rem',\r\n                fontWeight: '600',\r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              Select Failed Only ({devices.filter(d => d.status === 'failed').length})\r\n            </button>\r\n\r\n            <button\r\n              onClick={() => {\r\n                const problemDevices = devices.filter(d => ['failed', 'rolledback'].includes(d.status)).map(d => d.deviceId);\r\n                setRollbackForm({ ...rollbackForm, selectedDevices: problemDevices });\r\n              }}\r\n              style={{\r\n                background: '#fd7e14',\r\n                color: 'white',\r\n                border: 'none',\r\n                padding: '0.5rem 1rem',\r\n                borderRadius: '6px',\r\n                fontSize: '0.85rem',\r\n                fontWeight: '600',\r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              Select Problem Devices ({devices.filter(d => ['failed', 'rolledback'].includes(d.status)).length})\r\n            </button>\r\n          </div>\r\n\r\n          {/* Device Selection Table */}\r\n          <div style={{ \r\n            background: isDark ? '#242424' : '#f8f9fa', \r\n            borderRadius: '8px', \r\n            padding: '1rem',\r\n            border: isDark ? '1px solid #404040' : '1px solid #dee2e6',\r\n            maxHeight: '400px',\r\n            overflowY: 'auto'\r\n          }}>\r\n            <div style={{ marginBottom: '0.75rem', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n              <strong style={{ fontSize: '0.95rem', color: isDark ? '#e0e0e0' : 'inherit' }}>\r\n                Devices List ({getFilteredRollbackDevices().length} available, {rollbackForm.selectedDevices.length} selected)\r\n              </strong>\r\n            </div>\r\n            \r\n            {loadingDevices ? (\r\n              <div style={{ padding: '2rem', textAlign: 'center', color: isDark ? '#a0a0a0' : '#6c757d' }}>\r\n                Loading devices...\r\n              </div>\r\n            ) : getFilteredRollbackDevices().length === 0 ? (\r\n              <div style={{ padding: '2rem', textAlign: 'center', color: isDark ? '#a0a0a0' : '#6c757d' }}>\r\n                No devices match the current filters\r\n              </div>\r\n            ) : (\r\n              <table style={{ width: '100%', fontSize: '0.85rem' }}>\r\n                <thead>\r\n                  <tr style={{ borderBottom: isDark ? '2px solid #404040' : '2px solid #dee2e6' }}>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', fontWeight: '600', width: '50px', color: isDark ? '#b0b0b0' : 'inherit' }}>\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={getFilteredRollbackDevices().length > 0 && getFilteredRollbackDevices().every(d => rollbackForm.selectedDevices.includes(d.deviceId))}\r\n                        onChange={(e) => {\r\n                          if (e.target.checked) {\r\n                            selectAllFilteredDevices();\r\n                          } else {\r\n                            deselectAllDevices();\r\n                          }\r\n                        }}\r\n                        style={{ cursor: 'pointer', width: '16px', height: '16px' }}\r\n                      />\r\n                    </th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : 'inherit' }}>Device ID</th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : 'inherit' }}>Current Version</th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : 'inherit' }}>Target Version</th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : 'inherit' }}>Status</th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : 'inherit' }}>Boot Count</th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', fontWeight: '600', color: isDark ? '#b0b0b0' : 'inherit' }}>Last Error</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {getFilteredRollbackDevices().map(device => (\r\n                    <tr \r\n                      key={device.deviceId} \r\n                      style={{ \r\n                        borderBottom: isDark ? '1px solid #404040' : '1px solid #e9ecef',\r\n                        background: rollbackForm.selectedDevices.includes(device.deviceId) ? (isDark ? '#3a2a00' : '#fff3cd') : 'transparent',\r\n                        cursor: 'pointer'\r\n                      }}\r\n                      onClick={() => toggleRollbackDevice(device.deviceId)}\r\n                    >\r\n                      <td style={{ padding: '0.75rem 0.5rem' }}>\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={rollbackForm.selectedDevices.includes(device.deviceId)}\r\n                          onChange={() => toggleRollbackDevice(device.deviceId)}\r\n                          onClick={(e) => e.stopPropagation()}\r\n                          style={{ cursor: 'pointer', width: '16px', height: '16px' }}\r\n                        />\r\n                      </td>\r\n                      <td style={{ padding: '0.75rem 0.5rem', fontFamily: 'monospace', fontWeight: '500' }}>{device.deviceId}</td>\r\n                      <td style={{ padding: '0.75rem 0.5rem', fontFamily: 'monospace' }}>{device.currentVersion}</td>\r\n                      <td style={{ padding: '0.75rem 0.5rem', fontFamily: 'monospace' }}>{device.targetVersion}</td>\r\n                      <td style={{ padding: '0.75rem 0.5rem' }}>\r\n                        <span style={{\r\n                          padding: '0.25rem 0.5rem',\r\n                          borderRadius: '4px',\r\n                          fontSize: '0.75rem',\r\n                          fontWeight: '600',\r\n                          background: device.status === 'failed' ? (isDark ? '#3d1a1a' : '#f8d7da') : \r\n                                     device.status === 'healthy' ? (isDark ? '#1a3d1a' : '#d4edda') : \r\n                                     device.status === 'downloading' || device.status === 'flashing' ? (isDark ? '#1a2a3a' : '#cce5ff') :\r\n                                     device.status === 'rolledback' ? (isDark ? '#3a2a00' : '#fff3cd') : (isDark ? '#2a2a2a' : '#e9ecef'),\r\n                          color: device.status === 'failed' ? (isDark ? '#ff9999' : '#721c24') : \r\n                                 device.status === 'healthy' ? (isDark ? '#99ff99' : '#155724') : \r\n                                 device.status === 'downloading' || device.status === 'flashing' ? (isDark ? '#66b2ff' : '#004085') :\r\n                                 device.status === 'rolledback' ? (isDark ? '#ffd966' : '#856404') : (isDark ? '#b0b0b0' : '#495057')\r\n                        }}>\r\n                          {device.status}\r\n                        </span>\r\n                      </td>\r\n                      <td style={{ padding: '0.75rem 0.5rem' }}>{device.bootCount}</td>\r\n                      <td style={{ padding: '0.75rem 0.5rem', color: device.lastError ? '#dc3545' : (isDark ? '#a0a0a0' : '#6c757d'), fontSize: '0.8rem' }}>\r\n                        {device.lastError || 'None'}\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Rollback Action Button */}\r\n        <div style={{ marginTop: '1.5rem', display: 'flex', justifyContent: 'flex-end' }}>\r\n          <button\r\n            onClick={handleEmergencyRollback}\r\n            disabled={rollbackForm.selectedDevices.length === 0}\r\n            style={{\r\n              background: rollbackForm.selectedDevices.length === 0 ? '#6c757d' : '#dc3545',\r\n              color: 'white',\r\n              border: 'none',\r\n              padding: '0.75rem 2rem',\r\n              borderRadius: '8px',\r\n              fontSize: '1rem',\r\n              fontWeight: '600',\r\n              cursor: rollbackForm.selectedDevices.length === 0 ? 'not-allowed' : 'pointer',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              opacity: rollbackForm.selectedDevices.length === 0 ? 0.6 : 1\r\n            }}\r\n          >\r\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n              <polyline points=\"1 4 1 10 7 10\"/>\r\n              <path d=\"M3.51 15a9 9 0 1 0 2.13-9.36L1 10\"/>\r\n            </svg>\r\n            Rollback {rollbackForm.selectedDevices.length} Device{rollbackForm.selectedDevices.length !== 1 ? 's' : ''}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Rollback Confirmation Modal */}\r\n      {showRollbackModal && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: 'rgba(0,0,0,0.6)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          zIndex: 1000\r\n        }}>\r\n          <div style={{\r\n            background: isDark ? '#2d2d2d' : 'white',\r\n            borderRadius: '12px',\r\n            padding: '2rem',\r\n            maxWidth: '500px',\r\n            width: '90%',\r\n            boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n            border: isDark ? '2px solid #dc3545' : '2px solid #dc3545'\r\n          }}>\r\n            <h3 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1rem', color: '#dc3545' }}>\r\n               Confirm Emergency Rollback\r\n            </h3>\r\n            <div style={{\r\n              background: isDark ? '#3d1a1a' : '#f8d7da',\r\n              border: isDark ? '1px solid #5a1f24' : '1px solid #f5c6cb',\r\n              borderRadius: '8px',\r\n              padding: '1rem',\r\n              marginBottom: '1.5rem',\r\n              color: isDark ? '#ff9999' : '#721c24',\r\n              fontSize: '0.95rem'\r\n            }}>\r\n              <strong>This action cannot be undone!</strong>\r\n              <p style={{ margin: '0.5rem 0 0 0' }}>\r\n                You are about to rollback devices to a previous firmware version.\r\n              </p>\r\n            </div>\r\n            <div style={{ marginBottom: '1.5rem', color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.8' }}>\r\n              <p><strong>Command:</strong> <code style={{ background: isDark ? '#1a1a1a' : '#f8f9fa', padding: '0.2rem 0.5rem', borderRadius: '4px', fontFamily: 'monospace', color: isDark ? '#e0e0e0' : 'inherit' }}>updateConfig = 2</code> (automatic rollback to previous version)</p>\r\n              <p><strong>Devices to Rollback:</strong> {rollbackForm.selectedDevices.length}</p>\r\n              <p><strong>Reason:</strong> {rollbackForm.reason || 'Not provided'}</p>\r\n            </div>\r\n            <div style={{ display: 'flex', gap: '1rem', justifyContent: 'flex-end' }}>\r\n              <button\r\n                onClick={() => setShowRollbackModal(false)}\r\n                style={{\r\n                  background: '#6c757d',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '0.75rem 1.5rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '1rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer'\r\n                }}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={confirmRollback}\r\n                style={{\r\n                  background: '#dc3545',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '0.75rem 1.5rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '1rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer'\r\n                }}\r\n              >\r\n                Confirm Rollback\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Generic Confirm-Action Modal  used for delete, deactivate, and any future destructive action */}\r\n      {confirmActionModal.show && (\r\n        <div style={{\r\n          position: 'fixed', top: 0, left: 0, right: 0, bottom: 0,\r\n          background: 'rgba(0,0,0,0.6)', display: 'flex', alignItems: 'center',\r\n          justifyContent: 'center', zIndex: 1000, backdropFilter: 'blur(4px)'\r\n        }}>\r\n          <div style={{\r\n            background: isDark ? '#2d2d2d' : 'white', borderRadius: '16px', padding: '2rem',\r\n            maxWidth: '500px', width: '90%',\r\n            boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n            border: `2px solid ${confirmActionModal.accentColor}`,\r\n            animation: 'slideIn 0.2s ease-out'\r\n          }}>\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '1.5rem' }}>\r\n              <div style={{\r\n                width: '48px', height: '48px', borderRadius: '12px', flexShrink: 0,\r\n                background: `linear-gradient(135deg, ${confirmActionModal.accentColor} 0%, ${confirmActionModal.accentColor}cc 100%)`,\r\n                display: 'flex', alignItems: 'center', justifyContent: 'center',\r\n                fontSize: '1.5rem', animation: 'pulse 2s infinite'\r\n              }}>\r\n                {confirmActionModal.icon}\r\n              </div>\r\n              <h3 style={{ fontSize: '1.5rem', fontWeight: '600', margin: 0, color: confirmActionModal.accentColor }}>\r\n                {confirmActionModal.title}\r\n              </h3>\r\n            </div>\r\n\r\n            <div style={{ marginBottom: '1.5rem', color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.6' }}>\r\n              <p style={{ marginBottom: '1rem' }}>{confirmActionModal.message}</p>\r\n              <div style={{\r\n                background: isDark ? 'rgba(128,128,128,0.12)' : '#f8f9fa',\r\n                border: `1px solid ${confirmActionModal.accentColor}55`,\r\n                borderRadius: '8px', padding: '0.75rem 1rem',\r\n                fontSize: '0.9rem', color: isDark ? '#ccc' : '#555'\r\n              }}>\r\n                {confirmActionModal.warningText}\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{ display: 'flex', gap: '0.75rem', justifyContent: 'flex-end' }}>\r\n              <button\r\n                onClick={() => setConfirmActionModal(m => ({ ...m, show: false }))}\r\n                style={{\r\n                  background: isDark ? '#3a3a3a' : '#e0e0e0', color: isDark ? '#e0e0e0' : '#495057',\r\n                  border: 'none', padding: '0.75rem 1.5rem', borderRadius: '8px',\r\n                  fontSize: '0.95rem', fontWeight: '600', cursor: 'pointer', transition: 'all 0.2s'\r\n                }}\r\n                onMouseOver={e => e.currentTarget.style.background = isDark ? '#4a4a4a' : '#d0d0d0'}\r\n                onMouseOut={e => e.currentTarget.style.background = isDark ? '#3a3a3a' : '#e0e0e0'}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={async () => {\r\n                  const action = confirmActionModal.onConfirm;\r\n                  setConfirmActionModal(m => ({ ...m, show: false }));\r\n                  try { await action(); }\r\n                  catch (err: any) { setErrorModal({ show: true, message: err.message || 'Operation failed' }); }\r\n                }}\r\n                style={{\r\n                  background: `linear-gradient(135deg, ${confirmActionModal.accentColor} 0%, ${confirmActionModal.accentColor}cc 100%)`,\r\n                  color: 'white', border: 'none', padding: '0.75rem 1.5rem', borderRadius: '8px',\r\n                  fontSize: '0.95rem', fontWeight: '600', cursor: 'pointer',\r\n                  boxShadow: `0 4px 12px ${confirmActionModal.accentColor}44`, transition: 'all 0.2s'\r\n                }}\r\n                onMouseOver={e => e.currentTarget.style.transform = 'translateY(-1px)'}\r\n                onMouseOut={e => e.currentTarget.style.transform = 'translateY(0)'}\r\n              >\r\n                {confirmActionModal.confirmLabel}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modern Success Notification Modal */}\r\n      {successModal.show && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: 'rgba(0,0,0,0.4)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          zIndex: 1000,\r\n          backdropFilter: 'blur(2px)'\r\n        }}>\r\n          <div style={{\r\n            background: isDark ? '#2d2d2d' : 'white',\r\n            borderRadius: '16px',\r\n            padding: '2rem',\r\n            maxWidth: '450px',\r\n            width: '90%',\r\n            boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n            border: isDark ? '1px solid #28a745' : '2px solid #28a745',\r\n            animation: 'slideIn 0.2s ease-out'\r\n          }}>\r\n            <div style={{ textAlign: 'center' }}>\r\n              <div style={{\r\n                width: '64px',\r\n                height: '64px',\r\n                borderRadius: '50%',\r\n                background: 'linear-gradient(135deg, #28a745 0%, #20c997 100%)',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                fontSize: '2rem',\r\n                margin: '0 auto 1rem',\r\n                animation: 'scaleIn 0.3s ease-out'\r\n              }}>\r\n                \r\n              </div>\r\n              \r\n              <h3 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1rem', color: isDark ? '#e0e0e0' : '#2c3e50' }}>\r\n                Success\r\n              </h3>\r\n              \r\n              <p style={{ color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.6', marginBottom: '1.5rem', whiteSpace: 'pre-line' }}>\r\n                {successModal.message}\r\n              </p>\r\n              \r\n              <button\r\n                onClick={() => setSuccessModal({ show: false, message: '' })}\r\n                style={{\r\n                  background: 'linear-gradient(135deg, #28a745 0%, #20c997 100%)',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '0.75rem 2rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '0.95rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer',\r\n                  boxShadow: '0 4px 12px rgba(40, 167, 69, 0.3)',\r\n                  transition: 'all 0.2s'\r\n                }}\r\n                onMouseOver={e => e.currentTarget.style.transform = 'translateY(-1px)'}\r\n                onMouseOut={e => e.currentTarget.style.transform = 'translateY(0)'}\r\n              >\r\n                Got it!\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modern Error Notification Modal */}\r\n      {errorModal.show && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: 'rgba(0,0,0,0.4)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          zIndex: 1000,\r\n          backdropFilter: 'blur(2px)'\r\n        }}>\r\n          <div style={{\r\n            background: isDark ? '#2d2d2d' : 'white',\r\n            borderRadius: '16px',\r\n            padding: '2rem',\r\n            maxWidth: '450px',\r\n            width: '90%',\r\n            boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n            border: isDark ? '2px solid #dc3545' : '2px solid #dc3545',\r\n            animation: 'slideIn 0.2s ease-out'\r\n          }}>\r\n            <div style={{ textAlign: 'center' }}>\r\n              <div style={{\r\n                width: '64px',\r\n                height: '64px',\r\n                borderRadius: '50%',\r\n                background: 'linear-gradient(135deg, #dc3545 0%, #c82333 100%)',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                fontSize: '2rem',\r\n                margin: '0 auto 1rem',\r\n                animation: 'pulse 2s infinite'\r\n              }}>\r\n                \r\n              </div>\r\n              \r\n              <h3 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1rem', color: '#dc3545' }}>\r\n                Error\r\n              </h3>\r\n              \r\n              <p style={{ color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.6', marginBottom: '1.5rem', whiteSpace: 'pre-line' }}>\r\n                {errorModal.message}\r\n              </p>\r\n              \r\n              <button\r\n                onClick={() => setErrorModal({ show: false, message: '' })}\r\n                style={{\r\n                  background: 'linear-gradient(135deg, #dc3545 0%, #c82333 100%)',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '0.75rem 2rem',\r\n                  borderRadius: '8px',\r\n                  fontSize: '0.95rem',\r\n                  fontWeight: '600',\r\n                  cursor: 'pointer',\r\n                  boxShadow: '0 4px 12px rgba(220, 53, 69, 0.3)',\r\n                  transition: 'all 0.2s'\r\n                }}\r\n                onMouseOver={e => e.currentTarget.style.transform = 'translateY(-1px)'}\r\n                onMouseOut={e => e.currentTarget.style.transform = 'translateY(0)'}\r\n              >\r\n                Dismiss\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OTA;\r\n"],"names":["OTA","_activeDeployment$dev","_activeDeployment$tar","isDark","useTheme","firmwares","setFirmwares","useState","uploadForm","setUploadForm","name","version","deviceModel","minBootloader","releaseNotes","file","deploymentConfig","setDeploymentConfig","firmwareVersion","targetDevices","mode","autoRollback","healthTimeout","failureThreshold","confirmModal","setConfirmModal","show","firmware","deviceCount","dataTransfer","isDeploying","setIsDeploying","devices","setDevices","statusFilter","setStatusFilter","loadingDevices","setLoadingDevices","loadingFirmwares","setLoadingFirmwares","activeDeployment","setActiveDeployment","rollbackForm","setRollbackForm","selectedDevices","reason","showRollbackModal","setShowRollbackModal","rollbackFilters","setRollbackFilters","currentVersion","status","confirmActionModal","setConfirmActionModal","title","message","warningText","confirmLabel","accentColor","icon","onConfirm","async","successModal","setSuccessModal","errorModal","setErrorModal","useEffect","loadFirmwareData","loadDevices","loadDeployments","interval","setInterval","clearInterval","response","apiService","getFirmwareVersions","transformedFirmwares","results","map","fw","_fw$description","_fw$description$match","id","filename","concat","description","match","minBootloaderVersion","size","checksum","signatureValid","is_active","release_notes","uploadDate","created_at","Date","toISOString","error","console","getDevices","realDevices","transformedDevices","Array","isArray","device","deviceId","device_serial","serial","firmware_version","config_version","targetVersion","activeSlot","Math","random","bootCount","boot_count","lastError","progress","undefined","campaigns","listTargetedUpdates","displayCampaign","find","c","updateDeployedDeviceStatuses","_campaignDetail$targe","_campaignDetail$targe2","activeDeploymentToUse","deployment","campaignDetail","getTargetedUpdate","targetedDevices","device_targets","length","firmwareSize","target_firmware","mapBackendStatus","backendStatus","toLowerCase","updateMap","Map","dt","_dt$device","deviceSerial","mappedStatus","log_status","bytesDownloaded","log_bytes_downloaded","round","log_error","lastCheckedAt","log_last_checked_at","filter","entry","prevDevices","update","get","_objectSpread","statusMetrics","total","inProgress","d","includes","healthy","failed","devices_failed","rolledBack","toggleRollbackDevice","prev","getFilteredRollbackDevices","selectAllFilteredDevices","filtered","deselectAllDevices","filteredDevices","_jsxs","style","padding","maxWidth","margin","background","minHeight","children","marginBottom","fontSize","fontWeight","color","display","alignItems","gap","width","height","viewBox","fill","stroke","strokeWidth","_jsx","points","x1","y1","x2","y2","borderRadius","boxShadow","border","paddingBottom","borderBottom","onSubmit","e","preventDefault","_response$checksum","formData","FormData","append","uploadFirmwareVersion","toFixed","substring","fileInput","document","querySelector","value","gridTemplateColumns","type","onChange","target","placeholder","required","pattern","marginTop","rows","fontFamily","resize","accept","_e$target$files","files","buffer","arrayBuffer","hashBuffer","crypto","subtle","digest","from","Uint8Array","b","toString","padStart","join","calculateSHA256","log","disabled","whiteSpace","cursor","overflowX","borderCollapse","textAlign","colSpan","justifyContent","animation","cx","cy","r","opacity","toLocaleDateString","textTransform","onClick","updateFirmwareVersion","handleMarkAsStable","deleteFirmwareVersion","f","parseInt","min","max","handleSelectAllDevices","idleDevices","maxHeight","overflowY","_Fragment","checked","newTargets","marginRight","flexWrap","handleDeployClick","position","top","left","right","bottom","zIndex","lineHeight","Error","deployFirmware","devices_total","marginLeft","devices_updated","toLocaleString","notes","idle","downloading","flashing","rebooting","trial","rolledback","overflow","transition","toLocaleTimeString","Set","failedDevices","problemDevices","every","stopPropagation","handleEmergencyRollback","trim","Promise","all","triggerRollback","backdropFilter","flexShrink","m","onMouseOver","currentTarget","onMouseOut","action","err","transform"],"sourceRoot":""}