"use strict";(self.webpackChunksmart_solar_frontend=self.webpackChunksmart_solar_frontend||[]).push([[898],{898(e,s,t){t.r(s),t.d(s,{default:()=>o});var a=t(9379),r=t(5043),l=t(5560),n=t(9550),i=t(579);const o=()=>{const[e,s]=(0,r.useState)([]),[t,o]=(0,r.useState)([]),[d,c]=(0,r.useState)(!0),[m,u]=(0,r.useState)(null),[h,x]=(0,r.useState)(null),[p,j]=(0,r.useState)(!1),[f,g]=(0,r.useState)(""),[y,v]=(0,r.useState)({first_name:"",last_name:"",email:"",mobile_number:"",address:""}),[b,A]=(0,r.useState)({username:"",email:"",password:"",first_name:"",last_name:"",mobile_number:"",address:"",is_staff:!0});(0,r.useEffect)(()=>{w()},[]);const[_,N]=(0,r.useState)("");(0,r.useEffect)(()=>{const e=setTimeout(()=>{N(f)},300);return()=>clearTimeout(e)},[f]),(0,r.useEffect)(()=>{w(_)},[_]);const w=async e=>{try{const t=(await l.K.getUsers(e)).filter(e=>e.is_staff&&!e.is_superuser);s(t),o(t),c(!1)}catch(t){u(t instanceof Error?t.message:"An error occurred"),c(!1)}};return d?(0,i.jsx)("div",{className:"loading",children:"Loading employees..."}):m?(0,i.jsxs)("div",{className:"error",children:["Error: ",m]}):(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{children:"Employee Management"}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsxs)("h2",{children:["Employees (",t.length,")"]}),(0,i.jsxs)("div",{className:"card-actions",children:[(0,i.jsx)("input",{type:"text",placeholder:"Search employees...",value:f,onChange:e=>{g(e.target.value)},className:"search-input"}),(0,i.jsx)("button",{onClick:()=>j(!0),className:"btn",children:"Add New Employee"})]})]}),(0,i.jsxs)("table",{className:"table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{textAlign:"center"},children:"Name"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Username"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Email"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Mobile"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Joined"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:t.map(a=>(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{style:{textAlign:"center"},children:[a.first_name," ",a.last_name]}),(0,i.jsx)("td",{style:{textAlign:"center"},children:a.username}),(0,i.jsx)("td",{style:{textAlign:"center"},children:a.email}),(0,i.jsx)("td",{style:{textAlign:"center"},children:a.mobile_number||"-"}),(0,i.jsx)("td",{style:{textAlign:"center"},children:(()=>{if(!a.date_joined)return"N/A";const e=new Date(a.date_joined);return isNaN(e.getTime())?"Invalid Date":e.toLocaleDateString()})()}),(0,i.jsxs)("td",{style:{textAlign:"center"},children:[(0,i.jsx)("button",{onClick:()=>(e=>{x(e),v({first_name:e.first_name,last_name:e.last_name,email:e.email,mobile_number:e.mobile_number||"",address:e.address||""})})(a),style:{background:"none",border:"none",cursor:"pointer",color:"#6366f1",margin:"0 6px"},title:"Edit",children:(0,i.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,i.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,i.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),(0,i.jsx)("button",{onClick:()=>(async a=>{if(window.confirm("Are you sure you want to delete employee ".concat(a.username,"?")))try{await l.K.deleteUser(a.id),s(e.filter(e=>e.id!==a.id)),o(t.filter(e=>e.id!==a.id))}catch(r){u(r instanceof Error?r.message:"Failed to delete employee")}})(a),style:{background:"none",border:"none",cursor:"pointer",color:"#ef4444",margin:"0 6px"},title:"Delete",children:(0,i.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,i.jsx)("polyline",{points:"3,6 5,6 21,6"}),(0,i.jsx)("path",{d:"M19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2"}),(0,i.jsx)("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),(0,i.jsx)("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})})]})]},a.id))})]})]}),(h||p)&&(0,i.jsx)("div",{className:"modal",children:(0,i.jsxs)("div",{className:"modal-content",children:[(0,i.jsx)("h3",{children:h?"Edit Employee: ".concat(h.username):"Add New Employee"}),(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),h?(async()=>{if(h)try{await l.K.updateUser(h.id,y),x(null),await w(f)}catch(e){u(e instanceof Error?e.message:"Failed to update employee")}})():(async()=>{try{await l.K.createEmployee(b),j(!1),A({username:"",email:"",password:"",first_name:"",last_name:"",mobile_number:"",address:"",is_staff:!0}),await w(f)}catch(e){u(e instanceof Error?e.message:"Failed to create employee")}})()},children:[(0,i.jsxs)("div",{className:"modal-body",children:[(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsx)("h4",{className:"form-section-title",children:"Account Information"}),(0,i.jsxs)("div",{className:"form-grid",children:[p&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{type:"text",autoComplete:"username",style:{display:"none"}}),(0,i.jsx)("input",{type:"password",autoComplete:"current-password",style:{display:"none"}}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Username"}),(0,i.jsx)("input",{type:"text",value:b.username,onChange:e=>A((0,a.A)((0,a.A)({},b),{},{username:e.target.value})),required:!0,autoComplete:"off",placeholder:"jdoe"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Password"}),(0,i.jsx)("input",{type:"password",value:b.password,onChange:e=>A((0,a.A)((0,a.A)({},b),{},{password:e.target.value})),required:!0,autoComplete:"new-password",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Email Address"}),(0,i.jsx)("input",{type:"email",value:h?y.email:b.email,onChange:e=>h?v((0,a.A)((0,a.A)({},y),{},{email:e.target.value})):A((0,a.A)((0,a.A)({},b),{},{email:e.target.value})),required:!0,autoComplete:"off",placeholder:"john.doe@example.com"})]})]})]}),(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsx)("h4",{className:"form-section-title",children:"Personal Details"}),(0,i.jsxs)("div",{className:"form-grid form-grid-2",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"First Name"}),(0,i.jsx)("input",{type:"text",value:h?y.first_name:b.first_name,onChange:e=>h?v((0,a.A)((0,a.A)({},y),{},{first_name:e.target.value})):A((0,a.A)((0,a.A)({},b),{},{first_name:e.target.value})),required:!0,autoComplete:"off",placeholder:"John"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Last Name"}),(0,i.jsx)("input",{type:"text",value:h?y.last_name:b.last_name,onChange:e=>h?v((0,a.A)((0,a.A)({},y),{},{last_name:e.target.value})):A((0,a.A)((0,a.A)({},b),{},{last_name:e.target.value})),required:!0,autoComplete:"off",placeholder:"Doe"})]})]})]}),(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsx)("h4",{className:"form-section-title",children:"Contact Information"}),(0,i.jsxs)("div",{className:"form-grid",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Mobile Number"}),(0,i.jsx)("input",{type:"tel",value:h?y.mobile_number:b.mobile_number,onChange:e=>h?v((0,a.A)((0,a.A)({},y),{},{mobile_number:e.target.value})):A((0,a.A)((0,a.A)({},b),{},{mobile_number:e.target.value})),autoComplete:"off",placeholder:"+1 (555) 000-0000"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Address"}),(0,i.jsx)("textarea",{value:h?y.address:b.address,onChange:e=>h?v((0,a.A)((0,a.A)({},y),{},{address:e.target.value})):A((0,a.A)((0,a.A)({},b),{},{address:e.target.value})),autoComplete:"off",rows:3,placeholder:"123 Solar Street..."})]})]})]})]}),h&&(0,i.jsx)(n.A,{createdBy:h.created_by_username,createdAt:h.created_at,updatedBy:h.updated_by_username,updatedAt:h.updated_at}),(0,i.jsxs)("div",{className:"form-actions",children:[(0,i.jsx)("button",{type:"submit",className:"btn",children:h?"Save":"Create"}),(0,i.jsx)("button",{type:"button",onClick:()=>{x(null),j(!1)},className:"btn btn-secondary",children:"Cancel"})]})]})]})})]})}}}]);
//# sourceMappingURL=898.e00f7790.chunk.js.map