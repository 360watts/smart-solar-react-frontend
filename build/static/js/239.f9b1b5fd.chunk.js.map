{"version":3,"file":"static/js/239.f9b1b5fd.chunk.js","mappings":"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","sources":["components/AuditTrail.tsx","hooks/useDebounce.ts","components/SiteDataPanel.tsx","components/Devices.tsx","services/cacheService.ts","services/api.ts"],"sourcesContent":["import React from 'react';\r\n\r\ninterface AuditTrailProps {\r\n  createdBy?: string | null;\r\n  createdAt?: string;\r\n  updatedBy?: string | null;\r\n  updatedAt?: string;\r\n  className?: string;\r\n}\r\n\r\nconst AuditTrail: React.FC<AuditTrailProps> = ({\r\n  createdBy,\r\n  createdAt,\r\n  updatedBy,\r\n  updatedAt,\r\n  className = 'audit-trail',\r\n}) => {\r\n  const formatDate = (dateString?: string) => {\r\n    if (!dateString) return 'N/A';\r\n    try {\r\n      return new Date(dateString).toLocaleString();\r\n    } catch {\r\n      return dateString;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={className}>\r\n      <div className=\"audit-row\">\r\n        <span className=\"audit-label\">Created:</span>\r\n        {createdBy ? (\r\n          <span className=\"audit-value\">\r\n            by <strong>{createdBy}</strong> on {formatDate(createdAt)}\r\n          </span>\r\n        ) : (\r\n          <span className=\"audit-value\">System</span>\r\n        )}\r\n      </div>\r\n\r\n      {updatedBy && (\r\n        <div className=\"audit-row\">\r\n          <span className=\"audit-label\">Last Updated:</span>\r\n          <span className=\"audit-value\">\r\n            by <strong>{updatedBy}</strong> on {formatDate(updatedAt)}\r\n          </span>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default React.memo(AuditTrail);\r\n","import { useState, useEffect, useCallback } from 'react';\r\n\r\ninterface UseDebouncedValueOptions {\r\n  delay?: number;\r\n}\r\n\r\n/**\r\n * Custom hook to debounce a value with a delay\r\n * Useful for search inputs and other frequent updates\r\n */\r\nexport function useDebouncedValue<T>(\r\n  value: T,\r\n  options: UseDebouncedValueOptions = {}\r\n): T {\r\n  const { delay = 300 } = options;\r\n  const [debouncedValue, setDebouncedValue] = useState<T>(value);\r\n\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setDebouncedValue(value);\r\n    }, delay);\r\n\r\n    return () => clearTimeout(timer);\r\n  }, [value, delay]);\r\n\r\n  return debouncedValue;\r\n}\r\n\r\n/**\r\n * Custom hook to debounce a callback function\r\n * Useful for search, filtering, and other expensive operations\r\n */\r\nexport function useDebouncedCallback<T extends (...args: any[]) => any>(\r\n  callback: T,\r\n  delay: number = 300\r\n): (...args: Parameters<T>) => void {\r\n  const [timeoutId, setTimeoutId] = useState<NodeJS.Timeout | null>(null);\r\n\r\n  const debouncedCallback = useCallback(\r\n    (...args: Parameters<T>) => {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId);\r\n      }\r\n\r\n      const newTimeoutId = setTimeout(() => {\r\n        callback(...args);\r\n      }, delay);\r\n\r\n      setTimeoutId(newTimeoutId);\r\n    },\r\n    [callback, delay, timeoutId]\r\n  );\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId);\r\n      }\r\n    };\r\n  }, [timeoutId]);\r\n\r\n  return debouncedCallback;\r\n}\r\n\r\n/**\r\n * Custom hook for search input with debouncing\r\n * Returns a hook that handles search input changes with built-in debouncing\r\n */\r\nexport function useDebouncedSearch(\r\n  onSearch: (query: string) => void,\r\n  delay: number = 300\r\n) {\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const debouncedCallback = useDebouncedCallback(onSearch, delay);\r\n\r\n  const handleSearch = useCallback(\r\n    (query: string) => {\r\n      setSearchQuery(query);\r\n      debouncedCallback(query);\r\n    },\r\n    [debouncedCallback]\r\n  );\r\n\r\n  return {\r\n    searchQuery,\r\n    setSearchQuery,\r\n    handleSearch,\r\n  };\r\n}\r\n","/**\n * SiteDataPanel  reusable panel that fetches and visualises DynamoDB data\n * for a solar site. Accepts a siteId prop and shows:\n *  - 4 live KPI cards (PV power, battery SOC, load, energy today)\n *  - 24 h power history area chart\n *  - Today's ML forecast with p10/p50/p90 confidence bands\n *  - Latest weather observation\n */\nimport React, { useState, useEffect, useCallback } from 'react';\nimport {\n  AreaChart, Area, Line,\n  XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend, Brush, ReferenceLine\n} from 'recharts';\nimport html2canvas from 'html2canvas';\nimport { apiService } from '../services/api';\n// Custom tooltip for forecast chart\nconst ForecastTooltip = ({ active, payload, label }: any) => {\n  if (active && payload && payload.length) {\n    return (\n      <div style={{ background: 'rgba(255,255,255,0.97)', border: '1px solid #00a63e22', borderRadius: 10, padding: '0.7em 1.1em', boxShadow: '0 4px 16px #00a63e11', fontSize: 13, minWidth: 120 }}>\n        <div style={{ fontWeight: 700, color: '#00a63e', marginBottom: 2 }}>{label}</div>\n        {payload.map((entry: any) => (\n          <div key={entry.dataKey} style={{ color: entry.color, fontWeight: 600, margin: '2px 0' }}>\n            {entry.name}: <span style={{ fontFamily: 'JetBrains Mono, monospace' }}>{entry.value} kW</span>\n          </div>\n        ))}\n      </div>\n    );\n  }\n  return null;\n};\n\n//  helpers \n\nfunction fmt(ts: string, range: string): string {\n  // Format timestamp based on date range\n  try {\n    const date = new Date(ts);\n    if (range === '24h') {\n      // \"14:30\"\n      return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    } else if (range === '7d') {\n      // \"Mon 14:00\" for 7 days\n      return date.toLocaleDateString([], { weekday: 'short' }) + ' ' + \n             date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    } else {\n      // \"Feb 23\" for 30d or custom\n      return date.toLocaleDateString([], { month: 'short', day: 'numeric' });\n    }\n  } catch { return ts; }\n}\n\nfunction fmtForecast(ts: string, forecastFor?: string): string {\n  // Use forecast_for if available, otherwise parse from timestamp\n  // \"FORECAST#2026-02-23T14:30:00Z\"  \"14:30\"\n  const cleanTs = forecastFor || ts.replace('FORECAST#', '');\n  try {\n    return new Date(cleanTs).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n  } catch { return cleanTs; }\n}\n\nfunction aggregateByPeriod(data: any[], range: string): any[] {\n  // Aggregate telemetry data based on date range\n  if (!data || data.length === 0) return [];\n  \n  if (range === '24h') {\n    // 24h: downsample to ~48 points (every other 15-min = 30-min)\n    return data.filter((_, i) => i % 2 === 0 || i === data.length - 1);\n  } else if (range === '7d') {\n    // 7d: aggregate by hour (~168 points max)\n    const buckets = new Map<string, any[]>();\n    data.forEach(row => {\n      const date = new Date(row.timestamp);\n      const hourKey = `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}-${date.getHours()}`;\n      if (!buckets.has(hourKey)) buckets.set(hourKey, []);\n      buckets.get(hourKey)!.push(row);\n    });\n    \n    return Array.from(buckets.values()).map(bucket => {\n      const first = bucket[0];\n      return {\n        timestamp: first.timestamp,\n        pv1_power_w: bucket.reduce((sum, r) => sum + (r.pv1_power_w ?? 0), 0) / bucket.length,\n        pv2_power_w: bucket.reduce((sum, r) => sum + (r.pv2_power_w ?? 0), 0) / bucket.length,\n        load_power_w: bucket.reduce((sum, r) => sum + (r.load_power_w ?? 0), 0) / bucket.length,\n        grid_power_w: bucket.reduce((sum, r) => sum + (r.grid_power_w ?? 0), 0) / bucket.length,\n        battery_soc_percent: bucket.reduce((sum, r) => sum + (r.battery_soc_percent ?? 0), 0) / bucket.length,\n        pv_today_kwh: first.pv_today_kwh,\n      };\n    });\n  } else {\n    // 30d or custom: aggregate by day (max 30-90 points)\n    const buckets = new Map<string, any[]>();\n    data.forEach(row => {\n      const date = new Date(row.timestamp);\n      const dayKey = `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;\n      if (!buckets.has(dayKey)) buckets.set(dayKey, []);\n      buckets.get(dayKey)!.push(row);\n    });\n    \n    return Array.from(buckets.values()).map(bucket => {\n      const first = bucket[0];\n      // For daily aggregation, use averages for instantaneous values, max for daily energy\n      return {\n        timestamp: first.timestamp,\n        pv1_power_w: bucket.reduce((sum, r) => sum + (r.pv1_power_w ?? 0), 0) / bucket.length,\n        pv2_power_w: bucket.reduce((sum, r) => sum + (r.pv2_power_w ?? 0), 0) / bucket.length,\n        load_power_w: bucket.reduce((sum, r) => sum + (r.load_power_w ?? 0), 0) / bucket.length,\n        grid_power_w: bucket.reduce((sum, r) => sum + (r.grid_power_w ?? 0), 0) / bucket.length,\n        battery_soc_percent: bucket.reduce((sum, r) => sum + (r.battery_soc_percent ?? 0), 0) / bucket.length,\n        pv_today_kwh: Math.max(...bucket.map(r => r.pv_today_kwh ?? 0)),\n      };\n    });\n  }\n}\n\nconst TOOLTIP_STYLE = {\n  background: 'rgba(255,255,255,0.97)',\n  border: '1px solid rgba(0,166,62,0.15)',\n  borderRadius: 10,\n  color: '#0a0a0a',\n  boxShadow: '0 8px 24px rgba(0,0,0,0.1)',\n  fontSize: 12,\n};\n\n//  tiny inline icons \nconst IconSun = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#F07522\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <circle cx=\"12\" cy=\"12\" r=\"5\" fill=\"#FFD600\" stroke=\"#F07522\" strokeWidth=\"1.5\"/>\n    <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\"/>\n    <line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"23\"/>\n    <line x1=\"4.22\" y1=\"4.22\" x2=\"5.64\" y2=\"5.64\"/>\n    <line x1=\"18.36\" y1=\"18.36\" x2=\"19.78\" y2=\"19.78\"/>\n    <line x1=\"1\" y1=\"12\" x2=\"3\" y2=\"12\"/>\n    <line x1=\"21\" y1=\"12\" x2=\"23\" y2=\"12\"/>\n  </svg>\n);\nconst IconBattery = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <rect x=\"1\" y=\"6\" width=\"18\" height=\"12\" rx=\"2\"/>\n    <line x1=\"23\" y1=\"13\" x2=\"23\" y2=\"11\"/>\n    <rect x=\"3\" y=\"8\" width=\"10\" height=\"8\" fill=\"currentColor\" rx=\"1\"/>\n  </svg>\n);\nconst IconLoad = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z\"/>\n    <polyline points=\"9 22 9 12 15 12 15 22\"/>\n  </svg>\n);\nconst IconEnergy = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M13 2L3 14h9l-1 8 10-12h-9l1-8z\"/>\n  </svg>\n);\nconst IconCloud = () => (\n  <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M18 10h-1.26A8 8 0 109 20h9a5 5 0 000-10z\"/>\n  </svg>\n);\n\n//  sub-components \n\ninterface KpiCardProps {\n  label: string;\n  value: string;\n  unit?: string;\n  sub?: string;\n  accent: string;\n  icon: React.ReactNode;\n}\nconst KpiCard: React.FC<KpiCardProps> = ({ label, value, unit, sub, accent, icon }) => (\n  <div className=\"card\" style={{ padding: '1.1rem', flex: 1, minWidth: 130 }}>\n    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.4rem' }}>\n      <span style={{ fontSize: '0.7rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.06em', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>{label}</span>\n      <span style={{ width: 28, height: 28, borderRadius: '50%', background: `${accent}18`, display: 'flex', alignItems: 'center', justifyContent: 'center', color: accent, flexShrink: 0 }}>{icon}</span>\n    </div>\n    <p style={{ margin: 0, fontFamily: 'JetBrains Mono, monospace', fontSize: '1.55rem', fontWeight: 800, color: '#0a0a0a', lineHeight: 1 }}>\n      {value}\n      {unit && <span style={{ fontSize: '0.8rem', fontWeight: 500, color: '#9ca3af', marginLeft: 4 }}>{unit}</span>}\n    </p>\n    {sub && <p style={{ margin: '0.25rem 0 0', fontSize: '0.7rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>{sub}</p>}\n  </div>\n);\n\n//  main component \n\ninterface Props {\n  siteId: string;\n  /** If true, auto-refreshes every 60 s */\n  autoRefresh?: boolean;\n}\n\nconst SiteDataPanel: React.FC<Props> = ({ siteId, autoRefresh = false }) => {\n  const [telemetry, setTelemetry] = useState<any[]>([]);\n  const [forecast, setForecast] = useState<any[]>([]);\n  const [weather, setWeather] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);\n  \n  // Date range controls\n\n  // Interactive forecast band toggles\n  const [showBands, setShowBands] = useState<{ [key: string]: boolean }>({\n    P10: true,\n    P50: true,\n    P90: true,\n  });\n  const [dateRange, setDateRange] = useState<string>('24h'); // '24h' | '7d' | '30d' | 'custom'\n  const [customStartDate, setCustomStartDate] = useState<string>('');\n  const [customEndDate, setCustomEndDate] = useState<string>('');\n\n  const fetchAll = useCallback(async () => {\n    try {\n      // Calculate date range parameters for telemetry\n      let telemetryParams: any = {};\n      \n      if (dateRange === 'custom' && customStartDate && customEndDate) {\n        telemetryParams = {\n          start_date: new Date(customStartDate).toISOString(),\n          end_date: new Date(customEndDate).toISOString(),\n        };\n      } else if (dateRange === '7d') {\n        telemetryParams = { days: 7 };\n      } else if (dateRange === '30d') {\n        telemetryParams = { days: 30 };\n      } else {\n        // Default 24h\n        telemetryParams = {};\n      }\n      \n      // Fetch forecast for the correct date range\n      let forecastParams: any = {};\n      if (dateRange === 'custom' && customStartDate && customEndDate) {\n        forecastParams = {\n          start_date: new Date(customStartDate).toISOString(),\n          end_date: new Date(customEndDate).toISOString(),\n        };\n      } else if (dateRange === '7d') {\n        // Last 7 days: start_date = 6 days ago, end_date = today\n        const end = new Date();\n        const start = new Date();\n        start.setDate(end.getDate() - 6);\n        forecastParams = {\n          start_date: start.toISOString().split('T')[0] + 'T00:00:00Z',\n          end_date: end.toISOString().split('T')[0] + 'T23:59:59Z',\n        };\n      } else if (dateRange === '30d') {\n        // Last 30 days: start_date = 29 days ago, end_date = today\n        const end = new Date();\n        const start = new Date();\n        start.setDate(end.getDate() - 29);\n        forecastParams = {\n          start_date: start.toISOString().split('T')[0] + 'T00:00:00Z',\n          end_date: end.toISOString().split('T')[0] + 'T23:59:59Z',\n        };\n      } else {\n        // Default: today only\n        forecastParams = {};\n      }\n\n      const [tel, fcst, wth] = await Promise.all([\n        apiService.getSiteTelemetry(siteId, telemetryParams),\n        apiService.getSiteForecast(siteId, forecastParams),\n        apiService.getSiteWeather(siteId),\n      ]);\n      \n      // Debug logging\n      console.log('[SiteDataPanel] Forecast API response:', fcst);\n      console.log('[SiteDataPanel] Forecast count:', Array.isArray(fcst) ? fcst.length : 'not array');\n      if (Array.isArray(fcst) && fcst.length > 0) {\n        console.log('[SiteDataPanel] First forecast item:', fcst[0]);\n      }\n      \n      setTelemetry(Array.isArray(tel) ? tel : []);\n      setForecast(Array.isArray(fcst) ? fcst : []);\n      setWeather(wth || null);\n      setLastUpdated(new Date());\n      setError(null);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load site data');\n    } finally {\n      setLoading(false);\n    }\n  }, [siteId, dateRange, customStartDate, customEndDate]);\n\n  useEffect(() => {\n    setLoading(true);\n    fetchAll();\n    if (!autoRefresh) return;\n    const id = setInterval(fetchAll, 60_000);\n    return () => clearInterval(id);\n  }, [fetchAll, autoRefresh]);\n\n  //  derived values \n  const latest = telemetry.length > 0 ? telemetry[telemetry.length - 1] : null;\n\n  const pvKw    = latest ? ((latest.pv1_power_w ?? 0) + (latest.pv2_power_w ?? 0)) / 1000 : null;\n  const batSoc  = latest?.battery_soc_percent ?? null;\n  const loadKw  = latest ? (latest.load_power_w ?? 0) / 1000 : null;\n  const todayKwh = latest?.pv_today_kwh ?? null;\n\n  // History chart: aggregate based on date range\n  const aggregated = aggregateByPeriod(telemetry, dateRange);\n  const historyData = aggregated.map(row => ({\n    time: fmt(row.timestamp, dateRange),\n    'PV (kW)': +((( row.pv1_power_w ?? 0) + (row.pv2_power_w ?? 0)) / 1000).toFixed(2),\n    'Load (kW)': +((row.load_power_w ?? 0) / 1000).toFixed(2),\n    'Grid (kW)': +((row.grid_power_w ?? 0) / 1000).toFixed(2),\n    'Batt SOC (%)': row.battery_soc_percent ?? null,\n  }));\n\n  // Forecast chart\n  const forecastData = forecast.map(row => {\n    // For multi-day, show date + time; for 1 day, just time\n    let label = '';\n    if (dateRange === '7d' || dateRange === '30d' || dateRange === 'custom') {\n      const cleanTs = row.forecast_for || row.timestamp.replace('FORECAST#', '');\n      const d = new Date(cleanTs);\n      label = d.toLocaleDateString([], { month: 'short', day: 'numeric' }) + ' ' + d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    } else {\n      label = fmtForecast(row.timestamp, row.forecast_for);\n    }\n    return {\n      time: label,\n      p50: row.p50_kw != null ? +row.p50_kw.toFixed(3) : null,\n      p10: row.p10_kw != null ? +row.p10_kw.toFixed(3) : null,\n      p90: row.p90_kw != null ? +row.p90_kw.toFixed(3) : null,\n    };\n  });\n\n  // Calculate total forecasted energy for the day using trapezoidal integration\n  let forecastEnergyP10 = 0, forecastEnergyP50 = 0, forecastEnergyP90 = 0;\n  let forecastGeneratedAt: Date | null = null;\n  \n  if (forecast.length > 1) {\n    // Extract forecast generation time from first record (if available)\n    const firstForecast = forecast[0];\n    if (firstForecast.generated_at) {\n      forecastGeneratedAt = new Date(firstForecast.generated_at);\n    } else if (firstForecast.timestamp) {\n      // Use first timestamp as approximation\n      const ts = firstForecast.timestamp.replace('FORECAST#', '');\n      // Forecast is typically generated at midnight or early morning for the day\n      forecastGeneratedAt = new Date(ts.split('T')[0] + 'T00:00:00Z');\n    }\n    \n    // Use trapezoidal rule: energy = [(power[i] + power[i+1]) / 2  t]\n    for (let i = 0; i < forecast.length - 1; i++) {\n      const t1 = new Date(forecast[i].timestamp.replace('FORECAST#', '')).getTime();\n      const t2 = new Date(forecast[i + 1].timestamp.replace('FORECAST#', '')).getTime();\n      const intervalHours = Math.abs(t2 - t1) / (1000 * 60 * 60);\n      \n      // Trapezoidal integration: average of two consecutive power values  time interval\n      if (forecast[i].p10_kw != null && forecast[i + 1].p10_kw != null) {\n        forecastEnergyP10 += (forecast[i].p10_kw + forecast[i + 1].p10_kw) / 2 * intervalHours;\n      }\n      if (forecast[i].p50_kw != null && forecast[i + 1].p50_kw != null) {\n        forecastEnergyP50 += (forecast[i].p50_kw + forecast[i + 1].p50_kw) / 2 * intervalHours;\n      }\n      if (forecast[i].p90_kw != null && forecast[i + 1].p90_kw != null) {\n        forecastEnergyP90 += (forecast[i].p90_kw + forecast[i + 1].p90_kw) / 2 * intervalHours;\n      }\n    }\n  }\n\n  //  render \n\n  if (loading) {\n    return (\n      <div style={{ padding: '1.5rem 0' }}>\n        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem', flexWrap: 'wrap' }}>\n          {[...Array(4)].map((_, i) => (\n            <div key={i} className=\"card skeleton\" style={{ flex: 1, minWidth: 130, height: 96 }} />\n          ))}\n        </div>\n        <div className=\"card skeleton\" style={{ height: 220, marginBottom: '1rem' }} />\n        <div className=\"card skeleton\" style={{ height: 200 }} />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div style={{ padding: '1.5rem', color: '#ef4444', fontSize: '0.85rem', background: 'rgba(239,68,68,0.06)', borderRadius: 10, marginTop: '1rem' }}>\n        Failed to load DynamoDB data for <strong>{siteId}</strong>: {error}\n      </div>\n    );\n  }\n\n  // Check if we have any meaningful data (including forecast)\n  const noData = telemetry.length === 0 && forecast.length === 0 && !weather;\n\n  return (\n    <div style={{ marginTop: '1.5rem' }}>\n      {/* Section header */}\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '0.75rem', gap: '1rem', flexWrap: 'wrap' }}>\n        <p className=\"dash-section-label\" style={{ margin: 0 }}>Live Site Intelligence  <span style={{ fontFamily: 'JetBrains Mono, monospace', color: '#00a63e' }}>{siteId}</span></p>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>\n          {/* Date range selector */}\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n            <select\n              value={dateRange}\n              onChange={(e) => setDateRange(e.target.value)}\n              style={{\n                background: 'var(--card-bg, #fff)',\n                border: '1px solid rgba(0,166,62,0.2)',\n                borderRadius: 8,\n                padding: '0.3rem 0.6rem',\n                fontSize: '0.72rem',\n                color: 'var(--text-color, #0a0a0a)',\n                cursor: 'pointer',\n                fontFamily: 'Poppins, sans-serif',\n                fontWeight: 600,\n              }}\n            >\n              <option value=\"24h\">Today</option>\n              <option value=\"7d\">Last 7 days</option>\n              <option value=\"30d\">Last 30 days</option>\n              <option value=\"custom\">Custom range</option>\n            </select>\n            \n            {dateRange === 'custom' && (\n              <>\n                <input\n                  type=\"date\"\n                  value={customStartDate}\n                  onChange={(e) => setCustomStartDate(e.target.value)}\n                  style={{\n                    background: 'var(--card-bg, #fff)',\n                    border: '1px solid rgba(0,166,62,0.2)',\n                    borderRadius: 8,\n                    padding: '0.3rem 0.6rem',\n                    fontSize: '0.72rem',\n                    color: 'var(--text-color, #0a0a0a)',\n                    fontFamily: 'Poppins, sans-serif',\n                    fontWeight: 600,\n                  }}\n                />\n                <span style={{ color: '#9ca3af', fontSize: '0.7rem' }}>to</span>\n                <input\n                  type=\"date\"\n                  value={customEndDate}\n                  onChange={(e) => setCustomEndDate(e.target.value)}\n                  style={{\n                    background: 'var(--card-bg, #fff)',\n                    border: '1px solid rgba(0,166,62,0.2)',\n                    borderRadius: 8,\n                    padding: '0.3rem 0.6rem',\n                    fontSize: '0.72rem',\n                    color: 'var(--text-color, #0a0a0a)',\n                    fontFamily: 'Poppins, sans-serif',\n                    fontWeight: 600,\n                  }}\n                />\n              </>\n            )}\n          </div>\n          \n          {lastUpdated && (\n            <span style={{ fontSize: '0.7rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>\n              Updated {lastUpdated.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n            </span>\n          )}\n          <button\n            onClick={() => { setLoading(true); fetchAll(); }}\n            style={{ background: 'none', border: '1px solid rgba(0,166,62,0.2)', borderRadius: 8, padding: '0.2rem 0.6rem', fontSize: '0.72rem', color: '#00a63e', cursor: 'pointer', fontFamily: 'Poppins, sans-serif', fontWeight: 600 }}\n          >\n             Refresh\n          </button>\n        </div>\n      </div>\n\n      {noData ? (\n        <div style={{ padding: '2rem', textAlign: 'center', color: '#9ca3af', fontSize: '0.875rem', background: 'rgba(0,166,62,0.03)', borderRadius: 12, border: '1px dashed rgba(0,166,62,0.15)' }}>\n          No DynamoDB data found for site <strong style={{ color: '#00a63e' }}>{siteId}</strong> in the {\n            dateRange === '24h' ? 'today' :\n            dateRange === '7d' ? 'last 7 days' :\n            dateRange === '30d' ? 'last 30 days' : 'selected date range'\n          }.<br />\n          <span style={{ fontSize: '0.78rem' }}>Data is written by the ML forecast scheduler when the device is actively posting telemetry.</span>\n        </div>\n      ) : (\n        <>\n          {/*  KPI strip  */}\n          <div style={{ display: 'flex', gap: '0.75rem', flexWrap: 'wrap', marginBottom: '1rem' }}>\n            <KpiCard label=\"PV Power\"     value={pvKw != null ? pvKw.toFixed(2) : ''}         unit=\"kW\"  sub=\"Current generation\"   accent=\"#F07522\" icon={<IconSun />}     />\n            <KpiCard label=\"Battery SOC\"  value={batSoc != null ? batSoc.toFixed(1) : ''}      unit=\"%\"   sub=\"State of charge\"       accent=\"#00a63e\" icon={<IconBattery />} />\n            <KpiCard label=\"Load\"         value={loadKw != null ? loadKw.toFixed(2) : ''}      unit=\"kW\"  sub=\"Current consumption\"   accent=\"#8b5cf6\" icon={<IconLoad />}    />\n            <KpiCard label=\"Energy Today\" value={todayKwh != null ? todayKwh.toFixed(2) : ''}  unit=\"kWh\" sub=\"Solar yield today\"     accent=\"#10b981\" icon={<IconEnergy />}  />\n          </div>\n\n          {/*  Weather pill row  */}\n          {weather && (\n            <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap', marginBottom: '1rem' }}>\n              {[\n                { label: 'Temp', value: weather.temperature_c != null ? `${weather.temperature_c.toFixed(1)} C` : null },\n                { label: 'Humidity', value: weather.humidity_pct != null ? `${weather.humidity_pct} %` : null },\n                { label: 'Cloud', value: weather.cloud_cover_pct != null ? `${weather.cloud_cover_pct} %` : null, icon: <IconCloud /> },\n                { label: 'Wind', value: weather.wind_speed_ms != null ? `${weather.wind_speed_ms.toFixed(1)} m/s` : null },\n                { label: 'GHI', value: weather.ghi_wm2 != null ? `${Math.round(weather.ghi_wm2)} W/m` : null },\n              ].filter(p => p.value != null).map(p => (\n                <span key={p.label} style={{\n                  fontSize: '0.72rem', fontWeight: 600, fontFamily: 'Poppins, sans-serif',\n                  padding: '0.2rem 0.65rem', borderRadius: 99,\n                  background: 'rgba(0,166,62,0.07)', border: '1px solid rgba(0,166,62,0.12)',\n                  color: '#007a55', display: 'flex', alignItems: 'center', gap: '0.3rem',\n                }}>\n                  {p.icon}{p.label}: <span style={{ fontFamily: 'JetBrains Mono, monospace', color: '#0a0a0a' }}>{p.value}</span>\n                </span>\n              ))}\n            </div>\n          )}\n\n          {/*  History chart  */}\n          {historyData.length > 0 && (\n            <div className=\"card\" style={{ padding: '1.25rem', marginBottom: '1rem' }}>\n              <div style={{ marginBottom: '1rem' }}>\n                <h3 style={{ margin: '0 0 0.25rem', fontSize: '0.9rem', fontFamily: 'Urbanist, sans-serif', color: '#0a0a0a' }}>\n                  Power History  {\n                    dateRange === '24h' ? 'Today' :\n                    dateRange === '7d' ? 'Last 7 days' :\n                    dateRange === '30d' ? 'Last 30 days' :\n                    dateRange === 'custom' && customStartDate && customEndDate ? \n                      `${new Date(customStartDate).toLocaleDateString()} - ${new Date(customEndDate).toLocaleDateString()}` :\n                      'Custom range'\n                  }\n                </h3>\n                {(dateRange === '7d' || dateRange === '30d' || dateRange === 'custom') && (\n                  <p style={{ margin: 0, fontSize: '0.7rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>\n                    {dateRange === '7d' ? 'Data aggregated by hour' : 'Data aggregated by day'}\n                  </p>\n                )}\n              </div>\n              <div style={{ height: 220 }}>\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <AreaChart data={historyData} margin={{ top: 4, right: 8, left: 0, bottom: dateRange === '7d' || dateRange === '30d' ? 20 : 0 }}>\n                    <defs>\n                      <linearGradient id=\"pvGrad\"   x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                        <stop offset=\"5%\"  stopColor=\"#F07522\" stopOpacity={0.22}/>\n                        <stop offset=\"95%\" stopColor=\"#F07522\" stopOpacity={0}/>\n                      </linearGradient>\n                      <linearGradient id=\"loadGrad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                        <stop offset=\"5%\"  stopColor=\"#8b5cf6\" stopOpacity={0.18}/>\n                        <stop offset=\"95%\" stopColor=\"#8b5cf6\" stopOpacity={0}/>\n                      </linearGradient>\n                    </defs>\n                    <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(0,166,62,0.08)\" />\n                    <XAxis \n                      dataKey=\"time\" \n                      stroke=\"#9ca3af\" \n                      fontSize={dateRange === '30d' ? 9 : 10} \n                      interval={dateRange === '24h' ? 'preserveStartEnd' : Math.ceil(historyData.length / 10)}\n                      angle={dateRange === '7d' || dateRange === '30d' ? -15 : 0}\n                      textAnchor={dateRange === '7d' || dateRange === '30d' ? 'end' : 'middle'}\n                    />\n                    <YAxis stroke=\"#9ca3af\" fontSize={10} tickFormatter={v => `${v}kW`} />\n                    <Tooltip contentStyle={TOOLTIP_STYLE} formatter={(v: any, name: string) => [`${v} ${name.includes('%') ? '%' : 'kW'}`, name]} />\n                    <Legend iconType=\"circle\" iconSize={8} wrapperStyle={{ fontSize: 11, fontFamily: 'Poppins, sans-serif' }} />\n                    <Area type=\"monotone\" dataKey=\"PV (kW)\"   stroke=\"#F07522\" strokeWidth={2} fill=\"url(#pvGrad)\"   dot={false} />\n                    <Area type=\"monotone\" dataKey=\"Load (kW)\" stroke=\"#8b5cf6\" strokeWidth={2} fill=\"url(#loadGrad)\" dot={false} />\n                    <Line type=\"monotone\" dataKey=\"Grid (kW)\" stroke=\"#3b82f6\" strokeWidth={1.5} dot={false} strokeDasharray=\"4 3\" />\n                  </AreaChart>\n                </ResponsiveContainer>\n              </div>\n            </div>\n          )}\n\n          {/*  Forecast chart  */}\n          {/* DEBUG: Force render to test */}\n          <div style={{ padding: '0.5rem', background: '#ffe', border: '1px solid #cc0', marginBottom: '0.5rem', fontSize: '12px' }}>\n            DEBUG: forecast.length={forecast.length}, forecastData.length={forecastData.length}, \n            telemetry.length={telemetry.length}, noData={String(telemetry.length === 0 && forecast.length === 0 && !weather)}\n          </div>\n          {forecastData.length > 0 && (\n            <div className=\"card\" style={{ padding: '1.25rem', boxShadow: '0 4px 24px rgba(0,166,62,0.07)', border: '1px solid #e0f2ef', borderRadius: 16, background: 'linear-gradient(120deg, #f0fdfa 0%, #e0f7e9 100%)', position: 'relative' }}>\n                            {/* Download button */}\n                            <button\n                              onClick={async () => {\n                                const chartDiv = document.getElementById('forecast-chart-img');\n                                if (chartDiv) {\n                                  const canvas = await html2canvas(chartDiv, { background: 'transparent' });\n                                  const link = document.createElement('a');\n                                  link.download = `solar-forecast-${new Date().toISOString().slice(0,10)}.png`;\n                                  link.href = canvas.toDataURL();\n                                  link.click();\n                                }\n                              }}\n                              style={{ position: 'absolute', top: 12, right: 16, background: '#00a63e', color: '#fff', border: 'none', borderRadius: 6, padding: '0.3em 0.9em', fontWeight: 700, fontSize: 13, cursor: 'pointer', boxShadow: '0 2px 8px #00a63e22', zIndex: 2 }}\n                              title=\"Download chart as image\"\n                            >\n                               Export\n                            </button>\n              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '1rem', flexWrap: 'wrap', gap: '1rem' }}>\n                <div>\n                  <h3 style={{ margin: '0 0 0.25rem', fontSize: '1.1rem', fontFamily: 'Urbanist, sans-serif', color: '#00a63e', letterSpacing: '0.01em', fontWeight: 800 }}>\n                    <span style={{ verticalAlign: 'middle', marginRight: 6, fontSize: '1.2em' }}></span> Solar Forecast\n                  </h3>\n                  <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.7rem', alignItems: 'center' }}>\n                    {forecastEnergyP50 > 0 && (\n                      <span style={{ fontSize: '0.8rem', color: '#00a63e', fontFamily: 'JetBrains Mono, monospace', fontWeight: 700, background: '#e0f7e9', borderRadius: 8, padding: '0.18em 0.7em' }}>\n                        {forecastEnergyP10.toFixed(2)}  {forecastEnergyP50.toFixed(2)}  {forecastEnergyP90.toFixed(2)} kWh\n                      </span>\n                    )}\n                    {forecastGeneratedAt && (\n                      <span style={{ fontSize: '0.7rem', color: '#b0b0b0', fontFamily: 'Poppins, sans-serif' }}>\n                        Generated: {forecastGeneratedAt.toLocaleDateString()} {forecastGeneratedAt.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                      </span>\n                    )}\n                  </div>\n                </div>\n                <div style={{ display: 'flex', gap: '0.4rem', alignItems: 'center', flexWrap: 'wrap' }}>\n                  {[{ label: 'P10', color: '#fbbf24' }, { label: 'P50', color: '#00a63e' }, { label: 'P90', color: '#4ade80' }].map(b => (\n                    <label key={b.label} style={{ fontSize: '0.7rem', fontWeight: 600, color: b.color, display: 'flex', alignItems: 'center', gap: '0.25rem', fontFamily: 'Poppins, sans-serif', cursor: 'pointer' }}>\n                      <input type=\"checkbox\" checked={showBands[b.label]} onChange={() => setShowBands(s => ({ ...s, [b.label]: !s[b.label] }))} style={{ accentColor: b.color, marginRight: 3 }} />\n                      <span style={{ width: 8, height: 8, borderRadius: '50%', background: b.color, display: 'inline-block' }} />\n                      {b.label}\n                    </label>\n                  ))}\n                </div>\n              </div>\n              <div id=\"forecast-chart-img\" style={{ height: 260, borderRadius: 12, overflow: 'hidden', background: 'linear-gradient(120deg, #f0fdfa 0%, #e0f7e9 100%)' }}>\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <AreaChart data={forecastData} margin={{ top: 4, right: 8, left: 0, bottom: 24 }}>\n                    <defs>\n                      <linearGradient id=\"p50Grad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                        <stop offset=\"5%\"  stopColor=\"#00a63e\" stopOpacity={0.25}/>\n                        <stop offset=\"95%\" stopColor=\"#00a63e\" stopOpacity={0}/>\n                      </linearGradient>\n                      <linearGradient id=\"bgGrad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                        <stop offset=\"0%\" stopColor=\"#e0f7e9\" stopOpacity={0.7}/>\n                        <stop offset=\"100%\" stopColor=\"#f0fdfa\" stopOpacity={0.7}/>\n                      </linearGradient>\n                    </defs>\n                    <rect x={0} y={0} width=\"100%\" height=\"100%\" fill=\"url(#bgGrad)\" />\n                    <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(0,166,62,0.08)\" />\n                    <XAxis \n                      dataKey=\"time\" \n                      stroke=\"#9ca3af\" \n                      fontSize={10} \n                      interval={dateRange === '24h' ? 'preserveStartEnd' : Math.ceil(forecastData.length / 10)}\n                      angle={dateRange === '7d' || dateRange === '30d' || dateRange === 'custom' ? -15 : 0}\n                      textAnchor={dateRange === '7d' || dateRange === '30d' || dateRange === 'custom' ? 'end' : 'middle'}\n                    />\n                    <YAxis stroke=\"#9ca3af\" fontSize={10} tickFormatter={v => `${v}kW`} />\n                    <Tooltip content={<ForecastTooltip />} animationDuration={350} cursor={{ stroke: '#00a63e', strokeWidth: 2, opacity: 0.18 }} />\n                    <Legend iconType=\"circle\" iconSize={10} wrapperStyle={{ fontSize: 12, fontFamily: 'Poppins, sans-serif', bottom: 0, left: 0, padding: 0 }} verticalAlign=\"top\" height={32} />\n                    {/* Confidence band: p90 filled down to p10 */}\n                    {showBands['P90'] && <Area type=\"monotone\" dataKey=\"p90\" stroke=\"#4ade80\" strokeWidth={1} strokeDasharray=\"4 3\" fill=\"rgba(74,222,128,0.08)\" dot={false} isAnimationActive={true} name=\"P90\" />}\n                    {showBands['P50'] && <Area type=\"monotone\" dataKey=\"p50\" stroke=\"#00a63e\" strokeWidth={2} fill=\"url(#p50Grad)\" dot={false} isAnimationActive={true} name=\"P50\" />}\n                    {showBands['P10'] && <Area type=\"monotone\" dataKey=\"p10\" stroke=\"#fbbf24\" strokeWidth={1} strokeDasharray=\"4 3\" fill=\"none\" dot={false} isAnimationActive={true} name=\"P10\" />}\n                    {/* Reference line for now */}\n                    <ReferenceLine x={new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })} stroke=\"#ef4444\" strokeDasharray=\"3 3\" label={{ value: 'Now', position: 'top', fill: '#ef4444', fontSize: 11, fontWeight: 700 }} ifOverflow=\"extendDomain\" />\n                    {/* Interactive brush for zoom/pan */}\n                    <Brush dataKey=\"time\" height={18} stroke=\"#00a63e\" fill=\"#e0f7e9\" travellerWidth={12} startIndex={0} endIndex={Math.min(23, forecastData.length-1)} />\n                  </AreaChart>\n                </ResponsiveContainer>\n              </div>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default SiteDataPanel;\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport { apiService } from '../services/api';\r\nimport { useDebouncedCallback } from '../hooks/useDebounce';\r\nimport { useTheme } from '../contexts/ThemeContext';\r\nimport AuditTrail from './AuditTrail';\r\nimport SiteDataPanel from './SiteDataPanel';\r\n\r\ninterface User {\r\n  id: number;\r\n  username: string;\r\n  first_name: string;\r\n  last_name: string;\r\n  email: string;\r\n  is_staff: boolean;\r\n  is_superuser: boolean;\r\n}\r\n\r\ninterface Device {\r\n  id: number;\r\n  device_serial: string;\r\n  hw_id?: string;\r\n  model?: string;\r\n  user?: string;\r\n  provisioned_at: string;\r\n  config_version?: string;\r\n  is_online?: boolean;\r\n  last_heartbeat?: string;\r\n  logs_enabled?: boolean;\r\n  pending_config_update?: boolean;\r\n  config_ack_ver?: number | null;\r\n  config_downloaded_at?: string | null;\r\n  config_acked_at?: string | null;\r\n  created_by_username?: string;\r\n  created_at?: string;\r\n  updated_by_username?: string;\r\n  updated_at?: string;\r\n}\r\n\r\ninterface Preset {\r\n  id: number;\r\n  config_id?: string;\r\n  name: string;\r\n  description?: string;\r\n  slaves_count?: number;\r\n  version?: number;\r\n  updated_at?: string;\r\n  gateway_configuration?: {\r\n    general_settings?: {\r\n      config_id?: string;\r\n      last_updated?: string;\r\n    };\r\n  };\r\n}\r\n\r\ninterface SystemHealthData {\r\n  total_devices: number;\r\n  active_devices: number;\r\n  total_telemetry_points: number;\r\n  uptime_seconds: number;\r\n  database_status: string;\r\n  mqtt_status: string;\r\n  overall_health: string;\r\n}\r\n\r\ninterface TelemetryData {\r\n  deviceId: string;\r\n  timestamp: string;\r\n  data_type: string;\r\n  value: number;\r\n  unit: string;\r\n}\r\n\r\ninterface TelemetrySummary {\r\n  totalPoints: number;\r\n  deviceCount: number;\r\n  latestTimestamp: string | null;\r\n}\r\n\r\ninterface SolarSite {\r\n  id: number;\r\n  device_id: number;\r\n  site_id: string;\r\n  display_name: string;\r\n  latitude: number;\r\n  longitude: number;\r\n  capacity_kw: number;\r\n  tilt_deg: number;\r\n  azimuth_deg: number;\r\n  timezone: string;\r\n  is_active: boolean;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\ninterface SolarSiteForm {\r\n  site_id: string;\r\n  display_name: string;\r\n  latitude: string;\r\n  longitude: string;\r\n  capacity_kw: string;\r\n  tilt_deg: string;\r\n  azimuth_deg: string;\r\n  timezone: string;\r\n  is_active: boolean;\r\n}\r\n\r\nconst Devices: React.FC = () => {\r\n  const { isDark } = useTheme();\r\n  const [searchParams] = useSearchParams();\r\n  const [devices, setDevices] = useState<Device[]>([]);\r\n  const [filteredDevices, setFilteredDevices] = useState<Device[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [editingDevice, setEditingDevice] = useState<Device | null>(null);\r\n  const [creatingDevice, setCreatingDevice] = useState(false);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [userSearchTerm, setUserSearchTerm] = useState('');\r\n  const [filteredUsers, setFilteredUsers] = useState<User[]>([]);\r\n  const [showUserDropdown, setShowUserDropdown] = useState(false);\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [selectedDevices, setSelectedDevices] = useState<Set<number>>(new Set());\r\n  const [bulkDeleteLoading, setBulkDeleteLoading] = useState(false);\r\n  // Pagination state\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [pageSize, setPageSize] = useState(25);\r\n  const [totalCount, setTotalCount] = useState(0);\r\n  const [totalPages, setTotalPages] = useState(0);\r\n  const [presets, setPresets] = useState<Preset[]>([]);\r\n  const [presetsLoading, setPresetsLoading] = useState(true);\r\n  const [health, setHealth] = useState<SystemHealthData | null>(null);\r\n  const [telemetrySummary, setTelemetrySummary] = useState<TelemetrySummary | null>(null);\r\n  const [telemetryData, setTelemetryData] = useState<TelemetryData[]>([]);\r\n  const [dashboardError, setDashboardError] = useState<string | null>(null);\r\n  const [selectedDevice, setSelectedDevice] = useState<Device | null>(null);\r\n  const [deviceLogs, setDeviceLogs] = useState<any[]>([]);\r\n  const [logsLoading, setLogsLoading] = useState(false);\r\n  const [editForm, setEditForm] = useState({\r\n    device_serial: '',\r\n    user: '',\r\n    config_version: '',\r\n  });\r\n  const [createForm, setCreateForm] = useState({\r\n    device_serial: '',\r\n    user: '',\r\n    config_version: '',\r\n  });\r\n\r\n  // Site management state\r\n  const [siteDetails, setSiteDetails] = useState<SolarSite | null>(null);\r\n  const [siteLoading, setSiteLoading] = useState(false);\r\n  const [editingSite, setEditingSite] = useState(false);\r\n  const [siteForm, setSiteForm] = useState<SolarSiteForm>({\r\n    site_id: '', display_name: '', latitude: '', longitude: '',\r\n    capacity_kw: '', tilt_deg: '18', azimuth_deg: '180',\r\n    timezone: 'Asia/Kolkata', is_active: true,\r\n  });\r\n  const [siteSaving, setSiteSaving] = useState(false);\r\n  const [siteError, setSiteError] = useState<string | null>(null);\r\n  const [devicePreset, setDevicePreset] = useState<Preset | null>(null);\r\n\r\n  const fetchDevices = useCallback(async (page: number = 1, search: string = '') => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await apiService.getDevices(search || undefined, page, pageSize);\r\n      \r\n      // Handle paginated response\r\n      if (response.results) {\r\n        setDevices(response.results);\r\n        setFilteredDevices(response.results);\r\n        setTotalCount(response.count);\r\n        setTotalPages(response.total_pages);\r\n        setCurrentPage(response.current_page);\r\n      } else {\r\n        // Fallback for non-paginated response\r\n        setDevices(Array.isArray(response) ? response : []);\r\n        setFilteredDevices(Array.isArray(response) ? response : []);\r\n        setTotalCount(Array.isArray(response) ? response.length : 0);\r\n        setTotalPages(1);\r\n        setCurrentPage(1);\r\n      }\r\n      \r\n      setLoading(false);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'An error occurred');\r\n      setLoading(false);\r\n    }\r\n  }, [pageSize]);\r\n\r\n  const fetchUsers = async () => {\r\n    try {\r\n      const data: User[] = await apiService.getUsers();\r\n      // Filter out staff and superusers, only showing regular customers\r\n      const customers = data.filter(user => !user.is_staff && !user.is_superuser);\r\n      setUsers(customers);\r\n    } catch (err) {\r\n      console.error('Failed to fetch users:', err);\r\n      setError('Failed to load users for device assignment');\r\n    }\r\n  };\r\n\r\n  const fetchPresets = async () => {\r\n    try {\r\n      const data = await apiService.getPresets();\r\n      setPresets(Array.isArray(data) ? data : []);\r\n    } catch (err) {\r\n      console.error('Failed to fetch presets:', err);\r\n    } finally {\r\n      setPresetsLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchDashboardData = async () => {\r\n    try {\r\n      const [healthData, telemetryData] = await Promise.all([\r\n        apiService.getSystemHealth(),\r\n        apiService.getTelemetry(),\r\n      ]);\r\n\r\n      setHealth(healthData || null);\r\n\r\n      const telemetryArray = Array.isArray(telemetryData) ? telemetryData : [];\r\n      setTelemetryData(telemetryArray);\r\n      const latest = telemetryArray.reduce<string | null>((currentLatest, item) => {\r\n        if (!item?.timestamp) return currentLatest;\r\n        const itemDate = new Date(item.timestamp);\r\n        if (Number.isNaN(itemDate.getTime())) return currentLatest;\r\n        if (!currentLatest) return item.timestamp;\r\n        const currentDate = new Date(currentLatest);\r\n        return itemDate > currentDate ? item.timestamp : currentLatest;\r\n      }, null);\r\n\r\n      const deviceCount = new Set(telemetryArray.map((item: TelemetryData) => item.deviceId)).size;\r\n      setTelemetrySummary({\r\n        totalPoints: telemetryArray.length,\r\n        deviceCount,\r\n        latestTimestamp: latest,\r\n      });\r\n    } catch (err) {\r\n      console.error('Failed to fetch dashboard data:', err);\r\n      setDashboardError('Failed to load device dashboards');\r\n    }\r\n  };\r\n\r\n  const fetchDeviceLogs = useCallback(async (deviceId: number) => {\r\n    setLogsLoading(true);\r\n    try {\r\n      const response = await apiService.getDeviceLogs(deviceId, 50, 0);\r\n      setDeviceLogs(response.logs || []);\r\n    } catch (err) {\r\n      console.error('Failed to fetch device logs:', err);\r\n      setDeviceLogs([]);\r\n    } finally {\r\n      setLogsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const handleViewDevice = useCallback((device: Device) => {\r\n    setSelectedDevice(device);\r\n    setSiteDetails(null);\r\n    setSiteLoading(true);\r\n    setDeviceLogs([]);\r\n    \r\n    // Load preset details if device has config\r\n    if (device.config_version) {\r\n      const preset = presets.find(p => p.config_id === device.config_version);\r\n      setDevicePreset(preset || null);\r\n    } else {\r\n      setDevicePreset(null);\r\n    }\r\n    \r\n    // Fetch site details and logs in parallel\r\n    Promise.all([\r\n      apiService.getDeviceSite(device.id)\r\n        .then(data => setSiteDetails(data))\r\n        .catch((err) => {\r\n          console.error('Failed to fetch site for device', device.id, ':', err);\r\n          setSiteDetails(null);\r\n        }),\r\n      fetchDeviceLogs(device.id)\r\n    ]).finally(() => setSiteLoading(false));\r\n  }, [fetchDeviceLogs, presets]);\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n    fetchPresets();\r\n    fetchDashboardData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const deviceIdParam = searchParams.get('deviceId');\r\n    if (deviceIdParam) {\r\n      const deviceId = parseInt(deviceIdParam, 10);\r\n      if (!isNaN(deviceId)) {\r\n        const foundDevice = devices.find(d => d.id === deviceId);\r\n        if (foundDevice) {\r\n          handleViewDevice(foundDevice);\r\n        }\r\n      }\r\n    }\r\n  }, [searchParams, devices, handleViewDevice]);\r\n  \r\n  useEffect(() => {\r\n    fetchDevices(currentPage, searchTerm);\r\n  }, [currentPage, searchTerm, pageSize, fetchDevices]);\r\n  \r\n  useEffect(() => {\r\n    const handleClickOutside = () => {\r\n      setShowUserDropdown(false);\r\n    };\r\n\r\n    if (showUserDropdown) {\r\n      document.addEventListener('click', handleClickOutside);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('click', handleClickOutside);\r\n    };\r\n  }, [showUserDropdown]);\r\n\r\n  useEffect(() => {\r\n    if (userSearchTerm.trim() === '') {\r\n      setFilteredUsers(users);\r\n    } else {\r\n      const searchLower = userSearchTerm.toLowerCase();\r\n      const filtered = users.filter(user => {\r\n        const fullName = `${user.first_name} ${user.last_name}`.toLowerCase();\r\n        return (\r\n          user.username.toLowerCase().includes(searchLower) ||\r\n          user.first_name.toLowerCase().includes(searchLower) ||\r\n          user.last_name.toLowerCase().includes(searchLower) ||\r\n          fullName.includes(searchLower) ||\r\n          user.email.toLowerCase().includes(searchLower)\r\n        );\r\n      });\r\n      setFilteredUsers(filtered);\r\n    }\r\n  }, [users, userSearchTerm]);\r\n\r\n  // Debounced search function that runs the actual search after 300ms of inactivity\r\n  const debouncedSearch = useDebouncedCallback(\r\n    (query: string) => {\r\n      // The actual search happens via useEffect that watches currentPage and searchTerm\r\n      // This ensures we don't make too many API calls\r\n    },\r\n    300\r\n  );\r\n\r\n  const handleSearch = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const query = e.target.value;\r\n    setSearchTerm(query);\r\n    setCurrentPage(1);  // Reset to page 1 on new search\r\n    debouncedSearch(query);  // Debounce the search\r\n  };\r\n\r\n  const handleEdit = (device: Device) => {\r\n    setEditingDevice(device);\r\n    setEditForm({\r\n      device_serial: device.device_serial,\r\n      user: device.user || '',\r\n      config_version: device.config_version || '',\r\n    });\r\n    setUserSearchTerm(device.user ? `${users.find(u => u.username === device.user)?.first_name} ${users.find(u => u.username === device.user)?.last_name} (${device.user})` : '');\r\n    setShowUserDropdown(false);\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    if (!editingDevice) return;\r\n\r\n    try {\r\n      await apiService.updateDevice(editingDevice.id, editForm);\r\n      setEditingDevice(null);\r\n      // Refetch to get the updated device with all fields including audit trail\r\n      await fetchDevices(currentPage, searchTerm);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to update device');\r\n    }\r\n  };\r\n\r\n  const handleCreate = async () => {\r\n    try {\r\n      await apiService.createDevice(createForm);\r\n      setCreatingDevice(false);\r\n      setCreateForm({\r\n        device_serial: '',\r\n        user: '',\r\n        config_version: '',\r\n      });\r\n      // Refetch to get the new device with all fields including audit trail\r\n      await fetchDevices(currentPage, searchTerm);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to create device');\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (device: any) => {\r\n    if (window.confirm(`Are you sure you want to delete device ${device.device_serial}?`)) {\r\n      try {\r\n        await apiService.deleteDevice(device.id);\r\n        const updatedDevices = devices.filter(d => d.id !== device.id);\r\n        setDevices(updatedDevices);\r\n        setFilteredDevices(updatedDevices);\r\n      } catch (err) {\r\n        console.error('Delete error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to delete device');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleReboot = async (device: any) => {\r\n    if (window.confirm(`Are you sure you want to reboot device ${device.device_serial}? The device will restart on its next heartbeat.`)) {\r\n      try {\r\n        await apiService.rebootDevice(device.id);\r\n        alert(`Reboot command queued for ${device.device_serial}. Device will reboot on next heartbeat.`);\r\n      } catch (err) {\r\n        console.error('Reboot error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to queue reboot command');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleHardReset = async (device: any) => {\r\n    if (window.confirm(` WARNING: Hard reset will erase device configuration and restart it.\\n\\nAre you sure you want to hard reset device ${device.device_serial}?`)) {\r\n      try {\r\n        await apiService.hardResetDevice(device.id);\r\n        alert(`Hard reset command queued for ${device.device_serial}. Device will reset on next heartbeat.`);\r\n      } catch (err) {\r\n        console.error('Hard reset error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to queue hard reset command');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDeleteDevice = async (device: any) => {\r\n    if (window.confirm(` WARNING: This will permanently delete device ${device.device_serial} and all its data.\\n\\nAre you sure you want to delete this device?`)) {\r\n      try {\r\n        await apiService.deleteDevice(device.id);\r\n        alert(`Device ${device.device_serial} deleted successfully.`);\r\n        setSelectedDevice(null);\r\n        fetchDevices(); // Refresh device list\r\n      } catch (err) {\r\n        console.error('Delete device error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to delete device');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleToggleLogs = async (device: any, enabled: boolean) => {\r\n    try {\r\n      await apiService.toggleDeviceLogs(device.id, enabled);\r\n      setSelectedDevice({ ...device, logs_enabled: enabled });\r\n      fetchDevices(); // Refresh device list\r\n    } catch (err) {\r\n      console.error('Toggle logs error:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to toggle device logs');\r\n    }\r\n  };\r\n\r\n  const handleSelectDevice = (deviceId: number) => {\r\n    const newSelected = new Set(selectedDevices);\r\n    if (newSelected.has(deviceId)) {\r\n      newSelected.delete(deviceId);\r\n    } else {\r\n      newSelected.add(deviceId);\r\n    }\r\n    setSelectedDevices(newSelected);\r\n  };\r\n\r\n  const handleSelectAll = () => {\r\n    if (selectedDevices.size === filteredDevices.length) {\r\n      setSelectedDevices(new Set());\r\n    } else {\r\n      const allIds = new Set(filteredDevices.map(d => d.id));\r\n      setSelectedDevices(allIds);\r\n    }\r\n  };\r\n\r\n  const handleBulkDelete = async () => {\r\n    if (selectedDevices.size === 0) {\r\n      setError('No devices selected for deletion');\r\n      return;\r\n    }\r\n\r\n    const deviceList = Array.from(selectedDevices)\r\n      .map(id => devices.find(d => d.id === id))\r\n      .filter(Boolean);\r\n\r\n    const confirmMessage = `Are you sure you want to delete ${selectedDevices.size} device(s)?\\n\\n${deviceList.map(d => d?.device_serial).join(', ')}`;\r\n\r\n    if (window.confirm(confirmMessage)) {\r\n      try {\r\n        setBulkDeleteLoading(true);\r\n        await apiService.deleteDevicesBulk(Array.from(selectedDevices));\r\n        \r\n        const updatedDevices = devices.filter(d => !selectedDevices.has(d.id));\r\n        setDevices(updatedDevices);\r\n        setFilteredDevices(updatedDevices.filter(d => \r\n          d.device_serial.toLowerCase().includes(searchTerm.toLowerCase())\r\n        ));\r\n        setSelectedDevices(new Set());\r\n        setBulkDeleteLoading(false);\r\n      } catch (err) {\r\n        setBulkDeleteLoading(false);\r\n        console.error('Bulk delete error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to delete devices');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setEditingDevice(null);\r\n    setCreatingDevice(false);\r\n    setUserSearchTerm('');\r\n    setShowUserDropdown(false);\r\n  };\r\n\r\n  const handleBackToList = () => {\r\n    setSelectedDevice(null);\r\n    setSiteDetails(null);\r\n    setEditingSite(false);\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"loading\">Loading devices...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div className=\"error\">Error: {error}</div>;\r\n  }\r\n\r\n  const getPresetConfigId = (preset: Preset): string => {\r\n    return preset.gateway_configuration?.general_settings?.config_id || preset.config_id || '';\r\n  };\r\n\r\n  if (selectedDevice) {\r\n    const deviceTelemetry = telemetryData.filter((entry) => entry.deviceId === selectedDevice.device_serial);\r\n    const latestTelemetry = deviceTelemetry.reduce<string | null>((currentLatest, item) => {\r\n      if (!item?.timestamp) return currentLatest;\r\n      const itemDate = new Date(item.timestamp);\r\n      if (Number.isNaN(itemDate.getTime())) return currentLatest;\r\n      if (!currentLatest) return item.timestamp;\r\n      const currentDate = new Date(currentLatest);\r\n      return itemDate > currentDate ? item.timestamp : currentLatest;\r\n    }, null);\r\n\r\n    return (\r\n      <div>\r\n        <div style={{ display: 'flex', alignItems: 'center', marginBottom: '20px' }}>\r\n          <button\r\n            onClick={handleBackToList}\r\n            className=\"btn btn-secondary\"\r\n            style={{ marginRight: '15px' }}\r\n          >\r\n             Back to Devices\r\n          </button>\r\n          <h1 style={{ margin: 0 }}>{selectedDevice.device_serial} Dashboard</h1>\r\n        </div>\r\n\r\n        <div className=\"card\" style={{ marginBottom: '20px' }}>\r\n          <div className=\"card-header\">\r\n            <h2>Device Details</h2>\r\n            <div style={{ display: 'flex', gap: '10px' }}>\r\n              <button onClick={() => handleEdit(selectedDevice)} className=\"btn\">\r\n                Edit Device\r\n              </button>\r\n              <button \r\n                onClick={() => handleReboot(selectedDevice)} \r\n                className=\"btn\"\r\n                style={{ \r\n                  backgroundColor: '#f59e0b', \r\n                  color: 'white',\r\n                  border: 'none'\r\n                }}\r\n                title=\"Queue reboot command for device\"\r\n              >\r\n                 Reboot\r\n              </button>\r\n              <button \r\n                onClick={() => handleHardReset(selectedDevice)} \r\n                className=\"btn\"\r\n                style={{ \r\n                  backgroundColor: '#dc2626', \r\n                  color: 'white',\r\n                  border: 'none'\r\n                }}\r\n                title=\"Queue hard reset command for device (erases config)\"\r\n              >\r\n                 Hard Reset\r\n              </button>\r\n              <button \r\n                onClick={() => handleDeleteDevice(selectedDevice)} \r\n                className=\"btn\"\r\n                style={{ \r\n                  backgroundColor: '#7f1d1d', \r\n                  color: 'white',\r\n                  border: 'none'\r\n                }}\r\n                title=\"Permanently delete device and all its data\"\r\n              >\r\n                 Delete\r\n              </button>\r\n            </div>\r\n          </div>\r\n          <div style={{ padding: '20px' }}>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '15px' }}>\r\n              <div>\r\n                <strong>Status:</strong>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  <span style={{\r\n                    display: 'inline-block',\r\n                    padding: '4px 12px',\r\n                    borderRadius: '12px',\r\n                    fontSize: '0.875rem',\r\n                    fontWeight: '500',\r\n                    backgroundColor: selectedDevice.is_online ? '#dcfce7' : '#fee2e2',\r\n                    color: selectedDevice.is_online ? '#166534' : '#991b1b'\r\n                  }}>\r\n                    {selectedDevice.is_online ? ' Online' : ' Offline'}\r\n                  </span>\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <strong>Last Heartbeat:</strong>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  {selectedDevice.last_heartbeat\r\n                    ? new Date(selectedDevice.last_heartbeat).toLocaleString()\r\n                    : 'Never'}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <strong>MAC / HW ID:</strong>\r\n                <p style={{ margin: '5px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.9rem' }}>{selectedDevice.hw_id || ''}</p>\r\n              </div>\r\n              <div>\r\n                <strong>Model:</strong>\r\n                <p style={{ margin: '5px 0' }}>{selectedDevice.model || ''}</p>\r\n              </div>\r\n              <div>\r\n                <strong>Assigned User:</strong>\r\n                <p style={{ margin: '5px 0' }}>{selectedDevice.user || '-'}</p>\r\n              </div>\r\n              <div style={{ gridColumn: '1 / -1', padding: '15px', backgroundColor: 'transparent', borderRadius: '8px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-sync-card\">\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '12px' }}>\r\n                  <div>\r\n                    <strong style={{ fontSize: '0.95rem', color: 'inherit' }} className=\"config-heading\">Configuration</strong>\r\n                    {devicePreset && (\r\n                      <div style={{ fontSize: '0.875rem', color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginTop: '2px' }} className=\"config-label\">\r\n                        {devicePreset.name || selectedDevice.config_version}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  {!selectedDevice.config_version ? (\r\n                    <span style={{ color: isDark ? '#a0a0a0' : 'rgba(0, 0, 0, 0.5)', fontSize: '0.875rem' }} className=\"config-no-preset\">No preset assigned</span>\r\n                  ) : selectedDevice.pending_config_update ? (\r\n                    <span style={{\r\n                      display: 'inline-flex', alignItems: 'center', gap: '5px',\r\n                      padding: '4px 12px', borderRadius: '12px', fontSize: '0.8rem', fontWeight: '500',\r\n                      backgroundColor: '#fef9c3', color: '#854d0e'\r\n                    }}> Pending update</span>\r\n                  ) : (\r\n                    <span style={{\r\n                      display: 'inline-flex', alignItems: 'center', gap: '5px',\r\n                      padding: '4px 12px', borderRadius: '12px', fontSize: '0.8rem', fontWeight: '500',\r\n                      backgroundColor: '#dcfce7', color: '#166534'\r\n                    }}> Synced</span>\r\n                  )}\r\n                </div>\r\n                {selectedDevice.config_version && (\r\n                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '8px', fontSize: '0.8rem' }}>\r\n                    <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                      <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Preset ID</div>\r\n                      <div style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>{selectedDevice.config_version}</div>\r\n                    </div>\r\n                    {devicePreset?.slaves_count != null && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Slaves</div>\r\n                        <div style={{ fontWeight: '500', color: 'inherit' }}>{devicePreset.slaves_count} device{devicePreset.slaves_count !== 1 ? 's' : ''}</div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_ack_ver != null && devicePreset?.version != null && (\r\n                      <div style={{ \r\n                        padding: '8px', \r\n                        backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', \r\n                        borderRadius: '6px',\r\n                        gridColumn: '1 / -1',\r\n                        border: selectedDevice.config_ack_ver === devicePreset.version ? '2px solid #dcfce7' : '2px solid #fef9c3'\r\n                      }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '4px' }} className=\"config-label\">Version Status</div>\r\n                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                          <div>\r\n                            <span style={{ fontSize: '0.75rem', color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)' }} className=\"config-label\">Device: </span>\r\n                            <span style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>v{selectedDevice.config_ack_ver}</span>\r\n                            <span style={{ margin: '0 8px', color: isDark ? '#808080' : 'rgba(0, 0, 0, 0.4)' }} className=\"config-arrow\"></span>\r\n                            <span style={{ fontSize: '0.75rem', color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)' }} className=\"config-label\">Latest: </span>\r\n                            <span style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>v{devicePreset.version}</span>\r\n                          </div>\r\n                          {selectedDevice.config_ack_ver === devicePreset.version ? (\r\n                            <span style={{ color: '#166534', fontSize: '0.75rem', fontWeight: '500' }}> Up to date</span>\r\n                          ) : (\r\n                            <span style={{ color: '#854d0e', fontSize: '0.75rem', fontWeight: '500' }}> Update available</span>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_ack_ver != null && devicePreset?.version == null && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Device Version</div>\r\n                        <div style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>v{selectedDevice.config_ack_ver}</div>\r\n                      </div>\r\n                    )}\r\n                    {devicePreset?.gateway_configuration?.general_settings?.last_updated && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Last Modified</div>\r\n                        <div style={{ fontWeight: '500', fontSize: '0.75rem', color: 'inherit' }}>\r\n                          {new Date(devicePreset.gateway_configuration.general_settings.last_updated).toLocaleDateString()}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_acked_at && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)', gridColumn: '1 / -1' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Last Synced</div>\r\n                        <div style={{ fontWeight: '500', fontSize: '0.75rem', color: 'inherit' }}>\r\n                          {new Date(selectedDevice.config_acked_at).toLocaleString()}\r\n                          {(() => {\r\n                            const ackTime = new Date(selectedDevice.config_acked_at);\r\n                            const now = new Date();\r\n                            const diffMs = now.getTime() - ackTime.getTime();\r\n                            const diffMins = Math.floor(diffMs / 60000);\r\n                            const diffHours = Math.floor(diffMins / 60);\r\n                            const diffDays = Math.floor(diffHours / 24);\r\n                            if (diffMins < 1) return '  just now';\r\n                            if (diffMins < 60) return `  ${diffMins}m ago`;\r\n                            if (diffHours < 24) return `  ${diffHours}h ago`;\r\n                            return `  ${diffDays}d ago`;\r\n                          })()}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_downloaded_at && selectedDevice.config_acked_at && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)', gridColumn: '1 / -1' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Apply Duration</div>\r\n                        <div style={{ fontWeight: '500', color: 'inherit' }}>\r\n                          {Math.round((new Date(selectedDevice.config_acked_at).getTime() - new Date(selectedDevice.config_downloaded_at).getTime()) / 1000)} seconds\r\n                          <span style={{ color: isDark ? '#a0a0a0' : 'rgba(0, 0, 0, 0.5)', marginLeft: '8px', fontSize: '0.75rem' }} className=\"config-label\">\r\n                            (download  acknowledge)\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div>\r\n                <strong>Provisioned At:</strong>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  {selectedDevice.provisioned_at\r\n                    ? new Date(selectedDevice.provisioned_at).toLocaleDateString()\r\n                    : 'N/A'}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <strong>Created By:</strong>\r\n                <p style={{ margin: '5px 0' }}>{selectedDevice.created_by_username || '-'}</p>\r\n              </div>\r\n              <div style={{ gridColumn: '1 / -1' }}>\r\n                <label style={{ display: 'flex', alignItems: 'center', gap: '10px', cursor: 'pointer' }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedDevice.logs_enabled || false}\r\n                    onChange={(e) => handleToggleLogs(selectedDevice, e.target.checked)}\r\n                    style={{ background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                  />\r\n                  <strong>Enable Device Logs</strong>\r\n                  <span style={{ fontSize: '0.875rem', color: isDark ? '#b0b0b0' : '#9ca3af' }}>\r\n                    (Device will send logs when enabled)\r\n                  </span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-2\" style={{ gap: 'var(--space-6, 24px)', marginTop: '32px' }}>\r\n          <div className=\"card\">\r\n            <h2>System Health</h2>\r\n            {dashboardError && <p className=\"error\">{dashboardError}</p>}\r\n            {!dashboardError && !health && <p>Loading system health...</p>}\r\n            {health && (\r\n              <div>\r\n                <p><strong>Overall:</strong> {health.overall_health}</p>\r\n                <p><strong>Devices:</strong> {health.active_devices}/{health.total_devices} active</p>\r\n                <p><strong>Telemetry Points:</strong> {health.total_telemetry_points.toLocaleString()}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"card\">\r\n            <h2>Telemetry Snapshot</h2>\r\n            {dashboardError && <p className=\"error\">{dashboardError}</p>}\r\n            {!dashboardError && !telemetrySummary && <p>Loading telemetry...</p>}\r\n            {telemetrySummary && (\r\n              <div>\r\n                <p><strong>Total Points:</strong> {deviceTelemetry.length.toLocaleString()}</p>\r\n                <p><strong>Data Types:</strong> {new Set(deviceTelemetry.map((entry) => entry.data_type)).size}</p>\r\n                <p><strong>Latest:</strong> {latestTelemetry ? new Date(latestTelemetry).toLocaleString() : 'N/A'}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  Site Configuration  */}\r\n        <div className=\"card\" style={{ marginTop: '48px' }}>\r\n          <div className=\"card-header\">\r\n            <h2>Site Configuration</h2>\r\n            {!siteLoading && (\r\n              <button className=\"btn\" onClick={() => {\r\n                if (siteDetails) {\r\n                  setSiteForm({\r\n                    site_id: siteDetails.site_id,\r\n                    display_name: siteDetails.display_name,\r\n                    latitude: String(siteDetails.latitude),\r\n                    longitude: String(siteDetails.longitude),\r\n                    capacity_kw: String(siteDetails.capacity_kw),\r\n                    tilt_deg: String(siteDetails.tilt_deg),\r\n                    azimuth_deg: String(siteDetails.azimuth_deg),\r\n                    timezone: siteDetails.timezone,\r\n                    is_active: siteDetails.is_active,\r\n                  });\r\n                } else {\r\n                  setSiteForm({ site_id: '', display_name: '', latitude: '', longitude: '', capacity_kw: '', tilt_deg: '18', azimuth_deg: '180', timezone: 'Asia/Kolkata', is_active: true });\r\n                }\r\n                setSiteError(null);\r\n                setEditingSite(true);\r\n              }}>\r\n                {siteDetails ? 'Edit Site' : 'Add Site'}\r\n              </button>\r\n            )}\r\n          </div>\r\n          <div style={{ padding: '20px' }}>\r\n            {siteLoading ? (\r\n              <p style={{ color: 'var(--text-muted)' }}>Loading site details</p>\r\n            ) : !siteDetails ? (\r\n              <p style={{ color: 'var(--text-muted)', fontSize: '0.9rem' }}>No site configured for this device yet.</p>\r\n            ) : (\r\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '15px' }}>\r\n                <div><strong>Site ID:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.88rem', color: '#00a63e' }}>{siteDetails.site_id}</p></div>\r\n                <div><strong>Display Name:</strong><p style={{ margin: '4px 0' }}>{siteDetails.display_name || ''}</p></div>\r\n                <div><strong>Status:</strong><p style={{ margin: '4px 0' }}><span className={siteDetails.is_active ? 'status-badge status-badge-success' : 'status-badge status-badge-danger'}>{siteDetails.is_active ? 'Active' : 'Inactive'}</span></p></div>\r\n                <div><strong>Latitude:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.88rem' }}>{siteDetails.latitude}</p></div>\r\n                <div><strong>Longitude:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.88rem' }}>{siteDetails.longitude}</p></div>\r\n                <div><strong>Timezone:</strong><p style={{ margin: '4px 0' }}>{siteDetails.timezone}</p></div>\r\n                <div><strong>Capacity:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace' }}>{siteDetails.capacity_kw} kW</p></div>\r\n                <div><strong>Tilt:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace' }}>{siteDetails.tilt_deg}</p></div>\r\n                <div><strong>Azimuth:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace' }}>{siteDetails.azimuth_deg}</p></div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  Live Site Intelligence (DynamoDB)  */}\r\n        {siteDetails && (\r\n          <div style={{ marginTop: '48px' }}>\r\n            <SiteDataPanel siteId={siteDetails.site_id} autoRefresh />\r\n          </div>\r\n        )}\r\n\r\n        {/*  Device Logs  */}\r\n        <div className=\"card\" style={{ marginTop: '48px', marginBottom: '20px' }}>\r\n          <div className=\"card-header\">\r\n            <h2>Device Logs</h2>\r\n            <button onClick={() => fetchDeviceLogs(selectedDevice.id)} className=\"btn\" disabled={logsLoading}>\r\n              {logsLoading ? 'Loading...' : ' Refresh'}\r\n            </button>\r\n          </div>\r\n          <div style={{ padding: '20px' }}>\r\n            {!selectedDevice.logs_enabled && (\r\n              <p style={{ color: 'var(--text-muted, #9ca3af)', fontStyle: 'italic' }}>\r\n                Logging is disabled for this device. Enable it in Device Details to receive logs.\r\n              </p>\r\n            )}\r\n            {deviceLogs.length === 0 && selectedDevice.logs_enabled && !logsLoading && (\r\n              <p style={{ color: 'var(--text-muted, #9ca3af)' }}>\r\n                No logs available yet. Logs will appear when device sends them.\r\n              </p>\r\n            )}\r\n            {logsLoading && (\r\n              <p style={{ color: 'var(--text-muted, #9ca3af)' }}>\r\n                Loading logs...\r\n              </p>\r\n            )}\r\n            {deviceLogs.length > 0 && (\r\n              <div style={{ \r\n                maxHeight: '400px', \r\n                overflowY: 'auto', \r\n                fontFamily: 'JetBrains Mono, monospace', \r\n                fontSize: '0.85rem',\r\n                backgroundColor: '#1e1e1e',\r\n                padding: '10px',\r\n                borderRadius: '4px'\r\n              }}>\r\n                {deviceLogs.map((log) => (\r\n                  <div key={log.id} style={{ \r\n                    marginBottom: '8px', \r\n                    paddingBottom: '8px', \r\n                    borderBottom: '1px solid #333',\r\n                    color: log.level === 'ERROR' ? '#ff6b6b' : \r\n                           log.level === 'WARNING' ? '#ffa500' : \r\n                           log.level === 'INFO' ? '#4dabf7' : '#ced4da'\r\n                  }}>\r\n                    <span style={{ color: '#888' }}>[{new Date(log.timestamp).toLocaleString()}]</span>\r\n                    <span style={{ fontWeight: 'bold', marginLeft: '8px' }}>[{log.level}]</span>\r\n                    <span style={{ marginLeft: '8px' }}>{log.message}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  Site edit modal  */}\r\n        {editingSite && (\r\n          <div className=\"modal\">\r\n            <div className=\"modal-content\">\r\n              <h3>{siteDetails ? `Edit Site: ${siteDetails.site_id}` : 'Add Site Configuration'}</h3>\r\n              <form onSubmit={async (e) => {\r\n                e.preventDefault();\r\n                setSiteSaving(true);\r\n                setSiteError(null);\r\n                try {\r\n                  const payload = {\r\n                    site_id: siteForm.site_id.trim(),\r\n                    display_name: siteForm.display_name.trim(),\r\n                    latitude: parseFloat(siteForm.latitude),\r\n                    longitude: parseFloat(siteForm.longitude),\r\n                    capacity_kw: parseFloat(siteForm.capacity_kw),\r\n                    tilt_deg: parseFloat(siteForm.tilt_deg),\r\n                    azimuth_deg: parseFloat(siteForm.azimuth_deg),\r\n                    timezone: siteForm.timezone.trim(),\r\n                    is_active: siteForm.is_active,\r\n                  };\r\n\r\n                  let updated;\r\n                  if (siteDetails) {\r\n                    updated = await apiService.updateDeviceSite(selectedDevice.id, payload);\r\n                  } else {\r\n                    updated = await apiService.createDeviceSite(selectedDevice.id, payload);\r\n                  }\r\n\r\n                  if (!updated || !updated.site_id) {\r\n                    throw new Error('Invalid response from server  site data missing');\r\n                  }\r\n\r\n                  setSiteDetails(updated);\r\n                  setEditingSite(false);\r\n                  setSiteSaving(false);\r\n\r\n                  // Re-fetch after creation to get server-assigned fields\r\n                  if (!siteDetails) {\r\n                    setTimeout(() => {\r\n                      apiService.getDeviceSite(selectedDevice.id)\r\n                        .then(data => { if (data) setSiteDetails(data); })\r\n                        .catch(err => console.error('Failed to re-fetch site:', err));\r\n                    }, 500);\r\n                  }\r\n                } catch (err: any) {\r\n                  setSiteError(err.message || 'Failed to save site');\r\n                  setSiteSaving(false);\r\n                }\r\n              }}>\r\n                <div className=\"modal-body\">\r\n                  {siteError && (\r\n                    <p style={{ color: isDark ? '#fca5a5' : '#ef4444', fontSize: '0.875rem', marginBottom: '1rem' }}>{siteError}</p>\r\n                  )}\r\n\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Identification</h4>\r\n                    <div className=\"form-grid form-grid-2\">\r\n                      <div className=\"form-group\">\r\n                        <label>Site ID *</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          required\r\n                          value={siteForm.site_id}\r\n                          disabled={!!siteDetails}\r\n                          onChange={e => setSiteForm({ ...siteForm, site_id: e.target.value })}\r\n                          placeholder=\"e.g. site_mumbai_01\"\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                        {!!siteDetails && <small className=\"form-hint\">Site ID cannot be changed after creation.</small>}\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Display Name</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={siteForm.display_name}\r\n                          onChange={e => setSiteForm({ ...siteForm, display_name: e.target.value })}\r\n                          placeholder=\"e.g. Mumbai Rooftop\"\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Location</h4>\r\n                    <div className=\"form-grid form-grid-3\">\r\n                      <div className=\"form-group\">\r\n                        <label>Latitude *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          required\r\n                          step=\"any\"\r\n                          value={siteForm.latitude}\r\n                          onChange={e => setSiteForm({ ...siteForm, latitude: e.target.value })}\r\n                          placeholder=\"19.0760\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Longitude *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          required\r\n                          step=\"any\"\r\n                          value={siteForm.longitude}\r\n                          onChange={e => setSiteForm({ ...siteForm, longitude: e.target.value })}\r\n                          placeholder=\"72.8777\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Timezone</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={siteForm.timezone}\r\n                          onChange={e => setSiteForm({ ...siteForm, timezone: e.target.value })}\r\n                          placeholder=\"Asia/Kolkata\"\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Panel Configuration</h4>\r\n                    <div className=\"form-grid form-grid-3\">\r\n                      <div className=\"form-group\">\r\n                        <label>Capacity (kW) *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          required\r\n                          step=\"any\"\r\n                          value={siteForm.capacity_kw}\r\n                          onChange={e => setSiteForm({ ...siteForm, capacity_kw: e.target.value })}\r\n                          placeholder=\"5.0\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Tilt ()</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          step=\"any\"\r\n                          value={siteForm.tilt_deg}\r\n                          onChange={e => setSiteForm({ ...siteForm, tilt_deg: e.target.value })}\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Azimuth ()</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          step=\"any\"\r\n                          value={siteForm.azimuth_deg}\r\n                          onChange={e => setSiteForm({ ...siteForm, azimuth_deg: e.target.value })}\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label style={{ display: 'flex', alignItems: 'center', gap: '8px', cursor: 'pointer' }}>\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          id=\"dev-site-active\"\r\n                          checked={siteForm.is_active}\r\n                          onChange={e => setSiteForm({ ...siteForm, is_active: e.target.checked })}\r\n                          style={{ width: '16px', height: '16px', background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                        Active\r\n                      </label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"form-actions\" style={{ padding: '0 24px 24px 24px' }}>\r\n                  <button type=\"submit\" className=\"btn\" disabled={siteSaving}>\r\n                    {siteSaving ? 'Saving' : siteDetails ? 'Save Changes' : 'Add Site'}\r\n                  </button>\r\n                  <button type=\"button\" className=\"btn btn-secondary\" onClick={() => setEditingSite(false)} disabled={siteSaving}>\r\n                    Cancel\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {editingDevice && (\r\n          <div className=\"modal\">\r\n            <div className=\"modal-content\">\r\n              <h3>{editingDevice ? `Edit Device: ${editingDevice.device_serial}` : 'Register New Device'}</h3>\r\n              <form onSubmit={(e) => { e.preventDefault(); editingDevice ? handleSave() : handleCreate(); }}>\r\n                <div className=\"modal-body\">\r\n                  \r\n                  {/* Device Identity */}\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Device Identity</h4>\r\n                    <div className=\"form-grid\">\r\n                      <div className=\"form-group\">\r\n                        <label>Device Serial Number</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={editingDevice ? editForm.device_serial : createForm.device_serial}\r\n                          onChange={(e) => editingDevice ? setEditForm({...editForm, device_serial: e.target.value}) : setCreateForm({...createForm, device_serial: e.target.value})}\r\n                          required\r\n                          autoComplete=\"off\"\r\n                          placeholder=\"SN-12345678\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Ownership */}\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Ownership & Assignment</h4>\r\n                    <div className=\"form-grid\">\r\n                      <div className=\"form-group\">\r\n                        <label>Assigned User</label>\r\n                        <div style={{ position: 'relative' }} onClick={(e) => e.stopPropagation()}>\r\n                          <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search by name, username, or email...\"\r\n                            value={userSearchTerm}\r\n                            onChange={(e) => {\r\n                              setUserSearchTerm(e.target.value);\r\n                              setShowUserDropdown(true);\r\n                            }}\r\n                            onFocus={() => setShowUserDropdown(true)}\r\n                            autoComplete=\"off\"\r\n                            className=\"full-width\"\r\n                            style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                          />\r\n                          {showUserDropdown && (\r\n                            <div style={{\r\n                              position: 'absolute',\r\n                              top: '100%',\r\n                              left: '0',\r\n                              right: '0',\r\n                              background: 'var(--bg-secondary, #1e293b)',\r\n                              border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                              borderRadius: '6px',\r\n                              marginTop: '4px',\r\n                              maxHeight: '200px',\r\n                              overflowY: 'auto',\r\n                              zIndex: 10,\r\n                              boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)'\r\n                            }}>\r\n                              {filteredUsers.length > 0 ? (\r\n                                filteredUsers.map((user) => (\r\n                                  <div\r\n                                    key={user.id}\r\n                                    onClick={() => {\r\n                                      if (editingDevice) {\r\n                                        setEditForm({...editForm, user: user.username});\r\n                                      } else {\r\n                                        setCreateForm({...createForm, user: user.username});\r\n                                      }\r\n                                      setUserSearchTerm(`${user.first_name} ${user.last_name} (${user.username})`);\r\n                                      setShowUserDropdown(false);\r\n                                    }}\r\n                                    style={{\r\n                                      padding: '12px 16px',\r\n                                      cursor: 'pointer',\r\n                                      borderBottom: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n                                      background: (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent',\r\n                                      color: 'var(--text-primary, #f8fafc)',\r\n                                      transition: 'all 0.15s ease',\r\n                                      fontSize: '0.875rem'\r\n                                    }}\r\n                                    onMouseEnter={(e) => e.currentTarget.style.background = 'rgba(255, 255, 255, 0.06)'}\r\n                                    onMouseLeave={(e) => e.currentTarget.style.background = (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent'}\r\n                                  >\r\n                                    {user.first_name} {user.last_name} ({user.username}) <br/>\r\n                                    <span style={{ fontSize: '0.75rem', color: 'var(--text-secondary, #94a3b8)' }}>{user.email}</span>\r\n                                  </div>\r\n                                ))\r\n                              ) : (\r\n                                <div style={{ padding: '12px 16px', color: 'var(--text-muted, #64748b)', fontSize: '0.875rem' }}>\r\n                                  {userSearchTerm.trim() === '' ? 'Start typing to search users...' : 'No users found'}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Configuration */}\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Configuration</h4>\r\n                    <div className=\"form-grid form-grid-2\">\r\n                      <div className=\"form-group\">\r\n                        <label>Preset Template</label>\r\n                        <select\r\n                          value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                          onChange={(e) => editingDevice ? setEditForm({ ...editForm, config_version: e.target.value }) : setCreateForm({ ...createForm, config_version: e.target.value })}\r\n                          className=\"full-width\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        >\r\n                          <option value=\"\">-- Manual Configuration --</option>\r\n                          {presetsLoading && <option value=\"\" disabled>Loading presets...</option>}\r\n                          {!presetsLoading && presets.map((preset) => (\r\n                            <option key={preset.id} value={getPresetConfigId(preset)}>\r\n                              {preset.name} ({getPresetConfigId(preset) || 'no ID'})\r\n                            </option>\r\n                          ))}\r\n                        </select>\r\n                        <small className=\"form-hint\">Selecting a preset sets the Config Version ID below.</small>\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Config Version ID</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                          onChange={(e) => editingDevice ? setEditForm({...editForm, config_version: e.target.value}) : setCreateForm({...createForm, config_version: e.target.value})}\r\n                          autoComplete=\"off\"\r\n                          placeholder=\"Manual Config ID\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                </div>\r\n                {editingDevice && (\r\n                  <div style={{ padding: '0 24px' }}>\r\n                     <AuditTrail\r\n                       createdBy={editingDevice.created_by_username}\r\n                       createdAt={editingDevice.created_at}\r\n                       updatedBy={editingDevice.updated_by_username}\r\n                       updatedAt={editingDevice.updated_at}\r\n                     />\r\n                  </div>\r\n                )}\r\n                <div className=\"form-actions\" style={{ padding: '0 24px 24px 24px' }}>\r\n                  <button type=\"submit\" className=\"btn\">{editingDevice ? 'Save Changes' : 'Create Device'}</button>\r\n                  <button type=\"button\" onClick={handleCancel} className=\"btn btn-secondary\">Cancel</button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h1>Device Management</h1>\r\n\r\n      <div className=\"card\">\r\n        <div className=\"card-header\">\r\n          <h2>Devices ({filteredDevices.length})</h2>\r\n          <div className=\"card-actions\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search devices...\"\r\n              value={searchTerm}\r\n              onChange={handleSearch}\r\n              className=\"search-input\"\r\n              style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n            />\r\n            {selectedDevices.size > 0 && (\r\n              <button \r\n                onClick={handleBulkDelete}\r\n                disabled={bulkDeleteLoading}\r\n                style={{ \r\n                  background: 'var(--danger-color, #ef4444)',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '8px 16px',\r\n                  borderRadius: '6px',\r\n                  cursor: bulkDeleteLoading ? 'not-allowed' : 'pointer',\r\n                  fontSize: '0.875rem',\r\n                  fontWeight: '500',\r\n                  opacity: bulkDeleteLoading ? '0.6' : '1'\r\n                }}\r\n              >\r\n                {bulkDeleteLoading ? `Deleting ${selectedDevices.size}...` : `Delete Selected (${selectedDevices.size})`}\r\n              </button>\r\n            )}\r\n            <button onClick={() => {\r\n              setCreatingDevice(true);\r\n              setUserSearchTerm('');\r\n              setShowUserDropdown(false);\r\n            }} className=\"btn\">\r\n              Register New Device\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <table className=\"table\">\r\n          <thead>\r\n            <tr>\r\n              <th style={{ textAlign: 'center', width: '40px' }}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={selectedDevices.size === filteredDevices.length && filteredDevices.length > 0}\r\n                  onChange={handleSelectAll}\r\n                  title=\"Select all displayed devices\"\r\n                  style={{ background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                />\r\n              </th>\r\n              <th style={{ textAlign: 'center' }}>Device Serial</th>\r\n              <th style={{ textAlign: 'center' }}>Status</th>\r\n              <th style={{ textAlign: 'center' }}>MAC / HW ID</th>\r\n              <th style={{ textAlign: 'center' }}>Model</th>\r\n              <th style={{ textAlign: 'center' }}>Assigned To</th>\r\n              <th style={{ textAlign: 'center' }}>Config Version</th>\r\n              <th style={{ textAlign: 'center' }}>Provisioned At</th>\r\n              <th style={{ textAlign: 'center' }}>Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {filteredDevices.map((device) => (\r\n              <tr\r\n                key={device.id}\r\n                onClick={() => handleViewDevice(device)}\r\n                style={{\r\n                  background: selectedDevices.has(device.id) ? 'rgba(99, 102, 241, 0.1)' : 'transparent',\r\n                  cursor: 'pointer'\r\n                }}\r\n                className=\"clickable-row\"\r\n              >\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedDevices.has(device.id)}\r\n                    onChange={() => handleSelectDevice(device.id)}\r\n                    style={{ background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                  />\r\n                </td>\r\n                <td style={{ textAlign: 'center', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.85rem' }}>{device.device_serial}</td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <span style={{\r\n                    display: 'inline-block',\r\n                    padding: '4px 8px',\r\n                    borderRadius: '12px',\r\n                    fontSize: '0.75rem',\r\n                    fontWeight: '500',\r\n                    backgroundColor: device.is_online ? '#dcfce7' : '#fee2e2',\r\n                    color: device.is_online ? '#166534' : '#991b1b'\r\n                  }}>\r\n                    {device.is_online ? ' Online' : ' Offline'}\r\n                  </span>\r\n                </td>\r\n                <td style={{ textAlign: 'center', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.82rem', color: device.hw_id ? 'inherit' : 'var(--text-muted, #9ca3af)' }}>{device.hw_id || ''}</td>\r\n                <td style={{ textAlign: 'center', fontSize: '0.875rem' }}>{device.model || <span style={{ color: 'var(--text-muted, #9ca3af)' }}></span>}</td>\r\n                <td style={{ textAlign: 'center' }}>{device.user || '-'}</td>\r\n                <td style={{ textAlign: 'center' }}>{device.config_version || '-'}</td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  {(() => {\r\n                    if (!device.provisioned_at) return 'N/A';\r\n                    const date = new Date(device.provisioned_at);\r\n                    return isNaN(date.getTime()) ? 'Invalid Date' : date.toLocaleDateString();\r\n                  })()}\r\n                </td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <button\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleEdit(device);\r\n                    }}\r\n                    style={{ background: 'none', border: 'none', cursor: 'pointer', color: 'var(--text-secondary, #94a3b8)', margin: '0 6px' }}\r\n                    title=\"Edit\"\r\n                  >\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                      <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\r\n                      <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\r\n                    </svg>\r\n                  </button>\r\n                  <button\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleDelete(device);\r\n                    }}\r\n                    style={{ background: 'none', border: 'none', cursor: 'pointer', color: 'var(--danger-color, #ef4444)', margin: '0 6px' }}\r\n                    title=\"Delete\"\r\n                  >\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                      <polyline points=\"3,6 5,6 21,6\"></polyline>\r\n                      <path d=\"M19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2\"></path>\r\n                      <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\"></line>\r\n                      <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\"></line>\r\n                    </svg>\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n        \r\n        {/* Pagination Controls */}\r\n        {totalCount > 0 && (\r\n          <div style={{\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            padding: '16px',\r\n            borderTop: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n            gap: '16px'\r\n          }}>\r\n            <div style={{ fontSize: '0.875rem', color: 'var(--text-secondary, #94a3b8)' }}>\r\n              Showing {((currentPage - 1) * pageSize) + 1} - {Math.min(currentPage * pageSize, totalCount)} of {totalCount} devices\r\n            </div>\r\n            \r\n            <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>\r\n              <button\r\n                onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\r\n                disabled={currentPage === 1}\r\n                style={{\r\n                  padding: '8px 12px',\r\n                  border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                  borderRadius: '6px',\r\n                  background: currentPage === 1 ? 'rgba(148, 163, 184, 0.1)' : 'transparent',\r\n                  color: 'var(--text-primary, #f8fafc)',\r\n                  cursor: currentPage === 1 ? 'not-allowed' : 'pointer',\r\n                  opacity: currentPage === 1 ? '0.5' : '1'\r\n                }}\r\n              >\r\n                 Previous\r\n              </button>\r\n              \r\n              <div style={{ display: 'flex', gap: '4px', alignItems: 'center' }}>\r\n                {(() => {\r\n                  const pages = [];\r\n                  \r\n                  for (let i = 1; i <= totalPages; i++) {\r\n                    // Always show first page, last page, current page, and adjacent pages\r\n                    const showPage = i === 1 || i === totalPages || Math.abs(i - currentPage) <= 1;\r\n                    \r\n                    if (showPage) {\r\n                      pages.push(\r\n                        <button\r\n                          key={i}\r\n                          onClick={() => setCurrentPage(i)}\r\n                          style={{\r\n                            padding: '6px 10px',\r\n                            border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                            borderRadius: '4px',\r\n                            background: i === currentPage ? 'rgba(99, 102, 241, 0.2)' : 'transparent',\r\n                            color: 'var(--text-primary, #f8fafc)',\r\n                            cursor: 'pointer',\r\n                            fontWeight: i === currentPage ? 'bold' : 'normal',\r\n                            minWidth: '32px'\r\n                          }}\r\n                        >\r\n                          {i}\r\n                        </button>\r\n                      );\r\n                    } else if (pages[pages.length - 1]?.key !== 'ellipsis-' + Math.floor(i / 10)) {\r\n                      // Add ellipsis if we skipped pages and haven't added one recently\r\n                      pages.push(\r\n                        <span key={`ellipsis-${Math.floor(i / 10)}`} style={{ padding: '0 4px', color: 'var(--text-secondary, #94a3b8)' }}>\r\n                          ...\r\n                        </span>\r\n                      );\r\n                    }\r\n                  }\r\n                  \r\n                  return pages;\r\n                })()}\r\n              </div>\r\n              \r\n              <button\r\n                onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\r\n                disabled={currentPage === totalPages}\r\n                style={{\r\n                  padding: '8px 12px',\r\n                  border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                  borderRadius: '6px',\r\n                  background: currentPage === totalPages ? 'rgba(148, 163, 184, 0.1)' : 'transparent',\r\n                  color: 'var(--text-primary, #f8fafc)',\r\n                  cursor: currentPage === totalPages ? 'not-allowed' : 'pointer',\r\n                  opacity: currentPage === totalPages ? '0.5' : '1'\r\n                }}\r\n              >\r\n                Next \r\n              </button>\r\n            </div>\r\n            \r\n            <select\r\n              value={pageSize}\r\n              onChange={(e) => {\r\n                setPageSize(parseInt(e.target.value));\r\n                setCurrentPage(1);\r\n              }}\r\n              style={{\r\n                padding: '8px',\r\n                border: isDark ? '1px solid #404040' : '1px solid rgba(148, 163, 184, 0.2)',\r\n                borderRadius: '6px',\r\n                background: isDark ? '#1a1a1a' : '#0f172a',\r\n                color: isDark ? '#e0e0e0' : '#f8fafc',\r\n                cursor: 'pointer',\r\n                fontSize: '0.875rem'\r\n              }}\r\n            >\r\n              <option value={10}>10 per page</option>\r\n              <option value={25}>25 per page</option>\r\n              <option value={50}>50 per page</option>\r\n              <option value={100}>100 per page</option>\r\n            </select>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {(editingDevice || creatingDevice) && (\r\n        <div className=\"modal\">\r\n          <div className=\"modal-content\">\r\n            <h3>{editingDevice ? `Edit Device: ${editingDevice.device_serial}` : 'Register New Device'}</h3>\r\n            <form onSubmit={(e) => { e.preventDefault(); editingDevice ? handleSave() : handleCreate(); }}>\r\n              <div className=\"modal-body\">\r\n                \r\n                {/* Device Identity */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Device Identity</h4>\r\n                  <div className=\"form-grid\">\r\n                    <div className=\"form-group\">\r\n                      <label>Device Serial Number</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingDevice ? editForm.device_serial : createForm.device_serial}\r\n                        onChange={(e) => editingDevice ? setEditForm({...editForm, device_serial: e.target.value}) : setCreateForm({...createForm, device_serial: e.target.value})}\r\n                        required\r\n                        autoComplete=\"off\"\r\n                        placeholder=\"SN-12345678\"\r\n                        style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Ownership */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Ownership & Assignment</h4>\r\n                  <div className=\"form-grid\">\r\n                    <div className=\"form-group\">\r\n                      <label>Assigned User</label>\r\n                      <div style={{ position: 'relative' }} onClick={(e) => e.stopPropagation()}>\r\n                        <input\r\n                          type=\"text\"\r\n                          placeholder=\"Search and select user...\"\r\n                          value={userSearchTerm}\r\n                          onChange={(e) => {\r\n                            setUserSearchTerm(e.target.value);\r\n                            setShowUserDropdown(true);\r\n                          }}\r\n                          onFocus={() => setShowUserDropdown(true)}\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                        {(editingDevice ? editForm.user : createForm.user) && (\r\n                          <div style={{ marginTop: '8px', fontSize: '0.875rem', color: isDark ? '#b0b0b0' : '#94a3b8' }}>\r\n                            <strong>Selected:</strong> {users.find(u => u.username === (editingDevice ? editForm.user : createForm.user))?.first_name} {users.find(u => u.username === (editingDevice ? editForm.user : createForm.user))?.last_name} ({editingDevice ? editForm.user : createForm.user})\r\n                            <button\r\n                              type=\"button\"\r\n                              onClick={() => {\r\n                                if (editingDevice) {\r\n                                  setEditForm({...editForm, user: ''});\r\n                                } else {\r\n                                  setCreateForm({...createForm, user: ''});\r\n                                }\r\n                                setUserSearchTerm('');\r\n                              }}\r\n                              className=\"btn-icon btn-icon-danger\"\r\n                              style={{ marginLeft: '10px' }}\r\n                              title=\"Remove Assignment\"\r\n                            >\r\n                              \r\n                            </button>\r\n                          </div>\r\n                        )}\r\n                        {showUserDropdown && (\r\n                          <div style={{\r\n                            position: 'absolute',\r\n                            top: '100%',\r\n                            left: 0,\r\n                            right: 0,\r\n                            background: 'var(--bg-secondary, #0f172a)',\r\n                            border: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n                            borderRadius: '8px',\r\n                            maxHeight: '200px',\r\n                            overflowY: 'auto',\r\n                            zIndex: 1000,\r\n                            boxShadow: 'var(--shadow-xl)',\r\n                            marginTop: '4px'\r\n                          }}>\r\n                            {filteredUsers.length > 0 ? (\r\n                              filteredUsers.map((user) => (\r\n                                <div\r\n                                  key={user.id}\r\n                                  onClick={() => {\r\n                                    if (editingDevice) {\r\n                                      setEditForm({...editForm, user: user.username});\r\n                                    } else {\r\n                                      setCreateForm({...createForm, user: user.username});\r\n                                    }\r\n                                    setUserSearchTerm(`${user.first_name} ${user.last_name} (${user.username})`);\r\n                                    setShowUserDropdown(false);\r\n                                  }}\r\n                                  style={{\r\n                                    padding: '12px 16px',\r\n                                    cursor: 'pointer',\r\n                                    borderBottom: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n                                    background: (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent',\r\n                                    color: 'var(--text-primary, #f8fafc)',\r\n                                    transition: 'all 0.15s ease',\r\n                                    fontSize: '0.875rem'\r\n                                  }}\r\n                                  onMouseEnter={(e) => e.currentTarget.style.background = 'rgba(255, 255, 255, 0.06)'}\r\n                                  onMouseLeave={(e) => e.currentTarget.style.background = (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent'}\r\n                                >\r\n                                  {user.first_name} {user.last_name} ({user.username}) <br/>\r\n                                  <span style={{ fontSize: '0.75rem', color: 'var(--text-secondary, #94a3b8)' }}>{user.email}</span>\r\n                                </div>\r\n                              ))\r\n                            ) : (\r\n                              <div style={{ padding: '12px 16px', color: 'var(--text-muted, #64748b)', fontSize: '0.875rem' }}>\r\n                                {userSearchTerm.trim() === '' ? 'Start typing to search users...' : 'No users found'}\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Configuration */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Configuration</h4>\r\n                  <div className=\"form-grid form-grid-2\">\r\n                    <div className=\"form-group\">\r\n                      <label>Preset Template</label>\r\n                      <select\r\n                        value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                        onChange={(e) => editingDevice ? setEditForm({ ...editForm, config_version: e.target.value }) : setCreateForm({ ...createForm, config_version: e.target.value })}\r\n                        className=\"full-width\"\r\n                        style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                      >\r\n                        <option value=\"\">-- Manual Configuration --</option>\r\n                        {presetsLoading && <option value=\"\" disabled>Loading presets...</option>}\r\n                        {!presetsLoading && presets.map((preset) => (\r\n                          <option key={preset.id} value={getPresetConfigId(preset)}>\r\n                            {preset.name} ({getPresetConfigId(preset) || 'no ID'})\r\n                          </option>\r\n                        ))}\r\n                      </select>\r\n                      <small className=\"form-hint\">Selecting a preset sets the Config Version ID below.</small>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label>Config Version ID</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                        onChange={(e) => editingDevice ? setEditForm({...editForm, config_version: e.target.value}) : setCreateForm({...createForm, config_version: e.target.value})}\r\n                        autoComplete=\"off\"\r\n                        placeholder=\"Manual Config ID\"\r\n                        style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n              </div>\r\n              {editingDevice && (\r\n                <div style={{ padding: '0 24px' }}>\r\n                   <AuditTrail\r\n                     createdBy={editingDevice.created_by_username}\r\n                     createdAt={editingDevice.created_at}\r\n                     updatedBy={editingDevice.updated_by_username}\r\n                     updatedAt={editingDevice.updated_at}\r\n                   />\r\n                </div>\r\n              )}\r\n              <div className=\"form-actions\" style={{ padding: '24px' }}>\r\n                <button type=\"submit\" className=\"btn\">{editingDevice ? 'Save Changes' : 'Register Device'}</button>\r\n                <button type=\"button\" onClick={handleCancel} className=\"btn btn-secondary\">Cancel</button>\r\n              </div>\r\n            </form>\r\n        </div>\r\n      </div>\r\n    )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Devices;","/**\r\n * Enhanced in-memory cache service for API responses\r\n * Features:\r\n * - TTL-based expiration\r\n * - Stale-while-revalidate pattern support\r\n * - Subscription system for real-time updates\r\n * - Pattern-based cache invalidation\r\n */\r\n\r\ninterface CacheEntry {\r\n  data: any;\r\n  timestamp: number;\r\n  expiresIn: number; // milliseconds\r\n  staleTime?: number; // Time after which data is considered stale but usable\r\n}\r\n\r\ninterface CacheSubscription {\r\n  callback: (data: any) => void;\r\n  pattern?: RegExp;\r\n}\r\n\r\nclass CacheService {\r\n  private cache: Map<string, CacheEntry> = new Map();\r\n  private subscribers: Map<string, Set<CacheSubscription>> = new Map();\r\n  private static readonly DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes default\r\n  private static readonly LONG_TTL = 30 * 60 * 1000; // 30 minutes for static data\r\n  private static readonly REALTIME_TTL = 10 * 1000; // 10 seconds for real-time data\r\n  private static readonly STALE_TIME = 30 * 1000; // 30 seconds before data is stale\r\n\r\n  /**\r\n   * Set a cache entry and notify subscribers\r\n   */\r\n  set(key: string, data: any, ttlMs: number = CacheService.DEFAULT_TTL, staleTime?: number): void {\r\n    this.cache.set(key, {\r\n      data,\r\n      timestamp: Date.now(),\r\n      expiresIn: ttlMs,\r\n      staleTime: staleTime ?? Math.min(ttlMs / 2, CacheService.STALE_TIME),\r\n    });\r\n    \r\n    // Notify subscribers\r\n    this.notifySubscribers(key, data);\r\n  }\r\n\r\n  /**\r\n   * Get a cache entry if valid (returns null if expired)\r\n   */\r\n  get(key: string): any | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    // Check if expired\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return entry.data;\r\n  }\r\n\r\n  /**\r\n   * Get cache entry even if stale (for stale-while-revalidate pattern)\r\n   * Returns { data, isStale } or null if no entry exists\r\n   */\r\n  getWithStaleStatus(key: string): { data: any; isStale: boolean; isExpired: boolean } | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    const now = Date.now();\r\n    const age = now - entry.timestamp;\r\n    const isExpired = age > entry.expiresIn;\r\n    const isStale = age > (entry.staleTime ?? entry.expiresIn / 2);\r\n\r\n    // Remove if fully expired\r\n    if (isExpired) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      data: entry.data,\r\n      isStale,\r\n      isExpired: false,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Check if key exists and is not expired\r\n   */\r\n  has(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return false;\r\n\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Check if cached data is stale but usable\r\n   */\r\n  isStale(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return true;\r\n\r\n    const now = Date.now();\r\n    const age = now - entry.timestamp;\r\n    return age > (entry.staleTime ?? entry.expiresIn / 2);\r\n  }\r\n\r\n  /**\r\n   * Clear a specific cache entry\r\n   */\r\n  clear(key: string): void {\r\n    this.cache.delete(key);\r\n  }\r\n\r\n  /**\r\n   * Clear cache entries matching a pattern\r\n   */\r\n  clearPattern(pattern: string | RegExp): void {\r\n    const regex = typeof pattern === 'string' ? new RegExp(pattern) : pattern;\r\n    const keysToDelete: string[] = [];\r\n    \r\n    this.cache.forEach((_, key) => {\r\n      if (regex.test(key)) {\r\n        keysToDelete.push(key);\r\n      }\r\n    });\r\n    \r\n    keysToDelete.forEach(key => this.cache.delete(key));\r\n  }\r\n\r\n  /**\r\n   * Clear all cache entries\r\n   */\r\n  clearAll(): void {\r\n    this.cache.clear();\r\n  }\r\n\r\n  /**\r\n   * Get cache size\r\n   */\r\n  size(): number {\r\n    return this.cache.size;\r\n  }\r\n\r\n  /**\r\n   * Subscribe to cache updates for a specific key\r\n   */\r\n  subscribe(key: string, callback: (data: any) => void): () => void {\r\n    if (!this.subscribers.has(key)) {\r\n      this.subscribers.set(key, new Set());\r\n    }\r\n    \r\n    const subscription: CacheSubscription = { callback };\r\n    this.subscribers.get(key)!.add(subscription);\r\n\r\n    // Return unsubscribe function\r\n    return () => {\r\n      const subs = this.subscribers.get(key);\r\n      if (subs) {\r\n        subs.delete(subscription);\r\n        if (subs.size === 0) {\r\n          this.subscribers.delete(key);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Subscribe to cache updates matching a pattern\r\n   */\r\n  subscribePattern(pattern: RegExp, callback: (data: any) => void): () => void {\r\n    const key = `__pattern__${pattern.source}`;\r\n    if (!this.subscribers.has(key)) {\r\n      this.subscribers.set(key, new Set());\r\n    }\r\n    \r\n    const subscription: CacheSubscription = { callback, pattern };\r\n    this.subscribers.get(key)!.add(subscription);\r\n\r\n    return () => {\r\n      const subs = this.subscribers.get(key);\r\n      if (subs) {\r\n        subs.delete(subscription);\r\n        if (subs.size === 0) {\r\n          this.subscribers.delete(key);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Notify all subscribers of a cache update\r\n   */\r\n  private notifySubscribers(key: string, data: any): void {\r\n    // Direct key subscribers\r\n    const directSubs = this.subscribers.get(key);\r\n    if (directSubs) {\r\n      directSubs.forEach(sub => {\r\n        try {\r\n          sub.callback(data);\r\n        } catch (error) {\r\n          console.error(`Cache subscriber error for key ${key}:`, error);\r\n        }\r\n      });\r\n    }\r\n\r\n    // Pattern subscribers\r\n    this.subscribers.forEach((subs, subKey) => {\r\n      if (subKey.startsWith('__pattern__')) {\r\n        subs.forEach(sub => {\r\n          if (sub.pattern && sub.pattern.test(key)) {\r\n            try {\r\n              sub.callback(data);\r\n            } catch (error) {\r\n              console.error(`Cache pattern subscriber error for key ${key}:`, error);\r\n            }\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get all keys in cache\r\n   */\r\n  keys(): string[] {\r\n    return Array.from(this.cache.keys());\r\n  }\r\n\r\n  /**\r\n   * Get cache stats for debugging\r\n   */\r\n  getStats(): { size: number; keys: string[]; subscribers: number } {\r\n    return {\r\n      size: this.cache.size,\r\n      keys: this.keys(),\r\n      subscribers: Array.from(this.subscribers.values()).reduce((sum, set) => sum + set.size, 0),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get TTL constants\r\n   */\r\n  static getTTL(type: 'short' | 'long' | 'realtime' = 'short'): number {\r\n    switch (type) {\r\n      case 'realtime':\r\n        return CacheService.REALTIME_TTL;\r\n      case 'long':\r\n        return CacheService.LONG_TTL;\r\n      default:\r\n        return CacheService.DEFAULT_TTL;\r\n    }\r\n  }\r\n}\r\n\r\nexport const cacheService = new CacheService();\r\nexport const DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes\r\nexport const LONG_TTL = 30 * 60 * 1000; // 30 minutes\r\nexport const REALTIME_TTL = 10 * 1000; // 10 seconds\r\n","import { cacheService, DEFAULT_TTL } from './cacheService';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'https://smart-solar-django-backend.vercel.app/api';\r\n\r\nclass ApiService {\r\n  private getAuthHeaders(): HeadersInit {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (tokens) {\r\n      try {\r\n        const parsedTokens = JSON.parse(tokens);\r\n        return {\r\n          'Authorization': `Bearer ${parsedTokens.access}`,\r\n          'Content-Type': 'application/json',\r\n        };\r\n      } catch (error) {\r\n        console.error('Error parsing auth tokens:', error);\r\n      }\r\n    }\r\n    return {\r\n      'Content-Type': 'application/json',\r\n    };\r\n  }\r\n\r\n  private async request(endpoint: string, options: RequestInit = {}): Promise<any> {\r\n    const url = `${API_BASE_URL}${endpoint}`;\r\n    let headers = this.getAuthHeaders();\r\n\r\n    let response = await fetch(url, {\r\n      ...options,\r\n      headers: {\r\n        ...headers,\r\n        ...options.headers,\r\n      },\r\n    });\r\n\r\n    if (response.status === 401) {\r\n      // Try to refresh token\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        // Retry with new token\r\n        headers = this.getAuthHeaders();\r\n        response = await fetch(url, {\r\n          ...options,\r\n          headers: {\r\n            ...headers,\r\n            ...options.headers,\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      // Token refresh failed or not attempted, logout\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`API request failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n    }\r\n\r\n    if (response.status === 204) return null;\r\n    return response.json();\r\n  }\r\n\r\n  private async refreshToken(): Promise<boolean> {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (!tokens) return false;\r\n\r\n    try {\r\n      const parsedTokens = JSON.parse(tokens);\r\n      const response = await fetch(`${API_BASE_URL}/auth/token/refresh/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ refresh: parsedTokens.refresh }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        const newTokens = {\r\n          access: data.access,\r\n          refresh: parsedTokens.refresh, // Keep the same refresh token\r\n        };\r\n        localStorage.setItem('authTokens', JSON.stringify(newTokens));\r\n        return true;\r\n      }\r\n    } catch (error) {\r\n      console.error('Token refresh failed:', error);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  async getConfiguration(): Promise<any> {\r\n    return this.request('/config/');\r\n  }\r\n\r\n  async getTelemetry(): Promise<any[]> {\r\n    return this.request('/telemetry/');\r\n  }\r\n\r\n  async provisionDevice(data: any): Promise<any> {\r\n    const response = await fetch(`${API_BASE_URL}/devices/provision`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n    if (!response.ok) {\r\n      throw new Error(`Provisioning failed: ${response.statusText}`);\r\n    }\r\n    return response.json();\r\n  }\r\n\r\n  async getAlerts(): Promise<any[]> {\r\n    const cacheKey = 'alerts';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/alerts/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getSystemHealth(): Promise<any> {\r\n    const cacheKey = 'system_health';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/health/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getKPIs(): Promise<any> {\r\n    const cacheKey = 'kpis';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/kpis/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getUsers(search?: string): Promise<any[]> {\r\n    const cacheKey = `users_${search || 'all'}`;\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    const data = await this.request(`/users/${params}`);\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async createUser(userData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(userData),\r\n    });\r\n    // Invalidate users cache\r\n    cacheService.clear('users_all');\r\n    cacheService.clearAll(); // Clear all cache for safety\r\n    return result;\r\n  }\r\n\r\n  async createEmployee(employeeData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ ...employeeData, is_staff: true }),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async getUserDevices(userId: number): Promise<any[]> {\r\n    return this.request(`/users/${userId}/devices/`);\r\n  }\r\n\r\n  async getUserSite(userId: number): Promise<any> {\r\n    return this.request(`/users/${userId}/site/`);\r\n  }\r\n\r\n  async createUserSite(userId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/users/${userId}/site/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async updateUserSite(userId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/users/${userId}/site/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async getDeviceSite(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/`);\r\n  }\r\n\r\n  async createDeviceSite(deviceId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async updateDeviceSite(deviceId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // DynamoDB site data\r\n  async getSiteTelemetry(siteId: string, params?: { start_date?: string; end_date?: string; days?: number }): Promise<any[]> {\r\n    const query = new URLSearchParams();\r\n    if (params?.start_date) query.append('start_date', params.start_date);\r\n    if (params?.end_date) query.append('end_date', params.end_date);\r\n    if (params?.days) query.append('days', params.days.toString());\r\n    const url = `/sites/${siteId}/telemetry/${query.toString() ? '?' + query.toString() : ''}`;\r\n    return this.request(url);\r\n  }\r\n\r\n  async getSiteForecast(siteId: string, params?: { date?: string; start_date?: string; end_date?: string }): Promise<any[]> {\r\n    const query = new URLSearchParams();\r\n    if (params?.date) query.append('date', params.date);\r\n    if (params?.start_date) query.append('start_date', params.start_date);\r\n    if (params?.end_date) query.append('end_date', params.end_date);\r\n    const url = `/sites/${siteId}/forecast/${query.toString() ? '?' + query.toString() : ''}`;\r\n    return this.request(url);\r\n  }\r\n\r\n  async getSiteWeather(siteId: string): Promise<any> {\r\n    return this.request(`/sites/${siteId}/weather/`);\r\n  }\r\n\r\n  async updateUser(userId: number, data: any): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async deleteUser(userId: number): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  // Profile Management (for current logged-in user)\r\n  async getProfile(): Promise<any> {\r\n    return this.request('/profile/');\r\n  }\r\n\r\n  async updateProfile(data: any): Promise<any> {\r\n    return this.request('/profile/update/', {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async changePassword(data: { current_password: string; new_password: string }): Promise<any> {\r\n    return this.request('/profile/change-password/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // Customer Management (separate from staff users/employees)\r\n  async getCustomers(search?: string): Promise<any[]> {\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    return this.request(`/customers/${params}`);\r\n  }\r\n\r\n  async createCustomer(customerData: any): Promise<any> {\r\n    return this.request('/customers/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(customerData),\r\n    });\r\n  }\r\n\r\n  async getCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/`);\r\n  }\r\n\r\n  async updateCustomer(customerId: number, data: any): Promise<any> {\r\n    return this.request(`/customers/${customerId}/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getPresets(): Promise<any[]> {\r\n    const cacheKey = 'presets';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/presets/');\r\n    // Use longer TTL for presets as they change less frequently\r\n    cacheService.set(cacheKey, data, 30 * 60 * 1000); // 30 minutes\r\n    return data;\r\n  }\r\n\r\n  async createPreset(data: any): Promise<any> {\r\n    const result = await this.request('/presets/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async updatePreset(id: number, data: any): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async deletePreset(id: number): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async getGlobalSlaves(): Promise<any[]> {\r\n    return this.request('/slaves/');\r\n  }\r\n\r\n  async createGlobalSlave(slaveData: any): Promise<any> {\r\n    return this.request('/slaves/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateGlobalSlave(slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteGlobalSlave(slaveId: number): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getDevices(search?: string, page: number = 1, pageSize: number = 25): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    if (search) params.append('search', search);\r\n    params.append('page', page.toString());\r\n    params.append('page_size', pageSize.toString());\r\n    \r\n    const queryString = params.toString();\r\n    return this.request(`/devices/?${queryString}`);\r\n  }\r\n\r\n  async createDevice(deviceData: any): Promise<any> {\r\n    return this.request('/devices/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(deviceData),\r\n    });\r\n  }\r\n\r\n  async updateDevice(deviceId: number, data: any): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async rebootDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/reboot/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  async hardResetDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/hard-reset/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  async getDeviceLogs(deviceId: number, limit: number = 100, offset: number = 0): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/logs/?limit=${limit}&offset=${offset}`);\r\n  }\r\n\r\n  async toggleDeviceLogs(deviceId: number, enabled: boolean): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/logs/toggle/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ enabled }),\r\n    });\r\n  }\r\n\r\n  async deleteDevicesBulk(deviceIds: number[]): Promise<any> {\r\n    return this.request(`/devices/delete-bulk/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ device_ids: deviceIds }),\r\n    });\r\n  }\r\n\r\n  async getSlaves(configId: string): Promise<any[]> {\r\n    return this.request(`/presets/${configId}/slaves/`);\r\n  }\r\n\r\n  async createSlave(configId: string, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/create/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateSlave(configId: string, slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteSlave(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async addSlavesToPreset(configId: string, slaveIds: number[]): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/add/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ slave_ids: slaveIds }),\r\n    });\r\n  }\r\n\r\n  async detachSlaveFromPreset(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/detach/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  // OTA (Over-The-Air) Update Endpoints\r\n  async getFirmwareVersions(activeOnly: boolean = true): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    params.append('active', activeOnly.toString());\r\n    return this.request(`/ota/firmware/?${params.toString()}`);\r\n  }\r\n\r\n  async uploadFirmwareVersion(formData: FormData): Promise<any> {\r\n    const url = `${API_BASE_URL}/ota/firmware/create/`;\r\n    const tokens = localStorage.getItem('authTokens');\r\n    \r\n    if (!tokens) {\r\n      throw new Error('Authentication required');\r\n    }\r\n    \r\n    const parsedTokens = JSON.parse(tokens);\r\n    let headers: HeadersInit = {\r\n      'Authorization': `Bearer ${parsedTokens.access}`,\r\n    };\r\n    // Don't set Content-Type - let browser set it with boundary for multipart/form-data\r\n    \r\n    let response = await fetch(url, {\r\n      method: 'POST',\r\n      headers,\r\n      body: formData,\r\n    });\r\n\r\n    // Handle 401 with token refresh\r\n    if (response.status === 401) {\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        const newTokens = JSON.parse(localStorage.getItem('authTokens') || '{}');\r\n        headers = {\r\n          'Authorization': `Bearer ${newTokens.access}`,\r\n        };\r\n        response = await fetch(url, {\r\n          method: 'POST',\r\n          headers,\r\n          body: formData,\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`Upload failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  async updateFirmwareVersion(firmwareId: number, data: any): Promise<any> {\r\n    return this.request(`/ota/firmware/${firmwareId}/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteFirmwareVersion(firmwareId: number): Promise<any> {\r\n    return this.request(`/ota/firmware/${firmwareId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getDeviceUpdateLogs(deviceId: string): Promise<any> {\r\n    return this.request(`/ota/devices/${deviceId}/logs`);\r\n  }\r\n\r\n  async getOTAConfig(): Promise<any> {\r\n    return this.request(`/ota/config/`);\r\n  }\r\n\r\n  async updateOTAConfig(config: any): Promise<any> {\r\n    return this.request(`/ota/config/update/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(config),\r\n    });\r\n  }\r\n\r\n  async getOTAHealth(): Promise<any> {\r\n    return this.request(`/ota/health/`);\r\n  }\r\n\r\n  async triggerRollback(deviceSerial: string, notes?: string): Promise<any> {\r\n    return this.request(`/ota/updates/rollback/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        device_serial: deviceSerial,\r\n        notes: notes || ''\r\n      }),\r\n    });\r\n  }\r\n\r\n  async deployFirmware(firmwareId: number, deviceSerials: string[], notes?: string): Promise<any> {\r\n    return this.request(`/ota/updates/multiple/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        firmware_id: firmwareId,\r\n        device_serials: deviceSerials,\r\n        notes: notes || ''\r\n      }),\r\n    });\r\n  }\r\n\r\n  async listTargetedUpdates(): Promise<any> {\r\n    return this.request(`/ota/updates/`);\r\n  }\r\n\r\n  async getTargetedUpdate(updateId: number): Promise<any> {\r\n    return this.request(`/ota/updates/${updateId}/`);\r\n  }\r\n}\r\n\r\nexport const apiService = new ApiService();"],"names":["AuditTrail","_ref","createdBy","createdAt","updatedBy","updatedAt","className","formatDate","dateString","Date","toLocaleString","_unused","_jsxs","children","_jsx","React","useDebouncedCallback","callback","delay","arguments","length","undefined","timeoutId","setTimeoutId","useState","debouncedCallback","useCallback","_len","args","Array","_key","clearTimeout","newTimeoutId","setTimeout","useEffect","ForecastTooltip","active","payload","label","style","background","border","borderRadius","padding","boxShadow","fontSize","minWidth","fontWeight","color","marginBottom","map","entry","margin","name","fontFamily","value","dataKey","fmt","ts","range","date","toLocaleTimeString","hour","minute","toLocaleDateString","weekday","month","day","TOOLTIP_STYLE","IconSun","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","cx","cy","r","x1","y1","x2","y2","IconBattery","x","y","rx","IconLoad","d","points","IconEnergy","IconCloud","KpiCard","_ref2","unit","sub","accent","icon","flex","display","justifyContent","alignItems","textTransform","letterSpacing","concat","flexShrink","lineHeight","marginLeft","_ref3","_latest$pv1_power_w","_latest$pv2_power_w","_latest$battery_soc_p","_latest$load_power_w","_latest$pv_today_kwh","siteId","autoRefresh","telemetry","setTelemetry","forecast","setForecast","weather","setWeather","loading","setLoading","error","setError","lastUpdated","setLastUpdated","showBands","setShowBands","P10","P50","P90","dateRange","setDateRange","customStartDate","setCustomStartDate","customEndDate","setCustomEndDate","fetchAll","async","telemetryParams","start_date","toISOString","end_date","days","forecastParams","end","start","setDate","getDate","split","tel","fcst","wth","Promise","all","apiService","getSiteTelemetry","getSiteForecast","getSiteWeather","console","log","isArray","err","Error","message","id","setInterval","clearInterval","latest","pvKw","pv1_power_w","pv2_power_w","batSoc","battery_soc_percent","loadKw","load_power_w","todayKwh","pv_today_kwh","historyData","data","filter","_","i","buckets","Map","forEach","row","timestamp","hourKey","getFullYear","getMonth","getHours","has","set","get","push","from","values","bucket","first","reduce","sum","_r$pv1_power_w","_r$pv2_power_w","_r$load_power_w","grid_power_w","_r$grid_power_w","_r$battery_soc_percen","dayKey","_r$pv1_power_w2","_r$pv2_power_w2","_r$load_power_w2","_r$grid_power_w2","_r$battery_soc_percen2","Math","max","_r$pv_today_kwh","aggregateByPeriod","_row$pv1_power_w","_row$pv2_power_w","_row$load_power_w","_row$grid_power_w","_row$battery_soc_perc","time","toFixed","forecastData","cleanTs","forecast_for","replace","forecastFor","_unused2","fmtForecast","p50","p50_kw","p10","p10_kw","p90","p90_kw","forecastEnergyP10","forecastEnergyP50","forecastEnergyP90","forecastGeneratedAt","firstForecast","generated_at","t1","getTime","t2","intervalHours","abs","gap","flexWrap","marginTop","noData","onChange","e","target","cursor","_Fragment","type","onClick","textAlign","temperature_c","humidity_pct","cloud_cover_pct","wind_speed_ms","ghi_wm2","round","p","ResponsiveContainer","AreaChart","top","right","left","bottom","offset","stopColor","stopOpacity","CartesianGrid","strokeDasharray","XAxis","interval","ceil","angle","textAnchor","YAxis","tickFormatter","v","Tooltip","contentStyle","formatter","includes","Legend","iconType","iconSize","wrapperStyle","Area","dot","Line","String","position","chartDiv","document","getElementById","canvas","html2canvas","link","createElement","download","slice","href","toDataURL","click","zIndex","title","verticalAlign","marginRight","b","checked","s","_objectSpread","accentColor","overflow","content","animationDuration","opacity","isAnimationActive","ReferenceLine","ifOverflow","Brush","travellerWidth","startIndex","endIndex","min","Devices","_users$find3","_users$find4","isDark","useTheme","searchParams","useSearchParams","devices","setDevices","filteredDevices","setFilteredDevices","editingDevice","setEditingDevice","creatingDevice","setCreatingDevice","searchTerm","setSearchTerm","userSearchTerm","setUserSearchTerm","filteredUsers","setFilteredUsers","showUserDropdown","setShowUserDropdown","users","setUsers","selectedDevices","setSelectedDevices","Set","bulkDeleteLoading","setBulkDeleteLoading","currentPage","setCurrentPage","pageSize","setPageSize","totalCount","setTotalCount","totalPages","setTotalPages","presets","setPresets","presetsLoading","setPresetsLoading","health","setHealth","telemetrySummary","setTelemetrySummary","telemetryData","setTelemetryData","dashboardError","setDashboardError","selectedDevice","setSelectedDevice","deviceLogs","setDeviceLogs","logsLoading","setLogsLoading","editForm","setEditForm","device_serial","user","config_version","createForm","setCreateForm","siteDetails","setSiteDetails","siteLoading","setSiteLoading","editingSite","setEditingSite","siteForm","setSiteForm","site_id","display_name","latitude","longitude","capacity_kw","tilt_deg","azimuth_deg","timezone","is_active","siteSaving","setSiteSaving","siteError","setSiteError","devicePreset","setDevicePreset","fetchDevices","page","search","response","getDevices","results","count","total_pages","current_page","fetchDeviceLogs","getDeviceLogs","deviceId","logs","handleViewDevice","device","preset","find","config_id","getDeviceSite","then","catch","finally","customers","getUsers","is_staff","is_superuser","fetchUsers","getPresets","fetchPresets","healthData","getSystemHealth","getTelemetry","telemetryArray","currentLatest","item","itemDate","Number","isNaN","deviceCount","size","totalPoints","latestTimestamp","fetchDashboardData","deviceIdParam","parseInt","foundDevice","handleClickOutside","addEventListener","removeEventListener","trim","searchLower","toLowerCase","filtered","fullName","first_name","last_name","username","email","debouncedSearch","query","handleEdit","_users$find","_users$find2","u","handleSave","updateDevice","handleCreate","createDevice","handleCancel","handleBackToList","getPresetConfigId","_preset$gateway_confi","_preset$gateway_confi2","gateway_configuration","general_settings","_devicePreset$gateway","_devicePreset$gateway2","deviceTelemetry","latestTelemetry","window","confirm","rebootDevice","alert","handleReboot","backgroundColor","hardResetDevice","handleHardReset","deleteDevice","handleDeleteDevice","gridTemplateColumns","is_online","last_heartbeat","hw_id","model","gridColumn","pending_config_update","slaves_count","config_ack_ver","version","last_updated","config_acked_at","ackTime","diffMs","diffMins","floor","diffHours","diffDays","config_downloaded_at","provisioned_at","created_by_username","logs_enabled","enabled","toggleDeviceLogs","handleToggleLogs","overall_health","active_devices","total_devices","total_telemetry_points","data_type","SiteDataPanel","disabled","fontStyle","maxHeight","overflowY","paddingBottom","borderBottom","level","onSubmit","preventDefault","parseFloat","updated","updateDeviceSite","createDeviceSite","required","placeholder","autoComplete","step","stopPropagation","onFocus","transition","onMouseEnter","currentTarget","onMouseLeave","created_at","updated_by_username","updated_at","deviceList","Boolean","confirmMessage","join","deleteDevicesBulk","updatedDevices","handleSelectAll","allIds","newSelected","delete","add","handleSelectDevice","handleDelete","borderTop","pages","_pages","key","CacheService","constructor","cache","subscribers","ttlMs","DEFAULT_TTL","staleTime","this","now","expiresIn","STALE_TIME","notifySubscribers","getWithStaleStatus","_entry$staleTime","age","isExpired","isStale","_entry$staleTime2","clear","clearPattern","pattern","regex","RegExp","keysToDelete","test","clearAll","subscribe","subscription","subs","subscribePattern","source","directSubs","subKey","startsWith","keys","getStats","getTTL","REALTIME_TTL","LONG_TTL","cacheService","API_BASE_URL","process","getAuthHeaders","tokens","localStorage","getItem","parsedTokens","JSON","parse","access","request","endpoint","options","url","headers","fetch","status","refreshToken","removeItem","location","ok","errorText","text","statusText","json","method","body","stringify","refresh","newTokens","setItem","getConfiguration","provisionDevice","getAlerts","cacheKey","cached","getKPIs","params","encodeURIComponent","createUser","userData","result","createEmployee","employeeData","getUserDevices","userId","getUserSite","createUserSite","updateUserSite","URLSearchParams","append","toString","updateUser","deleteUser","getProfile","updateProfile","changePassword","getCustomers","createCustomer","customerData","getCustomer","customerId","updateCustomer","deleteCustomer","createPreset","updatePreset","deletePreset","getGlobalSlaves","createGlobalSlave","slaveData","updateGlobalSlave","slaveId","deleteGlobalSlave","queryString","deviceData","limit","deviceIds","device_ids","getSlaves","configId","createSlave","updateSlave","deleteSlave","addSlavesToPreset","slaveIds","slave_ids","detachSlaveFromPreset","getFirmwareVersions","activeOnly","uploadFirmwareVersion","formData","updateFirmwareVersion","firmwareId","deleteFirmwareVersion","getDeviceUpdateLogs","getOTAConfig","updateOTAConfig","config","getOTAHealth","triggerRollback","deviceSerial","notes","deployFirmware","deviceSerials","firmware_id","device_serials","listTargetedUpdates","getTargetedUpdate","updateId"],"sourceRoot":""}