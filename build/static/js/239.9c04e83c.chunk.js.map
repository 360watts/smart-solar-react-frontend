{"version":3,"file":"static/js/239.9c04e83c.chunk.js","mappings":"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","sources":["hooks/useDebounce.ts","components/SiteDataPanel.tsx","components/Devices.tsx"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\r\n\r\ninterface UseDebouncedValueOptions {\r\n  delay?: number;\r\n}\r\n\r\n/**\r\n * Custom hook to debounce a value with a delay\r\n * Useful for search inputs and other frequent updates\r\n */\r\nexport function useDebouncedValue<T>(\r\n  value: T,\r\n  options: UseDebouncedValueOptions = {}\r\n): T {\r\n  const { delay = 300 } = options;\r\n  const [debouncedValue, setDebouncedValue] = useState<T>(value);\r\n\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setDebouncedValue(value);\r\n    }, delay);\r\n\r\n    return () => clearTimeout(timer);\r\n  }, [value, delay]);\r\n\r\n  return debouncedValue;\r\n}\r\n\r\n/**\r\n * Custom hook to debounce a callback function\r\n * Useful for search, filtering, and other expensive operations\r\n */\r\nexport function useDebouncedCallback<T extends (...args: any[]) => any>(\r\n  callback: T,\r\n  delay: number = 300\r\n): (...args: Parameters<T>) => void {\r\n  const [timeoutId, setTimeoutId] = useState<NodeJS.Timeout | null>(null);\r\n\r\n  const debouncedCallback = useCallback(\r\n    (...args: Parameters<T>) => {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId);\r\n      }\r\n\r\n      const newTimeoutId = setTimeout(() => {\r\n        callback(...args);\r\n      }, delay);\r\n\r\n      setTimeoutId(newTimeoutId);\r\n    },\r\n    [callback, delay, timeoutId]\r\n  );\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId);\r\n      }\r\n    };\r\n  }, [timeoutId]);\r\n\r\n  return debouncedCallback;\r\n}\r\n\r\n/**\r\n * Custom hook for search input with debouncing\r\n * Returns a hook that handles search input changes with built-in debouncing\r\n */\r\nexport function useDebouncedSearch(\r\n  onSearch: (query: string) => void,\r\n  delay: number = 300\r\n) {\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const debouncedCallback = useDebouncedCallback(onSearch, delay);\r\n\r\n  const handleSearch = useCallback(\r\n    (query: string) => {\r\n      setSearchQuery(query);\r\n      debouncedCallback(query);\r\n    },\r\n    [debouncedCallback]\r\n  );\r\n\r\n  return {\r\n    searchQuery,\r\n    setSearchQuery,\r\n    handleSearch,\r\n  };\r\n}\r\n","/**\n * SiteDataPanel  solar site intelligence panel\n *\n * Tabs:\n *  - Overview: 6 live KPI cards + energy breakdown + insights\n *  - Weather:  current conditions + 24 h hourly outlook strip\n *  - History:  power area chart with Battery SOC on secondary axis\n *  - Forecast: P10/P50/P90 + physics baseline, regime tags, % achieved\n */\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport {\n  AreaChart, Area, Line,\n  XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend, ReferenceLine, ReferenceArea,\n} from 'recharts';\nimport html2canvas from 'html2canvas';\nimport { apiService } from '../services/api';\nimport { useTheme } from '../contexts/ThemeContext';\n\n//  Tabs \n\nconst TABS = [\n  { id: 'overview',  label: 'Overview',  icon: '' },\n  { id: 'weather',   label: 'Weather',   icon: '' },\n  { id: 'history',   label: 'History',   icon: '' },\n  { id: 'forecast',  label: 'Forecast',  icon: '' },\n] as const;\ntype TabId = typeof TABS[number]['id'];\n\n//  Custom forecast tooltip \n\nconst ForecastTooltip = ({ active, payload, label }: any) => {\n  const { isDark } = useTheme();\n  if (!active || !payload || !payload.length) return null;\n  return (\n    <div style={{\n      background: isDark ? 'rgba(30,41,59,0.97)' : 'rgba(255,255,255,0.97)',\n      backdropFilter: 'blur(8px)',\n      border: `1px solid ${isDark ? 'rgba(148,163,184,0.12)' : '#f3f4f6'}`,\n      borderRadius: 12,\n      padding: '0.75rem 1rem',\n      boxShadow: '0 10px 15px -3px rgba(0,0,0,0.1)',\n      minWidth: 175,\n    }}>\n      <div style={{ fontFamily: 'Urbanist, sans-serif', fontWeight: 700, color: isDark ? '#f1f5f9' : '#111827', fontSize: '0.85rem', marginBottom: '0.4rem', borderBottom: `1px solid ${isDark ? 'rgba(148,163,184,0.12)' : '#f3f4f6'}`, paddingBottom: '0.25rem' }}>\n        {label}\n      </div>\n      <div style={{ display: 'flex', flexDirection: 'column', gap: '0.2rem' }}>\n        {payload.map((entry: any) => {\n          const unit = entry.name?.includes('Temp') ? 'C' : entry.name?.includes('GHI') ? 'W/m' : 'kW';\n          return (\n            <div key={entry.name} style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', gap: '1rem', fontSize: '0.78rem', fontFamily: 'Inter, sans-serif', color: isDark ? '#94a3b8' : '#374151' }}>\n              <div style={{ display: 'flex', alignItems: 'center', gap: '0.4rem' }}>\n                <span style={{ width: 7, height: 7, borderRadius: '50%', background: entry.color || entry.stroke || entry.fill, flexShrink: 0 }} />\n                <span style={{ fontWeight: 600 }}>{entry.name?.split(' ')[0]}</span>\n              </div>\n              <span style={{ fontFamily: 'JetBrains Mono, monospace', fontWeight: 600, color: isDark ? '#f1f5f9' : '#111827' }}>\n                {Number(entry.value).toFixed(3)} {unit}\n              </span>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\n//  Helpers \n\nfunction fmt(ts: string, range: string): string {\n  try {\n    const d = new Date(ts);\n    if (range === '24h') return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    if (range === '7d')  return d.toLocaleDateString([], { weekday: 'short' }) + ' ' + d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    return d.toLocaleDateString([], { month: 'short', day: 'numeric' });\n  } catch { return ts; }\n}\n\n\nfunction aggregateByPeriod(data: any[], range: string): any[] {\n  if (!data.length) return [];\n  if (range === '24h') return data.filter((_, i) => i % 2 === 0 || i === data.length - 1);\n\n  const isDay = range !== '7d';\n  const buckets = new Map<string, any[]>();\n  data.forEach(row => {\n    const d = new Date(row.timestamp);\n    const key = isDay\n      ? `${d.getFullYear()}-${d.getMonth()}-${d.getDate()}`\n      : `${d.getFullYear()}-${d.getMonth()}-${d.getDate()}-${d.getHours()}`;\n    if (!buckets.has(key)) buckets.set(key, []);\n    buckets.get(key)!.push(row);\n  });\n\n  return Array.from(buckets.values()).map(bucket => {\n    const avg = (field: string) => bucket.reduce((s, r) => s + (r[field] ?? 0), 0) / bucket.length;\n    const first = bucket[0];\n    return {\n      timestamp:            first.timestamp,\n      pv1_power_w:          avg('pv1_power_w'),\n      pv2_power_w:          avg('pv2_power_w'),\n      load_power_w:         avg('load_power_w'),\n      grid_power_w:         avg('grid_power_w'),\n      battery_soc_percent:  avg('battery_soc_percent'),\n      battery_power_w:      avg('battery_power_w'),\n      pv_today_kwh:         isDay ? Math.max(...bucket.map(r => r.pv_today_kwh ?? 0)) : first.pv_today_kwh,\n    };\n  });\n}\n\n//  Icons \n\nconst IconSun = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#F07522\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <circle cx=\"12\" cy=\"12\" r=\"5\" fill=\"#FFD600\" stroke=\"#F07522\" strokeWidth=\"1.5\"/>\n    <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\"/><line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"23\"/>\n    <line x1=\"4.22\" y1=\"4.22\" x2=\"5.64\" y2=\"5.64\"/><line x1=\"18.36\" y1=\"18.36\" x2=\"19.78\" y2=\"19.78\"/>\n    <line x1=\"1\" y1=\"12\" x2=\"3\" y2=\"12\"/><line x1=\"21\" y1=\"12\" x2=\"23\" y2=\"12\"/>\n  </svg>\n);\nconst IconBattery = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <rect x=\"1\" y=\"6\" width=\"18\" height=\"12\" rx=\"2\"/>\n    <line x1=\"23\" y1=\"13\" x2=\"23\" y2=\"11\"/>\n    <rect x=\"3\" y=\"8\" width=\"10\" height=\"8\" fill=\"currentColor\" rx=\"1\"/>\n  </svg>\n);\nconst IconLoad = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z\"/>\n    <polyline points=\"9 22 9 12 15 12 15 22\"/>\n  </svg>\n);\nconst IconEnergy = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M13 2L3 14h9l-1 8 10-12h-9l1-8z\"/>\n  </svg>\n);\nconst IconCloud = () => (\n  <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M18 10h-1.26A8 8 0 109 20h9a5 5 0 000-10z\"/>\n  </svg>\n);\nconst IconGrid = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <polyline points=\"22 12 18 12 15 21 9 3 6 12 2 12\"/>\n  </svg>\n);\nconst IconThermometer = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M14 14.76V3.5a2.5 2.5 0 0 0-5 0v11.26a4.5 4.5 0 1 0 5 0z\"/>\n  </svg>\n);\n\n//  KPI Card \n\ninterface KpiCardProps {\n  label: string; value: string; unit?: string; sub?: string;\n  accent: string; icon: React.ReactNode; badge?: React.ReactNode;\n}\nconst KpiCard: React.FC<KpiCardProps> = ({ label, value, unit, sub, accent, icon, badge }) => (\n  <div className=\"card\" style={{ padding: '1.1rem', flex: 1, minWidth: 140 }}>\n    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.4rem' }}>\n      <span style={{ fontSize: '0.7rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.06em', color: 'var(--text-muted)', fontFamily: 'Poppins, sans-serif' }}>{label}</span>\n      <span style={{ width: 28, height: 28, borderRadius: '50%', background: `${accent}18`, display: 'flex', alignItems: 'center', justifyContent: 'center', color: accent, flexShrink: 0 }}>{icon}</span>\n    </div>\n    <p style={{ margin: 0, fontFamily: 'JetBrains Mono, monospace', fontSize: '1.5rem', fontWeight: 800, color: 'var(--text-primary)', lineHeight: 1 }}>\n      {value}{unit && <span style={{ fontSize: '0.78rem', fontWeight: 500, color: 'var(--text-muted)', marginLeft: 4 }}>{unit}</span>}\n    </p>\n    {sub   && <p style={{ margin: '0.2rem 0 0', fontSize: '0.7rem', color: 'var(--text-muted)', fontFamily: 'Poppins, sans-serif' }}>{sub}</p>}\n    {badge && <div style={{ marginTop: '0.3rem' }}>{badge}</div>}\n  </div>\n);\n\n//  Weather Hourly Forecast Strip \n\nconst WeatherHourlyStrip = ({ hourly }: { hourly: any[] }) => {\n  if (!hourly || hourly.length === 0) return null;\n  const icon = (cloud: number, ghi: number) =>\n    ghi < 10 ? '' : cloud > 75 ? '' : cloud > 40 ? '' : '';\n\n  return (\n    <div className=\"card\" style={{ padding: '1rem 1.25rem', marginBottom: '1rem' }}>\n      <p style={{ margin: '0 0 0.65rem', fontSize: '0.68rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.07em', color: 'var(--text-muted)', fontFamily: 'Poppins, sans-serif' }}>\n        24 h Weather Outlook\n      </p>\n      <div style={{ overflowX: 'auto', paddingTop: 14, paddingBottom: 2 }}>\n        <div style={{ display: 'flex', gap: '0.45rem', minWidth: 'max-content' }}>\n          {hourly.map((h, i) => {\n            const time = (() => { try { return new Date(h.forecast_for).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }); } catch { return ''; } })();\n            const cloud    = h.cloud_cover_pct ?? 0;\n            const ghi      = h.ghi_wm2 ?? 0;\n            const temp     = Number(h.temperature_c ?? 0);\n            const wind     = Number(h.wind_speed_ms ?? 0);\n            const humidity = h.humidity_pct != null ? Number(h.humidity_pct) : null;\n            const ghiPct   = Math.min(100, (ghi / 900) * 100);\n            const humPct   = humidity != null ? Math.min(100, humidity) : null;\n            const isNow    = i === 0;\n            const wi       = icon(cloud, ghi);\n            const ghiColor = ghi > 600 ? '#F07522' : ghi > 200 ? '#f59e0b' : '#d1d5db';\n            const humColor = humidity == null ? '#d1d5db'\n              : humidity > 80 ? '#3b82f6'\n              : humidity > 50 ? '#60a5fa'\n              : '#93c5fd';\n            return (\n              <div key={i} style={{\n                display: 'flex', flexDirection: 'column', alignItems: 'center',\n                background: isNow ? 'rgba(0,166,62,0.09)' : 'rgba(0,0,0,0.025)',\n                border: `1px solid ${isNow ? 'rgba(0,166,62,0.28)' : 'rgba(0,0,0,0.07)'}`,\n                borderRadius: 10, padding: '0.45rem 0.65rem', minWidth: 64, gap: '0.1rem',\n                position: 'relative',\n              }}>\n                {isNow && (\n                  <span style={{ position: 'absolute', top: -9, fontSize: '0.55rem', fontWeight: 700, background: '#00a63e', color: '#fff', padding: '1px 5px', borderRadius: 4, fontFamily: 'Poppins, sans-serif' }}>NOW</span>\n                )}\n                <span style={{ fontSize: '0.65rem', color: 'var(--text-muted)', fontFamily: 'Poppins, sans-serif', fontWeight: 600 }}>{time}</span>\n                <span style={{ fontSize: '1.1rem', lineHeight: 1.4 }}>{wi}</span>\n                <span style={{ fontSize: '0.8rem', fontFamily: 'JetBrains Mono, monospace', fontWeight: 700, color: 'var(--text-primary)' }}>{temp.toFixed(1)}</span>\n                {/* GHI mini-bar */}\n                <div title={`GHI ${Math.round(ghi)} W/m`} style={{ width: '100%', height: 3, background: 'rgba(0,0,0,0.08)', borderRadius: 2, overflow: 'hidden', margin: '2px 0' }}>\n                  <div style={{ width: `${ghiPct}%`, height: '100%', background: ghiColor, borderRadius: 2 }} />\n                </div>\n                <span style={{ fontSize: '0.6rem', color: 'var(--text-muted)', fontFamily: 'Poppins, sans-serif' }}>{Math.round(ghi)} W/m</span>\n                {/* Humidity bar */}\n                {humPct != null && (\n                  <>\n                    <div title={`Humidity ${Math.round(humPct)}%`} style={{ width: '100%', height: 3, background: 'rgba(0,0,0,0.06)', borderRadius: 2, overflow: 'hidden', margin: '2px 0' }}>\n                      <div style={{ width: `${humPct}%`, height: '100%', background: humColor, borderRadius: 2 }} />\n                    </div>\n                    <span style={{ fontSize: '0.6rem', color: humColor, fontFamily: 'Poppins, sans-serif', fontWeight: 600 }}>{Math.round(humPct)}%</span>\n                  </>\n                )}\n                <span style={{ fontSize: '0.6rem', color: 'var(--text-muted)', fontFamily: 'Poppins, sans-serif' }}>{wind.toFixed(1)} m/s</span>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n    </div>\n  );\n};\n\n//  Daily Energy Breakdown \n\nconst EnergyBreakdownRow = ({ latest }: { latest: any }) => {\n  if (!latest) return null;\n  const items = [\n    { label: 'PV Yield',    value: latest.pv_today_kwh,              color: '#F07522', bg: '#F0752212', icon: '' },\n    { label: 'Grid In',     value: latest.grid_buy_today_kwh,         color: '#3b82f6', bg: '#3b82f612', icon: '' },\n    { label: 'Grid Out',    value: latest.grid_sell_today_kwh,        color: '#10b981', bg: '#10b98112', icon: '' },\n    { label: 'Batt Chg',    value: latest.batt_charge_today_kwh,      color: '#8b5cf6', bg: '#8b5cf612', icon: '' },\n    { label: 'Batt Dchg',   value: latest.batt_discharge_today_kwh,   color: '#ec4899', bg: '#ec489912', icon: '' },\n    { label: 'Consumption', value: latest.load_today_kwh,             color: '#6b7280', bg: '#6b728012', icon: '' },\n  ].filter(e => e.value != null);\n  if (!items.length) return null;\n\n  return (\n    <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap', marginBottom: '1rem', alignItems: 'center' }}>\n      <span style={{ fontSize: '0.65rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.06em', color: 'var(--text-muted)', fontFamily: 'Poppins, sans-serif', alignSelf: 'center', minWidth: 40 }}>Today</span>\n      {items.map(e => (\n        <span key={e.label} style={{\n          fontSize: '0.72rem', fontWeight: 600, fontFamily: 'Poppins, sans-serif',\n          padding: '0.2rem 0.65rem', borderRadius: 99,\n          background: e.bg, border: `1px solid ${e.color}28`,\n          color: e.color, display: 'flex', alignItems: 'center', gap: '0.3rem',\n        }}>\n          <span style={{ opacity: 0.85 }}>{e.icon}</span>\n          {e.label}:&nbsp;\n          <span style={{ fontFamily: 'JetBrains Mono, monospace', color: 'var(--text-primary)' }}>{Number(e.value).toFixed(2)}</span>\n          <span style={{ fontSize: '0.6rem', color: 'var(--text-muted)' }}>kWh</span>\n        </span>\n      ))}\n    </div>\n  );\n};\n\n//  Solar Insights Row \n\nconst InsightsRow = ({ latest }: { latest: any }) => {\n  if (!latest) return null;\n\n  const pvKwh    = Number(latest.pv_today_kwh      ?? 0);\n  const loadKwh  = Number(latest.load_today_kwh    ?? 0);\n  const gridBuy  = Number(latest.grid_buy_today_kwh ?? 0);\n\n  // Only render if we have at least PV data\n  if (pvKwh === 0 && loadKwh === 0) return null;\n\n  const co2Kg       = pvKwh * 0.82;  // India grid factor ~0.82 kg CO/kWh\n  // Self-sufficiency = portion of load met by solar+battery (not from grid)\n  const selfSufPct = loadKwh > 0\n    ? Math.max(0, Math.min(100, Math.round(((loadKwh - gridBuy) / loadKwh) * 100)))\n    : null;\n  const gridDepPct  = loadKwh > 0\n    ? Math.max(0, Math.min(100, Math.round((gridBuy / loadKwh) * 100)))\n    : null;\n\n  const items: { icon: string; label: string; value: string; sub?: string; color: string; bg: string }[] = [];\n\n  if (pvKwh > 0) {\n    items.push({\n      icon: '', label: 'CO Avoided',\n      value: co2Kg >= 1 ? `${co2Kg.toFixed(2)} kg` : `${(co2Kg * 1000).toFixed(0)} g`,\n      sub: 'vs grid (0.82 kg/kWh)',\n      color: '#10b981', bg: '#10b98110',\n    });\n  }\n  if (selfSufPct != null) {\n    const color = selfSufPct >= 70 ? '#00a63e' : selfSufPct >= 40 ? '#f59e0b' : '#ef4444';\n    items.push({\n      icon: '', label: 'Self-Sufficiency',\n      value: `${selfSufPct}%`,\n      sub: 'load met by solar+battery',\n      color, bg: `${color}10`,\n    });\n  }\n  if (gridDepPct != null) {\n    const color = gridDepPct <= 20 ? '#10b981' : gridDepPct <= 50 ? '#f59e0b' : '#ef4444';\n    items.push({\n      icon: '', label: 'Grid Dependency',\n      value: `${gridDepPct}%`,\n      sub: 'portion from grid',\n      color, bg: `${color}10`,\n    });\n  }\n\n  if (!items.length) return null;\n\n  return (\n    <div style={{ display: 'flex', gap: '0.6rem', flexWrap: 'wrap', marginBottom: '1rem' }}>\n      <span style={{ fontSize: '0.65rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.06em', color: 'var(--text-muted)', fontFamily: 'Poppins, sans-serif', alignSelf: 'center', minWidth: 40 }}>\n        Insights\n      </span>\n      {items.map(item => (\n        <div key={item.label} style={{\n          display: 'flex', alignItems: 'center', gap: '0.55rem',\n          padding: '0.35rem 0.85rem', borderRadius: 10,\n          background: item.bg, border: `1px solid ${item.color}28`,\n          flexShrink: 0,\n        }}>\n          <span style={{ fontSize: '1rem', lineHeight: 1 }}>{item.icon}</span>\n          <div style={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n            <span style={{ fontSize: '0.62rem', color: 'var(--text-muted)', fontFamily: 'Poppins, sans-serif', fontWeight: 600, textTransform: 'uppercase', letterSpacing: '0.04em' }}>{item.label}</span>\n            <span style={{ fontFamily: 'JetBrains Mono, monospace', fontWeight: 800, color: item.color, fontSize: '0.88rem', lineHeight: 1 }}>{item.value}</span>\n            {item.sub && <span style={{ fontSize: '0.58rem', color: 'var(--text-muted)', fontFamily: 'Poppins, sans-serif' }}>{item.sub}</span>}\n          </div>\n        </div>\n      ))}\n    </div>\n  );\n};\n\n//  Forecast Table \n\nconst REGIME_STYLE: Record<string, { bg: string; color: string }> = {\n  night:  { bg: '#1e293b1a', color: '#475569' },\n  ramp:   { bg: '#f59e0b18', color: '#d97706' },\n  midday: { bg: '#F0752218', color: '#c2410c' },\n};\n\n// Stock-chart style XAxis tick:\n//   - time always shown on the first line\n//   - date shown only at the first visible tick of each day (below the time)\nconst ForecastXAxisTick = ({ x, y, payload, visibleData, forecastWindow: fw }: any) => {\n  const val: string = payload?.value ?? '';\n  if (!val) return null;\n  // visibleData is the filtered tick-object array (forecastTickObjects)\n  const idx = (visibleData as any[]).findIndex((d: any) => d.time === val);\n  const timeLabel = fw === '1d' ? val : (val.split('||')[1] ?? val);\n  const dateLabel = fw === '1d' ? '' : (val.split('||')[0] ?? '');\n\n  // First tick of a new day among the VISIBLE ticks (not all 672 raw data points)\n  const isFirstOfDay = fw !== '1d' && (\n    idx <= 0 || (visibleData as any[])[idx]?.rawDate !== (visibleData as any[])[idx - 1]?.rawDate\n  );\n\n  return (\n    <g transform={`translate(${x},${y})`}>\n      {/* Time  always */}\n      <text x={0} y={0} dy={13} textAnchor=\"middle\" fill=\"var(--text-muted)\" fontSize={10} fontFamily=\"Inter, sans-serif\">\n        {timeLabel}\n      </text>\n      {/* Date  once per day, below the time */}\n      {isFirstOfDay && dateLabel && (\n        <text x={0} y={0} dy={26} textAnchor=\"middle\" fill=\"#00a63e\" fontSize={10} fontWeight={700} fontFamily=\"Inter, sans-serif\">\n          {dateLabel}\n        </text>\n      )}\n    </g>\n  );\n};\n\nconst ForecastTable = ({ data }: { data: any[] }) => {\n  const { isDark } = useTheme();\n  const theadBg  = isDark ? 'rgba(15,23,42,0.9)'  : '#f9fafb';\n  const rowBorder = isDark ? '1px solid rgba(148,163,184,0.07)' : '1px solid #f3f4f6';\n  return (\n    <div style={{ maxHeight: 300, overflowY: 'auto' }}>\n      <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.8rem', fontFamily: 'Inter, sans-serif' }}>\n        <thead style={{ position: 'sticky', top: 0, background: theadBg, zIndex: 1 }}>\n          <tr>\n            <th style={{ padding: '0.7rem 1rem', textAlign: 'left',   fontWeight: 600, color: 'var(--text-secondary)',  borderBottom: `1px solid ${isDark ? 'rgba(148,163,184,0.1)' : '#e5e7eb'}` }}>Time</th>\n            <th style={{ padding: '0.7rem 0.6rem', textAlign: 'center', fontWeight: 600, color: 'var(--text-muted)',  borderBottom: `1px solid ${isDark ? 'rgba(148,163,184,0.1)' : '#e5e7eb'}` }}>Regime</th>\n            <th style={{ padding: '0.7rem 0.8rem', textAlign: 'right', fontWeight: 600, color: '#f59e0b',  borderBottom: `1px solid ${isDark ? 'rgba(148,163,184,0.1)' : '#e5e7eb'}` }}>P10 </th>\n            <th style={{ padding: '0.7rem 0.8rem', textAlign: 'right', fontWeight: 600, color: '#00a63e',  borderBottom: `1px solid ${isDark ? 'rgba(148,163,184,0.1)' : '#e5e7eb'}` }}>P50</th>\n            <th style={{ padding: '0.7rem 0.8rem', textAlign: 'right', fontWeight: 600, color: '#3b82f6',  borderBottom: `1px solid ${isDark ? 'rgba(148,163,184,0.1)' : '#e5e7eb'}` }}>P90 </th>\n            <th style={{ padding: '0.7rem 0.8rem', textAlign: 'right', fontWeight: 600, color: 'var(--text-muted)',  borderBottom: `1px solid ${isDark ? 'rgba(148,163,184,0.1)' : '#e5e7eb'}` }}>Physics</th>\n            <th style={{ padding: '0.7rem 0.8rem', textAlign: 'right', fontWeight: 600, color: '#eab308',  borderBottom: `1px solid ${isDark ? 'rgba(148,163,184,0.1)' : '#e5e7eb'}` }}>GHI W/m</th>\n          </tr>\n        </thead>\n        <tbody>\n          {data.map((row, i) => {\n            const rc = row.regime ? (REGIME_STYLE[row.regime] ?? { bg: 'transparent', color: 'var(--text-muted)' }) : null;\n            return (\n              <tr key={i} style={{ borderBottom: rowBorder }}>\n                <td style={{ padding: '0.55rem 1rem', color: 'var(--text-primary)', fontFamily: 'JetBrains Mono, monospace' }}>\n                  {row.dateLabel ? <span style={{ marginRight: '0.5rem', color: '#00a63e', fontWeight: 700 }}>{row.dateLabel}</span> : null}\n                  {row.timeLabel ?? row.time}\n                </td>\n                <td style={{ padding: '0.4rem 0.6rem', textAlign: 'center' }}>\n                  {row.regime && rc && (\n                    <span style={{ fontSize: '0.62rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.04em', background: rc.bg, color: rc.color, padding: '2px 6px', borderRadius: 4, fontFamily: 'Poppins, sans-serif' }}>\n                      {row.regime}\n                    </span>\n                  )}\n                </td>\n                <td style={{ padding: '0.55rem 0.8rem', textAlign: 'right', color: 'var(--text-secondary)' }}>{row.p10?.toFixed(3) ?? ''}</td>\n                <td style={{ padding: '0.55rem 0.8rem', textAlign: 'right', fontWeight: 600, color: 'var(--text-primary)' }}>{row.p50?.toFixed(3) ?? ''}</td>\n                <td style={{ padding: '0.55rem 0.8rem', textAlign: 'right', color: 'var(--text-secondary)' }}>{row.p90?.toFixed(3) ?? ''}</td>\n                <td style={{ padding: '0.55rem 0.8rem', textAlign: 'right', color: 'var(--text-muted)', fontStyle: 'italic' }}>{row.physics?.toFixed(3) ?? ''}</td>\n                <td style={{ padding: '0.55rem 0.8rem', textAlign: 'right', color: 'var(--text-secondary)' }}>{row.ghi?.toFixed(0) ?? ''}</td>\n              </tr>\n            );\n          })}\n        </tbody>\n      </table>\n    </div>\n  );\n};\n\n//  Main component \n\ninterface Props {\n  siteId: string;\n  autoRefresh?: boolean;\n}\n\nconst SiteDataPanel: React.FC<Props> = ({ siteId, autoRefresh = false }) => {\n  const { isDark } = useTheme();\n\n  const [telemetry,  setTelemetry]  = useState<any[]>([]);\n  const [forecast,   setForecast]   = useState<any[]>([]);\n  const [weather,    setWeather]    = useState<any>(null);\n  const [loading,    setLoading]    = useState(true);\n  const [error,      setError]      = useState<string | null>(null);\n  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);\n\n  const [activeTab,       setActiveTab]       = useState<TabId>('overview');\n  const [showBands,       setShowBands]       = useState<Record<string, boolean>>({ P10: true, P50: true, P90: true });\n  const [dateRange,       setDateRange]       = useState('24h');\n  const [customStartDate, setCustomStartDate] = useState('');\n  const [customEndDate,   setCustomEndDate]   = useState('');\n  const [forecastView,    setForecastView]    = useState<'chart' | 'table'>('chart');\n  const [forecastWindow,  setForecastWindow]  = useState<'1d' | '3d' | '7d'>('7d');\n\n  // Drag-to-zoom state (stock-chart style)\n  const [refAreaLeft,  setRefAreaLeft]  = useState('');\n  const [refAreaRight, setRefAreaRight] = useState('');\n  const [isSelecting,  setIsSelecting]  = useState(false);\n  const [zoomStart,    setZoomStart]    = useState<string | null>(null);\n  const [zoomEnd,      setZoomEnd]      = useState<string | null>(null);\n\n  // Dark-mode-aware tooltip style for recharts\n  const tooltipStyle = {\n    background: isDark ? 'rgba(30,41,59,0.97)' : 'rgba(255,255,255,0.97)',\n    border: `1px solid ${isDark ? 'rgba(148,163,184,0.1)' : 'rgba(0,166,62,0.15)'}`,\n    borderRadius: 10,\n    color: isDark ? '#f1f5f9' : '#0a0a0a',\n    boxShadow: '0 8px 24px rgba(0,0,0,0.1)',\n    fontSize: 12,\n  };\n\n  const fetchAll = useCallback(async () => {\n    try {\n      // Forecast: always next 7 days from today (independent of history dateRange)\n      const now = new Date();\n      const forecastStart = now.toISOString().split('T')[0] + 'T00:00:00Z';\n      const forecastEndDt = new Date(now.getTime() + 7 * 24 * 3600 * 1000);\n      const forecastEnd   = forecastEndDt.toISOString().split('T')[0] + 'T23:59:59Z';\n\n      // Telemetry from DynamoDB based on selected date range\n      let telemetryParams: any = {};\n      if      (dateRange === 'custom' && customStartDate && customEndDate) telemetryParams = { start_date: new Date(customStartDate).toISOString(), end_date: new Date(customEndDate).toISOString() };\n      else if (dateRange === '7d')  telemetryParams = { days: 7 };\n      else if (dateRange === '30d') telemetryParams = { days: 30 };\n\n      // For ranges > 7 days, also fetch older history from S3\n      let historyParams: { start_date: string; end_date: string } | null = null;\n      const sevenDaysAgo = new Date(now.getTime() - 7 * 24 * 3600 * 1000);\n      if (dateRange === '30d') {\n        const thirtyDaysAgo = new Date(now.getTime() - 30 * 24 * 3600 * 1000);\n        historyParams = { start_date: thirtyDaysAgo.toISOString(), end_date: sevenDaysAgo.toISOString() };\n      } else if (dateRange === 'custom' && customStartDate && customEndDate) {\n        const customStart = new Date(customStartDate);\n        const customEnd   = new Date(customEndDate);\n        if (customStart < sevenDaysAgo) {\n          historyParams = {\n            start_date: customStart.toISOString(),\n            end_date:   (customEnd < sevenDaysAgo ? customEnd : sevenDaysAgo).toISOString(),\n          };\n        }\n      }\n\n      const results = await Promise.all([\n        apiService.getSiteTelemetry(siteId, telemetryParams),\n        apiService.getSiteForecast(siteId, { start_date: forecastStart, end_date: forecastEnd }),\n        apiService.getSiteWeather(siteId),\n        historyParams ? apiService.getSiteHistory(siteId, historyParams) : Promise.resolve(null),\n      ] as Promise<any>[]);\n      const [tel, fcst, wth, hist] = results;\n\n      // Merge DynamoDB telemetry + S3 history, deduplicate by timestamp\n      let merged: any[] = Array.isArray(tel) ? tel : [];\n      if (Array.isArray(hist) && hist.length > 0) {\n        const tsSet = new Set(merged.map((r: any) => r.timestamp));\n        const older = (hist as any[]).filter(r => !tsSet.has(r.timestamp));\n        merged = [...older, ...merged].sort((a: any, b: any) => a.timestamp.localeCompare(b.timestamp));\n      }\n\n      setTelemetry(merged);\n      setForecast(Array.isArray(fcst) ? fcst : []);\n      setWeather(wth || null);\n      setLastUpdated(new Date());\n      setError(null);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load site data');\n    } finally {\n      setLoading(false);\n    }\n  }, [siteId, dateRange, customStartDate, customEndDate]);\n\n  useEffect(() => {\n    setLoading(true);\n    fetchAll();\n    if (!autoRefresh) return;\n    const id = setInterval(fetchAll, 60_000);\n    return () => clearInterval(id);\n  }, [fetchAll, autoRefresh]);\n\n  // Reset zoom when forecast window changes\n  useEffect(() => {\n    setZoomStart(null);\n    setZoomEnd(null);\n  }, [forecastWindow]);\n\n  //  Derived values \n  const latest = telemetry.length > 0 ? telemetry[telemetry.length - 1] : null;\n\n  const pvKw       = latest ? ((latest.pv1_power_w ?? 0) + (latest.pv2_power_w ?? 0)) / 1000 : null;\n  const batSoc     = latest?.battery_soc_percent ?? null;\n  const loadKw     = latest ? (latest.load_power_w    ?? 0) / 1000 : null;\n  const todayKwh   = latest?.pv_today_kwh ?? null;\n  const gridKw     = latest ? (latest.grid_power_w    ?? 0) / 1000 : null;\n  const batPowerKw = latest ? (latest.battery_power_w ?? 0) / 1000 : null;\n  const invTemp    = latest?.inverter_temp_c   ?? null;\n  const batVoltage = latest?.battery_voltage_v ?? null;\n  const runState   = latest?.run_state;\n\n  const gridImporting  = gridKw     != null && gridKw     > 0.01;\n  const gridExporting  = gridKw     != null && gridKw     < -0.01;\n  const batCharging    = batPowerKw != null && batPowerKw > 0.01;\n\n  const runStateBadge = runState != null ? (\n    runState === 0 ? { label: 'Standby', color: '#9ca3af' } :\n    runState === 1 ? { label: 'Online',  color: '#00a63e' } :\n    runState === 2 ? { label: 'Warning', color: '#f59e0b' } :\n    runState === 3 ? { label: 'Fault',   color: '#ef4444' } :\n                     { label: `State ${runState}`, color: '#6b7280' }\n  ) : null;\n\n  const invTempColor = invTemp == null ? '#9ca3af'\n    : invTemp > 60 ? '#ef4444'\n    : invTemp > 45 ? '#f59e0b'\n    : '#10b981';\n\n  //  Chart data \n  const aggregated  = aggregateByPeriod(telemetry, dateRange);\n  const historyData = aggregated.map(row => ({\n    time:           fmt(row.timestamp, dateRange),\n    'PV (kW)':      +((( row.pv1_power_w ?? 0) + (row.pv2_power_w ?? 0)) / 1000).toFixed(2),\n    'Load (kW)':    +((row.load_power_w ?? 0) / 1000).toFixed(2),\n    'Grid (kW)':    +((row.grid_power_w ?? 0) / 1000).toFixed(2),\n    'Batt SOC (%)': row.battery_soc_percent ?? null,\n  }));\n\n  // Filter forecast by the selected forecast window (1d / 3d / 7d) for display\n  const forecastWindowDays = forecastWindow === '1d' ? 1 : forecastWindow === '3d' ? 3 : 7;\n  const forecastCutoff = new Date(Date.now() + forecastWindowDays * 24 * 3600 * 1000);\n  const forecastFiltered = forecast.filter(row => {\n    const clean = row.forecast_for || row.timestamp.replace('FORECAST#', '');\n    return new Date(clean) <= forecastCutoff;\n  });\n\n  const forecastData = forecastFiltered.map(row => {\n    const clean = row.forecast_for || row.timestamp.replace('FORECAST#', '');\n    const d = new Date(clean);\n    const timeLabel  = d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    const dateLabel  = forecastWindow === '3d'\n      ? d.toLocaleDateString([], { weekday: 'short', day: 'numeric' })\n      : d.toLocaleDateString([], { weekday: 'short', month: 'short', day: 'numeric' });\n    const rawDate    = `${d.getFullYear()}-${d.getMonth()}-${d.getDate()}`;\n    // Unique key for the XAxis: just use time for 1d, date+time otherwise\n    const time = forecastWindow === '1d' ? timeLabel : `${dateLabel}||${timeLabel}`;\n    return {\n      time, dateLabel, timeLabel, rawDate,\n      p50:     row.p50_kw            != null ? +Number(row.p50_kw).toFixed(3)            : null,\n      p10:     row.p10_kw            != null ? +Number(row.p10_kw).toFixed(3)            : null,\n      p90:     row.p90_kw            != null ? +Number(row.p90_kw).toFixed(3)            : null,\n      physics: row.physics_baseline_kw != null ? +Number(row.physics_baseline_kw).toFixed(3) : null,\n      ghi:     row.ghi_input_wm2     != null ? +row.ghi_input_wm2                       : null,\n      temp:    row.temperature_c     != null ? +row.temperature_c                        : null,\n      regime:  row.regime            ?? null,\n    };\n  });\n\n  // Zoom-sliced data for the chart (stock-market drag-to-zoom)\n  const zoomedForecastData = useMemo(() => {\n    if (!zoomStart || !zoomEnd) return forecastData;\n    const li = forecastData.findIndex(d => d.time === zoomStart);\n    const ri = forecastData.findIndex(d => d.time === zoomEnd);\n    if (li === -1 || ri === -1 || li === ri) return forecastData;\n    const [s, e] = li < ri ? [li, ri] : [ri, li];\n    return forecastData.slice(s, e + 1);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [forecastData, zoomStart, zoomEnd]);\n\n  // Pre-computed tick list for XAxis: always include day boundaries + regular interval\n  // This ensures day-start ticks are never skipped by minTickGap\n  const forecastTickObjects = useMemo(() => {\n    if (forecastWindow === '1d') return undefined;\n    const N = forecastWindow === '7d' ? 8 : 4; // every 2h for 7d, every 1h for 3d\n    return zoomedForecastData.filter((d, i) => {\n      if (i === 0) return true;\n      if (d.rawDate !== zoomedForecastData[i - 1].rawDate) return true; // day boundary\n      return i % N === 0;\n    });\n  }, [zoomedForecastData, forecastWindow]);\n  const forecastTickValues = forecastTickObjects?.map(d => d.time);\n\n  // Trapezoidal energy integration over the selected forecast window (filtered)\n  let fcastP10 = 0, fcastP50 = 0, fcastP90 = 0;\n  let forecastGeneratedAt: Date | null = null;\n  if (forecast.length > 0) {\n    const first = forecast[0];\n    if (first.generated_at) {\n      forecastGeneratedAt = new Date(first.generated_at);\n    } else if (first.timestamp) {\n      forecastGeneratedAt = new Date(first.timestamp.replace('FORECAST#', '').split('T')[0] + 'T00:00:00Z');\n    }\n  }\n  if (forecastFiltered.length > 1) {\n    for (let i = 0; i < forecastFiltered.length - 1; i++) {\n      const h = Math.abs(\n        new Date(forecastFiltered[i+1].timestamp.replace('FORECAST#', '')).getTime() -\n        new Date(forecastFiltered[i].timestamp.replace('FORECAST#', '')).getTime()\n      ) / 3_600_000;\n      if (forecastFiltered[i].p10_kw != null && forecastFiltered[i+1].p10_kw != null) fcastP10 += (forecastFiltered[i].p10_kw + forecastFiltered[i+1].p10_kw) / 2 * h;\n      if (forecastFiltered[i].p50_kw != null && forecastFiltered[i+1].p50_kw != null) fcastP50 += (forecastFiltered[i].p50_kw + forecastFiltered[i+1].p50_kw) / 2 * h;\n      if (forecastFiltered[i].p90_kw != null && forecastFiltered[i+1].p90_kw != null) fcastP90 += (forecastFiltered[i].p90_kw + forecastFiltered[i+1].p90_kw) / 2 * h;\n    }\n  }\n\n  // achievedPct: today's actual kWh vs today's P50 forecast only\n  const todayStr = new Date().toISOString().split('T')[0];\n  const todayForecast = forecast.filter(row => {\n    const clean = (row.forecast_for || row.timestamp.replace('FORECAST#', '')).substring(0, 10);\n    return clean === todayStr;\n  });\n  let todayFcastP50 = 0;\n  if (todayForecast.length > 1) {\n    for (let i = 0; i < todayForecast.length - 1; i++) {\n      const h = Math.abs(\n        new Date(todayForecast[i+1].timestamp.replace('FORECAST#', '')).getTime() -\n        new Date(todayForecast[i].timestamp.replace('FORECAST#', '')).getTime()\n      ) / 3_600_000;\n      if (todayForecast[i].p50_kw != null && todayForecast[i+1].p50_kw != null) {\n        todayFcastP50 += (todayForecast[i].p50_kw + todayForecast[i+1].p50_kw) / 2 * h;\n      }\n    }\n  }\n  const achievedPct = todayKwh != null && todayFcastP50 > 0\n    ? Math.min(999, Math.round((todayKwh / todayFcastP50) * 100))\n    : null;\n\n  //  Derived dark-mode colours \n  const cardBg     = isDark ? 'rgba(30,41,59,0.85)'   : '#ffffff';\n  const headerGrad = isDark ? 'rgba(30,41,59,0.6)'    : 'linear-gradient(to right,#ffffff,#f9fafb)';\n  const toggleBg   = isDark ? 'rgba(15,23,42,0.6)'    : '#f3f4f6';\n  const toggleActive = isDark ? 'rgba(30,41,59,0.95)' : '#fff';\n  const borderClr  = isDark ? 'rgba(148,163,184,0.1)' : '#e5e7eb';\n\n  //  Render \n  if (loading) {\n    return (\n      <div style={{ padding: '1.5rem 0' }}>\n        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem', flexWrap: 'wrap' }}>\n          {[...Array(6)].map((_, i) => <div key={i} className=\"card skeleton\" style={{ flex: 1, minWidth: 140, height: 100 }} />)}\n        </div>\n        <div className=\"card skeleton\" style={{ height: 52, marginBottom: '0.75rem' }} />\n        <div className=\"card skeleton\" style={{ height: 130, marginBottom: '1rem' }} />\n        <div className=\"card skeleton\" style={{ height: 240, marginBottom: '1rem' }} />\n        <div className=\"card skeleton\" style={{ height: 200 }} />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div style={{ padding: '1.5rem', color: '#ef4444', fontSize: '0.85rem', background: 'rgba(239,68,68,0.06)', borderRadius: 10, marginTop: '1rem' }}>\n        Failed to load DynamoDB data for <strong>{siteId}</strong>: {error}\n      </div>\n    );\n  }\n\n  const noData = telemetry.length === 0 && forecast.length === 0 && !weather;\n\n  return (\n    <div style={{ marginTop: '1.5rem' }}>\n\n      {/*  Section header  */}\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '0.75rem', gap: '1rem', flexWrap: 'wrap' }}>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>\n          <p className=\"dash-section-label\" style={{ margin: 0 }}>\n            Live Site Intelligence  <span style={{ fontFamily: 'JetBrains Mono, monospace', color: '#00a63e' }}>{siteId}</span>\n          </p>\n          {runStateBadge && (\n            <span style={{\n              fontSize: '0.65rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.06em',\n              background: `${runStateBadge.color}18`, color: runStateBadge.color,\n              padding: '2px 8px', borderRadius: 99, fontFamily: 'Poppins, sans-serif',\n              border: `1px solid ${runStateBadge.color}30`,\n            }}>\n               {runStateBadge.label}\n            </span>\n          )}\n        </div>\n\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n            {/* History range  shown on Overview and History tabs */}\n            {(activeTab === 'overview' || activeTab === 'history') && (<>\n              <select\n                value={dateRange}\n                onChange={e => setDateRange(e.target.value)}\n                style={{ background: 'var(--bg-card,#fff)', border: '1px solid rgba(0,166,62,0.2)', borderRadius: 8, padding: '0.3rem 0.6rem', fontSize: '0.72rem', color: 'var(--text-primary,#0a0a0a)', cursor: 'pointer', fontFamily: 'Poppins, sans-serif', fontWeight: 600 }}\n              >\n                <option value=\"24h\">Today</option>\n                <option value=\"7d\">Last 7 days</option>\n                <option value=\"30d\">Last 30 days</option>\n                <option value=\"custom\">Custom range</option>\n              </select>\n              {dateRange === 'custom' && (<>\n                <input type=\"date\" value={customStartDate} onChange={e => setCustomStartDate(e.target.value)}\n                  style={{ background: 'var(--bg-card,#fff)', border: '1px solid rgba(0,166,62,0.2)', borderRadius: 8, padding: '0.3rem 0.6rem', fontSize: '0.72rem', color: 'var(--text-primary,#0a0a0a)', fontFamily: 'Poppins, sans-serif', fontWeight: 600 }} />\n                <span style={{ color: 'var(--text-muted)', fontSize: '0.7rem' }}>to</span>\n                <input type=\"date\" value={customEndDate} onChange={e => setCustomEndDate(e.target.value)}\n                  style={{ background: 'var(--bg-card,#fff)', border: '1px solid rgba(0,166,62,0.2)', borderRadius: 8, padding: '0.3rem 0.6rem', fontSize: '0.72rem', color: 'var(--text-primary,#0a0a0a)', fontFamily: 'Poppins, sans-serif', fontWeight: 600 }} />\n              </>)}\n            </>)}\n            {/* Forecast window  shown on Forecast tab */}\n            {activeTab === 'forecast' && (\n              <select\n                value={forecastWindow}\n                onChange={e => setForecastWindow(e.target.value as '1d' | '3d' | '7d')}\n                style={{ background: 'var(--bg-card,#fff)', border: '1px solid rgba(0,166,62,0.2)', borderRadius: 8, padding: '0.3rem 0.6rem', fontSize: '0.72rem', color: 'var(--text-primary,#0a0a0a)', cursor: 'pointer', fontFamily: 'Poppins, sans-serif', fontWeight: 600 }}\n              >\n                <option value=\"1d\">Next 24 hours</option>\n                <option value=\"3d\">Next 3 days</option>\n                <option value=\"7d\">Next 7 days</option>\n              </select>\n            )}\n          </div>\n          {lastUpdated && (\n            <span style={{ fontSize: '0.7rem', color: 'var(--text-muted)', fontFamily: 'Poppins, sans-serif' }}>\n              Updated {lastUpdated.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n            </span>\n          )}\n          <button\n            onClick={() => { setLoading(true); fetchAll(); }}\n            style={{ background: 'none', border: '1px solid rgba(0,166,62,0.2)', borderRadius: 8, padding: '0.2rem 0.6rem', fontSize: '0.72rem', color: '#00a63e', cursor: 'pointer', fontFamily: 'Poppins, sans-serif', fontWeight: 600 }}\n          > Refresh</button>\n        </div>\n      </div>\n\n      {noData ? (\n        <div style={{ padding: '2rem', textAlign: 'center', color: 'var(--text-muted)', fontSize: '0.875rem', background: 'rgba(0,166,62,0.03)', borderRadius: 12, border: '1px dashed rgba(0,166,62,0.15)' }}>\n          No DynamoDB data found for site <strong style={{ color: '#00a63e' }}>{siteId}</strong> in the {\n            dateRange === '24h' ? 'today' : dateRange === '7d' ? 'last 7 days' : dateRange === '30d' ? 'last 30 days' : 'selected date range'\n          }.<br />\n          <span style={{ fontSize: '0.78rem' }}>Data is written by the ML forecast scheduler when the device is actively posting telemetry.</span>\n        </div>\n      ) : (<>\n\n        {/*  Tab Bar  */}\n        <div style={{ display: 'flex', borderBottom: `2px solid ${isDark ? 'rgba(148,163,184,0.12)' : '#f3f4f6'}`, marginBottom: '1rem', gap: 0 }}>\n          {TABS.map(tab => {\n            const isActive = activeTab === tab.id;\n            return (\n              <button\n                key={tab.id}\n                onClick={() => setActiveTab(tab.id)}\n                style={{\n                  border: 'none', background: 'transparent', cursor: 'pointer',\n                  padding: '0.5rem 1rem',\n                  fontSize: '0.78rem', fontWeight: isActive ? 700 : 600,\n                  fontFamily: 'Poppins, sans-serif',\n                  color: isActive ? '#00a63e' : 'var(--text-muted)',\n                  borderBottom: `2px solid ${isActive ? '#00a63e' : 'transparent'}`,\n                  marginBottom: -2,\n                  display: 'flex', alignItems: 'center', gap: '0.35rem',\n                  transition: 'color 0.15s',\n                  letterSpacing: '0.01em',\n                }}\n              >\n                <span>{tab.icon}</span>\n                <span>{tab.label}</span>\n              </button>\n            );\n          })}\n        </div>\n\n        {/*  OVERVIEW TAB  */}\n        {activeTab === 'overview' && (<>\n\n          {/* 6-card KPI strip */}\n          <div style={{ display: 'flex', gap: '0.75rem', flexWrap: 'wrap', marginBottom: '0.75rem' }}>\n            <KpiCard\n              label=\"PV Power\" value={pvKw != null ? pvKw.toFixed(2) : ''} unit=\"kW\"\n              sub={latest?.pv1_power_w != null && latest?.pv2_power_w != null\n                ? `S1: ${(latest.pv1_power_w/1000).toFixed(2)}  S2: ${(latest.pv2_power_w/1000).toFixed(2)} kW`\n                : 'Current generation'}\n              accent=\"#F07522\" icon={<IconSun />}\n            />\n            <KpiCard\n              label=\"Battery\" value={batSoc != null ? batSoc.toFixed(1) : ''} unit=\"%\"\n              sub={batVoltage != null ? `${batVoltage.toFixed(1)} V` : 'State of charge'}\n              accent=\"#00a63e\" icon={<IconBattery />}\n              badge={batPowerKw != null && Math.abs(batPowerKw) > 0.01 ? (\n                <span style={{ fontSize: '0.65rem', fontWeight: 700, color: batCharging ? '#00a63e' : '#ec4899', fontFamily: 'Poppins, sans-serif' }}>\n                  {batCharging ? ' Charging' : ' Discharging'} {Math.abs(batPowerKw).toFixed(2)} kW\n                </span>\n              ) : <span style={{ fontSize: '0.65rem', color: 'var(--text-muted)', fontFamily: 'Poppins, sans-serif' }}>Idle</span>}\n            />\n            <KpiCard\n              label=\"Load\" value={loadKw != null ? loadKw.toFixed(2) : ''} unit=\"kW\"\n              sub=\"Current consumption\" accent=\"#8b5cf6\" icon={<IconLoad />}\n            />\n            <KpiCard\n              label=\"Energy Today\" value={todayKwh != null ? todayKwh.toFixed(2) : ''} unit=\"kWh\"\n              sub=\"Solar yield today\" accent=\"#10b981\" icon={<IconEnergy />}\n            />\n            <KpiCard\n              label=\"Grid\" value={gridKw != null ? Math.abs(gridKw).toFixed(2) : ''} unit=\"kW\"\n              sub={latest?.grid_voltage_v != null\n                ? `${Number(latest.grid_voltage_v).toFixed(0)} V  ${Number(latest.grid_frequency_hz ?? 0).toFixed(1)} Hz`\n                : 'Grid power'}\n              accent=\"#3b82f6\" icon={<IconGrid />}\n              badge={gridKw != null ? (\n                <span style={{ fontSize: '0.65rem', fontWeight: 700, color: gridImporting ? '#3b82f6' : gridExporting ? '#10b981' : 'var(--text-muted)', fontFamily: 'Poppins, sans-serif' }}>\n                  {gridImporting ? ' Importing' : gridExporting ? ' Exporting' : ' Standby'}\n                </span>\n              ) : undefined}\n            />\n            <KpiCard\n              label=\"Inv. Temp\" value={invTemp != null ? invTemp.toFixed(1) : ''} unit=\"C\"\n              sub={invTemp != null\n                ? invTemp > 60 ? ' Hot  check cooling' : invTemp > 45 ? ' Warm' : ' Normal'\n                : 'No data'}\n              accent={invTempColor} icon={<IconThermometer />}\n            />\n          </div>\n\n          {/* Daily energy breakdown */}\n          <EnergyBreakdownRow latest={latest} />\n          <InsightsRow latest={latest} />\n\n        </>)}\n\n        {/*  WEATHER TAB  */}\n        {activeTab === 'weather' && (<>\n\n          {/* Current weather pills */}\n          {weather?.current ? (\n            <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap', marginBottom: '0.75rem', alignItems: 'center' }}>\n              <span style={{ fontSize: '0.65rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.06em', color: 'var(--text-muted)', fontFamily: 'Poppins, sans-serif' }}>Now</span>\n              {[\n                { label: 'Temp',     value: weather.current.temperature_c  != null ? `${Number(weather.current.temperature_c).toFixed(1)} C`  : null },\n                { label: 'Humidity', value: weather.current.humidity_pct   != null ? `${weather.current.humidity_pct} %`                        : null },\n                { label: 'Cloud',    value: weather.current.cloud_cover_pct != null ? `${weather.current.cloud_cover_pct} %`                    : null, icon: <IconCloud /> },\n                { label: 'Wind',     value: weather.current.wind_speed_ms  != null ? `${Number(weather.current.wind_speed_ms).toFixed(1)} m/s`  : null },\n                { label: 'GHI',      value: weather.current.ghi_wm2        != null ? `${Math.round(weather.current.ghi_wm2)} W/m`              : null },\n              ].filter(p => p.value).map(p => (\n                <span key={p.label} style={{\n                  fontSize: '0.72rem', fontWeight: 600, fontFamily: 'Poppins, sans-serif',\n                  padding: '0.2rem 0.65rem', borderRadius: 99,\n                  background: 'rgba(0,166,62,0.07)', border: '1px solid rgba(0,166,62,0.12)',\n                  color: '#007a55', display: 'flex', alignItems: 'center', gap: '0.3rem',\n                }}>\n                  {(p as any).icon}{p.label}: <span style={{ fontFamily: 'JetBrains Mono, monospace', color: 'var(--text-primary)' }}>{p.value}</span>\n                </span>\n              ))}\n            </div>\n          ) : (\n            <div style={{ padding: '1.5rem', textAlign: 'center', color: 'var(--text-muted)', fontSize: '0.85rem', background: isDark ? 'rgba(0,0,0,0.15)' : 'rgba(0,166,62,0.03)', borderRadius: 12, border: '1px dashed rgba(0,166,62,0.15)', marginBottom: '1rem' }}>\n              No current weather data available.\n            </div>\n          )}\n\n          {/* 24 h weather outlook */}\n          {weather?.hourly_forecast && weather.hourly_forecast.length > 0\n            ? <WeatherHourlyStrip hourly={weather.hourly_forecast} />\n            : !weather?.current && null\n          }\n\n        </>)}\n\n        {/*  HISTORY TAB  */}\n        {activeTab === 'history' && (\n          historyData.length > 0 ? (\n            <div className=\"card\" style={{ padding: '1.25rem', marginBottom: '1rem' }}>\n              <div style={{ marginBottom: '0.75rem' }}>\n                <h3 style={{ margin: '0 0 0.2rem', fontSize: '0.9rem', fontFamily: 'Urbanist, sans-serif', color: 'var(--text-primary)' }}>\n                  Power History  {\n                    dateRange === '24h'   ? 'Today' :\n                    dateRange === '7d'    ? 'Last 7 days' :\n                    dateRange === '30d'   ? 'Last 30 days' :\n                    customStartDate && customEndDate\n                      ? `${new Date(customStartDate).toLocaleDateString()}  ${new Date(customEndDate).toLocaleDateString()}`\n                      : 'Custom range'\n                  }\n                </h3>\n                <p style={{ margin: 0, fontSize: '0.68rem', color: 'var(--text-muted)', fontFamily: 'Poppins, sans-serif' }}>\n                  {dateRange === '7d' ? 'Hourly aggregates' : dateRange !== '24h' ? 'Daily aggregates' : '30-min samples'}  Battery SOC on right axis\n                </p>\n              </div>\n              <div style={{ height: 240 }}>\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <AreaChart data={historyData} margin={{ top: 4, right: 44, left: 0, bottom: dateRange === '7d' || dateRange === '30d' ? 20 : 0 }}>\n                    <defs>\n                      <linearGradient id=\"pvGrad\"   x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                        <stop offset=\"5%\"  stopColor=\"#F07522\" stopOpacity={0.22}/>\n                        <stop offset=\"95%\" stopColor=\"#F07522\" stopOpacity={0}/>\n                      </linearGradient>\n                      <linearGradient id=\"loadGrad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                        <stop offset=\"5%\"  stopColor=\"#8b5cf6\" stopOpacity={0.18}/>\n                        <stop offset=\"95%\" stopColor=\"#8b5cf6\" stopOpacity={0}/>\n                      </linearGradient>\n                    </defs>\n                    <CartesianGrid strokeDasharray=\"3 3\" stroke={isDark ? 'rgba(148,163,184,0.07)' : 'rgba(0,166,62,0.08)'} />\n                    <XAxis\n                      dataKey=\"time\" stroke=\"var(--text-muted)\"\n                      interval={dateRange === '24h' ? 'preserveStartEnd' : Math.ceil(historyData.length / 10)}\n                      angle={dateRange === '7d' || dateRange === '30d' ? -15 : 0}\n                      textAnchor={dateRange === '7d' || dateRange === '30d' ? 'end' : 'middle'}\n                      tick={{ fontSize: dateRange === '30d' ? 9 : 10, fill: 'var(--text-muted)' }}\n                    />\n                    <YAxis yAxisId=\"power\" stroke=\"var(--text-muted)\" tickFormatter={(v: number) => `${v}kW`} tick={{ fontSize: 10, fill: 'var(--text-muted)' }} />\n                    <YAxis yAxisId=\"soc\" orientation=\"right\" stroke=\"var(--text-muted)\" domain={[0, 100]} tickFormatter={(v: number) => `${v}%`} width={36} tick={{ fontSize: 10, fill: 'var(--text-muted)' }} />\n                    <Tooltip contentStyle={tooltipStyle} formatter={(v: any, name: any) => [`${v} ${String(name).includes('%') ? '%' : 'kW'}`, name]} />\n                    <Legend iconType=\"circle\" iconSize={8} wrapperStyle={{ fontSize: 11, fontFamily: 'Poppins, sans-serif', color: 'var(--text-secondary)' }} />\n                    <Area yAxisId=\"power\" type=\"monotone\" dataKey=\"PV (kW)\"   stroke=\"#F07522\" strokeWidth={2} fill=\"url(#pvGrad)\"   dot={false} />\n                    <Area yAxisId=\"power\" type=\"monotone\" dataKey=\"Load (kW)\" stroke=\"#8b5cf6\" strokeWidth={2} fill=\"url(#loadGrad)\" dot={false} />\n                    <Line  yAxisId=\"power\" type=\"monotone\" dataKey=\"Grid (kW)\"     stroke=\"#3b82f6\" strokeWidth={1.5} dot={false} strokeDasharray=\"4 3\" />\n                    <Line  yAxisId=\"soc\"   type=\"monotone\" dataKey=\"Batt SOC (%)\"  stroke=\"#00a63e\" strokeWidth={1.5} dot={false} strokeDasharray=\"2 3\" />\n                  </AreaChart>\n                </ResponsiveContainer>\n              </div>\n            </div>\n          ) : (\n            <div style={{ padding: '2rem', textAlign: 'center', color: 'var(--text-muted)', fontSize: '0.875rem', background: isDark ? 'rgba(0,0,0,0.15)' : 'rgba(0,166,62,0.03)', borderRadius: 12, border: '1px dashed rgba(0,166,62,0.15)' }}>\n              No telemetry history data available for the selected range.\n            </div>\n          )\n        )}\n\n        {/*  FORECAST TAB  */}\n        {activeTab === 'forecast' && (\n          forecastData.length > 0 ? (\n            <div className=\"card\" style={{ padding: 0, boxShadow: '0 10px 30px -5px rgba(0,0,0,0.1)', border: `1px solid ${borderClr}`, borderRadius: 16, background: cardBg, overflow: 'hidden' }}>\n\n              {/* Header */}\n              <div style={{ padding: '1.25rem 1.5rem', borderBottom: `1px solid ${borderClr}`, display: 'flex', flexWrap: 'wrap', gap: '1rem', alignItems: 'center', justifyContent: 'space-between', background: headerGrad }}>\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '0.25rem' }}>\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n                    <div style={{ width: 32, height: 32, borderRadius: 8, background: 'rgba(0,166,62,0.1)', color: '#00a63e', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '1.1rem' }}></div>\n                    <h3 style={{ margin: 0, fontSize: '1.1rem', fontFamily: 'Urbanist, sans-serif', color: 'var(--text-primary)', fontWeight: 700 }}>Solar Forecast</h3>\n                  </div>\n                  {fcastP50 > 0 && (\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.6rem', marginLeft: '2.5rem', flexWrap: 'wrap' }}>\n                      <span style={{ fontSize: '0.82rem', color: 'var(--text-muted)', fontFamily: 'Inter, sans-serif' }}>\n                      {forecastWindow === '1d' ? '24h' : forecastWindow === '3d' ? '3-day' : '7-day'} Est. Yield:\n                    </span>\n                      <span style={{ fontFamily: 'JetBrains Mono, monospace', fontSize: '0.82rem', fontWeight: 600, color: 'var(--text-primary)', background: isDark ? 'rgba(148,163,184,0.1)' : '#f3f4f6', padding: '2px 7px', borderRadius: 4 }}>\n                        {fcastP10.toFixed(1)} <span style={{ color: 'var(--text-muted)' }}>/</span> <span style={{ color: '#00a63e' }}>{fcastP50.toFixed(1)}</span> <span style={{ color: 'var(--text-muted)' }}>/</span> {fcastP90.toFixed(1)} kWh\n                      </span>\n                      {achievedPct != null && (\n                        <span style={{\n                          fontSize: '0.72rem', fontWeight: 700, fontFamily: 'Poppins, sans-serif',\n                          padding: '2px 8px', borderRadius: 99,\n                          background: achievedPct >= 80 ? '#10b98118' : achievedPct >= 40 ? '#f59e0b18' : isDark ? 'rgba(148,163,184,0.1)' : '#e5e7eb',\n                          color:      achievedPct >= 80 ? '#059669'  : achievedPct >= 40 ? '#d97706'  : 'var(--text-muted)',\n                          border:     `1px solid ${achievedPct >= 80 ? '#10b98128' : achievedPct >= 40 ? '#f59e0b28' : borderClr}`,\n                        }}>\n                          {achievedPct}% achieved\n                        </span>\n                      )}\n                    </div>\n                  )}\n                </div>\n\n                {/* Controls */}\n                <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>\n                  {/* Chart / Table toggle */}\n                  <div style={{ display: 'flex', background: toggleBg, borderRadius: 8, padding: 3 }}>\n                    {(['chart', 'table'] as const).map(v => (\n                      <button key={v} onClick={() => setForecastView(v)} style={{ border: 'none', background: forecastView === v ? toggleActive : 'transparent', color: forecastView === v ? '#00a63e' : 'var(--text-muted)', borderRadius: 6, padding: '0.35rem 0.75rem', fontSize: '0.75rem', fontWeight: 600, cursor: 'pointer', boxShadow: forecastView === v ? '0 1px 3px rgba(0,0,0,0.1)' : 'none', textTransform: 'capitalize' }}>\n                        {v}\n                      </button>\n                    ))}\n                  </div>\n\n                  {/* Band toggles */}\n                  {forecastView === 'chart' && (\n                    <div style={{ display: 'flex', background: toggleBg, padding: 3, borderRadius: 8 }}>\n                      {[{ label: 'P10', color: '#f59e0b', desc: 'Conservative' }, { label: 'P50', color: '#00a63e', desc: 'Median' }, { label: 'P90', color: '#3b82f6', desc: 'Optimistic' }].map(b => (\n                        <button key={b.label} onClick={() => setShowBands(s => ({ ...s, [b.label]: !s[b.label] }))} style={{ border: 'none', background: showBands[b.label] ? toggleActive : 'transparent', color: showBands[b.label] ? b.color : 'var(--text-muted)', boxShadow: showBands[b.label] ? '0 2px 4px rgba(0,0,0,0.05)' : 'none', borderRadius: 6, padding: '0.35rem 0.75rem', fontSize: '0.75rem', fontWeight: 600, cursor: 'pointer', transition: 'all 0.2s', display: 'flex', alignItems: 'center', gap: 4 }} title={b.desc}>\n                          <span style={{ width: 6, height: 6, borderRadius: '50%', background: showBands[b.label] ? b.color : isDark ? '#475569' : '#d1d5db' }} />\n                          {b.label}\n                        </button>\n                      ))}\n                    </div>\n                  )}\n\n                  {/* Export */}\n                  <button\n                    onClick={async () => {\n                      const el = document.getElementById('forecast-chart-container');\n                      if (el) {\n                        const canvas = await html2canvas(el, { background: '#ffffff', scale: 2 } as any);\n                        const a = document.createElement('a');\n                        a.download = `solar-forecast-${new Date().toISOString().slice(0,10)}.png`;\n                        a.href = canvas.toDataURL(); a.click();\n                      }\n                    }}\n                    style={{ background: 'transparent', border: `1px solid ${borderClr}`, color: 'var(--text-secondary)', borderRadius: 8, padding: '0.4rem 0.8rem', fontSize: '0.8rem', fontWeight: 600, cursor: 'pointer', transition: 'all 0.2s', display: 'flex', alignItems: 'center', gap: 6 }}\n                    onMouseOver={e => e.currentTarget.style.background = isDark ? 'rgba(148,163,184,0.07)' : '#f9fafb'}\n                    onMouseOut={e  => e.currentTarget.style.background = 'transparent'}\n                  >\n                    <span></span><span>Save</span>\n                  </button>\n\n                  {/* CSV Export */}\n                  <button\n                    onClick={() => {\n                      if (!forecastData || forecastData.length === 0) return;\n                      // Get all keys from the first row\n                      const keys = Object.keys(forecastData[0]);\n                      // Build CSV header\n                      const header = keys.join(',');\n                      // Build CSV rows\n                      const rows = forecastData.map(row => keys.map(k => JSON.stringify((row as Record<string, any>)[k] ?? '')).join(','));\n                      const csv = [header, ...rows].join('\\n');\n                      // Download\n                      const blob = new Blob([csv], { type: 'text/csv' });\n                      const url = URL.createObjectURL(blob);\n                      const a = document.createElement('a');\n                      a.href = url;\n                      a.download = `solar-forecast-${new Date().toISOString().slice(0,10)}.csv`;\n                      document.body.appendChild(a);\n                      a.click();\n                      document.body.removeChild(a);\n                      URL.revokeObjectURL(url);\n                    }}\n                    style={{ background: 'transparent', border: `1px solid ${borderClr}`, color: '#00a63e', borderRadius: 8, padding: '0.4rem 0.8rem', fontSize: '0.8rem', fontWeight: 600, cursor: 'pointer', transition: 'all 0.2s', display: 'flex', alignItems: 'center', gap: 6 }}\n                    onMouseOver={e => e.currentTarget.style.background = isDark ? 'rgba(148,163,184,0.07)' : '#f9fafb'}\n                    onMouseOut={e  => e.currentTarget.style.background = 'transparent'}\n                  >\n                    <span></span><span>CSV</span>\n                  </button>\n                </div>\n              </div>\n\n              {/* Chart / Table area */}\n              <div id=\"forecast-chart-container\" style={{ padding: '0 1.5rem 1.5rem 0.5rem', background: cardBg, position: 'relative' }}>\n                {forecastView === 'chart' ? (\n                  <div style={{ height: forecastWindow === '7d' ? 360 : 300, width: '100%', userSelect: 'none', cursor: isSelecting ? 'crosshair' : 'default' }}>\n                    <ResponsiveContainer>\n                      <AreaChart\n                        data={zoomedForecastData}\n                        margin={{ top: 20, right: 10, left: 0, bottom: forecastWindow !== '1d' ? 10 : 0 }}\n                        onMouseDown={(e: any) => {\n                          if (e?.activeLabel) { setRefAreaLeft(e.activeLabel); setIsSelecting(true); }\n                        }}\n                        onMouseMove={(e: any) => {\n                          if (isSelecting && e?.activeLabel) setRefAreaRight(e.activeLabel);\n                        }}\n                        onMouseUp={() => {\n                          if (refAreaLeft && refAreaRight && refAreaLeft !== refAreaRight) {\n                            setZoomStart(refAreaLeft);\n                            setZoomEnd(refAreaRight);\n                          }\n                          setIsSelecting(false);\n                          setRefAreaLeft('');\n                          setRefAreaRight('');\n                        }}\n                      >\n                        <defs>\n                          <linearGradient id=\"p50Grad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                            <stop offset=\"5%\"  stopColor=\"#00a63e\" stopOpacity={0.2}/>\n                            <stop offset=\"95%\" stopColor=\"#00a63e\" stopOpacity={0}/>\n                          </linearGradient>\n                          <linearGradient id=\"p90Grad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                            <stop offset=\"5%\"  stopColor=\"#3b82f6\" stopOpacity={0.14}/>\n                            <stop offset=\"95%\" stopColor=\"#3b82f6\" stopOpacity={0}/>\n                          </linearGradient>\n                          <linearGradient id=\"p10Grad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                            <stop offset=\"5%\"  stopColor=\"#f59e0b\" stopOpacity={0.14}/>\n                            <stop offset=\"95%\" stopColor=\"#f59e0b\" stopOpacity={0}/>\n                          </linearGradient>\n                        </defs>\n                        <CartesianGrid strokeDasharray=\"3 3\" stroke={isDark ? 'rgba(148,163,184,0.07)' : '#f3f4f6'} vertical={false} />\n                        <XAxis\n                          dataKey=\"time\" stroke=\"var(--text-muted)\"\n                          tickLine={false} axisLine={false}\n                          height={forecastWindow === '1d' ? 22 : 42}\n                          allowDataOverflow type=\"category\"\n                          ticks={forecastTickValues}\n                          tick={(props: any) => (\n                            <ForecastXAxisTick\n                              {...props}\n                              visibleData={forecastTickObjects ?? zoomedForecastData}\n                              forecastWindow={forecastWindow}\n                            />\n                          )}\n                        />\n                        <YAxis\n                          stroke=\"var(--text-muted)\"\n                          tickLine={false} axisLine={false} width={40} allowDataOverflow\n                          tick={{ fontSize: 11, fontFamily: 'Inter, sans-serif', fill: 'var(--text-muted)' }}\n                          label={{ value: 'kW', angle: -90, position: 'insideLeft', fill: 'var(--text-muted)', fontSize: 10 }}\n                        />\n                        <Tooltip content={<ForecastTooltip />} cursor={{ stroke: '#00a63e', strokeWidth: 1, strokeDasharray: '4 4' }} animationDuration={300} wrapperStyle={{ pointerEvents: 'none' }} />\n                        <Legend verticalAlign=\"top\" height={36} iconType=\"circle\" iconSize={8} wrapperStyle={{ right: 0, top: 0, fontSize: 12, color: 'var(--text-muted)', fontFamily: 'Inter, sans-serif' }} />\n\n                        {showBands['P90'] && <Area type=\"monotone\" dataKey=\"p90\" stroke=\"#3b82f6\" strokeWidth={1} strokeDasharray=\"3 3\" fill=\"url(#p90Grad)\" activeDot={false} name=\"P90 (Optimistic)\" animationDuration={500} />}\n                        {showBands['P10'] && <Area type=\"monotone\" dataKey=\"p10\" stroke=\"#f59e0b\" strokeWidth={1} strokeDasharray=\"3 3\" fill=\"url(#p10Grad)\" activeDot={false} name=\"P10 (Conservative)\" animationDuration={500} />}\n                        {showBands['P50'] && <Area type=\"monotone\" dataKey=\"p50\" stroke=\"#00a63e\" strokeWidth={2.5} fill=\"url(#p50Grad)\" activeDot={{ r: 4, strokeWidth: 0 }} name=\"P50 (Median)\" animationDuration={800} />}\n                        <Line type=\"monotone\" dataKey=\"physics\" stroke={isDark ? '#475569' : '#d1d5db'} strokeWidth={1.5} strokeDasharray=\"5 3\" dot={false} name=\"Physics Baseline\" activeDot={false} />\n\n                        <ReferenceLine\n                          x={(() => {\n                            const n = new Date();\n                            const t = n.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n                            if (forecastWindow === '1d') return t;\n                            const dateL = forecastWindow === '3d'\n                              ? n.toLocaleDateString([], { weekday: 'short', day: 'numeric' })\n                              : n.toLocaleDateString([], { weekday: 'short', month: 'short', day: 'numeric' });\n                            return `${dateL}||${t}`;\n                          })()}\n                          stroke=\"#ef4444\" strokeWidth={1.5} strokeDasharray=\"3 3\"\n                          label={{ value: 'NOW', position: 'top', fill: '#ef4444', fontSize: 9, fontWeight: 700 }}\n                        />\n\n                        {/* Drag-selection highlight */}\n                        {isSelecting && refAreaLeft && refAreaRight && (\n                          <ReferenceArea x1={refAreaLeft} x2={refAreaRight} fill=\"#00a63e\" fillOpacity={0.08} stroke=\"#00a63e\" strokeOpacity={0.3} strokeDasharray=\"3 3\" />\n                        )}\n                      </AreaChart>\n                    </ResponsiveContainer>\n                    {/* Reset zoom button */}\n                    {(zoomStart || zoomEnd) && (\n                      <button\n                        onClick={() => { setZoomStart(null); setZoomEnd(null); }}\n                        style={{\n                          position: 'absolute', top: 10, right: 10,\n                          background: isDark ? 'rgba(30,41,59,0.9)' : 'rgba(255,255,255,0.92)',\n                          border: `1px solid ${isDark ? 'rgba(148,163,184,0.2)' : 'rgba(0,166,62,0.2)'}`,\n                          borderRadius: 6, padding: '3px 10px', fontSize: '0.72rem',\n                          color: '#00a63e', cursor: 'pointer', fontFamily: 'Poppins, sans-serif', fontWeight: 600,\n                          backdropFilter: 'blur(4px)',\n                        }}\n                      >\n                         Reset Zoom\n                      </button>\n                    )}\n                    <div style={{ position: 'absolute', bottom: 10, left: 24, fontSize: '0.62rem', color: 'var(--text-muted)', background: isDark ? 'rgba(30,41,59,0.85)' : 'rgba(255,255,255,0.85)', padding: '2px 6px', borderRadius: 4, pointerEvents: 'none' }}>\n                      {zoomStart ? 'Drag to select  Click  to reset' : 'Drag on chart to zoom'}\n                    </div>\n                  </div>\n                ) : (\n                  <ForecastTable data={zoomedForecastData} />\n                )}\n                {forecastGeneratedAt && (\n                  <div style={{ textAlign: 'right', fontSize: '0.7rem', color: 'var(--text-muted)', marginTop: '0.5rem', fontFamily: 'Inter, sans-serif', padding: '0 1rem 1rem' }}>\n                    Forecast generated: {forecastGeneratedAt.toLocaleDateString()} {forecastGeneratedAt.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                  </div>\n                )}\n              </div>\n            </div>\n          ) : (\n            <div style={{ padding: '2rem', textAlign: 'center', color: 'var(--text-muted)', fontSize: '0.875rem', background: isDark ? 'rgba(0,0,0,0.15)' : 'rgba(0,166,62,0.03)', borderRadius: 12, border: '1px dashed rgba(0,166,62,0.15)' }}>\n              No forecast data available for the selected range.\n            </div>\n          )\n        )}\n\n      </>)}\n    </div>\n  );\n};\n\nexport default SiteDataPanel;\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport { apiService } from '../services/api';\r\nimport { useDebouncedCallback } from '../hooks/useDebounce';\r\nimport { useTheme } from '../contexts/ThemeContext';\r\nimport AuditTrail from './AuditTrail';\r\nimport SiteDataPanel from './SiteDataPanel';\r\n\r\ninterface User {\r\n  id: number;\r\n  username: string;\r\n  first_name: string;\r\n  last_name: string;\r\n  email: string;\r\n  is_staff: boolean;\r\n  is_superuser: boolean;\r\n}\r\n\r\ninterface Device {\r\n  id: number;\r\n  device_serial: string;\r\n  hw_id?: string;\r\n  model?: string;\r\n  user?: string;\r\n  provisioned_at: string;\r\n  config_version?: string;\r\n  is_online?: boolean;\r\n  last_heartbeat?: string;\r\n  logs_enabled?: boolean;\r\n  pending_config_update?: boolean;\r\n  config_ack_ver?: number | null;\r\n  config_downloaded_at?: string | null;\r\n  config_acked_at?: string | null;\r\n  created_by_username?: string;\r\n  created_at?: string;\r\n  updated_by_username?: string;\r\n  updated_at?: string;\r\n}\r\n\r\ninterface Preset {\r\n  id: number;\r\n  config_id?: string;\r\n  name: string;\r\n  description?: string;\r\n  slaves_count?: number;\r\n  version?: number;\r\n  updated_at?: string;\r\n  gateway_configuration?: {\r\n    general_settings?: {\r\n      config_id?: string;\r\n      last_updated?: string;\r\n    };\r\n  };\r\n}\r\n\r\ninterface SystemHealthData {\r\n  total_devices: number;\r\n  active_devices: number;\r\n  total_telemetry_points: number;\r\n  uptime_seconds: number;\r\n  database_status: string;\r\n  mqtt_status: string;\r\n  overall_health: string;\r\n}\r\n\r\ninterface TelemetryData {\r\n  deviceId: string;\r\n  timestamp: string;\r\n  data_type: string;\r\n  value: number;\r\n  unit: string;\r\n}\r\n\r\ninterface TelemetrySummary {\r\n  totalPoints: number;\r\n  deviceCount: number;\r\n  latestTimestamp: string | null;\r\n}\r\n\r\ninterface SolarSite {\r\n  id: number;\r\n  device_id: number;\r\n  site_id: string;\r\n  display_name: string;\r\n  latitude: number;\r\n  longitude: number;\r\n  capacity_kw: number;\r\n  tilt_deg: number;\r\n  azimuth_deg: number;\r\n  timezone: string;\r\n  is_active: boolean;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\ninterface SolarSiteForm {\r\n  site_id: string;\r\n  display_name: string;\r\n  latitude: string;\r\n  longitude: string;\r\n  capacity_kw: string;\r\n  tilt_deg: string;\r\n  azimuth_deg: string;\r\n  timezone: string;\r\n  is_active: boolean;\r\n}\r\n\r\nconst Devices: React.FC = () => {\r\n  const { isDark } = useTheme();\r\n  const [searchParams] = useSearchParams();\r\n  const [devices, setDevices] = useState<Device[]>([]);\r\n  const [filteredDevices, setFilteredDevices] = useState<Device[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [editingDevice, setEditingDevice] = useState<Device | null>(null);\r\n  const [creatingDevice, setCreatingDevice] = useState(false);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [userSearchTerm, setUserSearchTerm] = useState('');\r\n  const [filteredUsers, setFilteredUsers] = useState<User[]>([]);\r\n  const [showUserDropdown, setShowUserDropdown] = useState(false);\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [selectedDevices, setSelectedDevices] = useState<Set<number>>(new Set());\r\n  const [bulkDeleteLoading, setBulkDeleteLoading] = useState(false);\r\n  // Pagination state\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [pageSize, setPageSize] = useState(25);\r\n  const [totalCount, setTotalCount] = useState(0);\r\n  const [totalPages, setTotalPages] = useState(0);\r\n  const [presets, setPresets] = useState<Preset[]>([]);\r\n  const [presetsLoading, setPresetsLoading] = useState(true);\r\n  const [health, setHealth] = useState<SystemHealthData | null>(null);\r\n  const [telemetrySummary, setTelemetrySummary] = useState<TelemetrySummary | null>(null);\r\n  const [telemetryData, setTelemetryData] = useState<TelemetryData[]>([]);\r\n  const [dashboardError, setDashboardError] = useState<string | null>(null);\r\n  const [selectedDevice, setSelectedDevice] = useState<Device | null>(null);\r\n  const [deviceLogs, setDeviceLogs] = useState<any[]>([]);\r\n  const [logsLoading, setLogsLoading] = useState(false);\r\n  const [editForm, setEditForm] = useState({\r\n    device_serial: '',\r\n    user: '',\r\n    config_version: '',\r\n  });\r\n  const [createForm, setCreateForm] = useState({\r\n    device_serial: '',\r\n    user: '',\r\n    config_version: '',\r\n  });\r\n\r\n  // Site management state\r\n  const [siteDetails, setSiteDetails] = useState<SolarSite | null>(null);\r\n  const [siteLoading, setSiteLoading] = useState(false);\r\n  const [editingSite, setEditingSite] = useState(false);\r\n  const [siteForm, setSiteForm] = useState<SolarSiteForm>({\r\n    site_id: '', display_name: '', latitude: '', longitude: '',\r\n    capacity_kw: '', tilt_deg: '18', azimuth_deg: '180',\r\n    timezone: 'Asia/Kolkata', is_active: true,\r\n  });\r\n  const [siteSaving, setSiteSaving] = useState(false);\r\n  const [siteError, setSiteError] = useState<string | null>(null);\r\n  const [devicePreset, setDevicePreset] = useState<Preset | null>(null);\r\n  \r\n  // Modern modal states\r\n  const [rebootModal, setRebootModal] = useState<{ show: boolean; device: Device | null }>({ show: false, device: null });\r\n  const [hardResetModal, setHardResetModal] = useState<{ show: boolean; device: Device | null }>({ show: false, device: null });\r\n  const [deleteModal, setDeleteModal] = useState<{ show: boolean; device: Device | null }>({ show: false, device: null });\r\n  const [successModal, setSuccessModal] = useState<{ show: boolean; message: string }>({ show: false, message: '' });\r\n\r\n  const fetchDevices = useCallback(async (page: number = 1, search: string = '') => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await apiService.getDevices(search || undefined, page, pageSize);\r\n      \r\n      // Handle paginated response\r\n      if (response.results) {\r\n        setDevices(response.results);\r\n        setFilteredDevices(response.results);\r\n        setTotalCount(response.count);\r\n        setTotalPages(response.total_pages);\r\n        setCurrentPage(response.current_page);\r\n      } else {\r\n        // Fallback for non-paginated response\r\n        setDevices(Array.isArray(response) ? response : []);\r\n        setFilteredDevices(Array.isArray(response) ? response : []);\r\n        setTotalCount(Array.isArray(response) ? response.length : 0);\r\n        setTotalPages(1);\r\n        setCurrentPage(1);\r\n      }\r\n      \r\n      setLoading(false);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'An error occurred');\r\n      setLoading(false);\r\n    }\r\n  }, [pageSize]);\r\n\r\n  const fetchUsers = async () => {\r\n    try {\r\n      const data: User[] = await apiService.getUsers();\r\n      // Filter out staff and superusers, only showing regular customers\r\n      const customers = data.filter(user => !user.is_staff && !user.is_superuser);\r\n      setUsers(customers);\r\n    } catch (err) {\r\n      console.error('Failed to fetch users:', err);\r\n      setError('Failed to load users for device assignment');\r\n    }\r\n  };\r\n\r\n  const fetchPresets = async () => {\r\n    try {\r\n      const data = await apiService.getPresets();\r\n      setPresets(Array.isArray(data) ? data : []);\r\n    } catch (err) {\r\n      console.error('Failed to fetch presets:', err);\r\n    } finally {\r\n      setPresetsLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchDashboardData = async () => {\r\n    try {\r\n      const [healthData, telemetryData] = await Promise.all([\r\n        apiService.getSystemHealth(),\r\n        apiService.getTelemetry(),\r\n      ]);\r\n\r\n      setHealth(healthData || null);\r\n\r\n      const telemetryArray = Array.isArray(telemetryData) ? telemetryData : [];\r\n      setTelemetryData(telemetryArray);\r\n      const latest = telemetryArray.reduce<string | null>((currentLatest, item) => {\r\n        if (!item?.timestamp) return currentLatest;\r\n        const itemDate = new Date(item.timestamp);\r\n        if (Number.isNaN(itemDate.getTime())) return currentLatest;\r\n        if (!currentLatest) return item.timestamp;\r\n        const currentDate = new Date(currentLatest);\r\n        return itemDate > currentDate ? item.timestamp : currentLatest;\r\n      }, null);\r\n\r\n      const deviceCount = new Set(telemetryArray.map((item: TelemetryData) => item.deviceId)).size;\r\n      setTelemetrySummary({\r\n        totalPoints: telemetryArray.length,\r\n        deviceCount,\r\n        latestTimestamp: latest,\r\n      });\r\n    } catch (err) {\r\n      console.error('Failed to fetch dashboard data:', err);\r\n      setDashboardError('Failed to load device dashboards');\r\n    }\r\n  };\r\n\r\n  const fetchDeviceLogs = useCallback(async (deviceId: number) => {\r\n    setLogsLoading(true);\r\n    try {\r\n      const response = await apiService.getDeviceLogs(deviceId, 50, 0);\r\n      setDeviceLogs(response.logs || []);\r\n    } catch (err) {\r\n      console.error('Failed to fetch device logs:', err);\r\n      setDeviceLogs([]);\r\n    } finally {\r\n      setLogsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const handleViewDevice = useCallback((device: Device) => {\r\n    setSelectedDevice(device);\r\n    setSiteDetails(null);\r\n    setSiteLoading(true);\r\n    setDeviceLogs([]);\r\n    \r\n    // Load preset details if device has config\r\n    if (device.config_version) {\r\n      const preset = presets.find(p => p.config_id === device.config_version);\r\n      setDevicePreset(preset || null);\r\n    } else {\r\n      setDevicePreset(null);\r\n    }\r\n    \r\n    // Fetch site details and logs in parallel\r\n    Promise.all([\r\n      apiService.getDeviceSite(device.id)\r\n        .then(data => setSiteDetails(data))\r\n        .catch((err) => {\r\n          console.error('Failed to fetch site for device', device.id, ':', err);\r\n          setSiteDetails(null);\r\n        }),\r\n      fetchDeviceLogs(device.id)\r\n    ]).finally(() => setSiteLoading(false));\r\n  }, [fetchDeviceLogs, presets]);\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n    fetchPresets();\r\n    fetchDashboardData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const deviceIdParam = searchParams.get('deviceId');\r\n    if (deviceIdParam) {\r\n      const deviceId = parseInt(deviceIdParam, 10);\r\n      if (!isNaN(deviceId)) {\r\n        const foundDevice = devices.find(d => d.id === deviceId);\r\n        if (foundDevice) {\r\n          handleViewDevice(foundDevice);\r\n        }\r\n      }\r\n    }\r\n  }, [searchParams, devices, handleViewDevice]);\r\n  \r\n  useEffect(() => {\r\n    fetchDevices(currentPage, searchTerm);\r\n  }, [currentPage, searchTerm, pageSize, fetchDevices]);\r\n  \r\n  useEffect(() => {\r\n    const handleClickOutside = () => {\r\n      setShowUserDropdown(false);\r\n    };\r\n\r\n    if (showUserDropdown) {\r\n      document.addEventListener('click', handleClickOutside);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('click', handleClickOutside);\r\n    };\r\n  }, [showUserDropdown]);\r\n\r\n  useEffect(() => {\r\n    if (userSearchTerm.trim() === '') {\r\n      setFilteredUsers(users);\r\n    } else {\r\n      const searchLower = userSearchTerm.toLowerCase();\r\n      const filtered = users.filter(user => {\r\n        const fullName = `${user.first_name} ${user.last_name}`.toLowerCase();\r\n        return (\r\n          user.username.toLowerCase().includes(searchLower) ||\r\n          user.first_name.toLowerCase().includes(searchLower) ||\r\n          user.last_name.toLowerCase().includes(searchLower) ||\r\n          fullName.includes(searchLower) ||\r\n          user.email.toLowerCase().includes(searchLower)\r\n        );\r\n      });\r\n      setFilteredUsers(filtered);\r\n    }\r\n  }, [users, userSearchTerm]);\r\n\r\n  // Debounced search function that runs the actual search after 300ms of inactivity\r\n  const debouncedSearch = useDebouncedCallback(\r\n    (query: string) => {\r\n      // The actual search happens via useEffect that watches currentPage and searchTerm\r\n      // This ensures we don't make too many API calls\r\n    },\r\n    300\r\n  );\r\n\r\n  const handleSearch = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const query = e.target.value;\r\n    setSearchTerm(query);\r\n    setCurrentPage(1);  // Reset to page 1 on new search\r\n    debouncedSearch(query);  // Debounce the search\r\n  };\r\n\r\n  const handleEdit = (device: Device) => {\r\n    setEditingDevice(device);\r\n    setEditForm({\r\n      device_serial: device.device_serial,\r\n      user: device.user || '',\r\n      config_version: device.config_version || '',\r\n    });\r\n    setUserSearchTerm(device.user ? `${users.find(u => u.username === device.user)?.first_name} ${users.find(u => u.username === device.user)?.last_name} (${device.user})` : '');\r\n    setShowUserDropdown(false);\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    if (!editingDevice) return;\r\n\r\n    try {\r\n      await apiService.updateDevice(editingDevice.id, editForm);\r\n      setEditingDevice(null);\r\n      // Refetch to get the updated device with all fields including audit trail\r\n      await fetchDevices(currentPage, searchTerm);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to update device');\r\n    }\r\n  };\r\n\r\n  const handleCreate = async () => {\r\n    try {\r\n      await apiService.createDevice(createForm);\r\n      setCreatingDevice(false);\r\n      setCreateForm({\r\n        device_serial: '',\r\n        user: '',\r\n        config_version: '',\r\n      });\r\n      // Refetch to get the new device with all fields including audit trail\r\n      await fetchDevices(currentPage, searchTerm);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to create device');\r\n    }\r\n  };\r\n\r\n  const handleDelete = (device: any) => {\r\n    console.log(' handleDelete called with device:', device.device_serial);\r\n    setDeleteModal({ show: true, device });\r\n  };\r\n\r\n  const handleReboot = async (device: any) => {\r\n    console.log(' handleReboot called with device:', device);\r\n    console.log(' Setting rebootModal to:', { show: true, device });\r\n    setRebootModal({ show: true, device });\r\n  };\r\n  \r\n  const confirmReboot = async () => {\r\n    if (!rebootModal.device) return;\r\n    \r\n    try {\r\n      await apiService.rebootDevice(rebootModal.device.id);\r\n      setRebootModal({ show: false, device: null });\r\n      setSuccessModal({ \r\n        show: true, \r\n        message: `Reboot command queued for ${rebootModal.device.device_serial}. Device will reboot on next heartbeat.` \r\n      });\r\n    } catch (err) {\r\n      console.error('Reboot error:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to queue reboot command');\r\n      setRebootModal({ show: false, device: null });\r\n    }\r\n  };\r\n\r\n  const handleHardReset = async (device: any) => {\r\n    setHardResetModal({ show: true, device });\r\n  };\r\n  \r\n  const confirmHardReset = async () => {\r\n    if (!hardResetModal.device) return;\r\n    \r\n    try {\r\n      await apiService.hardResetDevice(hardResetModal.device.id);\r\n      setHardResetModal({ show: false, device: null });\r\n      setSuccessModal({ \r\n        show: true, \r\n        message: `Hard reset command queued for ${hardResetModal.device.device_serial}. Device will reset on next heartbeat.` \r\n      });\r\n    } catch (err) {\r\n      console.error('Hard reset error:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to queue hard reset command');\r\n      setHardResetModal({ show: false, device: null });\r\n    }\r\n  };\r\n\r\n  const handleDeleteDevice = (device: any) => {\r\n    console.log(' handleDeleteDevice called with device:', device.device_serial);\r\n    setDeleteModal({ show: true, device });\r\n  };\r\n\r\n  const confirmDelete = async () => {\r\n    if (!deleteModal.device) return;\r\n    \r\n    try {\r\n      await apiService.deleteDevice(deleteModal.device.id);\r\n      setDeleteModal({ show: false, device: null });\r\n      setSuccessModal({ \r\n        show: true, \r\n        message: `Device ${deleteModal.device.device_serial} has been permanently deleted.` \r\n      });\r\n      setSelectedDevice(null);\r\n      fetchDevices(); // Refresh device list\r\n    } catch (err) {\r\n      console.error('Delete device error:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to delete device');\r\n      setDeleteModal({ show: false, device: null });\r\n    }\r\n  };\r\n\r\n  const handleToggleLogs = async (device: any, enabled: boolean) => {\r\n    try {\r\n      await apiService.toggleDeviceLogs(device.id, enabled);\r\n      setSelectedDevice({ ...device, logs_enabled: enabled });\r\n      fetchDevices(); // Refresh device list\r\n    } catch (err) {\r\n      console.error('Toggle logs error:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to toggle device logs');\r\n    }\r\n  };\r\n\r\n  const handleSelectDevice = (deviceId: number) => {\r\n    const newSelected = new Set(selectedDevices);\r\n    if (newSelected.has(deviceId)) {\r\n      newSelected.delete(deviceId);\r\n    } else {\r\n      newSelected.add(deviceId);\r\n    }\r\n    setSelectedDevices(newSelected);\r\n  };\r\n\r\n  const handleSelectAll = () => {\r\n    if (selectedDevices.size === filteredDevices.length) {\r\n      setSelectedDevices(new Set());\r\n    } else {\r\n      const allIds = new Set(filteredDevices.map(d => d.id));\r\n      setSelectedDevices(allIds);\r\n    }\r\n  };\r\n\r\n  const handleBulkDelete = async () => {\r\n    if (selectedDevices.size === 0) {\r\n      setError('No devices selected for deletion');\r\n      return;\r\n    }\r\n\r\n    const deviceList = Array.from(selectedDevices)\r\n      .map(id => devices.find(d => d.id === id))\r\n      .filter(Boolean);\r\n\r\n    const confirmMessage = `Are you sure you want to delete ${selectedDevices.size} device(s)?\\n\\n${deviceList.map(d => d?.device_serial).join(', ')}`;\r\n\r\n    if (window.confirm(confirmMessage)) {\r\n      try {\r\n        setBulkDeleteLoading(true);\r\n        await apiService.deleteDevicesBulk(Array.from(selectedDevices));\r\n        \r\n        const updatedDevices = devices.filter(d => !selectedDevices.has(d.id));\r\n        setDevices(updatedDevices);\r\n        setFilteredDevices(updatedDevices.filter(d => \r\n          d.device_serial.toLowerCase().includes(searchTerm.toLowerCase())\r\n        ));\r\n        setSelectedDevices(new Set());\r\n        setBulkDeleteLoading(false);\r\n      } catch (err) {\r\n        setBulkDeleteLoading(false);\r\n        console.error('Bulk delete error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to delete devices');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setEditingDevice(null);\r\n    setCreatingDevice(false);\r\n    setUserSearchTerm('');\r\n    setShowUserDropdown(false);\r\n  };\r\n\r\n  const handleBackToList = () => {\r\n    setSelectedDevice(null);\r\n    setSiteDetails(null);\r\n    setEditingSite(false);\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"loading\">Loading devices...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div className=\"error\">Error: {error}</div>;\r\n  }\r\n\r\n  const getPresetConfigId = (preset: Preset): string => {\r\n    return preset.gateway_configuration?.general_settings?.config_id || preset.config_id || '';\r\n  };\r\n\r\n  if (selectedDevice) {\r\n    const deviceTelemetry = telemetryData.filter((entry) => entry.deviceId === selectedDevice.device_serial);\r\n    const latestTelemetry = deviceTelemetry.reduce<string | null>((currentLatest, item) => {\r\n      if (!item?.timestamp) return currentLatest;\r\n      const itemDate = new Date(item.timestamp);\r\n      if (Number.isNaN(itemDate.getTime())) return currentLatest;\r\n      if (!currentLatest) return item.timestamp;\r\n      const currentDate = new Date(currentLatest);\r\n      return itemDate > currentDate ? item.timestamp : currentLatest;\r\n    }, null);\r\n\r\n    return (\r\n      <div>\r\n        <div style={{ display: 'flex', alignItems: 'center', marginBottom: '20px' }}>\r\n          <button\r\n            onClick={handleBackToList}\r\n            className=\"btn btn-secondary\"\r\n            style={{ marginRight: '15px' }}\r\n          >\r\n             Back to Devices\r\n          </button>\r\n          <h1 style={{ margin: 0 }}>{selectedDevice.device_serial} Dashboard</h1>\r\n        </div>\r\n\r\n        <div className=\"card\" style={{ marginBottom: '20px' }}>\r\n          <div className=\"card-header\">\r\n            <h2>Device Details</h2>\r\n            <div style={{ display: 'flex', gap: '10px' }}>\r\n              <button onClick={() => handleEdit(selectedDevice)} className=\"btn\">\r\n                Edit Device\r\n              </button>\r\n              <button \r\n                onClick={() => handleReboot(selectedDevice)} \r\n                className=\"btn\"\r\n                style={{ \r\n                  backgroundColor: '#f59e0b', \r\n                  color: 'white',\r\n                  border: 'none'\r\n                }}\r\n                title=\"Queue reboot command for device\"\r\n              >\r\n                 Reboot\r\n              </button>\r\n              <button \r\n                onClick={() => handleHardReset(selectedDevice)} \r\n                className=\"btn\"\r\n                style={{ \r\n                  backgroundColor: '#dc2626', \r\n                  color: 'white',\r\n                  border: 'none'\r\n                }}\r\n                title=\"Queue hard reset command for device (erases config)\"\r\n              >\r\n                 Hard Reset\r\n              </button>\r\n              <button \r\n                onClick={() => handleDeleteDevice(selectedDevice)} \r\n                className=\"btn\"\r\n                style={{ \r\n                  backgroundColor: '#7f1d1d', \r\n                  color: 'white',\r\n                  border: 'none'\r\n                }}\r\n                title=\"Permanently delete device and all its data\"\r\n              >\r\n                 Delete\r\n              </button>\r\n            </div>\r\n          </div>\r\n          <div style={{ padding: '20px' }}>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '15px' }}>\r\n              <div>\r\n                <strong>Status:</strong>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  <span style={{\r\n                    display: 'inline-block',\r\n                    padding: '4px 12px',\r\n                    borderRadius: '12px',\r\n                    fontSize: '0.875rem',\r\n                    fontWeight: '500',\r\n                    backgroundColor: selectedDevice.is_online ? '#dcfce7' : '#fee2e2',\r\n                    color: selectedDevice.is_online ? '#166534' : '#991b1b'\r\n                  }}>\r\n                    {selectedDevice.is_online ? ' Online' : ' Offline'}\r\n                  </span>\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <strong>Last Heartbeat:</strong>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  {selectedDevice.last_heartbeat\r\n                    ? new Date(selectedDevice.last_heartbeat).toLocaleString()\r\n                    : 'Never'}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <strong>MAC / HW ID:</strong>\r\n                <p style={{ margin: '5px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.9rem' }}>{selectedDevice.hw_id || ''}</p>\r\n              </div>\r\n              <div>\r\n                <strong>Model:</strong>\r\n                <p style={{ margin: '5px 0' }}>{selectedDevice.model || ''}</p>\r\n              </div>\r\n              <div>\r\n                <strong>Assigned User:</strong>\r\n                <p style={{ margin: '5px 0' }}>{selectedDevice.user || '-'}</p>\r\n              </div>\r\n              <div style={{ gridColumn: '1 / -1', padding: '15px', backgroundColor: 'transparent', borderRadius: '8px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-sync-card\">\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '12px' }}>\r\n                  <div>\r\n                    <strong style={{ fontSize: '0.95rem', color: 'inherit' }} className=\"config-heading\">Configuration</strong>\r\n                    {devicePreset && (\r\n                      <div style={{ fontSize: '0.875rem', color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginTop: '2px' }} className=\"config-label\">\r\n                        {devicePreset.name || selectedDevice.config_version}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  {!selectedDevice.config_version ? (\r\n                    <span style={{ color: isDark ? '#a0a0a0' : 'rgba(0, 0, 0, 0.5)', fontSize: '0.875rem' }} className=\"config-no-preset\">No preset assigned</span>\r\n                  ) : selectedDevice.pending_config_update ? (\r\n                    <span style={{\r\n                      display: 'inline-flex', alignItems: 'center', gap: '5px',\r\n                      padding: '4px 12px', borderRadius: '12px', fontSize: '0.8rem', fontWeight: '500',\r\n                      backgroundColor: '#fef9c3', color: '#854d0e'\r\n                    }}> Pending update</span>\r\n                  ) : (\r\n                    <span style={{\r\n                      display: 'inline-flex', alignItems: 'center', gap: '5px',\r\n                      padding: '4px 12px', borderRadius: '12px', fontSize: '0.8rem', fontWeight: '500',\r\n                      backgroundColor: '#dcfce7', color: '#166534'\r\n                    }}> Synced</span>\r\n                  )}\r\n                </div>\r\n                {selectedDevice.config_version && (\r\n                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '8px', fontSize: '0.8rem' }}>\r\n                    <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                      <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Preset ID</div>\r\n                      <div style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>{selectedDevice.config_version}</div>\r\n                    </div>\r\n                    {devicePreset?.slaves_count != null && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Slaves</div>\r\n                        <div style={{ fontWeight: '500', color: 'inherit' }}>{devicePreset.slaves_count} device{devicePreset.slaves_count !== 1 ? 's' : ''}</div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_ack_ver != null && devicePreset?.version != null && (\r\n                      <div style={{ \r\n                        padding: '8px', \r\n                        backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', \r\n                        borderRadius: '6px',\r\n                        gridColumn: '1 / -1',\r\n                        border: selectedDevice.config_ack_ver === devicePreset.version ? '2px solid #dcfce7' : '2px solid #fef9c3'\r\n                      }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '4px' }} className=\"config-label\">Version Status</div>\r\n                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                          <div>\r\n                            <span style={{ fontSize: '0.75rem', color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)' }} className=\"config-label\">Device: </span>\r\n                            <span style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>v{selectedDevice.config_ack_ver}</span>\r\n                            <span style={{ margin: '0 8px', color: isDark ? '#808080' : 'rgba(0, 0, 0, 0.4)' }} className=\"config-arrow\"></span>\r\n                            <span style={{ fontSize: '0.75rem', color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)' }} className=\"config-label\">Latest: </span>\r\n                            <span style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>v{devicePreset.version}</span>\r\n                          </div>\r\n                          {selectedDevice.config_ack_ver === devicePreset.version ? (\r\n                            <span style={{ color: '#166534', fontSize: '0.75rem', fontWeight: '500' }}> Up to date</span>\r\n                          ) : (\r\n                            <span style={{ color: '#854d0e', fontSize: '0.75rem', fontWeight: '500' }}> Update available</span>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_ack_ver != null && devicePreset?.version == null && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Device Version</div>\r\n                        <div style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>v{selectedDevice.config_ack_ver}</div>\r\n                      </div>\r\n                    )}\r\n                    {devicePreset?.gateway_configuration?.general_settings?.last_updated && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Last Modified</div>\r\n                        <div style={{ fontWeight: '500', fontSize: '0.75rem', color: 'inherit' }}>\r\n                          {new Date(devicePreset.gateway_configuration.general_settings.last_updated).toLocaleDateString()}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_acked_at && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)', gridColumn: '1 / -1' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Last Synced</div>\r\n                        <div style={{ fontWeight: '500', fontSize: '0.75rem', color: 'inherit' }}>\r\n                          {new Date(selectedDevice.config_acked_at).toLocaleString()}\r\n                          {(() => {\r\n                            const ackTime = new Date(selectedDevice.config_acked_at);\r\n                            const now = new Date();\r\n                            const diffMs = now.getTime() - ackTime.getTime();\r\n                            const diffMins = Math.floor(diffMs / 60000);\r\n                            const diffHours = Math.floor(diffMins / 60);\r\n                            const diffDays = Math.floor(diffHours / 24);\r\n                            if (diffMins < 1) return '  just now';\r\n                            if (diffMins < 60) return `  ${diffMins}m ago`;\r\n                            if (diffHours < 24) return `  ${diffHours}h ago`;\r\n                            return `  ${diffDays}d ago`;\r\n                          })()}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_downloaded_at && selectedDevice.config_acked_at && (\r\n                      <div style={{ padding: '8px', backgroundColor: isDark ? '#242424' : 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: isDark ? '1px solid #404040' : '1px solid rgba(0, 0, 0, 0.1)', gridColumn: '1 / -1' }} className=\"config-info-box\">\r\n                        <div style={{ color: isDark ? '#b0b0b0' : 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Apply Duration</div>\r\n                        <div style={{ fontWeight: '500', color: 'inherit' }}>\r\n                          {Math.round((new Date(selectedDevice.config_acked_at).getTime() - new Date(selectedDevice.config_downloaded_at).getTime()) / 1000)} seconds\r\n                          <span style={{ color: isDark ? '#a0a0a0' : 'rgba(0, 0, 0, 0.5)', marginLeft: '8px', fontSize: '0.75rem' }} className=\"config-label\">\r\n                            (download  acknowledge)\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div>\r\n                <strong>Provisioned At:</strong>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  {selectedDevice.provisioned_at\r\n                    ? new Date(selectedDevice.provisioned_at).toLocaleDateString()\r\n                    : 'N/A'}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <strong>Created By:</strong>\r\n                <p style={{ margin: '5px 0' }}>{selectedDevice.created_by_username || '-'}</p>\r\n              </div>\r\n              <div style={{ gridColumn: '1 / -1' }}>\r\n                <label style={{ display: 'flex', alignItems: 'center', gap: '10px', cursor: 'pointer' }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedDevice.logs_enabled || false}\r\n                    onChange={(e) => handleToggleLogs(selectedDevice, e.target.checked)}\r\n                    style={{ background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                  />\r\n                  <strong>Enable Device Logs</strong>\r\n                  <span style={{ fontSize: '0.875rem', color: isDark ? '#b0b0b0' : '#9ca3af' }}>\r\n                    (Device will send logs when enabled)\r\n                  </span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-2\" style={{ gap: 'var(--space-6, 24px)', marginTop: '32px' }}>\r\n          <div className=\"card\">\r\n            <h2>System Health</h2>\r\n            {dashboardError && <p className=\"error\">{dashboardError}</p>}\r\n            {!dashboardError && !health && <p>Loading system health...</p>}\r\n            {health && (\r\n              <div>\r\n                <p><strong>Overall:</strong> {health.overall_health}</p>\r\n                <p><strong>Devices:</strong> {health.active_devices}/{health.total_devices} active</p>\r\n                <p><strong>Telemetry Points:</strong> {health.total_telemetry_points.toLocaleString()}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"card\">\r\n            <h2>Telemetry Snapshot</h2>\r\n            {dashboardError && <p className=\"error\">{dashboardError}</p>}\r\n            {!dashboardError && !telemetrySummary && <p>Loading telemetry...</p>}\r\n            {telemetrySummary && (\r\n              <div>\r\n                <p><strong>Total Points:</strong> {deviceTelemetry.length.toLocaleString()}</p>\r\n                <p><strong>Data Types:</strong> {new Set(deviceTelemetry.map((entry) => entry.data_type)).size}</p>\r\n                <p><strong>Latest:</strong> {latestTelemetry ? new Date(latestTelemetry).toLocaleString() : 'N/A'}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  Site Configuration  */}\r\n        <div className=\"card\" style={{ marginTop: '48px' }}>\r\n          <div className=\"card-header\">\r\n            <h2>Site Configuration</h2>\r\n            {!siteLoading && (\r\n              <button className=\"btn\" onClick={() => {\r\n                if (siteDetails) {\r\n                  setSiteForm({\r\n                    site_id: siteDetails.site_id,\r\n                    display_name: siteDetails.display_name,\r\n                    latitude: String(siteDetails.latitude),\r\n                    longitude: String(siteDetails.longitude),\r\n                    capacity_kw: String(siteDetails.capacity_kw),\r\n                    tilt_deg: String(siteDetails.tilt_deg),\r\n                    azimuth_deg: String(siteDetails.azimuth_deg),\r\n                    timezone: siteDetails.timezone,\r\n                    is_active: siteDetails.is_active,\r\n                  });\r\n                } else {\r\n                  setSiteForm({ site_id: '', display_name: '', latitude: '', longitude: '', capacity_kw: '', tilt_deg: '18', azimuth_deg: '180', timezone: 'Asia/Kolkata', is_active: true });\r\n                }\r\n                setSiteError(null);\r\n                setEditingSite(true);\r\n              }}>\r\n                {siteDetails ? 'Edit Site' : 'Add Site'}\r\n              </button>\r\n            )}\r\n          </div>\r\n          <div style={{ padding: '20px' }}>\r\n            {siteLoading ? (\r\n              <p style={{ color: 'var(--text-muted)' }}>Loading site details</p>\r\n            ) : !siteDetails ? (\r\n              <p style={{ color: 'var(--text-muted)', fontSize: '0.9rem' }}>No site configured for this device yet.</p>\r\n            ) : (\r\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '15px' }}>\r\n                <div><strong>Site ID:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.88rem', color: '#00a63e' }}>{siteDetails.site_id}</p></div>\r\n                <div><strong>Display Name:</strong><p style={{ margin: '4px 0' }}>{siteDetails.display_name || ''}</p></div>\r\n                <div><strong>Status:</strong><p style={{ margin: '4px 0' }}><span className={siteDetails.is_active ? 'status-badge status-badge-success' : 'status-badge status-badge-danger'}>{siteDetails.is_active ? 'Active' : 'Inactive'}</span></p></div>\r\n                <div><strong>Latitude:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.88rem' }}>{siteDetails.latitude}</p></div>\r\n                <div><strong>Longitude:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.88rem' }}>{siteDetails.longitude}</p></div>\r\n                <div><strong>Timezone:</strong><p style={{ margin: '4px 0' }}>{siteDetails.timezone}</p></div>\r\n                <div><strong>Capacity:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace' }}>{siteDetails.capacity_kw} kW</p></div>\r\n                <div><strong>Tilt:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace' }}>{siteDetails.tilt_deg}</p></div>\r\n                <div><strong>Azimuth:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace' }}>{siteDetails.azimuth_deg}</p></div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  Live Site Intelligence (DynamoDB)  */}\r\n        {siteDetails && (\r\n          <div style={{ marginTop: '48px' }}>\r\n            <SiteDataPanel siteId={siteDetails.site_id} autoRefresh />\r\n          </div>\r\n        )}\r\n\r\n        {/*  Device Logs  */}\r\n        <div className=\"card\" style={{ marginTop: '48px', marginBottom: '20px' }}>\r\n          <div className=\"card-header\">\r\n            <h2>Device Logs</h2>\r\n            <button onClick={() => fetchDeviceLogs(selectedDevice.id)} className=\"btn\" disabled={logsLoading}>\r\n              {logsLoading ? 'Loading...' : ' Refresh'}\r\n            </button>\r\n          </div>\r\n          <div style={{ padding: '20px' }}>\r\n            {!selectedDevice.logs_enabled && (\r\n              <p style={{ color: 'var(--text-muted, #9ca3af)', fontStyle: 'italic' }}>\r\n                Logging is disabled for this device. Enable it in Device Details to receive logs.\r\n              </p>\r\n            )}\r\n            {deviceLogs.length === 0 && selectedDevice.logs_enabled && !logsLoading && (\r\n              <p style={{ color: 'var(--text-muted, #9ca3af)' }}>\r\n                No logs available yet. Logs will appear when device sends them.\r\n              </p>\r\n            )}\r\n            {logsLoading && (\r\n              <p style={{ color: 'var(--text-muted, #9ca3af)' }}>\r\n                Loading logs...\r\n              </p>\r\n            )}\r\n            {deviceLogs.length > 0 && (\r\n              <div style={{ \r\n                maxHeight: '400px', \r\n                overflowY: 'auto', \r\n                fontFamily: 'JetBrains Mono, monospace', \r\n                fontSize: '0.85rem',\r\n                backgroundColor: '#1e1e1e',\r\n                padding: '10px',\r\n                borderRadius: '4px'\r\n              }}>\r\n                {deviceLogs.map((log) => (\r\n                  <div key={log.id} style={{ \r\n                    marginBottom: '8px', \r\n                    paddingBottom: '8px', \r\n                    borderBottom: '1px solid #333',\r\n                    color: log.level === 'ERROR' ? '#ff6b6b' : \r\n                           log.level === 'WARNING' ? '#ffa500' : \r\n                           log.level === 'INFO' ? '#4dabf7' : '#ced4da'\r\n                  }}>\r\n                    <span style={{ color: '#888' }}>[{new Date(log.timestamp).toLocaleString()}]</span>\r\n                    <span style={{ fontWeight: 'bold', marginLeft: '8px' }}>[{log.level}]</span>\r\n                    <span style={{ marginLeft: '8px' }}>{log.message}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  Site edit modal  */}\r\n        {editingSite && (\r\n          <div className=\"modal\">\r\n            <div className=\"modal-content\">\r\n              <h3>{siteDetails ? `Edit Site: ${siteDetails.site_id}` : 'Add Site Configuration'}</h3>\r\n              <form onSubmit={async (e) => {\r\n                e.preventDefault();\r\n                setSiteSaving(true);\r\n                setSiteError(null);\r\n                try {\r\n                  const payload = {\r\n                    site_id: siteForm.site_id.trim(),\r\n                    display_name: siteForm.display_name.trim(),\r\n                    latitude: parseFloat(siteForm.latitude),\r\n                    longitude: parseFloat(siteForm.longitude),\r\n                    capacity_kw: parseFloat(siteForm.capacity_kw),\r\n                    tilt_deg: parseFloat(siteForm.tilt_deg),\r\n                    azimuth_deg: parseFloat(siteForm.azimuth_deg),\r\n                    timezone: siteForm.timezone.trim(),\r\n                    is_active: siteForm.is_active,\r\n                  };\r\n\r\n                  let updated;\r\n                  if (siteDetails) {\r\n                    updated = await apiService.updateDeviceSite(selectedDevice.id, payload);\r\n                  } else {\r\n                    updated = await apiService.createDeviceSite(selectedDevice.id, payload);\r\n                  }\r\n\r\n                  if (!updated || !updated.site_id) {\r\n                    throw new Error('Invalid response from server  site data missing');\r\n                  }\r\n\r\n                  setSiteDetails(updated);\r\n                  setEditingSite(false);\r\n                  setSiteSaving(false);\r\n\r\n                  // Re-fetch after creation to get server-assigned fields\r\n                  if (!siteDetails) {\r\n                    setTimeout(() => {\r\n                      apiService.getDeviceSite(selectedDevice.id)\r\n                        .then(data => { if (data) setSiteDetails(data); })\r\n                        .catch(err => console.error('Failed to re-fetch site:', err));\r\n                    }, 500);\r\n                  }\r\n                } catch (err: any) {\r\n                  setSiteError(err.message || 'Failed to save site');\r\n                  setSiteSaving(false);\r\n                }\r\n              }}>\r\n                <div className=\"modal-body\">\r\n                  {siteError && (\r\n                    <p style={{ color: isDark ? '#fca5a5' : '#ef4444', fontSize: '0.875rem', marginBottom: '1rem' }}>{siteError}</p>\r\n                  )}\r\n\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Identification</h4>\r\n                    <div className=\"form-grid form-grid-2\">\r\n                      <div className=\"form-group\">\r\n                        <label>Site ID *</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          required\r\n                          value={siteForm.site_id}\r\n                          disabled={!!siteDetails}\r\n                          onChange={e => setSiteForm({ ...siteForm, site_id: e.target.value })}\r\n                          placeholder=\"e.g. site_mumbai_01\"\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                        {!!siteDetails && <small className=\"form-hint\">Site ID cannot be changed after creation.</small>}\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Display Name</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={siteForm.display_name}\r\n                          onChange={e => setSiteForm({ ...siteForm, display_name: e.target.value })}\r\n                          placeholder=\"e.g. Mumbai Rooftop\"\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Location</h4>\r\n                    <div className=\"form-grid form-grid-3\">\r\n                      <div className=\"form-group\">\r\n                        <label>Latitude *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          required\r\n                          step=\"any\"\r\n                          value={siteForm.latitude}\r\n                          onChange={e => setSiteForm({ ...siteForm, latitude: e.target.value })}\r\n                          placeholder=\"19.0760\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Longitude *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          required\r\n                          step=\"any\"\r\n                          value={siteForm.longitude}\r\n                          onChange={e => setSiteForm({ ...siteForm, longitude: e.target.value })}\r\n                          placeholder=\"72.8777\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Timezone</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={siteForm.timezone}\r\n                          onChange={e => setSiteForm({ ...siteForm, timezone: e.target.value })}\r\n                          placeholder=\"Asia/Kolkata\"\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Panel Configuration</h4>\r\n                    <div className=\"form-grid form-grid-3\">\r\n                      <div className=\"form-group\">\r\n                        <label>Capacity (kW) *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          required\r\n                          step=\"any\"\r\n                          value={siteForm.capacity_kw}\r\n                          onChange={e => setSiteForm({ ...siteForm, capacity_kw: e.target.value })}\r\n                          placeholder=\"5.0\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Tilt ()</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          step=\"any\"\r\n                          value={siteForm.tilt_deg}\r\n                          onChange={e => setSiteForm({ ...siteForm, tilt_deg: e.target.value })}\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Azimuth ()</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          step=\"any\"\r\n                          value={siteForm.azimuth_deg}\r\n                          onChange={e => setSiteForm({ ...siteForm, azimuth_deg: e.target.value })}\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label style={{ display: 'flex', alignItems: 'center', gap: '8px', cursor: 'pointer' }}>\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          id=\"dev-site-active\"\r\n                          checked={siteForm.is_active}\r\n                          onChange={e => setSiteForm({ ...siteForm, is_active: e.target.checked })}\r\n                          style={{ width: '16px', height: '16px', background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                        Active\r\n                      </label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"form-actions\" style={{ padding: '0 24px 24px 24px' }}>\r\n                  <button type=\"submit\" className=\"btn\" disabled={siteSaving}>\r\n                    {siteSaving ? 'Saving' : siteDetails ? 'Save Changes' : 'Add Site'}\r\n                  </button>\r\n                  <button type=\"button\" className=\"btn btn-secondary\" onClick={() => setEditingSite(false)} disabled={siteSaving}>\r\n                    Cancel\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {editingDevice && (\r\n          <div className=\"modal\">\r\n            <div className=\"modal-content\">\r\n              <h3>{editingDevice ? `Edit Device: ${editingDevice.device_serial}` : 'Register New Device'}</h3>\r\n              <form onSubmit={(e) => { e.preventDefault(); editingDevice ? handleSave() : handleCreate(); }}>\r\n                <div className=\"modal-body\">\r\n                  \r\n                  {/* Device Identity */}\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Device Identity</h4>\r\n                    <div className=\"form-grid\">\r\n                      <div className=\"form-group\">\r\n                        <label>Device Serial Number</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={editingDevice ? editForm.device_serial : createForm.device_serial}\r\n                          onChange={(e) => editingDevice ? setEditForm({...editForm, device_serial: e.target.value}) : setCreateForm({...createForm, device_serial: e.target.value})}\r\n                          required\r\n                          autoComplete=\"off\"\r\n                          placeholder=\"SN-12345678\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Ownership */}\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Ownership & Assignment</h4>\r\n                    <div className=\"form-grid\">\r\n                      <div className=\"form-group\">\r\n                        <label>Assigned User</label>\r\n                        <div style={{ position: 'relative' }} onClick={(e) => e.stopPropagation()}>\r\n                          <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search by name, username, or email...\"\r\n                            value={userSearchTerm}\r\n                            onChange={(e) => {\r\n                              setUserSearchTerm(e.target.value);\r\n                              setShowUserDropdown(true);\r\n                            }}\r\n                            onFocus={() => setShowUserDropdown(true)}\r\n                            autoComplete=\"off\"\r\n                            className=\"full-width\"\r\n                            style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                          />\r\n                          {showUserDropdown && (\r\n                            <div style={{\r\n                              position: 'absolute',\r\n                              top: '100%',\r\n                              left: '0',\r\n                              right: '0',\r\n                              background: 'var(--bg-secondary, #1e293b)',\r\n                              border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                              borderRadius: '6px',\r\n                              marginTop: '4px',\r\n                              maxHeight: '200px',\r\n                              overflowY: 'auto',\r\n                              zIndex: 10,\r\n                              boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)'\r\n                            }}>\r\n                              {filteredUsers.length > 0 ? (\r\n                                filteredUsers.map((user) => (\r\n                                  <div\r\n                                    key={user.id}\r\n                                    onClick={() => {\r\n                                      if (editingDevice) {\r\n                                        setEditForm({...editForm, user: user.username});\r\n                                      } else {\r\n                                        setCreateForm({...createForm, user: user.username});\r\n                                      }\r\n                                      setUserSearchTerm(`${user.first_name} ${user.last_name} (${user.username})`);\r\n                                      setShowUserDropdown(false);\r\n                                    }}\r\n                                    style={{\r\n                                      padding: '12px 16px',\r\n                                      cursor: 'pointer',\r\n                                      borderBottom: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n                                      background: (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent',\r\n                                      color: 'var(--text-primary, #f8fafc)',\r\n                                      transition: 'all 0.15s ease',\r\n                                      fontSize: '0.875rem'\r\n                                    }}\r\n                                    onMouseEnter={(e) => e.currentTarget.style.background = 'rgba(255, 255, 255, 0.06)'}\r\n                                    onMouseLeave={(e) => e.currentTarget.style.background = (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent'}\r\n                                  >\r\n                                    {user.first_name} {user.last_name} ({user.username}) <br/>\r\n                                    <span style={{ fontSize: '0.75rem', color: 'var(--text-secondary, #94a3b8)' }}>{user.email}</span>\r\n                                  </div>\r\n                                ))\r\n                              ) : (\r\n                                <div style={{ padding: '12px 16px', color: 'var(--text-muted, #64748b)', fontSize: '0.875rem' }}>\r\n                                  {userSearchTerm.trim() === '' ? 'Start typing to search users...' : 'No users found'}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Configuration */}\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Configuration</h4>\r\n                    <div className=\"form-grid form-grid-2\">\r\n                      <div className=\"form-group\">\r\n                        <label>Preset Template</label>\r\n                        <select\r\n                          value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                          onChange={(e) => editingDevice ? setEditForm({ ...editForm, config_version: e.target.value }) : setCreateForm({ ...createForm, config_version: e.target.value })}\r\n                          className=\"full-width\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        >\r\n                          <option value=\"\">-- Manual Configuration --</option>\r\n                          {presetsLoading && <option value=\"\" disabled>Loading presets...</option>}\r\n                          {!presetsLoading && presets.map((preset) => (\r\n                            <option key={preset.id} value={getPresetConfigId(preset)}>\r\n                              {preset.name} ({getPresetConfigId(preset) || 'no ID'})\r\n                            </option>\r\n                          ))}\r\n                        </select>\r\n                        <small className=\"form-hint\">Selecting a preset sets the Config Version ID below.</small>\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Config Version ID</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                          onChange={(e) => editingDevice ? setEditForm({...editForm, config_version: e.target.value}) : setCreateForm({...createForm, config_version: e.target.value})}\r\n                          autoComplete=\"off\"\r\n                          placeholder=\"Manual Config ID\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                </div>\r\n                {editingDevice && (\r\n                  <div style={{ padding: '0 24px' }}>\r\n                     <AuditTrail\r\n                       createdBy={editingDevice.created_by_username}\r\n                       createdAt={editingDevice.created_at}\r\n                       updatedBy={editingDevice.updated_by_username}\r\n                       updatedAt={editingDevice.updated_at}\r\n                     />\r\n                  </div>\r\n                )}\r\n                <div className=\"form-actions\" style={{ padding: '0 24px 24px 24px' }}>\r\n                  <button type=\"submit\" className=\"btn\">{editingDevice ? 'Save Changes' : 'Create Device'}</button>\r\n                  <button type=\"button\" onClick={handleCancel} className=\"btn btn-secondary\">Cancel</button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Modern Reboot Confirmation Modal */}\r\n        {rebootModal.show && rebootModal.device && (\r\n          <div style={{\r\n            position: 'fixed',\r\n            top: 0,\r\n            left: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            background: 'rgba(0,0,0,0.6)',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            zIndex: 1000,\r\n            backdropFilter: 'blur(4px)'\r\n          }}>\r\n            <div style={{\r\n              background: isDark ? '#2d2d2d' : 'white',\r\n              borderRadius: '16px',\r\n              padding: '2rem',\r\n              maxWidth: '500px',\r\n              width: '90%',\r\n              boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n              border: isDark ? '1px solid #404040' : 'none',\r\n              animation: 'slideIn 0.2s ease-out'\r\n            }}>\r\n              <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '1.5rem' }}>\r\n                <div style={{\r\n                  width: '48px',\r\n                  height: '48px',\r\n                  borderRadius: '12px',\r\n                  background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  justifyContent: 'center',\r\n                  fontSize: '1.5rem'\r\n                }}>\r\n                  \r\n                </div>\r\n                <h3 style={{ fontSize: '1.5rem', fontWeight: '600', margin: 0, color: isDark ? '#e0e0e0' : '#2c3e50' }}>\r\n                  Confirm Reboot\r\n                </h3>\r\n              </div>\r\n              \r\n              <div style={{ marginBottom: '1.5rem', color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.6' }}>\r\n                <p style={{ marginBottom: '1rem' }}>\r\n                  Are you sure you want to reboot device <strong style={{ color: isDark ? '#e0e0e0' : '#2c3e50' }}>{rebootModal.device.device_serial}</strong>?\r\n                </p>\r\n                <div style={{\r\n                  background: isDark ? 'rgba(102,126,234,0.1)' : '#e7f3ff',\r\n                  border: isDark ? '1px solid rgba(102,126,234,0.3)' : '1px solid #b3d9ff',\r\n                  borderRadius: '8px',\r\n                  padding: '0.75rem 1rem',\r\n                  fontSize: '0.9rem',\r\n                  color: isDark ? '#88a6ff' : '#004085'\r\n                }}>\r\n                  <strong> Note:</strong> The device will restart on its next heartbeat. Any unsaved data may be lost.\r\n                </div>\r\n              </div>\r\n              \r\n              <div style={{ display: 'flex', gap: '0.75rem', justifyContent: 'flex-end' }}>\r\n                <button\r\n                  onClick={() => setRebootModal({ show: false, device: null })}\r\n                  style={{\r\n                    background: isDark ? '#3a3a3a' : '#e0e0e0',\r\n                    color: isDark ? '#e0e0e0' : '#495057',\r\n                    border: 'none',\r\n                    padding: '0.75rem 1.5rem',\r\n                    borderRadius: '8px',\r\n                    fontSize: '0.95rem',\r\n                    fontWeight: '600',\r\n                    cursor: 'pointer',\r\n                    transition: 'all 0.2s'\r\n                  }}\r\n                  onMouseOver={e => e.currentTarget.style.background = isDark ? '#4a4a4a' : '#d0d0d0'}\r\n                  onMouseOut={e => e.currentTarget.style.background = isDark ? '#3a3a3a' : '#e0e0e0'}\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  onClick={confirmReboot}\r\n                  style={{\r\n                    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n                    color: 'white',\r\n                    border: 'none',\r\n                    padding: '0.75rem 1.5rem',\r\n                    borderRadius: '8px',\r\n                    fontSize: '0.95rem',\r\n                    fontWeight: '600',\r\n                    cursor: 'pointer',\r\n                    boxShadow: '0 4px 12px rgba(102, 126, 234, 0.3)',\r\n                    transition: 'all 0.2s'\r\n                  }}\r\n                  onMouseOver={e => e.currentTarget.style.transform = 'translateY(-1px)'}\r\n                  onMouseOut={e => e.currentTarget.style.transform = 'translateY(0)'}\r\n                >\r\n                  Confirm Reboot\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Modern Hard Reset Confirmation Modal */}\r\n        {hardResetModal.show && hardResetModal.device && (\r\n          <div style={{\r\n            position: 'fixed',\r\n            top: 0,\r\n            left: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            background: 'rgba(0,0,0,0.6)',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            zIndex: 1000,\r\n            backdropFilter: 'blur(4px)'\r\n          }}>\r\n            <div style={{\r\n              background: isDark ? '#2d2d2d' : 'white',\r\n              borderRadius: '16px',\r\n              padding: '2rem',\r\n              maxWidth: '500px',\r\n              width: '90%',\r\n              boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n              border: isDark ? '2px solid #dc3545' : '2px solid #dc3545',\r\n              animation: 'slideIn 0.2s ease-out'\r\n            }}>\r\n              <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '1.5rem' }}>\r\n                <div style={{\r\n                  width: '48px',\r\n                  height: '48px',\r\n                  borderRadius: '12px',\r\n                  background: 'linear-gradient(135deg, #dc3545 0%, #c82333 100%)',\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  justifyContent: 'center',\r\n                  fontSize: '1.5rem',\r\n                  animation: 'pulse 2s infinite'\r\n                }}>\r\n                  \r\n                </div>\r\n                <h3 style={{ fontSize: '1.5rem', fontWeight: '600', margin: 0, color: '#dc3545' }}>\r\n                  Hard Reset Warning\r\n                </h3>\r\n              </div>\r\n              \r\n              <div style={{ marginBottom: '1.5rem', color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.6' }}>\r\n                <div style={{\r\n                  background: isDark ? 'rgba(220, 53, 69, 0.1)' : '#f8d7da',\r\n                  border: isDark ? '1px solid rgba(220, 53, 69, 0.3)' : '1px solid #f5c6cb',\r\n                  borderRadius: '8px',\r\n                  padding: '1rem',\r\n                  marginBottom: '1rem',\r\n                  color: isDark ? '#ff9999' : '#721c24'\r\n                }}>\r\n                  <strong style={{ fontSize: '1.05rem' }}> CRITICAL WARNING</strong>\r\n                  <p style={{ margin: '0.5rem 0 0 0', fontSize: '0.9rem' }}>\r\n                    This action will <strong>erase all device configuration</strong> and restart the device to factory settings.\r\n                  </p>\r\n                </div>\r\n                \r\n                <p style={{ marginBottom: '0.75rem' }}>\r\n                  Device to reset: <strong style={{ color: isDark ? '#e0e0e0' : '#2c3e50' }}>{hardResetModal.device.device_serial}</strong>\r\n                </p>\r\n                \r\n                <ul style={{ margin: '0.5rem 0', paddingLeft: '1.5rem', fontSize: '0.9rem' }}>\r\n                  <li>All configuration will be lost</li>\r\n                  <li>Device will return to factory defaults</li>\r\n                  <li>Re-provisioning will be required</li>\r\n                </ul>\r\n              </div>\r\n              \r\n              <div style={{ display: 'flex', gap: '0.75rem', justifyContent: 'flex-end' }}>\r\n                <button\r\n                  onClick={() => setHardResetModal({ show: false, device: null })}\r\n                  style={{\r\n                    background: isDark ? '#3a3a3a' : '#e0e0e0',\r\n                    color: isDark ? '#e0e0e0' : '#495057',\r\n                    border: 'none',\r\n                    padding: '0.75rem 1.5rem',\r\n                    borderRadius: '8px',\r\n                    fontSize: '0.95rem',\r\n                    fontWeight: '600',\r\n                    cursor: 'pointer',\r\n                    transition: 'all 0.2s'\r\n                  }}\r\n                  onMouseOver={e => e.currentTarget.style.background = isDark ? '#4a4a4a' : '#d0d0d0'}\r\n                  onMouseOut={e => e.currentTarget.style.background = isDark ? '#3a3a3a' : '#e0e0e0'}\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  onClick={confirmHardReset}\r\n                  style={{\r\n                    background: 'linear-gradient(135deg, #dc3545 0%, #c82333 100%)',\r\n                    color: 'white',\r\n                    border: 'none',\r\n                    padding: '0.75rem 1.5rem',\r\n                    borderRadius: '8px',\r\n                    fontSize: '0.95rem',\r\n                    fontWeight: '600',\r\n                    cursor: 'pointer',\r\n                    boxShadow: '0 4px 12px rgba(220, 53, 69, 0.3)',\r\n                    transition: 'all 0.2s'\r\n                  }}\r\n                  onMouseOver={e => e.currentTarget.style.transform = 'translateY(-1px)'}\r\n                  onMouseOut={e => e.currentTarget.style.transform = 'translateY(0)'}\r\n                >\r\n                  Yes, Hard Reset\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Modern Delete Confirmation Modal */}\r\n        {deleteModal.show && deleteModal.device && (\r\n          <div style={{\r\n            position: 'fixed',\r\n            top: 0,\r\n            left: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            background: 'rgba(0,0,0,0.6)',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            zIndex: 1000,\r\n            backdropFilter: 'blur(4px)'\r\n          }}>\r\n            <div style={{\r\n              background: isDark ? '#2d2d2d' : 'white',\r\n              borderRadius: '16px',\r\n              padding: '2rem',\r\n              maxWidth: '500px',\r\n              width: '90%',\r\n              boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n              border: isDark ? '2px solid #7f1d1d' : '2px solid #7f1d1d',\r\n              animation: 'slideIn 0.2s ease-out'\r\n            }}>\r\n              <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '1.5rem' }}>\r\n                <div style={{\r\n                  width: '48px',\r\n                  height: '48px',\r\n                  borderRadius: '12px',\r\n                  background: 'linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%)',\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  justifyContent: 'center',\r\n                  fontSize: '1.5rem',\r\n                  animation: 'pulse 2s infinite'\r\n                }}>\r\n                  \r\n                </div>\r\n                <h3 style={{ fontSize: '1.5rem', fontWeight: '600', margin: 0, color: '#7f1d1d' }}>\r\n                  Delete Device Permanently\r\n                </h3>\r\n              </div>\r\n              \r\n              <div style={{ marginBottom: '1.5rem', color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.6' }}>\r\n                <div style={{\r\n                  background: isDark ? 'rgba(127, 29, 29, 0.1)' : '#fee2e2',\r\n                  border: isDark ? '1px solid rgba(127, 29, 29, 0.3)' : '1px solid #fecaca',\r\n                  borderRadius: '8px',\r\n                  padding: '1rem',\r\n                  marginBottom: '1rem',\r\n                  color: isDark ? '#fca5a5' : '#991b1b'\r\n                }}>\r\n                  <strong style={{ fontSize: '1.05rem' }}> PERMANENT DELETION</strong>\r\n                  <p style={{ margin: '0.5rem 0 0 0', fontSize: '0.9rem' }}>\r\n                    This action <strong>cannot be undone</strong>. All device data will be permanently deleted.\r\n                  </p>\r\n                </div>\r\n                \r\n                <p style={{ marginBottom: '0.75rem' }}>\r\n                  Device to delete: <strong style={{ color: isDark ? '#e0e0e0' : '#2c3e50' }}>{deleteModal.device.device_serial}</strong>\r\n                </p>\r\n                \r\n                <ul style={{ margin: '0.5rem 0', paddingLeft: '1.5rem', fontSize: '0.9rem' }}>\r\n                  <li>All telemetry data will be lost</li>\r\n                  <li>All command history will be deleted</li>\r\n                  <li>Device must be re-provisioned to use again</li>\r\n                </ul>\r\n              </div>\r\n              \r\n              <div style={{ display: 'flex', gap: '0.75rem', justifyContent: 'flex-end' }}>\r\n                <button\r\n                  onClick={() => setDeleteModal({ show: false, device: null })}\r\n                  style={{\r\n                    background: isDark ? '#3a3a3a' : '#e0e0e0',\r\n                    color: isDark ? '#e0e0e0' : '#495057',\r\n                    border: 'none',\r\n                    padding: '0.75rem 1.5rem',\r\n                    borderRadius: '8px',\r\n                    fontSize: '0.95rem',\r\n                    fontWeight: '600',\r\n                    cursor: 'pointer',\r\n                    transition: 'all 0.2s'\r\n                  }}\r\n                  onMouseOver={e => e.currentTarget.style.background = isDark ? '#4a4a4a' : '#d0d0d0'}\r\n                  onMouseOut={e => e.currentTarget.style.background = isDark ? '#3a3a3a' : '#e0e0e0'}\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  onClick={confirmDelete}\r\n                  style={{\r\n                    background: 'linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%)',\r\n                    color: 'white',\r\n                    border: 'none',\r\n                    padding: '0.75rem 1.5rem',\r\n                    borderRadius: '8px',\r\n                    fontSize: '0.95rem',\r\n                    fontWeight: '600',\r\n                    cursor: 'pointer',\r\n                    boxShadow: '0 4px 12px rgba(127, 29, 29, 0.3)',\r\n                    transition: 'all 0.2s'\r\n                  }}\r\n                  onMouseOver={e => e.currentTarget.style.transform = 'translateY(-1px)'}\r\n                  onMouseOut={e => e.currentTarget.style.transform = 'translateY(0)'}\r\n                >\r\n                  Yes, Delete Permanently\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Modern Success Notification Modal */}\r\n        {successModal.show && (\r\n          <div style={{\r\n            position: 'fixed',\r\n            top: 0,\r\n            left: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            background: 'rgba(0,0,0,0.4)',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            zIndex: 1000,\r\n            backdropFilter: 'blur(2px)'\r\n          }}>\r\n            <div style={{\r\n              background: isDark ? '#2d2d2d' : 'white',\r\n              borderRadius: '16px',\r\n              padding: '2rem',\r\n              maxWidth: '450px',\r\n              width: '90%',\r\n              boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n              border: isDark ? '1px solid #28a745' : '2px solid #28a745',\r\n              animation: 'slideIn 0.2s ease-out'\r\n            }}>\r\n              <div style={{ textAlign: 'center' }}>\r\n                <div style={{\r\n                  width: '64px',\r\n                  height: '64px',\r\n                  borderRadius: '50%',\r\n                  background: 'linear-gradient(135deg, #28a745 0%, #20c997 100%)',\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  justifyContent: 'center',\r\n                  fontSize: '2rem',\r\n                  margin: '0 auto 1rem',\r\n                  animation: 'scaleIn 0.3s ease-out'\r\n                }}>\r\n                  \r\n                </div>\r\n                \r\n                <h3 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1rem', color: isDark ? '#e0e0e0' : '#2c3e50' }}>\r\n                  Command Queued\r\n                </h3>\r\n                \r\n                <p style={{ color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.6', marginBottom: '1.5rem' }}>\r\n                  {successModal.message}\r\n                </p>\r\n                \r\n                <button\r\n                  onClick={() => setSuccessModal({ show: false, message: '' })}\r\n                  style={{\r\n                    background: 'linear-gradient(135deg, #28a745 0%, #20c997 100%)',\r\n                    color: 'white',\r\n                    border: 'none',\r\n                    padding: '0.75rem 2rem',\r\n                    borderRadius: '8px',\r\n                    fontSize: '0.95rem',\r\n                    fontWeight: '600',\r\n                    cursor: 'pointer',\r\n                    boxShadow: '0 4px 12px rgba(40, 167, 69, 0.3)',\r\n                    transition: 'all 0.2s'\r\n                  }}\r\n                  onMouseOver={e => e.currentTarget.style.transform = 'translateY(-1px)'}\r\n                  onMouseOut={e => e.currentTarget.style.transform = 'translateY(0)'}\r\n                >\r\n                  Got it!\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h1>Device Management</h1>\r\n\r\n      <div className=\"card\">\r\n        <div className=\"card-header\">\r\n          <h2>Devices ({filteredDevices.length})</h2>\r\n          <div className=\"card-actions\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search devices...\"\r\n              value={searchTerm}\r\n              onChange={handleSearch}\r\n              className=\"search-input\"\r\n              style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n            />\r\n            {selectedDevices.size > 0 && (\r\n              <button \r\n                onClick={handleBulkDelete}\r\n                disabled={bulkDeleteLoading}\r\n                style={{ \r\n                  background: 'var(--danger-color, #ef4444)',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '8px 16px',\r\n                  borderRadius: '6px',\r\n                  cursor: bulkDeleteLoading ? 'not-allowed' : 'pointer',\r\n                  fontSize: '0.875rem',\r\n                  fontWeight: '500',\r\n                  opacity: bulkDeleteLoading ? '0.6' : '1'\r\n                }}\r\n              >\r\n                {bulkDeleteLoading ? `Deleting ${selectedDevices.size}...` : `Delete Selected (${selectedDevices.size})`}\r\n              </button>\r\n            )}\r\n            <button onClick={() => {\r\n              setCreatingDevice(true);\r\n              setUserSearchTerm('');\r\n              setShowUserDropdown(false);\r\n            }} className=\"btn\">\r\n              Register New Device\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <table className=\"table\">\r\n          <thead>\r\n            <tr>\r\n              <th style={{ textAlign: 'center', width: '40px' }}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={selectedDevices.size === filteredDevices.length && filteredDevices.length > 0}\r\n                  onChange={handleSelectAll}\r\n                  title=\"Select all displayed devices\"\r\n                  style={{ background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                />\r\n              </th>\r\n              <th style={{ textAlign: 'center' }}>Device Serial</th>\r\n              <th style={{ textAlign: 'center' }}>Status</th>\r\n              <th style={{ textAlign: 'center' }}>MAC / HW ID</th>\r\n              <th style={{ textAlign: 'center' }}>Model</th>\r\n              <th style={{ textAlign: 'center' }}>Assigned To</th>\r\n              <th style={{ textAlign: 'center' }}>Config Version</th>\r\n              <th style={{ textAlign: 'center' }}>Provisioned At</th>\r\n              <th style={{ textAlign: 'center' }}>Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {filteredDevices.map((device) => (\r\n              <tr\r\n                key={device.id}\r\n                onClick={() => handleViewDevice(device)}\r\n                style={{\r\n                  background: selectedDevices.has(device.id) ? 'rgba(99, 102, 241, 0.1)' : 'transparent',\r\n                  cursor: 'pointer'\r\n                }}\r\n                className=\"clickable-row\"\r\n              >\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedDevices.has(device.id)}\r\n                    onChange={() => handleSelectDevice(device.id)}\r\n                    style={{ background: isDark ? '#1a1a1a' : 'white', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                  />\r\n                </td>\r\n                <td style={{ textAlign: 'center', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.85rem' }}>{device.device_serial}</td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <span style={{\r\n                    display: 'inline-block',\r\n                    padding: '4px 8px',\r\n                    borderRadius: '12px',\r\n                    fontSize: '0.75rem',\r\n                    fontWeight: '500',\r\n                    backgroundColor: device.is_online ? '#dcfce7' : '#fee2e2',\r\n                    color: device.is_online ? '#166534' : '#991b1b'\r\n                  }}>\r\n                    {device.is_online ? ' Online' : ' Offline'}\r\n                  </span>\r\n                </td>\r\n                <td style={{ textAlign: 'center', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.82rem', color: device.hw_id ? 'inherit' : 'var(--text-muted, #9ca3af)' }}>{device.hw_id || ''}</td>\r\n                <td style={{ textAlign: 'center', fontSize: '0.875rem' }}>{device.model || <span style={{ color: 'var(--text-muted, #9ca3af)' }}></span>}</td>\r\n                <td style={{ textAlign: 'center' }}>{device.user || '-'}</td>\r\n                <td style={{ textAlign: 'center' }}>{device.config_version || '-'}</td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  {(() => {\r\n                    if (!device.provisioned_at) return 'N/A';\r\n                    const date = new Date(device.provisioned_at);\r\n                    return isNaN(date.getTime()) ? 'Invalid Date' : date.toLocaleDateString();\r\n                  })()}\r\n                </td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <button\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleEdit(device);\r\n                    }}\r\n                    style={{ background: 'none', border: 'none', cursor: 'pointer', color: 'var(--text-secondary, #94a3b8)', margin: '0 6px' }}\r\n                    title=\"Edit\"\r\n                  >\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                      <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\r\n                      <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\r\n                    </svg>\r\n                  </button>\r\n                  <button\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleDelete(device);\r\n                    }}\r\n                    style={{ background: 'none', border: 'none', cursor: 'pointer', color: 'var(--danger-color, #ef4444)', margin: '0 6px' }}\r\n                    title=\"Delete\"\r\n                  >\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                      <polyline points=\"3,6 5,6 21,6\"></polyline>\r\n                      <path d=\"M19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2\"></path>\r\n                      <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\"></line>\r\n                      <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\"></line>\r\n                    </svg>\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n        \r\n        {/* Pagination Controls */}\r\n        {totalCount > 0 && (\r\n          <div style={{\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            padding: '16px',\r\n            borderTop: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n            gap: '16px'\r\n          }}>\r\n            <div style={{ fontSize: '0.875rem', color: 'var(--text-secondary, #94a3b8)' }}>\r\n              Showing {((currentPage - 1) * pageSize) + 1} - {Math.min(currentPage * pageSize, totalCount)} of {totalCount} devices\r\n            </div>\r\n            \r\n            <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>\r\n              <button\r\n                onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\r\n                disabled={currentPage === 1}\r\n                style={{\r\n                  padding: '8px 12px',\r\n                  border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                  borderRadius: '6px',\r\n                  background: currentPage === 1 ? 'rgba(148, 163, 184, 0.1)' : 'transparent',\r\n                  color: 'var(--text-primary, #f8fafc)',\r\n                  cursor: currentPage === 1 ? 'not-allowed' : 'pointer',\r\n                  opacity: currentPage === 1 ? '0.5' : '1'\r\n                }}\r\n              >\r\n                 Previous\r\n              </button>\r\n              \r\n              <div style={{ display: 'flex', gap: '4px', alignItems: 'center' }}>\r\n                {(() => {\r\n                  const pages = [];\r\n                  \r\n                  for (let i = 1; i <= totalPages; i++) {\r\n                    // Always show first page, last page, current page, and adjacent pages\r\n                    const showPage = i === 1 || i === totalPages || Math.abs(i - currentPage) <= 1;\r\n                    \r\n                    if (showPage) {\r\n                      pages.push(\r\n                        <button\r\n                          key={i}\r\n                          onClick={() => setCurrentPage(i)}\r\n                          style={{\r\n                            padding: '6px 10px',\r\n                            border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                            borderRadius: '4px',\r\n                            background: i === currentPage ? 'rgba(99, 102, 241, 0.2)' : 'transparent',\r\n                            color: 'var(--text-primary, #f8fafc)',\r\n                            cursor: 'pointer',\r\n                            fontWeight: i === currentPage ? 'bold' : 'normal',\r\n                            minWidth: '32px'\r\n                          }}\r\n                        >\r\n                          {i}\r\n                        </button>\r\n                      );\r\n                    } else if (pages[pages.length - 1]?.key !== 'ellipsis-' + Math.floor(i / 10)) {\r\n                      // Add ellipsis if we skipped pages and haven't added one recently\r\n                      pages.push(\r\n                        <span key={`ellipsis-${Math.floor(i / 10)}`} style={{ padding: '0 4px', color: 'var(--text-secondary, #94a3b8)' }}>\r\n                          ...\r\n                        </span>\r\n                      );\r\n                    }\r\n                  }\r\n                  \r\n                  return pages;\r\n                })()}\r\n              </div>\r\n              \r\n              <button\r\n                onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\r\n                disabled={currentPage === totalPages}\r\n                style={{\r\n                  padding: '8px 12px',\r\n                  border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                  borderRadius: '6px',\r\n                  background: currentPage === totalPages ? 'rgba(148, 163, 184, 0.1)' : 'transparent',\r\n                  color: 'var(--text-primary, #f8fafc)',\r\n                  cursor: currentPage === totalPages ? 'not-allowed' : 'pointer',\r\n                  opacity: currentPage === totalPages ? '0.5' : '1'\r\n                }}\r\n              >\r\n                Next \r\n              </button>\r\n            </div>\r\n            \r\n            <select\r\n              value={pageSize}\r\n              onChange={(e) => {\r\n                setPageSize(parseInt(e.target.value));\r\n                setCurrentPage(1);\r\n              }}\r\n              style={{\r\n                padding: '8px',\r\n                border: isDark ? '1px solid #404040' : '1px solid rgba(148, 163, 184, 0.2)',\r\n                borderRadius: '6px',\r\n                background: isDark ? '#1a1a1a' : '#0f172a',\r\n                color: isDark ? '#e0e0e0' : '#f8fafc',\r\n                cursor: 'pointer',\r\n                fontSize: '0.875rem'\r\n              }}\r\n            >\r\n              <option value={10}>10 per page</option>\r\n              <option value={25}>25 per page</option>\r\n              <option value={50}>50 per page</option>\r\n              <option value={100}>100 per page</option>\r\n            </select>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {(editingDevice || creatingDevice) && (\r\n        <div className=\"modal\">\r\n          <div className=\"modal-content\">\r\n            <h3>{editingDevice ? `Edit Device: ${editingDevice.device_serial}` : 'Register New Device'}</h3>\r\n            <form onSubmit={(e) => { e.preventDefault(); editingDevice ? handleSave() : handleCreate(); }}>\r\n              <div className=\"modal-body\">\r\n                \r\n                {/* Device Identity */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Device Identity</h4>\r\n                  <div className=\"form-grid\">\r\n                    <div className=\"form-group\">\r\n                      <label>Device Serial Number</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingDevice ? editForm.device_serial : createForm.device_serial}\r\n                        onChange={(e) => editingDevice ? setEditForm({...editForm, device_serial: e.target.value}) : setCreateForm({...createForm, device_serial: e.target.value})}\r\n                        required\r\n                        autoComplete=\"off\"\r\n                        placeholder=\"SN-12345678\"\r\n                        style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Ownership */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Ownership & Assignment</h4>\r\n                  <div className=\"form-grid\">\r\n                    <div className=\"form-group\">\r\n                      <label>Assigned User</label>\r\n                      <div style={{ position: 'relative' }} onClick={(e) => e.stopPropagation()}>\r\n                        <input\r\n                          type=\"text\"\r\n                          placeholder=\"Search and select user...\"\r\n                          value={userSearchTerm}\r\n                          onChange={(e) => {\r\n                            setUserSearchTerm(e.target.value);\r\n                            setShowUserDropdown(true);\r\n                          }}\r\n                          onFocus={() => setShowUserDropdown(true)}\r\n                          autoComplete=\"off\"\r\n                          style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                        />\r\n                        {(editingDevice ? editForm.user : createForm.user) && (\r\n                          <div style={{ marginTop: '8px', fontSize: '0.875rem', color: isDark ? '#b0b0b0' : '#94a3b8' }}>\r\n                            <strong>Selected:</strong> {users.find(u => u.username === (editingDevice ? editForm.user : createForm.user))?.first_name} {users.find(u => u.username === (editingDevice ? editForm.user : createForm.user))?.last_name} ({editingDevice ? editForm.user : createForm.user})\r\n                            <button\r\n                              type=\"button\"\r\n                              onClick={() => {\r\n                                if (editingDevice) {\r\n                                  setEditForm({...editForm, user: ''});\r\n                                } else {\r\n                                  setCreateForm({...createForm, user: ''});\r\n                                }\r\n                                setUserSearchTerm('');\r\n                              }}\r\n                              className=\"btn-icon btn-icon-danger\"\r\n                              style={{ marginLeft: '10px' }}\r\n                              title=\"Remove Assignment\"\r\n                            >\r\n                              \r\n                            </button>\r\n                          </div>\r\n                        )}\r\n                        {showUserDropdown && (\r\n                          <div style={{\r\n                            position: 'absolute',\r\n                            top: '100%',\r\n                            left: 0,\r\n                            right: 0,\r\n                            background: 'var(--bg-secondary, #0f172a)',\r\n                            border: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n                            borderRadius: '8px',\r\n                            maxHeight: '200px',\r\n                            overflowY: 'auto',\r\n                            zIndex: 1000,\r\n                            boxShadow: 'var(--shadow-xl)',\r\n                            marginTop: '4px'\r\n                          }}>\r\n                            {filteredUsers.length > 0 ? (\r\n                              filteredUsers.map((user) => (\r\n                                <div\r\n                                  key={user.id}\r\n                                  onClick={() => {\r\n                                    if (editingDevice) {\r\n                                      setEditForm({...editForm, user: user.username});\r\n                                    } else {\r\n                                      setCreateForm({...createForm, user: user.username});\r\n                                    }\r\n                                    setUserSearchTerm(`${user.first_name} ${user.last_name} (${user.username})`);\r\n                                    setShowUserDropdown(false);\r\n                                  }}\r\n                                  style={{\r\n                                    padding: '12px 16px',\r\n                                    cursor: 'pointer',\r\n                                    borderBottom: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n                                    background: (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent',\r\n                                    color: 'var(--text-primary, #f8fafc)',\r\n                                    transition: 'all 0.15s ease',\r\n                                    fontSize: '0.875rem'\r\n                                  }}\r\n                                  onMouseEnter={(e) => e.currentTarget.style.background = 'rgba(255, 255, 255, 0.06)'}\r\n                                  onMouseLeave={(e) => e.currentTarget.style.background = (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent'}\r\n                                >\r\n                                  {user.first_name} {user.last_name} ({user.username}) <br/>\r\n                                  <span style={{ fontSize: '0.75rem', color: 'var(--text-secondary, #94a3b8)' }}>{user.email}</span>\r\n                                </div>\r\n                              ))\r\n                            ) : (\r\n                              <div style={{ padding: '12px 16px', color: 'var(--text-muted, #64748b)', fontSize: '0.875rem' }}>\r\n                                {userSearchTerm.trim() === '' ? 'Start typing to search users...' : 'No users found'}\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Configuration */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Configuration</h4>\r\n                  <div className=\"form-grid form-grid-2\">\r\n                    <div className=\"form-group\">\r\n                      <label>Preset Template</label>\r\n                      <select\r\n                        value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                        onChange={(e) => editingDevice ? setEditForm({ ...editForm, config_version: e.target.value }) : setCreateForm({ ...createForm, config_version: e.target.value })}\r\n                        className=\"full-width\"\r\n                        style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                      >\r\n                        <option value=\"\">-- Manual Configuration --</option>\r\n                        {presetsLoading && <option value=\"\" disabled>Loading presets...</option>}\r\n                        {!presetsLoading && presets.map((preset) => (\r\n                          <option key={preset.id} value={getPresetConfigId(preset)}>\r\n                            {preset.name} ({getPresetConfigId(preset) || 'no ID'})\r\n                          </option>\r\n                        ))}\r\n                      </select>\r\n                      <small className=\"form-hint\">Selecting a preset sets the Config Version ID below.</small>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label>Config Version ID</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                        onChange={(e) => editingDevice ? setEditForm({...editForm, config_version: e.target.value}) : setCreateForm({...createForm, config_version: e.target.value})}\r\n                        autoComplete=\"off\"\r\n                        placeholder=\"Manual Config ID\"\r\n                        style={{ background: isDark ? '#1a1a1a' : 'white', color: isDark ? '#e0e0e0' : 'inherit', border: isDark ? '1px solid #404040' : '1px solid #ced4da' }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n              </div>\r\n              {editingDevice && (\r\n                <div style={{ padding: '0 24px' }}>\r\n                   <AuditTrail\r\n                     createdBy={editingDevice.created_by_username}\r\n                     createdAt={editingDevice.created_at}\r\n                     updatedBy={editingDevice.updated_by_username}\r\n                     updatedAt={editingDevice.updated_at}\r\n                   />\r\n                </div>\r\n              )}\r\n              <div className=\"form-actions\" style={{ padding: '24px' }}>\r\n                <button type=\"submit\" className=\"btn\">{editingDevice ? 'Save Changes' : 'Register Device'}</button>\r\n                <button type=\"button\" onClick={handleCancel} className=\"btn btn-secondary\">Cancel</button>\r\n              </div>\r\n            </form>\r\n        </div>\r\n      </div>\r\n    )}\r\n\r\n    {/* Modern Reboot Confirmation Modal */}\r\n    {rebootModal.show && rebootModal.device && (\r\n      <div style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.6)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 1000,\r\n        backdropFilter: 'blur(4px)'\r\n      }}>\r\n        <div style={{\r\n          background: isDark ? '#2d2d2d' : 'white',\r\n          borderRadius: '16px',\r\n          padding: '2rem',\r\n          maxWidth: '500px',\r\n          width: '90%',\r\n          boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n          border: isDark ? '1px solid #404040' : 'none',\r\n          animation: 'slideIn 0.2s ease-out'\r\n        }}>\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '1.5rem' }}>\r\n            <div style={{\r\n              width: '48px',\r\n              height: '48px',\r\n              borderRadius: '12px',\r\n              background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              fontSize: '1.5rem'\r\n            }}>\r\n              \r\n            </div>\r\n            <h3 style={{ fontSize: '1.5rem', fontWeight: '600', margin: 0, color: isDark ? '#e0e0e0' : '#2c3e50' }}>\r\n              Confirm Reboot\r\n            </h3>\r\n          </div>\r\n          \r\n          <div style={{ marginBottom: '1.5rem', color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.6' }}>\r\n            <p style={{ marginBottom: '1rem' }}>\r\n              Are you sure you want to reboot device <strong style={{ color: isDark ? '#e0e0e0' : '#2c3e50' }}>{rebootModal.device.device_serial}</strong>?\r\n            </p>\r\n            <div style={{\r\n              background: isDark ? 'rgba(102,126,234,0.1)' : '#e7f3ff',\r\n              border: isDark ? '1px solid rgba(102,126,234,0.3)' : '1px solid #b3d9ff',\r\n              borderRadius: '8px',\r\n              padding: '0.75rem 1rem',\r\n              fontSize: '0.9rem',\r\n              color: isDark ? '#88a6ff' : '#004085'\r\n            }}>\r\n              <strong> Note:</strong> The device will restart on its next heartbeat. Any unsaved data may be lost.\r\n            </div>\r\n          </div>\r\n          \r\n          <div style={{ display: 'flex', gap: '0.75rem', justifyContent: 'flex-end' }}>\r\n            <button\r\n              onClick={() => setRebootModal({ show: false, device: null })}\r\n              style={{\r\n                background: isDark ? '#3a3a3a' : '#e0e0e0',\r\n                color: isDark ? '#e0e0e0' : '#495057',\r\n                border: 'none',\r\n                padding: '0.75rem 1.5rem',\r\n                borderRadius: '8px',\r\n                fontSize: '0.95rem',\r\n                fontWeight: '600',\r\n                cursor: 'pointer',\r\n                transition: 'all 0.2s'\r\n              }}\r\n              onMouseOver={e => e.currentTarget.style.background = isDark ? '#4a4a4a' : '#d0d0d0'}\r\n              onMouseOut={e => e.currentTarget.style.background = isDark ? '#3a3a3a' : '#e0e0e0'}\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              onClick={confirmReboot}\r\n              style={{\r\n                background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n                color: 'white',\r\n                border: 'none',\r\n                padding: '0.75rem 1.5rem',\r\n                borderRadius: '8px',\r\n                fontSize: '0.95rem',\r\n                fontWeight: '600',\r\n                cursor: 'pointer',\r\n                boxShadow: '0 4px 12px rgba(102, 126, 234, 0.3)',\r\n                transition: 'all 0.2s'\r\n              }}\r\n              onMouseOver={e => e.currentTarget.style.transform = 'translateY(-1px)'}\r\n              onMouseOut={e => e.currentTarget.style.transform = 'translateY(0)'}\r\n            >\r\n              Confirm Reboot\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )}\r\n\r\n    {/* Modern Hard Reset Confirmation Modal */}\r\n    {hardResetModal.show && hardResetModal.device && (\r\n      <div style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.6)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 1000,\r\n        backdropFilter: 'blur(4px)'\r\n      }}>\r\n        <div style={{\r\n          background: isDark ? '#2d2d2d' : 'white',\r\n          borderRadius: '16px',\r\n          padding: '2rem',\r\n          maxWidth: '500px',\r\n          width: '90%',\r\n          boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n          border: isDark ? '2px solid #dc3545' : '2px solid #dc3545',\r\n          animation: 'slideIn 0.2s ease-out'\r\n        }}>\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '1.5rem' }}>\r\n            <div style={{\r\n              width: '48px',\r\n              height: '48px',\r\n              borderRadius: '12px',\r\n              background: 'linear-gradient(135deg, #dc3545 0%, #c82333 100%)',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              fontSize: '1.5rem',\r\n              animation: 'pulse 2s infinite'\r\n            }}>\r\n              \r\n            </div>\r\n            <h3 style={{ fontSize: '1.5rem', fontWeight: '600', margin: 0, color: '#dc3545' }}>\r\n              Hard Reset Warning\r\n            </h3>\r\n          </div>\r\n          \r\n          <div style={{ marginBottom: '1.5rem', color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.6' }}>\r\n            <div style={{\r\n              background: isDark ? 'rgba(220, 53, 69, 0.1)' : '#f8d7da',\r\n              border: isDark ? '1px solid rgba(220, 53, 69, 0.3)' : '1px solid #f5c6cb',\r\n              borderRadius: '8px',\r\n              padding: '1rem',\r\n              marginBottom: '1rem',\r\n              color: isDark ? '#ff9999' : '#721c24'\r\n            }}>\r\n              <strong style={{ fontSize: '1.05rem' }}> CRITICAL WARNING</strong>\r\n              <p style={{ margin: '0.5rem 0 0 0', fontSize: '0.9rem' }}>\r\n                This action will <strong>erase all device configuration</strong> and restart the device to factory settings.\r\n              </p>\r\n            </div>\r\n            \r\n            <p style={{ marginBottom: '0.75rem' }}>\r\n              Device to reset: <strong style={{ color: isDark ? '#e0e0e0' : '#2c3e50' }}>{hardResetModal.device.device_serial}</strong>\r\n            </p>\r\n            \r\n            <ul style={{ margin: '0.5rem 0', paddingLeft: '1.5rem', fontSize: '0.9rem' }}>\r\n              <li>All configuration will be lost</li>\r\n              <li>Device will return to factory defaults</li>\r\n              <li>Re-provisioning will be required</li>\r\n            </ul>\r\n          </div>\r\n          \r\n          <div style={{ display: 'flex', gap: '0.75rem', justifyContent: 'flex-end' }}>\r\n            <button\r\n              onClick={() => setHardResetModal({ show: false, device: null })}\r\n              style={{\r\n                background: isDark ? '#3a3a3a' : '#e0e0e0',\r\n                color: isDark ? '#e0e0e0' : '#495057',\r\n                border: 'none',\r\n                padding: '0.75rem 1.5rem',\r\n                borderRadius: '8px',\r\n                fontSize: '0.95rem',\r\n                fontWeight: '600',\r\n                cursor: 'pointer',\r\n                transition: 'all 0.2s'\r\n              }}\r\n              onMouseOver={e => e.currentTarget.style.background = isDark ? '#4a4a4a' : '#d0d0d0'}\r\n              onMouseOut={e => e.currentTarget.style.background = isDark ? '#3a3a3a' : '#e0e0e0'}\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              onClick={confirmHardReset}\r\n              style={{\r\n                background: 'linear-gradient(135deg, #dc3545 0%, #c82333 100%)',\r\n                color: 'white',\r\n                border: 'none',\r\n                padding: '0.75rem 1.5rem',\r\n                borderRadius: '8px',\r\n                fontSize: '0.95rem',\r\n                fontWeight: '600',\r\n                cursor: 'pointer',\r\n                boxShadow: '0 4px 12px rgba(220, 53, 69, 0.3)',\r\n                transition: 'all 0.2s'\r\n              }}\r\n              onMouseOver={e => e.currentTarget.style.transform = 'translateY(-1px)'}\r\n              onMouseOut={e => e.currentTarget.style.transform = 'translateY(0)'}\r\n            >\r\n              Yes, Hard Reset\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )}\r\n\r\n    {/* Modern Delete Confirmation Modal */}\r\n    {deleteModal.show && deleteModal.device && (\r\n      <div style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.6)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 1000,\r\n        backdropFilter: 'blur(4px)'\r\n      }}>\r\n        <div style={{\r\n          background: isDark ? '#2d2d2d' : 'white',\r\n          borderRadius: '16px',\r\n          padding: '2rem',\r\n          maxWidth: '500px',\r\n          width: '90%',\r\n          boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n          border: isDark ? '2px solid #7f1d1d' : '2px solid #7f1d1d',\r\n          animation: 'slideIn 0.2s ease-out'\r\n        }}>\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '1.5rem' }}>\r\n            <div style={{\r\n              width: '48px',\r\n              height: '48px',\r\n              borderRadius: '12px',\r\n              background: 'linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%)',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              fontSize: '1.5rem',\r\n              animation: 'pulse 2s infinite'\r\n            }}>\r\n              \r\n            </div>\r\n            <h3 style={{ fontSize: '1.5rem', fontWeight: '600', margin: 0, color: '#7f1d1d' }}>\r\n              Delete Device Permanently\r\n            </h3>\r\n          </div>\r\n          \r\n          <div style={{ marginBottom: '1.5rem', color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.6' }}>\r\n            <div style={{\r\n              background: isDark ? 'rgba(127, 29, 29, 0.1)' : '#fee2e2',\r\n              border: isDark ? '1px solid rgba(127, 29, 29, 0.3)' : '1px solid #fecaca',\r\n              borderRadius: '8px',\r\n              padding: '1rem',\r\n              marginBottom: '1rem',\r\n              color: isDark ? '#fca5a5' : '#991b1b'\r\n            }}>\r\n              <strong style={{ fontSize: '1.05rem' }}> PERMANENT DELETION</strong>\r\n              <p style={{ margin: '0.5rem 0 0 0', fontSize: '0.9rem' }}>\r\n                This action <strong>cannot be undone</strong>. All device data will be permanently deleted.\r\n              </p>\r\n            </div>\r\n            \r\n            <p style={{ marginBottom: '0.75rem' }}>\r\n              Device to delete: <strong style={{ color: isDark ? '#e0e0e0' : '#2c3e50' }}>{deleteModal.device.device_serial}</strong>\r\n            </p>\r\n            \r\n            <ul style={{ margin: '0.5rem 0', paddingLeft: '1.5rem', fontSize: '0.9rem' }}>\r\n              <li>All telemetry data will be lost</li>\r\n              <li>All command history will be deleted</li>\r\n              <li>Device must be re-provisioned to use again</li>\r\n            </ul>\r\n          </div>\r\n          \r\n          <div style={{ display: 'flex', gap: '0.75rem', justifyContent: 'flex-end' }}>\r\n            <button\r\n              onClick={() => setDeleteModal({ show: false, device: null })}\r\n              style={{\r\n                background: isDark ? '#3a3a3a' : '#e0e0e0',\r\n                color: isDark ? '#e0e0e0' : '#495057',\r\n                border: 'none',\r\n                padding: '0.75rem 1.5rem',\r\n                borderRadius: '8px',\r\n                fontSize: '0.95rem',\r\n                fontWeight: '600',\r\n                cursor: 'pointer',\r\n                transition: 'all 0.2s'\r\n              }}\r\n              onMouseOver={e => e.currentTarget.style.background = isDark ? '#4a4a4a' : '#d0d0d0'}\r\n              onMouseOut={e => e.currentTarget.style.background = isDark ? '#3a3a3a' : '#e0e0e0'}\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              onClick={confirmDelete}\r\n              style={{\r\n                background: 'linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%)',\r\n                color: 'white',\r\n                border: 'none',\r\n                padding: '0.75rem 1.5rem',\r\n                borderRadius: '8px',\r\n                fontSize: '0.95rem',\r\n                fontWeight: '600',\r\n                cursor: 'pointer',\r\n                boxShadow: '0 4px 12px rgba(127, 29, 29, 0.3)',\r\n                transition: 'all 0.2s'\r\n              }}\r\n              onMouseOver={e => e.currentTarget.style.transform = 'translateY(-1px)'}\r\n              onMouseOut={e => e.currentTarget.style.transform = 'translateY(0)'}\r\n            >\r\n              Yes, Delete Permanently\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )}\r\n\r\n    {/* Modern Success Notification Modal */}\r\n    {successModal.show && (\r\n      <div style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.4)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 1000,\r\n        backdropFilter: 'blur(2px)'\r\n      }}>\r\n        <div style={{\r\n          background: isDark ? '#2d2d2d' : 'white',\r\n          borderRadius: '16px',\r\n          padding: '2rem',\r\n          maxWidth: '450px',\r\n          width: '90%',\r\n          boxShadow: isDark ? '0 20px 60px rgba(0,0,0,0.6)' : '0 20px 60px rgba(0,0,0,0.3)',\r\n          border: isDark ? '1px solid #28a745' : '2px solid #28a745',\r\n          animation: 'slideIn 0.2s ease-out'\r\n        }}>\r\n          <div style={{ textAlign: 'center' }}>\r\n            <div style={{\r\n              width: '64px',\r\n              height: '64px',\r\n              borderRadius: '50%',\r\n              background: 'linear-gradient(135deg, #28a745 0%, #20c997 100%)',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              fontSize: '2rem',\r\n              margin: '0 auto 1rem',\r\n              animation: 'scaleIn 0.3s ease-out'\r\n            }}>\r\n              \r\n            </div>\r\n            \r\n            <h3 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1rem', color: isDark ? '#e0e0e0' : '#2c3e50' }}>\r\n              Command Queued\r\n            </h3>\r\n            \r\n            <p style={{ color: isDark ? '#b0b0b0' : '#495057', lineHeight: '1.6', marginBottom: '1.5rem' }}>\r\n              {successModal.message}\r\n            </p>\r\n            \r\n            <button\r\n              onClick={() => setSuccessModal({ show: false, message: '' })}\r\n              style={{\r\n                background: 'linear-gradient(135deg, #28a745 0%, #20c997 100%)',\r\n                color: 'white',\r\n                border: 'none',\r\n                padding: '0.75rem 2rem',\r\n                borderRadius: '8px',\r\n                fontSize: '0.95rem',\r\n                fontWeight: '600',\r\n                cursor: 'pointer',\r\n                boxShadow: '0 4px 12px rgba(40, 167, 69, 0.3)',\r\n                transition: 'all 0.2s'\r\n              }}\r\n              onMouseOver={e => e.currentTarget.style.transform = 'translateY(-1px)'}\r\n              onMouseOut={e => e.currentTarget.style.transform = 'translateY(0)'}\r\n            >\r\n              Got it!\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Devices;"],"names":["useDebouncedCallback","callback","delay","arguments","length","undefined","timeoutId","setTimeoutId","useState","debouncedCallback","useCallback","_len","args","Array","_key","clearTimeout","newTimeoutId","setTimeout","useEffect","TABS","id","label","icon","ForecastTooltip","_ref","active","payload","isDark","useTheme","_jsxs","style","background","backdropFilter","border","concat","borderRadius","padding","boxShadow","minWidth","children","_jsx","fontFamily","fontWeight","color","fontSize","marginBottom","borderBottom","paddingBottom","display","flexDirection","gap","map","entry","_entry$name","_entry$name2","_entry$name3","unit","name","includes","alignItems","justifyContent","width","height","stroke","fill","flexShrink","split","Number","value","toFixed","fmt","ts","range","d","Date","toLocaleTimeString","hour","minute","toLocaleDateString","weekday","month","day","_unused","IconSun","viewBox","strokeWidth","strokeLinecap","strokeLinejoin","cx","cy","r","x1","y1","x2","y2","IconBattery","x","y","rx","IconLoad","points","IconEnergy","IconCloud","IconGrid","IconThermometer","KpiCard","_ref2","sub","accent","badge","className","flex","textTransform","letterSpacing","margin","lineHeight","marginLeft","marginTop","WeatherHourlyStrip","_ref3","hourly","overflowX","paddingTop","h","i","_h$cloud_cover_pct","_h$ghi_wm","_h$temperature_c","_h$wind_speed_ms","time","forecast_for","_unused2","cloud","cloud_cover_pct","ghi","ghi_wm2","temp","temperature_c","wind","wind_speed_ms","humidity","humidity_pct","ghiPct","Math","min","humPct","isNow","wi","ghiColor","humColor","position","top","title","round","overflow","_Fragment","EnergyBreakdownRow","_ref4","latest","items","pv_today_kwh","bg","grid_buy_today_kwh","grid_sell_today_kwh","batt_charge_today_kwh","batt_discharge_today_kwh","load_today_kwh","filter","e","flexWrap","alignSelf","opacity","InsightsRow","_ref5","_latest$pv_today_kwh","_latest$load_today_kw","_latest$grid_buy_toda","pvKwh","loadKwh","gridBuy","co2Kg","selfSufPct","max","gridDepPct","push","item","REGIME_STYLE","night","ramp","midday","ForecastXAxisTick","_ref6","_payload$value","_val$split$","_val$split$2","_idx","_ref7","visibleData","forecastWindow","fw","val","idx","findIndex","timeLabel","dateLabel","isFirstOfDay","rawDate","transform","dy","textAnchor","ForecastTable","_ref8","data","theadBg","rowBorder","maxHeight","overflowY","borderCollapse","zIndex","textAlign","row","_REGIME_STYLE$row$reg","_row$timeLabel","_row$p10$toFixed","_row$p","_row$p50$toFixed","_row$p2","_row$p90$toFixed","_row$p3","_row$physics$toFixed","_row$physics","_row$ghi$toFixed","_row$ghi","rc","regime","marginRight","p10","p50","p90","fontStyle","physics","_ref9","_latest$pv1_power_w","_latest$pv2_power_w","_latest$battery_soc_p","_latest$load_power_w","_latest$pv_today_kwh2","_latest$grid_power_w","_latest$battery_power","_latest$inverter_temp","_latest$battery_volta","_latest$grid_frequenc","siteId","autoRefresh","telemetry","setTelemetry","forecast","setForecast","weather","setWeather","loading","setLoading","error","setError","lastUpdated","setLastUpdated","activeTab","setActiveTab","showBands","setShowBands","P10","P50","P90","dateRange","setDateRange","customStartDate","setCustomStartDate","customEndDate","setCustomEndDate","forecastView","setForecastView","setForecastWindow","refAreaLeft","setRefAreaLeft","refAreaRight","setRefAreaRight","isSelecting","setIsSelecting","zoomStart","setZoomStart","zoomEnd","setZoomEnd","tooltipStyle","fetchAll","async","now","forecastStart","toISOString","forecastEnd","getTime","telemetryParams","start_date","end_date","days","historyParams","sevenDaysAgo","customStart","customEnd","results","Promise","all","apiService","getSiteTelemetry","getSiteForecast","getSiteWeather","getSiteHistory","resolve","tel","fcst","wth","hist","merged","isArray","tsSet","Set","timestamp","has","sort","a","b","localeCompare","err","Error","message","setInterval","clearInterval","pvKw","pv1_power_w","pv2_power_w","batSoc","battery_soc_percent","loadKw","load_power_w","todayKwh","gridKw","grid_power_w","batPowerKw","battery_power_w","invTemp","inverter_temp_c","batVoltage","battery_voltage_v","runState","run_state","gridImporting","gridExporting","batCharging","runStateBadge","invTempColor","historyData","_","isDay","buckets","Map","forEach","key","getFullYear","getMonth","getDate","getHours","set","get","from","values","bucket","avg","field","reduce","s","_r$field","first","_r$pv_today_kwh","aggregateByPeriod","_row$pv1_power_w","_row$pv2_power_w","_row$load_power_w","_row$grid_power_w","_row$battery_soc_perc","forecastWindowDays","forecastCutoff","forecastFiltered","clean","replace","forecastData","_row$regime","p50_kw","p10_kw","p90_kw","physics_baseline_kw","ghi_input_wm2","zoomedForecastData","useMemo","li","ri","slice","forecastTickObjects","N","forecastTickValues","fcastP10","fcastP50","fcastP90","forecastGeneratedAt","generated_at","abs","todayStr","todayForecast","substring","todayFcastP50","achievedPct","cardBg","headerGrad","toggleBg","toggleActive","borderClr","noData","onChange","target","cursor","type","onClick","tab","isActive","transition","grid_voltage_v","grid_frequency_hz","current","p","hourly_forecast","ResponsiveContainer","AreaChart","right","left","bottom","offset","stopColor","stopOpacity","CartesianGrid","strokeDasharray","XAxis","dataKey","interval","ceil","angle","tick","YAxis","yAxisId","tickFormatter","v","orientation","domain","Tooltip","contentStyle","formatter","String","Legend","iconType","iconSize","wrapperStyle","Area","dot","Line","desc","_objectSpread","el","document","getElementById","canvas","html2canvas","scale","createElement","download","href","toDataURL","click","onMouseOver","currentTarget","onMouseOut","keys","Object","csv","join","k","_k","JSON","stringify","blob","Blob","url","URL","createObjectURL","body","appendChild","removeChild","revokeObjectURL","userSelect","onMouseDown","activeLabel","onMouseMove","onMouseUp","vertical","tickLine","axisLine","allowDataOverflow","ticks","props","content","animationDuration","pointerEvents","verticalAlign","activeDot","ReferenceLine","n","t","dateL","ReferenceArea","fillOpacity","strokeOpacity","Devices","_users$find3","_users$find4","searchParams","useSearchParams","devices","setDevices","filteredDevices","setFilteredDevices","editingDevice","setEditingDevice","creatingDevice","setCreatingDevice","searchTerm","setSearchTerm","userSearchTerm","setUserSearchTerm","filteredUsers","setFilteredUsers","showUserDropdown","setShowUserDropdown","users","setUsers","selectedDevices","setSelectedDevices","bulkDeleteLoading","setBulkDeleteLoading","currentPage","setCurrentPage","pageSize","setPageSize","totalCount","setTotalCount","totalPages","setTotalPages","presets","setPresets","presetsLoading","setPresetsLoading","health","setHealth","telemetrySummary","setTelemetrySummary","telemetryData","setTelemetryData","dashboardError","setDashboardError","selectedDevice","setSelectedDevice","deviceLogs","setDeviceLogs","logsLoading","setLogsLoading","editForm","setEditForm","device_serial","user","config_version","createForm","setCreateForm","siteDetails","setSiteDetails","siteLoading","setSiteLoading","editingSite","setEditingSite","siteForm","setSiteForm","site_id","display_name","latitude","longitude","capacity_kw","tilt_deg","azimuth_deg","timezone","is_active","siteSaving","setSiteSaving","siteError","setSiteError","devicePreset","setDevicePreset","rebootModal","setRebootModal","show","device","hardResetModal","setHardResetModal","deleteModal","setDeleteModal","successModal","setSuccessModal","fetchDevices","page","search","response","getDevices","count","total_pages","current_page","fetchDeviceLogs","getDeviceLogs","deviceId","logs","console","handleViewDevice","preset","find","config_id","getDeviceSite","then","catch","finally","customers","getUsers","is_staff","is_superuser","fetchUsers","getPresets","fetchPresets","healthData","getSystemHealth","getTelemetry","telemetryArray","currentLatest","itemDate","isNaN","deviceCount","size","totalPoints","latestTimestamp","fetchDashboardData","deviceIdParam","parseInt","foundDevice","handleClickOutside","addEventListener","removeEventListener","trim","searchLower","toLowerCase","filtered","fullName","first_name","last_name","username","email","debouncedSearch","query","handleEdit","_users$find","_users$find2","u","handleSave","updateDevice","handleCreate","createDevice","confirmReboot","rebootDevice","confirmHardReset","hardResetDevice","confirmDelete","deleteDevice","handleCancel","handleBackToList","getPresetConfigId","_preset$gateway_confi","_preset$gateway_confi2","gateway_configuration","general_settings","_devicePreset$gateway","_devicePreset$gateway2","deviceTelemetry","latestTelemetry","log","handleReboot","backgroundColor","handleHardReset","handleDeleteDevice","gridTemplateColumns","is_online","last_heartbeat","toLocaleString","hw_id","model","gridColumn","pending_config_update","slaves_count","config_ack_ver","version","last_updated","config_acked_at","ackTime","diffMs","diffMins","floor","diffHours","diffDays","config_downloaded_at","provisioned_at","created_by_username","checked","logs_enabled","enabled","toggleDeviceLogs","handleToggleLogs","overall_health","active_devices","total_devices","total_telemetry_points","data_type","SiteDataPanel","disabled","level","onSubmit","preventDefault","parseFloat","updated","updateDeviceSite","createDeviceSite","required","placeholder","autoComplete","step","stopPropagation","onFocus","onMouseEnter","onMouseLeave","AuditTrail","createdBy","createdAt","created_at","updatedBy","updated_by_username","updatedAt","updated_at","maxWidth","animation","paddingLeft","deviceList","Boolean","confirmMessage","window","confirm","deleteDevicesBulk","updatedDevices","handleSelectAll","allIds","newSelected","delete","add","handleSelectDevice","date","handleDelete","borderTop","pages","_pages"],"sourceRoot":""}