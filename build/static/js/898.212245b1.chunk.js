"use strict";(self.webpackChunksmart_solar_frontend=self.webpackChunksmart_solar_frontend||[]).push([[898],{9550(e,s,t){t.d(s,{A:()=>n});var a=t(5043),l=t(579);const r=e=>{let{createdBy:s,createdAt:t,updatedBy:a,updatedAt:r,className:n="audit-trail"}=e;const i=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleString()}catch(s){return e}};return(0,l.jsxs)("div",{className:n,children:[(0,l.jsxs)("div",{className:"audit-row",children:[(0,l.jsx)("span",{className:"audit-label",children:"Created:"}),s?(0,l.jsxs)("span",{className:"audit-value",children:["by ",(0,l.jsx)("strong",{children:s})," on ",i(t)]}):(0,l.jsx)("span",{className:"audit-value",children:"System"})]}),a&&(0,l.jsxs)("div",{className:"audit-row",children:[(0,l.jsx)("span",{className:"audit-label",children:"Last Updated:"}),(0,l.jsxs)("span",{className:"audit-value",children:["by ",(0,l.jsx)("strong",{children:a})," on ",i(r)]})]})]})},n=a.memo(r)},898(e,s,t){t.r(s),t.d(s,{default:()=>o});var a=t(9379),l=t(5043),r=t(5560),n=t(9550),i=t(579);const o=()=>{const[e,s]=(0,l.useState)([]),[t,o]=(0,l.useState)([]),[d,c]=(0,l.useState)(!0),[m,u]=(0,l.useState)(null),[h,x]=(0,l.useState)({show:!1,employee:null}),[p,j]=(0,l.useState)(null),[y,f]=(0,l.useState)(!1),[g,b]=(0,l.useState)(""),[v,N]=(0,l.useState)({first_name:"",last_name:"",email:"",mobile_number:"",address:""}),[A,_]=(0,l.useState)({username:"",email:"",password:"",first_name:"",last_name:"",mobile_number:"",address:"",is_staff:!0});(0,l.useEffect)(()=>{S()},[]);const[w,C]=(0,l.useState)("");(0,l.useEffect)(()=>{const e=setTimeout(()=>{C(g)},300);return()=>clearTimeout(e)},[g]),(0,l.useEffect)(()=>{S(w)},[w]);const S=async e=>{try{const t=(await r.K.getUsers(e)).filter(e=>e.is_staff&&!e.is_superuser);s(t),o(t),c(!1)}catch(t){u(t instanceof Error?t.message:"An error occurred"),c(!1)}};return d?(0,i.jsx)("div",{className:"loading",children:"Loading employees..."}):m?(0,i.jsxs)("div",{className:"error",children:["Error: ",m]}):(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{children:"Employee Management"}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsxs)("h2",{children:["Employees (",t.length,")"]}),(0,i.jsxs)("div",{className:"card-actions",children:[(0,i.jsx)("input",{type:"text",placeholder:"Search employees...",value:g,onChange:e=>{b(e.target.value)},className:"search-input"}),(0,i.jsx)("button",{onClick:()=>f(!0),className:"btn",children:"Add New Employee"})]})]}),(0,i.jsxs)("table",{className:"table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{textAlign:"center"},children:"Name"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Username"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Email"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Mobile"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Joined"}),(0,i.jsx)("th",{style:{textAlign:"center"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:t.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{style:{textAlign:"center"},children:[e.first_name," ",e.last_name]}),(0,i.jsx)("td",{style:{textAlign:"center"},children:e.username}),(0,i.jsx)("td",{style:{textAlign:"center"},children:e.email}),(0,i.jsx)("td",{style:{textAlign:"center"},children:e.mobile_number||"-"}),(0,i.jsx)("td",{style:{textAlign:"center"},children:(()=>{if(!e.date_joined)return"N/A";const s=new Date(e.date_joined);return isNaN(s.getTime())?"Invalid Date":s.toLocaleDateString()})()}),(0,i.jsxs)("td",{style:{textAlign:"center"},children:[(0,i.jsx)("button",{onClick:()=>(e=>{j(e),N({first_name:e.first_name,last_name:e.last_name,email:e.email,mobile_number:e.mobile_number||"",address:e.address||""})})(e),style:{background:"none",border:"none",cursor:"pointer",color:"#6366f1",margin:"0 6px"},title:"Edit",children:(0,i.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,i.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,i.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),(0,i.jsx)("button",{onClick:()=>(e=>{x({show:!0,employee:e})})(e),style:{background:"none",border:"none",cursor:"pointer",color:"#ef4444",margin:"0 6px"},title:"Delete",children:(0,i.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,i.jsx)("polyline",{points:"3,6 5,6 21,6"}),(0,i.jsx)("path",{d:"M19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2"}),(0,i.jsx)("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),(0,i.jsx)("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})})]})]},e.id))})]})]}),(p||y)&&(0,i.jsx)("div",{className:"modal",children:(0,i.jsxs)("div",{className:"modal-content",children:[(0,i.jsx)("h3",{children:p?"Edit Employee: ".concat(p.username):"Add New Employee"}),(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),p?(async()=>{if(p)try{await r.K.updateUser(p.id,v),j(null),await S(g)}catch(e){u(e instanceof Error?e.message:"Failed to update employee")}})():(async()=>{try{await r.K.createEmployee(A),f(!1),_({username:"",email:"",password:"",first_name:"",last_name:"",mobile_number:"",address:"",is_staff:!0}),await S(g)}catch(e){u(e instanceof Error?e.message:"Failed to create employee")}})()},children:[(0,i.jsxs)("div",{className:"modal-body",children:[(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsx)("h4",{className:"form-section-title",children:"Account Information"}),(0,i.jsxs)("div",{className:"form-grid",children:[y&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{type:"text",autoComplete:"username",style:{display:"none"}}),(0,i.jsx)("input",{type:"password",autoComplete:"current-password",style:{display:"none"}}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Username"}),(0,i.jsx)("input",{type:"text",value:A.username,onChange:e=>_((0,a.A)((0,a.A)({},A),{},{username:e.target.value})),required:!0,autoComplete:"off",placeholder:"jdoe"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Password"}),(0,i.jsx)("input",{type:"password",value:A.password,onChange:e=>_((0,a.A)((0,a.A)({},A),{},{password:e.target.value})),required:!0,autoComplete:"new-password",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Email Address"}),(0,i.jsx)("input",{type:"email",value:p?v.email:A.email,onChange:e=>p?N((0,a.A)((0,a.A)({},v),{},{email:e.target.value})):_((0,a.A)((0,a.A)({},A),{},{email:e.target.value})),required:!0,autoComplete:"off",placeholder:"john.doe@example.com"})]})]})]}),(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsx)("h4",{className:"form-section-title",children:"Personal Details"}),(0,i.jsxs)("div",{className:"form-grid form-grid-2",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"First Name"}),(0,i.jsx)("input",{type:"text",value:p?v.first_name:A.first_name,onChange:e=>p?N((0,a.A)((0,a.A)({},v),{},{first_name:e.target.value})):_((0,a.A)((0,a.A)({},A),{},{first_name:e.target.value})),required:!0,autoComplete:"off",placeholder:"John"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Last Name"}),(0,i.jsx)("input",{type:"text",value:p?v.last_name:A.last_name,onChange:e=>p?N((0,a.A)((0,a.A)({},v),{},{last_name:e.target.value})):_((0,a.A)((0,a.A)({},A),{},{last_name:e.target.value})),required:!0,autoComplete:"off",placeholder:"Doe"})]})]})]}),(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsx)("h4",{className:"form-section-title",children:"Contact Information"}),(0,i.jsxs)("div",{className:"form-grid",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Mobile Number"}),(0,i.jsx)("input",{type:"tel",value:p?v.mobile_number:A.mobile_number,onChange:e=>p?N((0,a.A)((0,a.A)({},v),{},{mobile_number:e.target.value})):_((0,a.A)((0,a.A)({},A),{},{mobile_number:e.target.value})),autoComplete:"off",placeholder:"+1 (555) 000-0000"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Address"}),(0,i.jsx)("textarea",{value:p?v.address:A.address,onChange:e=>p?N((0,a.A)((0,a.A)({},v),{},{address:e.target.value})):_((0,a.A)((0,a.A)({},A),{},{address:e.target.value})),autoComplete:"off",rows:3,placeholder:"123 Solar Street..."})]})]})]})]}),p&&(0,i.jsx)(n.A,{createdBy:p.created_by_username,createdAt:p.created_at,updatedBy:p.updated_by_username,updatedAt:p.updated_at}),(0,i.jsxs)("div",{className:"form-actions",children:[(0,i.jsx)("button",{type:"submit",className:"btn",children:p?"Save":"Create"}),(0,i.jsx)("button",{type:"button",onClick:()=>{j(null),f(!1)},className:"btn btn-secondary",children:"Cancel"})]})]})]})}),h.show&&h.employee&&(0,i.jsx)("div",{className:"modal",children:(0,i.jsxs)("div",{className:"modal-content",style:{maxWidth:"450px"},children:[(0,i.jsx)("h3",{style:{color:"#dc3545",marginBottom:"1rem"},children:"\u26a0\ufe0f Delete Employee"}),(0,i.jsxs)("p",{children:["Are you sure you want to permanently delete"," ",(0,i.jsx)("strong",{children:h.employee.username}),"?"]}),(0,i.jsx)("p",{style:{fontSize:"0.9rem",color:"#6c757d",marginTop:"0.5rem"},children:"This action cannot be undone."}),(0,i.jsxs)("div",{className:"form-actions",style:{marginTop:"1.5rem"},children:[(0,i.jsx)("button",{onClick:async()=>{if(h.employee)try{await r.K.deleteUser(h.employee.id),s(e.filter(e=>e.id!==h.employee.id)),o(t.filter(e=>e.id!==h.employee.id)),x({show:!1,employee:null})}catch(a){x({show:!1,employee:null}),u(a instanceof Error?a.message:"Failed to delete employee")}},className:"btn",style:{background:"#dc3545",borderColor:"#dc3545"},children:"Delete"}),(0,i.jsx)("button",{type:"button",onClick:()=>x({show:!1,employee:null}),className:"btn btn-secondary",children:"Cancel"})]})]})})]})}}}]);
//# sourceMappingURL=898.212245b1.chunk.js.map