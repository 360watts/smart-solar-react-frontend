{"version":3,"file":"static/js/966.0b62ccb5.chunk.js","mappings":"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","sources":["services/cacheService.ts","services/api.ts","components/OTAManagement.tsx"],"sourcesContent":["/**\r\n * Simple in-memory cache service for API responses\r\n * Reduces unnecessary API calls and speeds up page loads\r\n */\r\n\r\ninterface CacheEntry {\r\n  data: any;\r\n  timestamp: number;\r\n  expiresIn: number; // milliseconds\r\n}\r\n\r\nclass CacheService {\r\n  private cache: Map<string, CacheEntry> = new Map();\r\n  private static readonly DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes default\r\n  private static readonly LONG_TTL = 30 * 60 * 1000; // 30 minutes for static data\r\n\r\n  /**\r\n   * Set a cache entry\r\n   */\r\n  set(key: string, data: any, ttlMs: number = CacheService.DEFAULT_TTL): void {\r\n    this.cache.set(key, {\r\n      data,\r\n      timestamp: Date.now(),\r\n      expiresIn: ttlMs,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get a cache entry if valid\r\n   */\r\n  get(key: string): any | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    // Check if expired\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return entry.data;\r\n  }\r\n\r\n  /**\r\n   * Check if key exists and is not expired\r\n   */\r\n  has(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return false;\r\n\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Clear a specific cache entry\r\n   */\r\n  clear(key: string): void {\r\n    this.cache.delete(key);\r\n  }\r\n\r\n  /**\r\n   * Clear all cache entries\r\n   */\r\n  clearAll(): void {\r\n    this.cache.clear();\r\n  }\r\n\r\n  /**\r\n   * Get cache size\r\n   */\r\n  size(): number {\r\n    return this.cache.size;\r\n  }\r\n\r\n  /**\r\n   * Get TTL constants\r\n   */\r\n  static getTTL(type: 'short' | 'long' = 'short'): number {\r\n    return type === 'long' ? CacheService.LONG_TTL : CacheService.DEFAULT_TTL;\r\n  }\r\n}\r\n\r\nexport const cacheService = new CacheService();\r\nexport const DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes\r\nexport const LONG_TTL = 30 * 60 * 1000; // 30 minutes\r\n","import { cacheService, DEFAULT_TTL } from './cacheService';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'http://localhost:8000/api';\r\n\r\nclass ApiService {\r\n  private getAuthHeaders(): HeadersInit {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (tokens) {\r\n      try {\r\n        const parsedTokens = JSON.parse(tokens);\r\n        return {\r\n          'Authorization': `Bearer ${parsedTokens.access}`,\r\n          'Content-Type': 'application/json',\r\n        };\r\n      } catch (error) {\r\n        console.error('Error parsing auth tokens:', error);\r\n      }\r\n    }\r\n    return {\r\n      'Content-Type': 'application/json',\r\n    };\r\n  }\r\n\r\n  private async request(endpoint: string, options: RequestInit = {}): Promise<any> {\r\n    const url = `${API_BASE_URL}${endpoint}`;\r\n    let headers = this.getAuthHeaders();\r\n\r\n    let response = await fetch(url, {\r\n      ...options,\r\n      headers: {\r\n        ...headers,\r\n        ...options.headers,\r\n      },\r\n    });\r\n\r\n    if (response.status === 401) {\r\n      // Try to refresh token\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        // Retry with new token\r\n        headers = this.getAuthHeaders();\r\n        response = await fetch(url, {\r\n          ...options,\r\n          headers: {\r\n            ...headers,\r\n            ...options.headers,\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      // Token refresh failed or not attempted, logout\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`API request failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  private async refreshToken(): Promise<boolean> {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (!tokens) return false;\r\n\r\n    try {\r\n      const parsedTokens = JSON.parse(tokens);\r\n      const response = await fetch(`${API_BASE_URL}/auth/token/refresh/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ refresh: parsedTokens.refresh }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        const newTokens = {\r\n          access: data.access,\r\n          refresh: parsedTokens.refresh, // Keep the same refresh token\r\n        };\r\n        localStorage.setItem('authTokens', JSON.stringify(newTokens));\r\n        return true;\r\n      }\r\n    } catch (error) {\r\n      console.error('Token refresh failed:', error);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  // Generic HTTP methods\r\n  async get(endpoint: string): Promise<any> {\r\n    const response = await this.request(endpoint, {\r\n      method: 'GET',\r\n    });\r\n    return response;\r\n  }\r\n\r\n  async post(endpoint: string, data?: any, options: RequestInit = {}): Promise<any> {\r\n    const requestOptions: RequestInit = {\r\n      method: 'POST',\r\n      ...options,\r\n    };\r\n\r\n    if (data && !(data instanceof FormData)) {\r\n      requestOptions.body = JSON.stringify(data);\r\n    } else if (data instanceof FormData) {\r\n      requestOptions.body = data;\r\n      // Remove Content-Type header for FormData to let browser set it with boundary\r\n      const headers = { ...this.getAuthHeaders() };\r\n      delete (headers as any)['Content-Type'];\r\n      requestOptions.headers = {\r\n        ...headers,\r\n        ...options.headers,\r\n      };\r\n    }\r\n\r\n    return this.request(endpoint, requestOptions);\r\n  }\r\n\r\n  async put(endpoint: string, data?: any): Promise<any> {\r\n    return this.request(endpoint, {\r\n      method: 'PUT',\r\n      body: data ? JSON.stringify(data) : undefined,\r\n    });\r\n  }\r\n\r\n  async delete(endpoint: string): Promise<any> {\r\n    return this.request(endpoint, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getConfiguration(): Promise<any> {\r\n    return this.request('/config/');\r\n  }\r\n\r\n  async getTelemetry(): Promise<any[]> {\r\n    return this.request('/telemetry/');\r\n  }\r\n\r\n  async provisionDevice(data: any): Promise<any> {\r\n    const response = await fetch(`${API_BASE_URL}/devices/provision`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n    if (!response.ok) {\r\n      throw new Error(`Provisioning failed: ${response.statusText}`);\r\n    }\r\n    return response.json();\r\n  }\r\n\r\n  async getAlerts(): Promise<any[]> {\r\n    const cacheKey = 'alerts';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/alerts/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getSystemHealth(): Promise<any> {\r\n    const cacheKey = 'system_health';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/health/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getKPIs(): Promise<any> {\r\n    const cacheKey = 'kpis';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/kpis/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getUsers(search?: string): Promise<any[]> {\r\n    const cacheKey = `users_${search || 'all'}`;\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    const data = await this.request(`/users/${params}`);\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async createUser(userData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(userData),\r\n    });\r\n    // Invalidate users cache\r\n    cacheService.clear('users_all');\r\n    cacheService.clearAll(); // Clear all cache for safety\r\n    return result;\r\n  }\r\n\r\n  async createEmployee(employeeData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ ...employeeData, is_staff: true }),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async getUserDevices(userId: number): Promise<any[]> {\r\n    return this.request(`/users/${userId}/devices/`);\r\n  }\r\n\r\n  async updateUser(userId: number, data: any): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async deleteUser(userId: number): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  // Profile Management (for current logged-in user)\r\n  async getProfile(): Promise<any> {\r\n    return this.request('/profile/');\r\n  }\r\n\r\n  async updateProfile(data: any): Promise<any> {\r\n    return this.request('/profile/update/', {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async changePassword(data: { current_password: string; new_password: string }): Promise<any> {\r\n    return this.request('/profile/change-password/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // Customer Management (separate from staff users/employees)\r\n  async getCustomers(search?: string): Promise<any[]> {\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    return this.request(`/customers/${params}`);\r\n  }\r\n\r\n  async createCustomer(customerData: any): Promise<any> {\r\n    return this.request('/customers/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(customerData),\r\n    });\r\n  }\r\n\r\n  async getCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/`);\r\n  }\r\n\r\n  async updateCustomer(customerId: number, data: any): Promise<any> {\r\n    return this.request(`/customers/${customerId}/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getPresets(): Promise<any[]> {\r\n    const cacheKey = 'presets';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/presets/');\r\n    // Use longer TTL for presets as they change less frequently\r\n    cacheService.set(cacheKey, data, 30 * 60 * 1000); // 30 minutes\r\n    return data;\r\n  }\r\n\r\n  async createPreset(data: any): Promise<any> {\r\n    const result = await this.request('/presets/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async updatePreset(id: number, data: any): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async deletePreset(id: number): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async getDevices(search?: string, page: number = 1, pageSize: number = 25): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    if (search) params.append('search', search);\r\n    params.append('page', page.toString());\r\n    params.append('page_size', pageSize.toString());\r\n    \r\n    const queryString = params.toString();\r\n    return this.request(`/devices/?${queryString}`);\r\n  }\r\n\r\n  async createDevice(deviceData: any): Promise<any> {\r\n    return this.request('/devices/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(deviceData),\r\n    });\r\n  }\r\n\r\n  async updateDevice(deviceId: number, data: any): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async deleteDevicesBulk(deviceIds: number[]): Promise<any> {\r\n    return this.request(`/devices/delete-bulk/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ device_ids: deviceIds }),\r\n    });\r\n  }\r\n\r\n  async getSlaves(configId: string): Promise<any[]> {\r\n    return this.request(`/presets/${configId}/slaves/`);\r\n  }\r\n\r\n  async createSlave(configId: string, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/create/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateSlave(configId: string, slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteSlave(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n}\r\n\r\nexport const apiService = new ApiService();","import React, { useState, useEffect } from 'react';\r\nimport { apiService } from '../services/api';\r\n\r\ninterface Device {\r\n  id: number;\r\n  device_serial: string;\r\n  customer?: string;\r\n  status: string;\r\n  firmware_version?: string;\r\n}\r\n\r\ninterface OTAUpdate {\r\n  id: number;\r\n  name: string;\r\n  description: string;\r\n  version: string;\r\n  file_size: number;\r\n  status: string;\r\n  target_type: string;\r\n  scheduled_at?: string;\r\n  created_at: string;\r\n  created_by_username?: string;\r\n  total_devices: number;\r\n  successful_updates: number;\r\n  failed_updates: number;\r\n  pending_updates: number;\r\n  progress_percentage: number;\r\n}\r\n\r\ninterface DeviceOTAStatus {\r\n  id: number;\r\n  device: Device;\r\n  status: string;\r\n  progress_percentage: number;\r\n  error_message?: string;\r\n  started_at?: string;\r\n  completed_at?: string;\r\n}\r\n\r\nconst OTAManagement: React.FC = () => {\r\n  const [otaUpdates, setOtaUpdates] = useState<OTAUpdate[]>([]);\r\n  const [devices, setDevices] = useState<Device[]>([]);\r\n  const [selectedUpdate, setSelectedUpdate] = useState<OTAUpdate | null>(null);\r\n  const [deviceStatuses, setDeviceStatuses] = useState<DeviceOTAStatus[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [createLoading, setCreateLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [showCreateForm, setShowCreateForm] = useState(false);\r\n  const [selectedDevices, setSelectedDevices] = useState<Set<number>>(new Set());\r\n  \r\n  const [createForm, setCreateForm] = useState({\r\n    name: '',\r\n    description: '',\r\n    version: '',\r\n    target_type: 'individual' as 'individual' | 'group' | 'all',\r\n    firmware_file: null as File | null,\r\n    scheduled_at: ''\r\n  });\r\n\r\n  useEffect(() => {\r\n    fetchOTAUpdates();\r\n    fetchDevices();\r\n  }, []);\r\n\r\n  const fetchOTAUpdates = async () => {\r\n    try {\r\n      const response = await apiService.get('/ota/updates/');\r\n      setOtaUpdates(response.data.ota_updates || []);\r\n      setError(null);\r\n    } catch (err: any) {\r\n      console.error('Error fetching OTA updates:', err);\r\n      setError(err.response?.data?.message || 'Failed to fetch OTA updates');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchDevices = async () => {\r\n    try {\r\n      const response = await apiService.get('/devices/');\r\n      setDevices(response.data.results || []);\r\n    } catch (err: any) {\r\n      console.error('Error fetching devices:', err);\r\n    }\r\n  };\r\n\r\n  const fetchUpdateDetail = async (updateId: number) => {\r\n    try {\r\n      const response = await apiService.get(`/ota/updates/${updateId}/`);\r\n      setDeviceStatuses(response.data.device_statuses || []);\r\n    } catch (err: any) {\r\n      console.error('Error fetching update detail:', err);\r\n    }\r\n  };\r\n\r\n  const handleCreateOTAUpdate = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!createForm.firmware_file) {\r\n      setError('Please select a firmware file');\r\n      return;\r\n    }\r\n\r\n    if (createForm.firmware_file.size > 1024 * 1024) { // 1MB limit\r\n      setError('Firmware file cannot exceed 1MB');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setCreateLoading(true);\r\n      \r\n      const formData = new FormData();\r\n      formData.append('name', createForm.name);\r\n      formData.append('description', createForm.description);\r\n      formData.append('version', createForm.version);\r\n      formData.append('target_type', createForm.target_type);\r\n      formData.append('firmware_file', createForm.firmware_file);\r\n      \r\n      if (createForm.scheduled_at) {\r\n        formData.append('scheduled_at', createForm.scheduled_at);\r\n      }\r\n      \r\n      // Add target devices if individual targeting\r\n      if (createForm.target_type === 'individual') {\r\n        Array.from(selectedDevices).forEach(deviceId => {\r\n          formData.append('target_devices', deviceId.toString());\r\n        });\r\n      }\r\n\r\n      await apiService.post('/ota/updates/', formData, {\r\n        headers: {\r\n          'Content-Type': 'multipart/form-data',\r\n        },\r\n      });\r\n\r\n      // Reset form and refresh data\r\n      setCreateForm({\r\n        name: '',\r\n        description: '',\r\n        version: '',\r\n        target_type: 'individual',\r\n        firmware_file: null,\r\n        scheduled_at: ''\r\n      });\r\n      setSelectedDevices(new Set());\r\n      setShowCreateForm(false);\r\n      setError(null);\r\n      fetchOTAUpdates();\r\n      \r\n      alert('OTA update created successfully!');\r\n    } catch (err: any) {\r\n      console.error('Error creating OTA update:', err);\r\n      setError(err.response?.data?.message || 'Failed to create OTA update');\r\n    } finally {\r\n      setCreateLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0] || null;\r\n    if (file && file.size > 1024 * 1024) {\r\n      setError('File size cannot exceed 1MB');\r\n      e.target.value = '';\r\n      return;\r\n    }\r\n    setCreateForm({ ...createForm, firmware_file: file });\r\n    setError(null);\r\n  };\r\n\r\n  const formatFileSize = (bytes: number): string => {\r\n    const kb = bytes / 1024;\r\n    if (kb < 1024) return `${kb.toFixed(1)} KB`;\r\n    return `${(kb / 1024).toFixed(1)} MB`;\r\n  };\r\n\r\n  const getStatusColor = (status: string): string => {\r\n    switch (status.toLowerCase()) {\r\n      case 'active': return 'text-blue-600 bg-blue-100';\r\n      case 'completed': return 'text-green-600 bg-green-100';\r\n      case 'failed': return 'text-red-600 bg-red-100';\r\n      case 'cancelled': return 'text-gray-600 bg-gray-100';\r\n      case 'draft': return 'text-yellow-600 bg-yellow-100';\r\n      case 'success': return 'text-green-600 bg-green-100';\r\n      case 'pending': return 'text-yellow-600 bg-yellow-100';\r\n      case 'downloading': return 'text-blue-600 bg-blue-100';\r\n      case 'installing': return 'text-purple-600 bg-purple-100';\r\n      default: return 'text-gray-600 bg-gray-100';\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mx-auto px-4 py-6\">\r\n      <div className=\"flex justify-between items-center mb-6\">\r\n        <h1 className=\"text-3xl font-bold text-gray-900\">OTA Management</h1>\r\n        <button\r\n          onClick={() => setShowCreateForm(true)}\r\n          className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700\"\r\n        >\r\n          Create OTA Update\r\n        </button>\r\n      </div>\r\n\r\n      {error && (\r\n        <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      {/* OTA Updates List */}\r\n      <div className=\"bg-white rounded-lg shadow overflow-hidden\">\r\n        <div className=\"px-6 py-4 border-b border-gray-200\">\r\n          <h2 className=\"text-lg font-semibold\">OTA Updates</h2>\r\n        </div>\r\n        \r\n        {otaUpdates.length > 0 ? (\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"w-full\">\r\n              <thead className=\"bg-gray-50\">\r\n                <tr>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Name & Version\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Status\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Target Type\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Progress\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    File Size\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Created\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Actions\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"divide-y divide-gray-200\">\r\n                {otaUpdates.map((update) => (\r\n                  <tr key={update.id} className=\"hover:bg-gray-50\">\r\n                    <td className=\"px-6 py-4\">\r\n                      <div>\r\n                        <div className=\"text-sm font-medium text-gray-900\">{update.name}</div>\r\n                        <div className=\"text-sm text-gray-500\">v{update.version}</div>\r\n                        {update.description && (\r\n                          <div className=\"text-xs text-gray-400 mt-1\">{update.description}</div>\r\n                        )}\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"px-6 py-4\">\r\n                      <span className={`px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(update.status)}`}>\r\n                        {update.status}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"px-6 py-4\">\r\n                      <span className=\"text-sm text-gray-900 capitalize\">{update.target_type}</span>\r\n                    </td>\r\n                    <td className=\"px-6 py-4\">\r\n                      <div className=\"text-sm text-gray-900\">\r\n                        {update.progress_percentage.toFixed(1)}%\r\n                      </div>\r\n                      <div className=\"text-xs text-gray-500\">\r\n                        {update.successful_updates + update.failed_updates} / {update.total_devices} devices\r\n                      </div>\r\n                      <div className=\"w-full bg-gray-200 rounded-full h-2 mt-1\">\r\n                        <div \r\n                          className=\"bg-blue-600 h-2 rounded-full\" \r\n                          style={{ width: `${update.progress_percentage}%` }}\r\n                        ></div>\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"px-6 py-4 text-sm text-gray-900\">\r\n                      {formatFileSize(update.file_size)}\r\n                    </td>\r\n                    <td className=\"px-6 py-4\">\r\n                      <div className=\"text-sm text-gray-900\">\r\n                        {new Date(update.created_at).toLocaleDateString()}\r\n                      </div>\r\n                      <div className=\"text-xs text-gray-500\">\r\n                        {update.created_by_username}\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"px-6 py-4\">\r\n                      <button\r\n                        onClick={() => {\r\n                          setSelectedUpdate(update);\r\n                          fetchUpdateDetail(update.id);\r\n                        }}\r\n                        className=\"text-blue-600 hover:text-blue-800 text-sm font-medium\"\r\n                      >\r\n                        View Details\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        ) : (\r\n          <div className=\"px-6 py-8 text-center text-gray-500\">\r\n            No OTA updates found. Create your first OTA update to get started.\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Create OTA Update Modal */}\r\n      {showCreateForm && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-2xl max-h-screen overflow-y-auto\">\r\n            <h2 className=\"text-xl font-semibold mb-4\">Create OTA Update</h2>\r\n            \r\n            <form onSubmit={handleCreateOTAUpdate} className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700\">Name</label>\r\n                <input\r\n                  type=\"text\"\r\n                  required\r\n                  value={createForm.name}\r\n                  onChange={(e) => setCreateForm({ ...createForm, name: e.target.value })}\r\n                  className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2\"\r\n                  placeholder=\"e.g., Security Update January 2024\"\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700\">Version</label>\r\n                <input\r\n                  type=\"text\"\r\n                  required\r\n                  value={createForm.version}\r\n                  onChange={(e) => setCreateForm({ ...createForm, version: e.target.value })}\r\n                  className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2\"\r\n                  placeholder=\"e.g., 1.2.3\"\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700\">Description</label>\r\n                <textarea\r\n                  value={createForm.description}\r\n                  onChange={(e) => setCreateForm({ ...createForm, description: e.target.value })}\r\n                  className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2\"\r\n                  rows={3}\r\n                  placeholder=\"Describe what this update includes...\"\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700\">Firmware File (Max 1MB)</label>\r\n                <input\r\n                  type=\"file\"\r\n                  required\r\n                  accept=\".bin,.hex,.fw\"\r\n                  onChange={handleFileChange}\r\n                  className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2\"\r\n                />\r\n                {createForm.firmware_file && (\r\n                  <p className=\"text-sm text-gray-600 mt-1\">\r\n                    Selected: {createForm.firmware_file.name} ({formatFileSize(createForm.firmware_file.size)})\r\n                  </p>\r\n                )}\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700\">Target Type</label>\r\n                <select\r\n                  value={createForm.target_type}\r\n                  onChange={(e) => setCreateForm({ ...createForm, target_type: e.target.value as any })}\r\n                  className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2\"\r\n                >\r\n                  <option value=\"individual\">Individual Devices</option>\r\n                  <option value=\"group\">Device Group</option>\r\n                  <option value=\"all\">All Devices</option>\r\n                </select>\r\n              </div>\r\n\r\n              {createForm.target_type === 'individual' && (\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700\">Select Devices</label>\r\n                  <div className=\"mt-1 max-h-40 overflow-y-auto border border-gray-300 rounded-md\">\r\n                    {devices.map((device) => (\r\n                      <label key={device.id} className=\"flex items-center px-3 py-2 hover:bg-gray-50\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={selectedDevices.has(device.id)}\r\n                          onChange={(e) => {\r\n                            const newSelection = new Set(selectedDevices);\r\n                            if (e.target.checked) {\r\n                              newSelection.add(device.id);\r\n                            } else {\r\n                              newSelection.delete(device.id);\r\n                            }\r\n                            setSelectedDevices(newSelection);\r\n                          }}\r\n                          className=\"mr-2\"\r\n                        />\r\n                        <span className=\"text-sm\">\r\n                          {device.device_serial} \r\n                          {device.firmware_version && ` (v${device.firmware_version})`}\r\n                          <span className={`ml-2 px-2 py-1 rounded text-xs ${getStatusColor(device.status)}`}>\r\n                            {device.status}\r\n                          </span>\r\n                        </span>\r\n                      </label>\r\n                    ))}\r\n                  </div>\r\n                  <p className=\"text-sm text-gray-600 mt-1\">\r\n                    {selectedDevices.size} device(s) selected\r\n                  </p>\r\n                </div>\r\n              )}\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700\">Schedule (Optional)</label>\r\n                <input\r\n                  type=\"datetime-local\"\r\n                  value={createForm.scheduled_at}\r\n                  onChange={(e) => setCreateForm({ ...createForm, scheduled_at: e.target.value })}\r\n                  className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2\"\r\n                />\r\n                <p className=\"text-xs text-gray-600 mt-1\">\r\n                  Leave empty to start immediately upon creation\r\n                </p>\r\n              </div>\r\n\r\n              <div className=\"flex justify-end space-x-3 pt-4\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => {\r\n                    setShowCreateForm(false);\r\n                    setCreateForm({\r\n                      name: '',\r\n                      description: '',\r\n                      version: '',\r\n                      target_type: 'individual',\r\n                      firmware_file: null,\r\n                      scheduled_at: ''\r\n                    });\r\n                    setSelectedDevices(new Set());\r\n                  }}\r\n                  className=\"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={createLoading}\r\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400\"\r\n                >\r\n                  {createLoading ? 'Creating...' : 'Create OTA Update'}\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* OTA Update Detail Modal */}\r\n      {selectedUpdate && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-4xl max-h-screen overflow-y-auto\">\r\n            <div className=\"flex justify-between items-center mb-4\">\r\n              <h2 className=\"text-xl font-semibold\">\r\n                {selectedUpdate.name} v{selectedUpdate.version}\r\n              </h2>\r\n              <button\r\n                onClick={() => {\r\n                  setSelectedUpdate(null);\r\n                  setDeviceStatuses([]);\r\n                }}\r\n                className=\"text-gray-600 hover:text-gray-800\"\r\n              >\r\n                <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                </svg>\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"mb-6\">\r\n              <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4\">\r\n                <div className=\"bg-blue-50 p-4 rounded-lg\">\r\n                  <div className=\"text-2xl font-bold text-blue-600\">{selectedUpdate.total_devices}</div>\r\n                  <div className=\"text-sm text-blue-600\">Total Devices</div>\r\n                </div>\r\n                <div className=\"bg-green-50 p-4 rounded-lg\">\r\n                  <div className=\"text-2xl font-bold text-green-600\">{selectedUpdate.successful_updates}</div>\r\n                  <div className=\"text-sm text-green-600\">Successful</div>\r\n                </div>\r\n                <div className=\"bg-red-50 p-4 rounded-lg\">\r\n                  <div className=\"text-2xl font-bold text-red-600\">{selectedUpdate.failed_updates}</div>\r\n                  <div className=\"text-sm text-red-600\">Failed</div>\r\n                </div>\r\n                <div className=\"bg-yellow-50 p-4 rounded-lg\">\r\n                  <div className=\"text-2xl font-bold text-yellow-600\">{selectedUpdate.pending_updates}</div>\r\n                  <div className=\"text-sm text-yellow-600\">Pending</div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {deviceStatuses.length > 0 && (\r\n              <div>\r\n                <h3 className=\"text-lg font-semibold mb-3\">Device Status Details</h3>\r\n                <div className=\"overflow-x-auto\">\r\n                  <table className=\"w-full border-collapse border border-gray-300\">\r\n                    <thead>\r\n                      <tr className=\"bg-gray-50\">\r\n                        <th className=\"border border-gray-300 px-4 py-2 text-left\">Device</th>\r\n                        <th className=\"border border-gray-300 px-4 py-2 text-left\">Status</th>\r\n                        <th className=\"border border-gray-300 px-4 py-2 text-left\">Progress</th>\r\n                        <th className=\"border border-gray-300 px-4 py-2 text-left\">Started</th>\r\n                        <th className=\"border border-gray-300 px-4 py-2 text-left\">Completed</th>\r\n                        <th className=\"border border-gray-300 px-4 py-2 text-left\">Error</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {deviceStatuses.map((deviceStatus) => (\r\n                        <tr key={deviceStatus.id} className=\"hover:bg-gray-50\">\r\n                          <td className=\"border border-gray-300 px-4 py-2\">\r\n                            {deviceStatus.device.device_serial}\r\n                          </td>\r\n                          <td className=\"border border-gray-300 px-4 py-2\">\r\n                            <span className={`px-2 py-1 rounded text-xs ${getStatusColor(deviceStatus.status)}`}>\r\n                              {deviceStatus.status}\r\n                            </span>\r\n                          </td>\r\n                          <td className=\"border border-gray-300 px-4 py-2\">\r\n                            {deviceStatus.progress_percentage}%\r\n                          </td>\r\n                          <td className=\"border border-gray-300 px-4 py-2\">\r\n                            {deviceStatus.started_at \r\n                              ? new Date(deviceStatus.started_at).toLocaleString()\r\n                              : '-'\r\n                            }\r\n                          </td>\r\n                          <td className=\"border border-gray-300 px-4 py-2\">\r\n                            {deviceStatus.completed_at \r\n                              ? new Date(deviceStatus.completed_at).toLocaleString()\r\n                              : '-'\r\n                            }\r\n                          </td>\r\n                          <td className=\"border border-gray-300 px-4 py-2 text-red-600 text-sm\">\r\n                            {deviceStatus.error_message || '-'}\r\n                          </td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OTAManagement;"],"names":["CacheService","constructor","cache","Map","set","key","data","ttlMs","arguments","length","undefined","DEFAULT_TTL","this","timestamp","Date","now","expiresIn","get","entry","delete","has","clear","clearAll","size","getTTL","LONG_TTL","cacheService","API_BASE_URL","process","apiService","getAuthHeaders","tokens","localStorage","getItem","parsedTokens","JSON","parse","concat","access","error","console","request","endpoint","options","url","headers","response","fetch","_objectSpread","status","refreshToken","removeItem","window","location","href","Error","ok","errorText","text","statusText","json","method","body","stringify","refresh","newTokens","setItem","post","requestOptions","FormData","put","getConfiguration","getTelemetry","provisionDevice","getAlerts","cacheKey","cached","getSystemHealth","getKPIs","getUsers","search","params","encodeURIComponent","createUser","userData","result","createEmployee","employeeData","is_staff","getUserDevices","userId","updateUser","deleteUser","getProfile","updateProfile","changePassword","getCustomers","createCustomer","customerData","getCustomer","customerId","updateCustomer","deleteCustomer","getPresets","createPreset","updatePreset","id","deletePreset","getDevices","page","pageSize","URLSearchParams","append","toString","queryString","createDevice","deviceData","updateDevice","deviceId","deleteDevice","deleteDevicesBulk","deviceIds","device_ids","getSlaves","configId","createSlave","slaveData","updateSlave","slaveId","deleteSlave","OTAManagement","otaUpdates","setOtaUpdates","useState","devices","setDevices","selectedUpdate","setSelectedUpdate","deviceStatuses","setDeviceStatuses","loading","setLoading","createLoading","setCreateLoading","setError","showCreateForm","setShowCreateForm","selectedDevices","setSelectedDevices","Set","createForm","setCreateForm","name","description","version","target_type","firmware_file","scheduled_at","useEffect","fetchOTAUpdates","fetchDevices","async","ota_updates","err","_err$response","_err$response$data","message","results","formatFileSize","bytes","kb","toFixed","getStatusColor","toLowerCase","_jsx","className","children","_jsxs","onClick","map","update","progress_percentage","successful_updates","failed_updates","total_devices","style","width","file_size","created_at","toLocaleDateString","created_by_username","updateId","device_statuses","fetchUpdateDetail","onSubmit","e","preventDefault","formData","Array","from","forEach","alert","_err$response2","_err$response2$data","type","required","value","onChange","target","placeholder","rows","accept","_e$target$files","file","files","device","checked","newSelection","add","device_serial","firmware_version","disabled","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","pending_updates","deviceStatus","started_at","toLocaleString","completed_at","error_message"],"ignoreList":[],"sourceRoot":""}