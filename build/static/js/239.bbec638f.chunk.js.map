{"version":3,"file":"static/js/239.bbec638f.chunk.js","mappings":"gKAUA,MAAMA,EAAwCC,IAMvC,IANwC,UAC7CC,EAAS,UACTC,EAAS,UACTC,EAAS,UACTC,EAAS,UACTC,EAAY,eACbL,EACC,MAAMM,EAAcC,IAClB,IAAKA,EAAY,MAAO,MACxB,IACE,OAAO,IAAIC,KAAKD,GAAYE,gBAC9B,CAAE,MAAAC,GACA,OAAOH,CACT,GAGF,OACEI,EAAAA,EAAAA,MAAA,OAAKN,UAAWA,EAAUO,SAAA,EACxBD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,YAAWO,SAAA,EACxBC,EAAAA,EAAAA,KAAA,QAAMR,UAAU,cAAaO,SAAC,aAC7BX,GACCU,EAAAA,EAAAA,MAAA,QAAMN,UAAU,cAAaO,SAAA,CAAC,OACzBC,EAAAA,EAAAA,KAAA,UAAAD,SAASX,IAAmB,OAAKK,EAAWJ,OAGjDW,EAAAA,EAAAA,KAAA,QAAMR,UAAU,cAAaO,SAAC,cAIjCT,IACCQ,EAAAA,EAAAA,MAAA,OAAKN,UAAU,YAAWO,SAAA,EACxBC,EAAAA,EAAAA,KAAA,QAAMR,UAAU,cAAaO,SAAC,mBAC9BD,EAAAA,EAAAA,MAAA,QAAMN,UAAU,cAAaO,SAAA,CAAC,OACzBC,EAAAA,EAAAA,KAAA,UAAAD,SAAST,IAAmB,OAAKG,EAAWF,aAQ3D,EAAeU,EAAAA,KAAWf,E,wFCnBnB,SAASgB,EACdC,GAEmC,IADnCC,EAAaC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,IAEhB,MAAOG,EAAWC,IAAgBC,EAAAA,EAAAA,UAAgC,MAE5DC,GAAoBC,EAAAA,EAAAA,aACxB,WAA6B,IAAD,IAAAC,EAAAR,UAAAC,OAAxBQ,EAAI,IAAAC,MAAAF,GAAAG,EAAA,EAAAA,EAAAH,EAAAG,IAAJF,EAAIE,GAAAX,UAAAW,GACFR,GACFS,aAAaT,GAGf,MAAMU,EAAeC,WAAW,KAC9BhB,KAAYW,IACXV,GAEHK,EAAaS,EACf,EACA,CAACf,EAAUC,EAAOI,IAYpB,OARAY,EAAAA,EAAAA,WAAU,IACD,KACDZ,GACFS,aAAaT,IAGhB,CAACA,IAEGG,CACT,C,8GC9CA,SAASU,EAAIC,EAAYC,GAEvB,IACE,MAAMC,EAAO,IAAI7B,KAAK2B,GACtB,MAAc,QAAVC,EAEKC,EAAKC,mBAAmB,GAAI,CAAEC,KAAM,UAAWC,OAAQ,YAC3C,OAAVJ,EAEFC,EAAKI,mBAAmB,GAAI,CAAEC,QAAS,UAAa,IACpDL,EAAKC,mBAAmB,GAAI,CAAEC,KAAM,UAAWC,OAAQ,YAGvDH,EAAKI,mBAAmB,GAAI,CAAEE,MAAO,QAASC,IAAK,WAE9D,CAAE,MAAAlC,GAAQ,OAAOyB,CAAI,CACvB,CAEA,SAASU,EAAYV,GAEnB,MAAMW,EAAUX,EAAGY,QAAQ,YAAa,IACxC,IACE,OAAO,IAAIvC,KAAKsC,GAASR,mBAAmB,GAAI,CAAEC,KAAM,UAAWC,OAAQ,WAC7E,CAAE,MAAAQ,GAAQ,OAAOF,CAAS,CAC5B,CAyDA,MAAMG,EAAgB,CACpBC,WAAY,yBACZC,OAAQ,gCACRC,aAAc,GACdC,MAAO,UACPC,UAAW,6BACXC,SAAU,IAINC,EAAUA,KACd7C,EAAAA,EAAAA,MAAA,OAAK8C,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,OAAO,UAAUC,YAAY,IAAIC,cAAc,QAAQC,eAAe,QAAOpD,SAAA,EACvIC,EAAAA,EAAAA,KAAA,UAAQoD,GAAG,KAAKC,GAAG,KAAKC,EAAE,IAAIP,KAAK,UAAUC,OAAO,UAAUC,YAAY,SAC1EjD,EAAAA,EAAAA,KAAA,QAAMuD,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAChC1D,EAAAA,EAAAA,KAAA,QAAMuD,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,QACjC1D,EAAAA,EAAAA,KAAA,QAAMuD,GAAG,OAAOC,GAAG,OAAOC,GAAG,OAAOC,GAAG,UACvC1D,EAAAA,EAAAA,KAAA,QAAMuD,GAAG,QAAQC,GAAG,QAAQC,GAAG,QAAQC,GAAG,WAC1C1D,EAAAA,EAAAA,KAAA,QAAMuD,GAAG,IAAIC,GAAG,KAAKC,GAAG,IAAIC,GAAG,QAC/B1D,EAAAA,EAAAA,KAAA,QAAMuD,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,UAG/BC,EAAcA,KAClB7D,EAAAA,EAAAA,MAAA,OAAK8C,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,OAAO,eAAeC,YAAY,IAAIC,cAAc,QAAQC,eAAe,QAAOpD,SAAA,EAC5IC,EAAAA,EAAAA,KAAA,QAAM4D,EAAE,IAAIC,EAAE,IAAIjB,MAAM,KAAKC,OAAO,KAAKiB,GAAG,OAC5C9D,EAAAA,EAAAA,KAAA,QAAMuD,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,QACjC1D,EAAAA,EAAAA,KAAA,QAAM4D,EAAE,IAAIC,EAAE,IAAIjB,MAAM,KAAKC,OAAO,IAAIE,KAAK,eAAee,GAAG,SAG7DC,EAAWA,KACfjE,EAAAA,EAAAA,MAAA,OAAK8C,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,OAAO,eAAeC,YAAY,IAAIC,cAAc,QAAQC,eAAe,QAAOpD,SAAA,EAC5IC,EAAAA,EAAAA,KAAA,QAAMgE,EAAE,kDACRhE,EAAAA,EAAAA,KAAA,YAAUiE,OAAO,6BAGfC,EAAaA,KACjBlE,EAAAA,EAAAA,KAAA,OAAK4C,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,OAAO,eAAeC,YAAY,IAAIC,cAAc,QAAQC,eAAe,QAAOpD,UAC5IC,EAAAA,EAAAA,KAAA,QAAMgE,EAAE,sCAGNG,EAAYA,KAChBnE,EAAAA,EAAAA,KAAA,OAAK4C,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,OAAO,eAAeC,YAAY,IAAIC,cAAc,QAAQC,eAAe,QAAOpD,UAC5IC,EAAAA,EAAAA,KAAA,QAAMgE,EAAE,gDAcNI,EAAkCjF,IAAA,IAAC,MAAEkF,EAAK,MAAEC,EAAK,KAAEC,EAAI,IAAEC,EAAG,OAAEC,EAAM,KAAEC,GAAMvF,EAAA,OAChFW,EAAAA,EAAAA,MAAA,OAAKN,UAAU,OAAOmF,MAAO,CAAEC,QAAS,SAAUC,KAAM,EAAGC,SAAU,KAAM/E,SAAA,EACzED,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEI,QAAS,OAAQC,eAAgB,gBAAiBC,WAAY,SAAUC,aAAc,UAAWnF,SAAA,EAC7GC,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEjC,SAAU,SAAUyC,WAAY,IAAKC,cAAe,YAAaC,cAAe,SAAU7C,MAAO,UAAW8C,WAAY,uBAAwBvF,SAAEsE,KACjKrE,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAE/B,MAAO,GAAIC,OAAQ,GAAIN,aAAc,MAAOF,WAAW,GAADkD,OAAKd,EAAM,MAAMM,QAAS,OAAQE,WAAY,SAAUD,eAAgB,SAAUxC,MAAOiC,EAAQe,WAAY,GAAIzF,SAAE2E,QAE1L5E,EAAAA,EAAAA,MAAA,KAAG6E,MAAO,CAAEc,OAAQ,EAAGH,WAAY,4BAA6B5C,SAAU,UAAWyC,WAAY,IAAK3C,MAAO,UAAWkD,WAAY,GAAI3F,SAAA,CACrIuE,EACAC,IAAQvE,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEjC,SAAU,SAAUyC,WAAY,IAAK3C,MAAO,UAAWmD,WAAY,GAAI5F,SAAEwE,OAElGC,IAAOxE,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEc,OAAQ,cAAe/C,SAAU,SAAUF,MAAO,UAAW8C,WAAY,uBAAwBvF,SAAEyE,QAyV3H,EA7UuCoB,IAAsC,IAADC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,IAApC,OAAEC,EAAM,YAAEC,GAAc,GAAOP,EACrE,MAAOQ,EAAWC,IAAgB3F,EAAAA,EAAAA,UAAgB,KAC3C4F,EAAUC,IAAe7F,EAAAA,EAAAA,UAAgB,KACzC8F,EAASC,IAAc/F,EAAAA,EAAAA,UAAc,OACrCgG,EAASC,IAAcjG,EAAAA,EAAAA,WAAS,IAChCkG,EAAOC,IAAYnG,EAAAA,EAAAA,UAAwB,OAC3CoG,EAAaC,IAAkBrG,EAAAA,EAAAA,UAAsB,OAGrDsG,EAAWC,IAAgBvG,EAAAA,EAAAA,UAAiB,QAC5CwG,EAAiBC,IAAsBzG,EAAAA,EAAAA,UAAiB,KACxD0G,EAAeC,IAAoB3G,EAAAA,EAAAA,UAAiB,IAErD4G,GAAW1G,EAAAA,EAAAA,aAAY2G,UAC3B,IAEE,IAAIC,EAAuB,CAAC,EACxBC,EAAsB,CAAC,EAET,WAAdT,GAA0BE,GAAmBE,GAC/CI,EAAkB,CAChBE,WAAY,IAAI/H,KAAKuH,GAAiBS,cACtCC,SAAU,IAAIjI,KAAKyH,GAAeO,eAEpCF,EAAiB,CACfC,WAAY,IAAI/H,KAAKuH,GAAiBS,cACtCC,SAAU,IAAIjI,KAAKyH,GAAeO,gBAEb,OAAdX,GACTQ,EAAkB,CAAEK,KAAM,GAE1BJ,EAAiB,CAAC,GACK,QAAdT,GACTQ,EAAkB,CAAEK,KAAM,IAC1BJ,EAAiB,CAAC,IAGlBD,EAAkB,CAAC,EACnBC,EAAiB,CAAC,GAGpB,MAAOK,EAAKC,EAAMC,SAAaC,QAAQC,IAAI,CACzCC,EAAAA,EAAWC,iBAAiBlC,EAAQsB,GACpCW,EAAAA,EAAWE,gBAAgBnC,EAAQuB,GACnCU,EAAAA,EAAWG,eAAepC,KAE5BG,EAAatF,MAAMwH,QAAQT,GAAOA,EAAM,IACxCvB,EAAYxF,MAAMwH,QAAQR,GAAQA,EAAO,IACzCtB,EAAWuB,GAAO,MAClBjB,EAAe,IAAIpH,MACnBkH,EAAS,KACX,CAAE,MAAO2B,GACP3B,EAAS2B,aAAeC,MAAQD,EAAIE,QAAU,2BAChD,CAAC,QACC/B,GAAW,EACb,GACC,CAACT,EAAQc,EAAWE,EAAiBE,KAExChG,EAAAA,EAAAA,WAAU,KAGR,GAFAuF,GAAW,GACXW,KACKnB,EAAa,OAClB,MAAMwC,EAAKC,YAAYtB,EAAU,KACjC,MAAO,IAAMuB,cAAcF,IAC1B,CAACrB,EAAUnB,IAGd,MAAM2C,EAAS1C,EAAU9F,OAAS,EAAI8F,EAAUA,EAAU9F,OAAS,GAAK,KAElEyI,EAAUD,IAA6B,QAAnBjD,EAACiD,EAAOE,mBAAW,IAAAnD,EAAAA,EAAI,IAAwB,QAAvBC,EAAKgD,EAAOG,mBAAW,IAAAnD,EAAAA,EAAI,IAAM,IAAO,KACpFoD,EAAqC,QAA/BnD,EAAU,OAAN+C,QAAM,IAANA,OAAM,EAANA,EAAQK,2BAAmB,IAAApD,EAAAA,EAAI,KACzCqD,EAAUN,GAA6B,QAApB9C,EAAC8C,EAAOO,oBAAY,IAAArD,EAAAA,EAAI,GAAK,IAAO,KACvDsD,EAA+B,QAAvBrD,EAAS,OAAN6C,QAAM,IAANA,OAAM,EAANA,EAAQS,oBAAY,IAAAtD,EAAAA,EAAI,KAInCuD,EAhNR,SAA2BC,EAAalI,GAEtC,IAAKkI,GAAwB,IAAhBA,EAAKnJ,OAAc,MAAO,GAEvC,GAAc,QAAViB,EAEF,OAAOkI,EAAKC,OAAO,CAACC,EAAGC,IAAMA,EAAI,IAAM,GAAKA,IAAMH,EAAKnJ,OAAS,GAC3D,GAAc,OAAViB,EAAgB,CAEzB,MAAMsI,EAAU,IAAIC,IAQpB,OAPAL,EAAKM,QAAQC,IACX,MAAMxI,EAAO,IAAI7B,KAAKqK,EAAIC,WACpBC,EAAO,GAAA3E,OAAM/D,EAAK2I,cAAa,KAAA5E,OAAI/D,EAAK4I,WAAU,KAAA7E,OAAI/D,EAAK6I,UAAS,KAAA9E,OAAI/D,EAAK8I,YAC9ET,EAAQU,IAAIL,IAAUL,EAAQW,IAAIN,EAAS,IAChDL,EAAQY,IAAIP,GAAUQ,KAAKV,KAGtBjJ,MAAM4J,KAAKd,EAAQe,UAAUC,IAAIC,IACtC,MAAMC,EAAQD,EAAO,GACrB,MAAO,CACLb,UAAWc,EAAMd,UACjBjB,YAAa8B,EAAOE,OAAO,CAACC,EAAK3H,KAAC,IAAA4H,EAAA,OAAKD,GAAoB,QAAjBC,EAAI5H,EAAE0F,mBAAW,IAAAkC,EAAAA,EAAI,IAAI,GAAKJ,EAAOxK,OAC/E2I,YAAa6B,EAAOE,OAAO,CAACC,EAAK3H,KAAC,IAAA6H,EAAA,OAAKF,GAAoB,QAAjBE,EAAI7H,EAAE2F,mBAAW,IAAAkC,EAAAA,EAAI,IAAI,GAAKL,EAAOxK,OAC/E+I,aAAcyB,EAAOE,OAAO,CAACC,EAAK3H,KAAC,IAAA8H,EAAA,OAAKH,GAAqB,QAAlBG,EAAI9H,EAAE+F,oBAAY,IAAA+B,EAAAA,EAAI,IAAI,GAAKN,EAAOxK,OACjF+K,aAAcP,EAAOE,OAAO,CAACC,EAAK3H,KAAC,IAAAgI,EAAA,OAAKL,GAAqB,QAAlBK,EAAIhI,EAAE+H,oBAAY,IAAAC,EAAAA,EAAI,IAAI,GAAKR,EAAOxK,OACjF6I,oBAAqB2B,EAAOE,OAAO,CAACC,EAAK3H,KAAC,IAAAiI,EAAA,OAAKN,GAA4B,QAAzBM,EAAIjI,EAAE6F,2BAAmB,IAAAoC,EAAAA,EAAI,IAAI,GAAKT,EAAOxK,OAC/FiJ,aAAcwB,EAAMxB,eAG1B,CAAO,CAEL,MAAMM,EAAU,IAAIC,IAQpB,OAPAL,EAAKM,QAAQC,IACX,MAAMxI,EAAO,IAAI7B,KAAKqK,EAAIC,WACpBuB,EAAM,GAAAjG,OAAM/D,EAAK2I,cAAa,KAAA5E,OAAI/D,EAAK4I,WAAU,KAAA7E,OAAI/D,EAAK6I,WAC3DR,EAAQU,IAAIiB,IAAS3B,EAAQW,IAAIgB,EAAQ,IAC9C3B,EAAQY,IAAIe,GAASd,KAAKV,KAGrBjJ,MAAM4J,KAAKd,EAAQe,UAAUC,IAAIC,IAG/B,CACLb,UAHYa,EAAO,GAGFb,UACjBjB,YAAa8B,EAAOE,OAAO,CAACC,EAAK3H,KAAC,IAAAmI,EAAA,OAAKR,GAAoB,QAAjBQ,EAAInI,EAAE0F,mBAAW,IAAAyC,EAAAA,EAAI,IAAI,GAAKX,EAAOxK,OAC/E2I,YAAa6B,EAAOE,OAAO,CAACC,EAAK3H,KAAC,IAAAoI,EAAA,OAAKT,GAAoB,QAAjBS,EAAIpI,EAAE2F,mBAAW,IAAAyC,EAAAA,EAAI,IAAI,GAAKZ,EAAOxK,OAC/E+I,aAAcyB,EAAOE,OAAO,CAACC,EAAK3H,KAAC,IAAAqI,EAAA,OAAKV,GAAqB,QAAlBU,EAAIrI,EAAE+F,oBAAY,IAAAsC,EAAAA,EAAI,IAAI,GAAKb,EAAOxK,OACjF+K,aAAcP,EAAOE,OAAO,CAACC,EAAK3H,KAAC,IAAAsI,EAAA,OAAKX,GAAqB,QAAlBW,EAAItI,EAAE+H,oBAAY,IAAAO,EAAAA,EAAI,IAAI,GAAKd,EAAOxK,OACjF6I,oBAAqB2B,EAAOE,OAAO,CAACC,EAAK3H,KAAC,IAAAuI,EAAA,OAAKZ,GAA4B,QAAzBY,EAAIvI,EAAE6F,2BAAmB,IAAA0C,EAAAA,EAAI,IAAI,GAAKf,EAAOxK,OAC/FiJ,aAAcuC,KAAKC,OAAOjB,EAAOD,IAAIvH,IAAC,IAAA0I,EAAA,OAAkB,QAAlBA,EAAI1I,EAAEiG,oBAAY,IAAAyC,EAAAA,EAAI,OAGlE,CACF,CA0JqBC,CAAkB7F,EAAWY,GACjB6D,IAAIb,IAAG,IAAAkC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,MAAK,CACzCC,KAAMlL,EAAI2I,EAAIC,UAAWjD,GACzB,cAA+B,QAAjBkF,EAAElC,EAAIhB,mBAAW,IAAAkD,EAAAA,EAAI,IAAqB,QAApBC,EAAKnC,EAAIf,mBAAW,IAAAkD,EAAAA,EAAI,IAAM,KAAMK,QAAQ,GAChF,eAAgC,QAAjBJ,EAACpC,EAAIX,oBAAY,IAAA+C,EAAAA,EAAI,GAAK,KAAMI,QAAQ,GACvD,eAAgC,QAAjBH,EAACrC,EAAIqB,oBAAY,IAAAgB,EAAAA,EAAI,GAAK,KAAMG,QAAQ,GACvD,eAAuC,QAAzBF,EAAEtC,EAAIb,2BAAmB,IAAAmD,EAAAA,EAAI,QAIvCG,GAAenG,EAASuE,IAAIb,IAAG,CACnCuC,KAAMvK,EAAYgI,EAAIC,WACtByC,IAAmB,MAAd1C,EAAI2C,QAAkB3C,EAAI2C,OAAOH,QAAQ,GAAK,KACnDI,IAAmB,MAAd5C,EAAI6C,QAAkB7C,EAAI6C,OAAOL,QAAQ,GAAK,KACnDM,IAAmB,MAAd9C,EAAI+C,QAAkB/C,EAAI+C,OAAOP,QAAQ,GAAK,QAKrD,GAAI9F,EACF,OACE5G,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEC,QAAS,YAAa7E,SAAA,EAClCC,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEI,QAAS,OAAQiI,IAAK,OAAQ9H,aAAc,OAAQ+H,SAAU,QAASlN,SAClF,IAAIgB,MAAM,IAAI8J,IAAI,CAAClB,EAAGC,KACrB5J,EAAAA,EAAAA,KAAA,OAAaR,UAAU,gBAAgBmF,MAAO,CAAEE,KAAM,EAAGC,SAAU,IAAKjC,OAAQ,KAAtE+G,OAGd5J,EAAAA,EAAAA,KAAA,OAAKR,UAAU,gBAAgBmF,MAAO,CAAE9B,OAAQ,IAAKqC,aAAc,WACnElF,EAAAA,EAAAA,KAAA,OAAKR,UAAU,gBAAgBmF,MAAO,CAAE9B,OAAQ,UAKtD,GAAI+D,EACF,OACE9G,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEC,QAAS,SAAUpC,MAAO,UAAWE,SAAU,UAAWL,WAAY,uBAAwBE,aAAc,GAAI2K,UAAW,QAASnN,SAAA,CAAC,qCAChHC,EAAAA,EAAAA,KAAA,UAAAD,SAASmG,IAAgB,KAAGU,KAKnE,MAAMuG,GAA8B,IAArB/G,EAAU9F,QAAoC,IAApBgG,EAAShG,SAAiBkG,EAEnE,OACE1G,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEuI,UAAW,UAAWnN,SAAA,EAElCD,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEI,QAAS,OAAQE,WAAY,SAAUD,eAAgB,gBAAiBE,aAAc,UAAW8H,IAAK,OAAQC,SAAU,QAASlN,SAAA,EAC7ID,EAAAA,EAAAA,MAAA,KAAGN,UAAU,qBAAqBmF,MAAO,CAAEc,OAAQ,GAAI1F,SAAA,CAAC,kCAAyBC,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEW,WAAY,4BAA6B9C,MAAO,WAAYzC,SAAEmG,QAC9JpG,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEI,QAAS,OAAQE,WAAY,SAAU+H,IAAK,UAAWC,SAAU,QAASlN,SAAA,EAEtFD,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEI,QAAS,OAAQE,WAAY,SAAU+H,IAAK,UAAWjN,SAAA,EACnED,EAAAA,EAAAA,MAAA,UACEwE,MAAO0C,EACPoG,SAAWC,GAAMpG,EAAaoG,EAAEC,OAAOhJ,OACvCK,MAAO,CACLtC,WAAY,uBACZC,OAAQ,+BACRC,aAAc,EACdqC,QAAS,gBACTlC,SAAU,UACVF,MAAO,6BACP+K,OAAQ,UACRjI,WAAY,sBACZH,WAAY,KACZpF,SAAA,EAEFC,EAAAA,EAAAA,KAAA,UAAQsE,MAAM,MAAKvE,SAAC,mBACpBC,EAAAA,EAAAA,KAAA,UAAQsE,MAAM,KAAIvE,SAAC,iBACnBC,EAAAA,EAAAA,KAAA,UAAQsE,MAAM,MAAKvE,SAAC,kBACpBC,EAAAA,EAAAA,KAAA,UAAQsE,MAAM,SAAQvE,SAAC,oBAGV,WAAdiH,IACClH,EAAAA,EAAAA,MAAA0N,EAAAA,SAAA,CAAAzN,SAAA,EACEC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,OACLnJ,MAAO4C,EACPkG,SAAWC,GAAMlG,EAAmBkG,EAAEC,OAAOhJ,OAC7CK,MAAO,CACLtC,WAAY,uBACZC,OAAQ,+BACRC,aAAc,EACdqC,QAAS,gBACTlC,SAAU,UACVF,MAAO,6BACP8C,WAAY,sBACZH,WAAY,QAGhBnF,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEnC,MAAO,UAAWE,SAAU,UAAW3C,SAAC,QACvDC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,OACLnJ,MAAO8C,EACPgG,SAAWC,GAAMhG,EAAiBgG,EAAEC,OAAOhJ,OAC3CK,MAAO,CACLtC,WAAY,uBACZC,OAAQ,+BACRC,aAAc,EACdqC,QAAS,gBACTlC,SAAU,UACVF,MAAO,6BACP8C,WAAY,sBACZH,WAAY,aAOrB2B,IACChH,EAAAA,EAAAA,MAAA,QAAM6E,MAAO,CAAEjC,SAAU,SAAUF,MAAO,UAAW8C,WAAY,uBAAwBvF,SAAA,CAAC,WAC/E+G,EAAYrF,mBAAmB,GAAI,CAAEC,KAAM,UAAWC,OAAQ,gBAG3E3B,EAAAA,EAAAA,KAAA,UACE0N,QAASA,KAAQ/G,GAAW,GAAOW,KACnC3C,MAAO,CAAEtC,WAAY,OAAQC,OAAQ,+BAAgCC,aAAc,EAAGqC,QAAS,gBAAiBlC,SAAU,UAAWF,MAAO,UAAW+K,OAAQ,UAAWjI,WAAY,sBAAuBH,WAAY,KAAMpF,SAChO,yBAMJoN,IACCrN,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEC,QAAS,OAAQ+I,UAAW,SAAUnL,MAAO,UAAWE,SAAU,WAAYL,WAAY,sBAAuBE,aAAc,GAAID,OAAQ,kCAAmCvC,SAAA,CAAC,oCAC3JC,EAAAA,EAAAA,KAAA,UAAQ2E,MAAO,CAAEnC,MAAO,WAAYzC,SAAEmG,IAAgB,sBAAkBlG,EAAAA,EAAAA,KAAA,UACxGA,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEjC,SAAU,WAAY3C,SAAC,oGAGxCD,EAAAA,EAAAA,MAAA0N,EAAAA,SAAA,CAAAzN,SAAA,EAEED,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEI,QAAS,OAAQiI,IAAK,UAAWC,SAAU,OAAQ/H,aAAc,QAASnF,SAAA,EACtFC,EAAAA,EAAAA,KAACoE,EAAO,CAACC,MAAM,WAAeC,MAAe,MAARyE,EAAeA,EAAKyD,QAAQ,GAAK,SAAajI,KAAK,KAAMC,IAAI,qBAAuBC,OAAO,UAAUC,MAAM1E,EAAAA,EAAAA,KAAC2C,EAAO,OACxJ3C,EAAAA,EAAAA,KAACoE,EAAO,CAACC,MAAM,cAAeC,MAAiB,MAAV4E,EAAiBA,EAAOsD,QAAQ,GAAK,SAAUjI,KAAK,IAAMC,IAAI,kBAAwBC,OAAO,UAAUC,MAAM1E,EAAAA,EAAAA,KAAC2D,EAAW,OAC9J3D,EAAAA,EAAAA,KAACoE,EAAO,CAACC,MAAM,OAAeC,MAAiB,MAAV8E,EAAiBA,EAAOoD,QAAQ,GAAK,SAAUjI,KAAK,KAAMC,IAAI,sBAAwBC,OAAO,UAAUC,MAAM1E,EAAAA,EAAAA,KAAC+D,EAAQ,OAC3J/D,EAAAA,EAAAA,KAACoE,EAAO,CAACC,MAAM,eAAeC,MAAmB,MAAZgF,EAAmBA,EAASkD,QAAQ,GAAK,SAAMjI,KAAK,MAAMC,IAAI,oBAAwBC,OAAO,UAAUC,MAAM1E,EAAAA,EAAAA,KAACkE,EAAU,SAI9JsC,IACCxG,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEI,QAAS,OAAQiI,IAAK,SAAUC,SAAU,OAAQ/H,aAAc,QAASnF,SACpF,CACC,CAAEsE,MAAO,OAAQC,MAAgC,MAAzBkC,EAAQoH,cAAqB,GAAArI,OAAMiB,EAAQoH,cAAcpB,QAAQ,GAAE,UAAQ,MACnG,CAAEnI,MAAO,WAAYC,MAA+B,MAAxBkC,EAAQqH,aAAoB,GAAAtI,OAAMiB,EAAQqH,aAAY,MAAO,MACzF,CAAExJ,MAAO,QAASC,MAAkC,MAA3BkC,EAAQsH,gBAAuB,GAAAvI,OAAMiB,EAAQsH,gBAAe,MAAO,KAAMpJ,MAAM1E,EAAAA,EAAAA,KAACmE,EAAS,KAClH,CAAEE,MAAO,OAAQC,MAAgC,MAAzBkC,EAAQuH,cAAqB,GAAAxI,OAAMiB,EAAQuH,cAAcvB,QAAQ,GAAE,QAAS,MACpG,CAAEnI,MAAO,MAAOC,MAA0B,MAAnBkC,EAAQwH,QAAe,GAAAzI,OAAMuG,KAAKmC,MAAMzH,EAAQwH,SAAQ,YAAU,OACzFtE,OAAOwE,GAAgB,MAAXA,EAAE5J,OAAeuG,IAAIqD,IACjCpO,EAAAA,EAAAA,MAAA,QAAoB6E,MAAO,CACzBjC,SAAU,UAAWyC,WAAY,IAAKG,WAAY,sBAClDV,QAAS,iBAAkBrC,aAAc,GACzCF,WAAY,sBAAuBC,OAAQ,gCAC3CE,MAAO,UAAWuC,QAAS,OAAQE,WAAY,SAAU+H,IAAK,UAC9DjN,SAAA,CACCmO,EAAExJ,KAAMwJ,EAAE7J,MAAM,MAAErE,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEW,WAAY,4BAA6B9C,MAAO,WAAYzC,SAAEmO,EAAE5J,UANzF4J,EAAE7J,UAalBmF,EAAYlJ,OAAS,IACpBR,EAAAA,EAAAA,MAAA,OAAKN,UAAU,OAAOmF,MAAO,CAAEC,QAAS,UAAWM,aAAc,QAASnF,SAAA,EACxED,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEO,aAAc,QAASnF,SAAA,EACnCD,EAAAA,EAAAA,MAAA,MAAI6E,MAAO,CAAEc,OAAQ,cAAe/C,SAAU,SAAU4C,WAAY,uBAAwB9C,MAAO,WAAYzC,SAAA,CAAC,wBAE9F,QAAdiH,EAAsB,gBACR,OAAdA,EAAqB,cACP,QAAdA,EAAsB,eACR,WAAdA,GAA0BE,GAAmBE,EAAa,GAAA7B,OACrD,IAAI5F,KAAKuH,GAAiBtF,qBAAoB,OAAA2D,OAAM,IAAI5F,KAAKyH,GAAexF,sBAC/E,mBAGU,OAAdoF,GAAoC,QAAdA,GAAqC,WAAdA,KAC7ChH,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEc,OAAQ,EAAG/C,SAAU,SAAUF,MAAO,UAAW8C,WAAY,uBAAwBvF,SAChF,OAAdiH,EAAqB,0BAA4B,+BAIxDhH,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAE9B,OAAQ,KAAM9C,UAC1BC,EAAAA,EAAAA,KAACmO,EAAAA,EAAmB,CAACvL,MAAM,OAAOC,OAAO,OAAM9C,UAC7CD,EAAAA,EAAAA,MAACsO,EAAAA,EAAS,CAAC3E,KAAMD,EAAa/D,OAAQ,CAAE4I,IAAK,EAAGC,MAAO,EAAGC,KAAM,EAAGC,OAAsB,OAAdxH,GAAoC,QAAdA,EAAsB,GAAK,GAAIjH,SAAA,EAC9HD,EAAAA,EAAAA,MAAA,QAAAC,SAAA,EACED,EAAAA,EAAAA,MAAA,kBAAgB6I,GAAG,SAAWpF,GAAG,IAAIC,GAAG,IAAIC,GAAG,IAAIC,GAAG,IAAG3D,SAAA,EACvDC,EAAAA,EAAAA,KAAA,QAAMyO,OAAO,KAAMC,UAAU,UAAUC,YAAa,OACpD3O,EAAAA,EAAAA,KAAA,QAAMyO,OAAO,MAAMC,UAAU,UAAUC,YAAa,QAEtD7O,EAAAA,EAAAA,MAAA,kBAAgB6I,GAAG,WAAWpF,GAAG,IAAIC,GAAG,IAAIC,GAAG,IAAIC,GAAG,IAAG3D,SAAA,EACvDC,EAAAA,EAAAA,KAAA,QAAMyO,OAAO,KAAMC,UAAU,UAAUC,YAAa,OACpD3O,EAAAA,EAAAA,KAAA,QAAMyO,OAAO,MAAMC,UAAU,UAAUC,YAAa,WAGxD3O,EAAAA,EAAAA,KAAC4O,EAAAA,EAAa,CAACC,gBAAgB,MAAM7L,OAAO,yBAC5ChD,EAAAA,EAAAA,KAAC8O,EAAAA,EAAK,CACJC,QAAQ,OACR/L,OAAO,UACPN,SAAwB,QAAdsE,EAAsB,EAAI,GACpCgI,SAAwB,QAAdhI,EAAsB,mBAAqB8E,KAAKmD,KAAKzF,EAAYlJ,OAAS,IACpF4O,MAAqB,OAAdlI,GAAoC,QAAdA,GAAuB,GAAK,EACzDmI,WAA0B,OAAdnI,GAAoC,QAAdA,EAAsB,MAAQ,YAElEhH,EAAAA,EAAAA,KAACoP,EAAAA,EAAK,CAACpM,OAAO,UAAUN,SAAU,GAAI2M,cAAeC,GAAC,GAAA/J,OAAO+J,EAAC,SAC9DtP,EAAAA,EAAAA,KAACuP,EAAAA,EAAO,CAACC,aAAcpN,EAAeqN,UAAWA,CAACH,EAAQI,IAAiB,CAAC,GAADnK,OAAI+J,EAAC,KAAA/J,OAAImK,EAAKC,SAAS,KAAO,IAAM,MAAQD,MACvH1P,EAAAA,EAAAA,KAAC4P,EAAAA,EAAM,CAACC,SAAS,SAASC,SAAU,EAAGC,aAAc,CAAErN,SAAU,GAAI4C,WAAY,0BACjFtF,EAAAA,EAAAA,KAACgQ,EAAAA,EAAI,CAACvC,KAAK,WAAWsB,QAAQ,UAAY/L,OAAO,UAAUC,YAAa,EAAGF,KAAK,eAAiBkN,KAAK,KACtGjQ,EAAAA,EAAAA,KAACgQ,EAAAA,EAAI,CAACvC,KAAK,WAAWsB,QAAQ,YAAY/L,OAAO,UAAUC,YAAa,EAAGF,KAAK,iBAAiBkN,KAAK,KACtGjQ,EAAAA,EAAAA,KAACkQ,EAAAA,EAAI,CAACzC,KAAK,WAAWsB,QAAQ,YAAY/L,OAAO,UAAUC,YAAa,IAAKgN,KAAK,EAAOpB,gBAAgB,kBAQlHpC,GAAanM,OAAS,IACrBR,EAAAA,EAAAA,MAAA,OAAKN,UAAU,OAAOmF,MAAO,CAAEC,QAAS,WAAY7E,SAAA,EAClDD,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEI,QAAS,OAAQE,WAAY,SAAUD,eAAgB,gBAAiBE,aAAc,QAASnF,SAAA,EAC3GC,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEc,OAAQ,EAAG/C,SAAU,SAAU4C,WAAY,uBAAwB9C,MAAO,WAAYzC,SAAC,4BAGpGC,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEI,QAAS,OAAQiI,IAAK,UAAWjN,SAC5C,CAAC,CAAEsE,MAAO,kBAAmB7B,MAAO,WAAa,CAAE6B,MAAO,aAAc7B,MAAO,WAAa,CAAE6B,MAAO,iBAAkB7B,MAAO,YAAaqI,IAAIsF,IAC9IrQ,EAAAA,EAAAA,MAAA,QAAoB6E,MAAO,CAAEjC,SAAU,UAAWyC,WAAY,IAAK3C,MAAO,UAAWuC,QAAS,OAAQE,WAAY,SAAU+H,IAAK,UAAW1H,WAAY,uBAAwBvF,SAAA,EAC9KC,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAE/B,MAAO,EAAGC,OAAQ,EAAGN,aAAc,MAAOF,WAAY8N,EAAE3N,MAAOuC,QAAS,kBACtFoL,EAAE9L,QAFM8L,EAAE9L,cAOnBrE,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAE9B,OAAQ,KAAM9C,UAC1BC,EAAAA,EAAAA,KAACmO,EAAAA,EAAmB,CAACvL,MAAM,OAAOC,OAAO,OAAM9C,UAC7CD,EAAAA,EAAAA,MAACsO,EAAAA,EAAS,CAAC3E,KAAMgD,GAAchH,OAAQ,CAAE4I,IAAK,EAAGC,MAAO,EAAGC,KAAM,EAAGC,OAAQ,GAAIzO,SAAA,EAC9EC,EAAAA,EAAAA,KAAA,QAAAD,UACED,EAAAA,EAAAA,MAAA,kBAAgB6I,GAAG,UAAUpF,GAAG,IAAIC,GAAG,IAAIC,GAAG,IAAIC,GAAG,IAAG3D,SAAA,EACtDC,EAAAA,EAAAA,KAAA,QAAMyO,OAAO,KAAMC,UAAU,UAAUC,YAAa,OACpD3O,EAAAA,EAAAA,KAAA,QAAMyO,OAAO,MAAMC,UAAU,UAAUC,YAAa,UAGxD3O,EAAAA,EAAAA,KAAC4O,EAAAA,EAAa,CAACC,gBAAgB,MAAM7L,OAAO,yBAC5ChD,EAAAA,EAAAA,KAAC8O,EAAAA,EAAK,CAACC,QAAQ,OAAO/L,OAAO,UAAUN,SAAU,GAAIsM,SAAS,sBAC9DhP,EAAAA,EAAAA,KAACoP,EAAAA,EAAK,CAACpM,OAAO,UAAUN,SAAU,GAAI2M,cAAeC,GAAC,GAAA/J,OAAO+J,EAAC,SAC9DtP,EAAAA,EAAAA,KAACuP,EAAAA,EAAO,CAACC,aAAcpN,EAAeqN,UAAYH,GAAW,CAAC,GAAD/J,OAAI+J,EAAC,WAElEtP,EAAAA,EAAAA,KAACgQ,EAAAA,EAAI,CAACvC,KAAK,WAAWsB,QAAQ,MAAM/L,OAAO,UAAUC,YAAa,EAAG4L,gBAAgB,MAAM9L,KAAK,wBAAwBkN,KAAK,KAC7HjQ,EAAAA,EAAAA,KAACgQ,EAAAA,EAAI,CAACvC,KAAK,WAAWsB,QAAQ,MAAM/L,OAAO,UAAUC,YAAa,EAAGF,KAAK,gBAAgBkN,KAAK,KAC/FjQ,EAAAA,EAAAA,KAACgQ,EAAAA,EAAI,CAACvC,KAAK,WAAWsB,QAAQ,MAAM/L,OAAO,UAAUC,YAAa,EAAG4L,gBAAgB,MAAM9L,KAAK,OAAOkN,KAAK,qBCyqChI,EA/iD0BG,KAAO,IAADC,EAAAC,EAC9B,MAAOC,IAAgBC,EAAAA,EAAAA,OAChBC,EAASC,IAAchQ,EAAAA,EAAAA,UAAmB,KAC1CiQ,EAAiBC,IAAsBlQ,EAAAA,EAAAA,UAAmB,KAC1DgG,EAASC,IAAcjG,EAAAA,EAAAA,WAAS,IAChCkG,EAAOC,IAAYnG,EAAAA,EAAAA,UAAwB,OAC3CmQ,EAAeC,IAAoBpQ,EAAAA,EAAAA,UAAwB,OAC3DqQ,EAAgBC,IAAqBtQ,EAAAA,EAAAA,WAAS,IAC9CuQ,EAAYC,IAAiBxQ,EAAAA,EAAAA,UAAS,KACtCyQ,EAAgBC,IAAqB1Q,EAAAA,EAAAA,UAAS,KAC9C2Q,EAAeC,IAAoB5Q,EAAAA,EAAAA,UAAiB,KACpD6Q,EAAkBC,IAAuB9Q,EAAAA,EAAAA,WAAS,IAClD+Q,EAAOC,IAAYhR,EAAAA,EAAAA,UAAiB,KACpCiR,EAAiBC,IAAsBlR,EAAAA,EAAAA,UAAsB,IAAImR,MACjEC,EAAmBC,IAAwBrR,EAAAA,EAAAA,WAAS,IAEpDsR,EAAaC,IAAkBvR,EAAAA,EAAAA,UAAS,IACxCwR,EAAUC,IAAezR,EAAAA,EAAAA,UAAS,KAClC0R,EAAYC,IAAiB3R,EAAAA,EAAAA,UAAS,IACtC4R,EAAYC,IAAiB7R,EAAAA,EAAAA,UAAS,IACtC8R,EAASC,IAAc/R,EAAAA,EAAAA,UAAmB,KAC1CgS,EAAgBC,IAAqBjS,EAAAA,EAAAA,WAAS,IAC9CkS,EAAQC,IAAanS,EAAAA,EAAAA,UAAkC,OACvDoS,EAAkBC,IAAuBrS,EAAAA,EAAAA,UAAkC,OAC3EsS,EAAeC,KAAoBvS,EAAAA,EAAAA,UAA0B,KAC7DwS,GAAgBC,KAAqBzS,EAAAA,EAAAA,UAAwB,OAC7D0S,GAAgBC,KAAqB3S,EAAAA,EAAAA,UAAwB,OAC7D4S,GAAYC,KAAiB7S,EAAAA,EAAAA,UAAgB,KAC7C8S,GAAaC,KAAkB/S,EAAAA,EAAAA,WAAS,IACxCgT,GAAUC,KAAejT,EAAAA,EAAAA,UAAS,CACvCkT,cAAe,GACfC,KAAM,GACNC,eAAgB,MAEXC,GAAYC,KAAiBtT,EAAAA,EAAAA,UAAS,CAC3CkT,cAAe,GACfC,KAAM,GACNC,eAAgB,MAIXG,GAAaC,KAAkBxT,EAAAA,EAAAA,UAA2B,OAC1DyT,GAAaC,KAAkB1T,EAAAA,EAAAA,WAAS,IACxC2T,GAAaC,KAAkB5T,EAAAA,EAAAA,WAAS,IACxC6T,GAAUC,KAAe9T,EAAAA,EAAAA,UAAwB,CACtD+T,QAAS,GAAIC,aAAc,GAAIC,SAAU,GAAIC,UAAW,GACxDC,YAAa,GAAIC,SAAU,KAAMC,YAAa,MAC9CC,SAAU,eAAgBC,WAAW,KAEhCC,GAAYC,KAAiBzU,EAAAA,EAAAA,WAAS,IACtC0U,GAAWC,KAAgB3U,EAAAA,EAAAA,UAAwB,OACnD4U,GAAcC,KAAmB7U,EAAAA,EAAAA,UAAwB,MAE1D8U,IAAe5U,EAAAA,EAAAA,aAAY2G,iBAAkD,IAA3CkO,EAAYpV,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,EAAGqV,EAAcrV,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,GACzE,IACEsG,GAAW,GACX,MAAMgP,QAAiBxN,EAAAA,EAAWyN,WAAWF,QAAUnV,EAAWkV,EAAMvD,GAGpEyD,EAASE,SACXnF,EAAWiF,EAASE,SACpBjF,EAAmB+E,EAASE,SAC5BxD,EAAcsD,EAASG,OACvBvD,EAAcoD,EAASI,aACvB9D,EAAe0D,EAASK,gBAGxBtF,EAAW3P,MAAMwH,QAAQoN,GAAYA,EAAW,IAChD/E,EAAmB7P,MAAMwH,QAAQoN,GAAYA,EAAW,IACxDtD,EAActR,MAAMwH,QAAQoN,GAAYA,EAASrV,OAAS,GAC1DiS,EAAc,GACdN,EAAe,IAGjBtL,GAAW,EACb,CAAE,MAAO6B,GACP3B,EAAS2B,aAAeC,MAAQD,EAAIE,QAAU,qBAC9C/B,GAAW,EACb,CACF,EAAG,CAACuL,IAyDE+D,IAAkBrV,EAAAA,EAAAA,aAAY2G,UAClCkM,IAAe,GACf,IACE,MAAMkC,QAAiBxN,EAAAA,EAAW+N,cAAcC,EAAU,GAAI,GAC9D5C,GAAcoC,EAASS,MAAQ,GACjC,CAAE,MAAO5N,GACP6N,QAAQzP,MAAM,+BAAgC4B,GAC9C+K,GAAc,GAChB,CAAC,QACCE,IAAe,EACjB,GACC,IAEG6C,IAAmB1V,EAAAA,EAAAA,aAAa2V,IAOpC,GANAlD,GAAkBkD,GAClBrC,GAAe,MACfE,IAAe,GACfb,GAAc,IAGVgD,EAAOzC,eAAgB,CACzB,MAAM0C,EAAShE,EAAQiE,KAAKvI,GAAKA,EAAEwI,YAAcH,EAAOzC,gBACxDyB,GAAgBiB,GAAU,KAC5B,MACEjB,GAAgB,MAIlBtN,QAAQC,IAAI,CACVC,EAAAA,EAAWwO,cAAcJ,EAAO5N,IAC7BiO,KAAKnN,GAAQyK,GAAezK,IAC5BoN,MAAOrO,IACN6N,QAAQzP,MAAM,kCAAmC2P,EAAO5N,GAAI,IAAKH,GACjE0L,GAAe,QAEnB+B,GAAgBM,EAAO5N,MACtBmO,QAAQ,IAAM1C,IAAe,KAC/B,CAAC6B,GAAiBzD,KAErBpR,EAAAA,EAAAA,WAAU,KA9FSmG,WACjB,IACE,MAEMwP,SAFqB5O,EAAAA,EAAW6O,YAEftN,OAAOmK,IAASA,EAAKoD,WAAapD,EAAKqD,cAC9DxF,EAASqF,EACX,CAAE,MAAOvO,GACP6N,QAAQzP,MAAM,yBAA0B4B,GACxC3B,EAAS,6CACX,GAsFAsQ,GAnFmB5P,WACnB,IACE,MAAMkC,QAAatB,EAAAA,EAAWiP,aAC9B3E,EAAW1R,MAAMwH,QAAQkB,GAAQA,EAAO,GAC1C,CAAE,MAAOjB,GACP6N,QAAQzP,MAAM,2BAA4B4B,EAC5C,CAAC,QACCmK,GAAkB,EACpB,GA4EA0E,GAzEyB9P,WACzB,IACE,MAAO+P,EAAYtE,SAAuB/K,QAAQC,IAAI,CACpDC,EAAAA,EAAWoP,kBACXpP,EAAAA,EAAWqP,iBAGb3E,EAAUyE,GAAc,MAExB,MAAMG,EAAiB1W,MAAMwH,QAAQyK,GAAiBA,EAAgB,GACtEC,GAAiBwE,GACjB,MAAM3O,EAAS2O,EAAezM,OAAsB,CAAC0M,EAAeC,KAClE,GAAS,OAAJA,QAAI,IAAJA,IAAAA,EAAM1N,UAAW,OAAOyN,EAC7B,MAAME,EAAW,IAAIjY,KAAKgY,EAAK1N,WAC/B,OAAI4N,OAAOC,MAAMF,EAASG,WAAmBL,EACxCA,EAEEE,EADa,IAAIjY,KAAK+X,GACGC,EAAK1N,UAAYyN,EAFtBC,EAAK1N,WAG/B,MAEG+N,EAAc,IAAInG,IAAI4F,EAAe5M,IAAK8M,GAAwBA,EAAKxB,WAAW8B,KACxFlF,EAAoB,CAClBmF,YAAaT,EAAenX,OAC5B0X,cACAG,gBAAiBrP,GAErB,CAAE,MAAON,GACP6N,QAAQzP,MAAM,kCAAmC4B,GACjD2K,GAAkB,mCACpB,GA6CAiF,IACC,KAEHhX,EAAAA,EAAAA,WAAU,KACR,MAAMiX,EAAgB9H,EAAa9F,IAAI,YACvC,GAAI4N,EAAe,CACjB,MAAMlC,EAAWmC,SAASD,EAAe,IACzC,IAAKP,MAAM3B,GAAW,CACpB,MAAMoC,EAAc9H,EAAQgG,KAAKzS,GAAKA,EAAE2E,KAAOwN,GAC3CoC,GACFjC,GAAiBiC,EAErB,CACF,GACC,CAAChI,EAAcE,EAAS6F,MAE3BlV,EAAAA,EAAAA,WAAU,KACRoU,GAAaxD,EAAaf,IACzB,CAACe,EAAaf,EAAYiB,EAAUsD,MAEvCpU,EAAAA,EAAAA,WAAU,KACR,MAAMoX,EAAqBA,KACzBhH,GAAoB,IAOtB,OAJID,GACFkH,SAASC,iBAAiB,QAASF,GAG9B,KACLC,SAASE,oBAAoB,QAASH,KAEvC,CAACjH,KAEJnQ,EAAAA,EAAAA,WAAU,KACR,GAA8B,KAA1B+P,EAAeyH,OACjBtH,EAAiBG,OACZ,CACL,MAAMoH,EAAc1H,EAAe2H,cAC7BC,EAAWtH,EAAM/H,OAAOmK,IAC5B,MAAMmF,EAAW,GAAAzT,OAAGsO,EAAKoF,WAAU,KAAA1T,OAAIsO,EAAKqF,WAAYJ,cACxD,OACEjF,EAAKsF,SAASL,cAAcnJ,SAASkJ,IACrChF,EAAKoF,WAAWH,cAAcnJ,SAASkJ,IACvChF,EAAKqF,UAAUJ,cAAcnJ,SAASkJ,IACtCG,EAASrJ,SAASkJ,IAClBhF,EAAKuF,MAAMN,cAAcnJ,SAASkJ,KAGtCvH,EAAiByH,EACnB,GACC,CAACtH,EAAON,IAGX,MAAMkI,GAAkBnZ,EACrBoZ,MAID,KAUIC,GAAchD,IAAoB,IAADiD,EAAAC,EACrC3I,EAAiByF,GACjB5C,GAAY,CACVC,cAAe2C,EAAO3C,cACtBC,KAAM0C,EAAO1C,MAAQ,GACrBC,eAAgByC,EAAOzC,gBAAkB,KAE3C1C,EAAkBmF,EAAO1C,KAAI,GAAAtO,OAAiD,QAAjDiU,EAAM/H,EAAMgF,KAAKiD,GAAKA,EAAEP,WAAa5C,EAAO1C,aAAK,IAAA2F,OAAA,EAA3CA,EAA6CP,WAAU,KAAA1T,OAA+C,QAA/CkU,EAAIhI,EAAMgF,KAAKiD,GAAKA,EAAEP,WAAa5C,EAAO1C,aAAK,IAAA4F,OAAA,EAA3CA,EAA6CP,UAAS,MAAA3T,OAAKgR,EAAO1C,KAAI,KAAM,IAC1KrC,GAAoB,IAGhBmI,GAAapS,UACjB,GAAKsJ,EAEL,UACQ1I,EAAAA,EAAWyR,aAAa/I,EAAclI,GAAI+K,IAChD5C,EAAiB,YAEX0E,GAAaxD,EAAaf,EAClC,CAAE,MAAOzI,GACP3B,EAAS2B,aAAeC,MAAQD,EAAIE,QAAU,0BAChD,GAGImR,GAAetS,UACnB,UACQY,EAAAA,EAAW2R,aAAa/F,IAC9B/C,GAAkB,GAClBgD,GAAc,CACZJ,cAAe,GACfC,KAAM,GACNC,eAAgB,WAGZ0B,GAAaxD,EAAaf,EAClC,CAAE,MAAOzI,GACP3B,EAAS2B,aAAeC,MAAQD,EAAIE,QAAU,0BAChD,GAqHIqR,GAAeA,KACnBjJ,EAAiB,MACjBE,GAAkB,GAClBI,EAAkB,IAClBI,GAAoB,IAGhBwI,GAAmBA,KACvB3G,GAAkB,MAClBa,GAAe,MACfI,IAAe,IAGjB,GAAI5N,EACF,OAAO1G,EAAAA,EAAAA,KAAA,OAAKR,UAAU,UAASO,SAAC,uBAGlC,GAAI6G,EACF,OAAO9G,EAAAA,EAAAA,MAAA,OAAKN,UAAU,QAAOO,SAAA,CAAC,UAAQ6G,KAGxC,MAAMqT,GAAqBzD,IAA4B,IAAD0D,EAAAC,EACpD,OAAmC,QAA5BD,EAAA1D,EAAO4D,6BAAqB,IAAAF,GAAkB,QAAlBC,EAA5BD,EAA8BG,wBAAgB,IAAAF,OAAlB,EAA5BA,EAAgDzD,YAAaF,EAAOE,WAAa,IAG1F,GAAItD,GAAgB,CAAC,IAADkH,GAAAC,GAClB,MAAMC,EAAkBxH,EAActJ,OAAQ+Q,GAAUA,EAAMtE,WAAa/C,GAAeQ,eACpF8G,EAAkBF,EAAgBxP,OAAsB,CAAC0M,EAAeC,KAC5E,GAAS,OAAJA,QAAI,IAAJA,IAAAA,EAAM1N,UAAW,OAAOyN,EAC7B,MAAME,EAAW,IAAIjY,KAAKgY,EAAK1N,WAC/B,GAAI4N,OAAOC,MAAMF,EAASG,WAAY,OAAOL,EAC7C,IAAKA,EAAe,OAAOC,EAAK1N,UAEhC,OAAO2N,EADa,IAAIjY,KAAK+X,GACGC,EAAK1N,UAAYyN,GAChD,MAEH,OACE5X,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACED,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEI,QAAS,OAAQE,WAAY,SAAUC,aAAc,QAASnF,SAAA,EAC1EC,EAAAA,EAAAA,KAAA,UACE0N,QAASsM,GACTxa,UAAU,oBACVmF,MAAO,CAAEgW,YAAa,QAAS5a,SAChC,4BAGDD,EAAAA,EAAAA,MAAA,MAAI6E,MAAO,CAAEc,OAAQ,GAAI1F,SAAA,CAAEqT,GAAeQ,cAAc,oBAG1D9T,EAAAA,EAAAA,MAAA,OAAKN,UAAU,OAAOmF,MAAO,CAAEO,aAAc,QAASnF,SAAA,EACpDD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,cAAaO,SAAA,EAC1BC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,oBACJD,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEI,QAAS,OAAQiI,IAAK,QAASjN,SAAA,EAC3CC,EAAAA,EAAAA,KAAA,UAAQ0N,QAASA,IAAM6L,GAAWnG,IAAiB5T,UAAU,MAAKO,SAAC,iBAGnEC,EAAAA,EAAAA,KAAA,UACE0N,QAASA,IA7JFnG,WACnB,GAAIqT,OAAOC,QAAQ,0CAADtV,OAA2CgR,EAAO3C,cAAa,qDAC/E,UACQzL,EAAAA,EAAW2S,aAAavE,EAAO5N,IACrCoS,MAAM,6BAADxV,OAA8BgR,EAAO3C,cAAa,2CACzD,CAAE,MAAOpL,GACP6N,QAAQzP,MAAM,gBAAiB4B,GAC/B3B,EAAS2B,aAAeC,MAAQD,EAAIE,QAAU,iCAChD,GAqJyBsS,CAAa5H,IAC5B5T,UAAU,MACVmF,MAAO,CACLsW,gBAAiB,UACjBzY,MAAO,QACPF,OAAQ,QAEV4Y,MAAM,kCAAiCnb,SACxC,yBAGDC,EAAAA,EAAAA,KAAA,UACE0N,QAASA,IA7JCnG,WACtB,GAAIqT,OAAOC,QAAQ,kIAADtV,OAAyHgR,EAAO3C,cAAa,MAC7J,UACQzL,EAAAA,EAAWgT,gBAAgB5E,EAAO5N,IACxCoS,MAAM,iCAADxV,OAAkCgR,EAAO3C,cAAa,0CAC7D,CAAE,MAAOpL,GACP6N,QAAQzP,MAAM,oBAAqB4B,GACnC3B,EAAS2B,aAAeC,MAAQD,EAAIE,QAAU,qCAChD,GAqJyB0S,CAAgBhI,IAC/B5T,UAAU,MACVmF,MAAO,CACLsW,gBAAiB,UACjBzY,MAAO,QACPF,OAAQ,QAEV4Y,MAAM,sDAAqDnb,SAC5D,6BAGDC,EAAAA,EAAAA,KAAA,UACE0N,QAASA,IA7JInG,WACzB,GAAIqT,OAAOC,QAAQ,6DAADtV,OAAoDgR,EAAO3C,cAAa,uEACxF,UACQzL,EAAAA,EAAWkT,aAAa9E,EAAO5N,IACrCoS,MAAM,UAADxV,OAAWgR,EAAO3C,cAAa,2BACpCP,GAAkB,MAClBmC,IACF,CAAE,MAAOhN,GACP6N,QAAQzP,MAAM,uBAAwB4B,GACtC3B,EAAS2B,aAAeC,MAAQD,EAAIE,QAAU,0BAChD,GAmJyB4S,CAAmBlI,IAClC5T,UAAU,MACVmF,MAAO,CACLsW,gBAAiB,UACjBzY,MAAO,QACPF,OAAQ,QAEV4Y,MAAM,6CAA4Cnb,SACnD,qCAKLC,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEC,QAAS,QAAS7E,UAC9BD,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEI,QAAS,OAAQwW,oBAAqB,iBAAkBvO,IAAK,QAASjN,SAAA,EAClFD,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACEC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,aACRC,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEc,OAAQ,SAAU1F,UAC5BC,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CACXI,QAAS,eACTH,QAAS,WACTrC,aAAc,OACdG,SAAU,WACVyC,WAAY,MACZ8V,gBAAiB7H,GAAeoI,UAAY,UAAY,UACxDhZ,MAAO4Q,GAAeoI,UAAY,UAAY,WAC9Czb,SACCqT,GAAeoI,UAAY,sBAAc,+BAIhD1b,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACEC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,qBACRC,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEc,OAAQ,SAAU1F,SAC3BqT,GAAeqI,eACZ,IAAI9b,KAAKyT,GAAeqI,gBAAgB7b,iBACxC,cAGRE,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACEC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,kBACRC,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEc,OAAQ,QAASH,WAAY,4BAA6B5C,SAAU,UAAW3C,SAAEqT,GAAesI,OAAS,eAEvH5b,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACEC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,YACRC,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEc,OAAQ,SAAU1F,SAAEqT,GAAeuI,OAAS,eAE1D7b,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACEC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,oBACRC,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEc,OAAQ,SAAU1F,SAAEqT,GAAeS,MAAQ,UAEzD/T,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEiX,WAAY,SAAUhX,QAAS,OAAQqW,gBAAiB,cAAe1Y,aAAc,MAAOD,OAAQ,gCAAkC9C,UAAU,mBAAkBO,SAAA,EAC9KD,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEI,QAAS,OAAQC,eAAgB,gBAAiBC,WAAY,aAAcC,aAAc,QAASnF,SAAA,EAC/GD,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACEC,EAAAA,EAAAA,KAAA,UAAQ2E,MAAO,CAAEjC,SAAU,UAAWF,MAAO,WAAahD,UAAU,iBAAgBO,SAAC,kBACpFuV,KACCtV,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEjC,SAAU,WAAYF,MAAO,qBAAsB0K,UAAW,OAAS1N,UAAU,eAAcO,SAC1GuV,GAAa5F,MAAQ0D,GAAeU,oBAIzCV,GAAeU,eAEbV,GAAeyI,uBACjB7b,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CACXI,QAAS,cAAeE,WAAY,SAAU+H,IAAK,MACnDpI,QAAS,WAAYrC,aAAc,OAAQG,SAAU,SAAUyC,WAAY,MAC3E8V,gBAAiB,UAAWzY,MAAO,WACnCzC,SAAC,2BAEHC,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CACXI,QAAS,cAAeE,WAAY,SAAU+H,IAAK,MACnDpI,QAAS,WAAYrC,aAAc,OAAQG,SAAU,SAAUyC,WAAY,MAC3E8V,gBAAiB,UAAWzY,MAAO,WACnCzC,SAAC,mBAZHC,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEnC,MAAO,qBAAsBE,SAAU,YAAclD,UAAU,mBAAkBO,SAAC,0BAepGqT,GAAeU,iBACdhU,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEI,QAAS,OAAQwW,oBAAqB,iBAAkBvO,IAAK,MAAOtK,SAAU,UAAW3C,SAAA,EACrGD,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEC,QAAS,MAAOqW,gBAAiB,sBAAuB1Y,aAAc,MAAOD,OAAQ,gCAAkC9C,UAAU,kBAAiBO,SAAA,EAC9JC,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEnC,MAAO,qBAAsB0C,aAAc,OAAS1F,UAAU,eAAcO,SAAC,eAC3FC,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEQ,WAAY,MAAOG,WAAY,YAAa9C,MAAO,WAAYzC,SAAEqT,GAAeU,oBAEjE,OAAlB,OAAZwB,SAAY,IAAZA,QAAY,EAAZA,GAAcwG,gBACbhc,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEC,QAAS,MAAOqW,gBAAiB,sBAAuB1Y,aAAc,MAAOD,OAAQ,gCAAkC9C,UAAU,kBAAiBO,SAAA,EAC9JC,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEnC,MAAO,qBAAsB0C,aAAc,OAAS1F,UAAU,eAAcO,SAAC,YAC3FD,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEQ,WAAY,MAAO3C,MAAO,WAAYzC,SAAA,CAAEuV,GAAawG,aAAa,UAAsC,IAA9BxG,GAAawG,aAAqB,IAAM,SAGlG,MAAjC1I,GAAe2I,gBAAmD,OAAb,OAAZzG,SAAY,IAAZA,QAAY,EAAZA,GAAc0G,WACtDlc,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CACVC,QAAS,MACTqW,gBAAiB,sBACjB1Y,aAAc,MACdqZ,WAAY,SACZtZ,OAAQ8Q,GAAe2I,iBAAmBzG,GAAa0G,QAAU,oBAAsB,qBACtFxc,UAAU,kBAAiBO,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEnC,MAAO,qBAAsB0C,aAAc,OAAS1F,UAAU,eAAcO,SAAC,oBAC3FD,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEI,QAAS,OAAQC,eAAgB,gBAAiBC,WAAY,UAAWlF,SAAA,EACrFD,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACEC,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEjC,SAAU,UAAWF,MAAO,sBAAwBhD,UAAU,eAAcO,SAAC,cAC5FD,EAAAA,EAAAA,MAAA,QAAM6E,MAAO,CAAEQ,WAAY,MAAOG,WAAY,YAAa9C,MAAO,WAAYzC,SAAA,CAAC,IAAEqT,GAAe2I,mBAChG/b,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEc,OAAQ,QAASjD,MAAO,sBAAwBhD,UAAU,eAAcO,SAAC,YACxFC,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEjC,SAAU,UAAWF,MAAO,sBAAwBhD,UAAU,eAAcO,SAAC,cAC5FD,EAAAA,EAAAA,MAAA,QAAM6E,MAAO,CAAEQ,WAAY,MAAOG,WAAY,YAAa9C,MAAO,WAAYzC,SAAA,CAAC,IAAEuV,GAAa0G,cAE/F5I,GAAe2I,iBAAmBzG,GAAa0G,SAC9Chc,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEnC,MAAO,UAAWE,SAAU,UAAWyC,WAAY,OAAQpF,SAAC,uBAE3EC,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEnC,MAAO,UAAWE,SAAU,UAAWyC,WAAY,OAAQpF,SAAC,kCAKjD,MAAjCqT,GAAe2I,gBAAmD,OAAb,OAAZzG,SAAY,IAAZA,QAAY,EAAZA,GAAc0G,WACtDlc,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEC,QAAS,MAAOqW,gBAAiB,sBAAuB1Y,aAAc,MAAOD,OAAQ,gCAAkC9C,UAAU,kBAAiBO,SAAA,EAC9JC,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEnC,MAAO,qBAAsB0C,aAAc,OAAS1F,UAAU,eAAcO,SAAC,oBAC3FD,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEQ,WAAY,MAAOG,WAAY,YAAa9C,MAAO,WAAYzC,SAAA,CAAC,IAAEqT,GAAe2I,sBAGtF,OAAZzG,SAAY,IAAZA,IAAmC,QAAvBgF,GAAZhF,GAAc8E,6BAAqB,IAAAE,IAAkB,QAAlBC,GAAnCD,GAAqCD,wBAAgB,IAAAE,QAAzC,EAAZA,GAAuD0B,gBACtDnc,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEC,QAAS,MAAOqW,gBAAiB,sBAAuB1Y,aAAc,MAAOD,OAAQ,gCAAkC9C,UAAU,kBAAiBO,SAAA,EAC9JC,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEnC,MAAO,qBAAsB0C,aAAc,OAAS1F,UAAU,eAAcO,SAAC,mBAC3FC,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEQ,WAAY,MAAOzC,SAAU,UAAWF,MAAO,WAAYzC,SACtE,IAAIJ,KAAK2V,GAAa8E,sBAAsBC,iBAAiB4B,cAAcra,0BAIjFwR,GAAe8I,kBACdpc,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEC,QAAS,MAAOqW,gBAAiB,sBAAuB1Y,aAAc,MAAOD,OAAQ,+BAAgCsZ,WAAY,UAAYpc,UAAU,kBAAiBO,SAAA,EACpLC,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEnC,MAAO,qBAAsB0C,aAAc,OAAS1F,UAAU,eAAcO,SAAC,iBAC3FD,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEQ,WAAY,MAAOzC,SAAU,UAAWF,MAAO,WAAYzC,SAAA,CACtE,IAAIJ,KAAKyT,GAAe8I,iBAAiBtc,iBACzC,MACC,MAAMuc,EAAU,IAAIxc,KAAKyT,GAAe8I,iBAElCE,GADM,IAAIzc,MACGoY,UAAYoE,EAAQpE,UACjCsE,EAAWvQ,KAAKwQ,MAAMF,EAAS,KAC/BG,EAAYzQ,KAAKwQ,MAAMD,EAAW,IAClCG,EAAW1Q,KAAKwQ,MAAMC,EAAY,IACxC,OAAIF,EAAW,EAAU,mBACrBA,EAAW,GAAU,WAAN9W,OAAa8W,EAAQ,SACpCE,EAAY,GAAU,WAANhX,OAAagX,EAAS,SACpC,WAANhX,OAAaiX,EAAQ,QACtB,EAXA,SAeNpJ,GAAeqJ,sBAAwBrJ,GAAe8I,kBACrDpc,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEC,QAAS,MAAOqW,gBAAiB,sBAAuB1Y,aAAc,MAAOD,OAAQ,+BAAgCsZ,WAAY,UAAYpc,UAAU,kBAAiBO,SAAA,EACpLC,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEnC,MAAO,qBAAsB0C,aAAc,OAAS1F,UAAU,eAAcO,SAAC,oBAC3FD,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEQ,WAAY,MAAO3C,MAAO,WAAYzC,SAAA,CACjD+L,KAAKmC,OAAO,IAAItO,KAAKyT,GAAe8I,iBAAiBnE,UAAY,IAAIpY,KAAKyT,GAAeqJ,sBAAsB1E,WAAa,KAAM,YACnI/X,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEnC,MAAO,qBAAsBmD,WAAY,MAAOjD,SAAU,WAAalD,UAAU,eAAcO,SAAC,+CAS3HD,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACEC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,qBACRC,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEc,OAAQ,SAAU1F,SAC3BqT,GAAesJ,eACZ,IAAI/c,KAAKyT,GAAesJ,gBAAgB9a,qBACxC,YAGR9B,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACEC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,iBACRC,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEc,OAAQ,SAAU1F,SAAEqT,GAAeuJ,qBAAuB,UAExE3c,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEiX,WAAY,UAAW7b,UACnCD,EAAAA,EAAAA,MAAA,SAAO6E,MAAO,CAAEI,QAAS,OAAQE,WAAY,SAAU+H,IAAK,OAAQO,OAAQ,WAAYxN,SAAA,EACtFC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,WACLmP,QAASxJ,GAAeyJ,eAAgB,EACxCzP,SAAWC,GAlUJ9F,OAAOgP,EAAauG,KAC3C,UACQ3U,EAAAA,EAAW4U,iBAAiBxG,EAAO5N,GAAImU,GAC7CzJ,IAAiB2J,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIzG,GAAM,IAAEsG,aAAcC,KAC7CtH,IACF,CAAE,MAAOhN,GACP6N,QAAQzP,MAAM,qBAAsB4B,GACpC3B,EAAS2B,aAAeC,MAAQD,EAAIE,QAAU,+BAChD,GA0TiCuU,CAAiB7J,GAAgB/F,EAAEC,OAAOsP,YAE7D5c,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,wBACRC,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEjC,SAAU,WAAYF,MAAO,8BAA+BzC,SAAC,uDAStFD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,mBAAmBmF,MAAO,CAAEqI,IAAK,uBAAwBE,UAAW,QAASnN,SAAA,EAC1FD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,OAAMO,SAAA,EACnBC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,kBACHmT,KAAkBlT,EAAAA,EAAAA,KAAA,KAAGR,UAAU,QAAOO,SAAEmT,MACvCA,KAAmBN,IAAU5S,EAAAA,EAAAA,KAAA,KAAAD,SAAG,6BACjC6S,IACC9S,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACED,EAAAA,EAAAA,MAAA,KAAAC,SAAA,EAAGC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,aAAiB,IAAE6S,EAAOsK,mBACrCpd,EAAAA,EAAAA,MAAA,KAAAC,SAAA,EAAGC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,aAAiB,IAAE6S,EAAOuK,eAAe,IAAEvK,EAAOwK,cAAc,cAC3Etd,EAAAA,EAAAA,MAAA,KAAAC,SAAA,EAAGC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,sBAA0B,IAAE6S,EAAOyK,uBAAuBzd,2BAK3EE,EAAAA,EAAAA,MAAA,OAAKN,UAAU,OAAMO,SAAA,EACnBC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,uBACHmT,KAAkBlT,EAAAA,EAAAA,KAAA,KAAGR,UAAU,QAAOO,SAAEmT,MACvCA,KAAmBJ,IAAoB9S,EAAAA,EAAAA,KAAA,KAAAD,SAAG,yBAC3C+S,IACChT,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACED,EAAAA,EAAAA,MAAA,KAAAC,SAAA,EAAGC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,kBAAsB,IAAEya,EAAgBla,OAAOV,qBAC1DE,EAAAA,EAAAA,MAAA,KAAAC,SAAA,EAAGC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,gBAAoB,IAAE,IAAI8R,IAAI2I,EAAgB3P,IAAK4P,GAAUA,EAAM6C,YAAYrF,SAC1FnY,EAAAA,EAAAA,MAAA,KAAAC,SAAA,EAAGC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,YAAgB,IAAE2a,EAAkB,IAAI/a,KAAK+a,GAAiB9a,iBAAmB,mBAOpGE,EAAAA,EAAAA,MAAA,OAAKN,UAAU,OAAOmF,MAAO,CAAEuI,UAAW,QAASnN,SAAA,EACjDD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,cAAaO,SAAA,EAC1BC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,wBACFoU,KACAnU,EAAAA,EAAAA,KAAA,UAAQR,UAAU,MAAMkO,QAASA,KAE7B8G,GADEP,GACU,CACVQ,QAASR,GAAYQ,QACrBC,aAAcT,GAAYS,aAC1BC,SAAU4I,OAAOtJ,GAAYU,UAC7BC,UAAW2I,OAAOtJ,GAAYW,WAC9BC,YAAa0I,OAAOtJ,GAAYY,aAChCC,SAAUyI,OAAOtJ,GAAYa,UAC7BC,YAAawI,OAAOtJ,GAAYc,aAChCC,SAAUf,GAAYe,SACtBC,UAAWhB,GAAYgB,WAGb,CAAER,QAAS,GAAIC,aAAc,GAAIC,SAAU,GAAIC,UAAW,GAAIC,YAAa,GAAIC,SAAU,KAAMC,YAAa,MAAOC,SAAU,eAAgBC,WAAW,IAEtKI,GAAa,MACbf,IAAe,IACfvU,SACCkU,GAAc,YAAc,iBAInCjU,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEC,QAAS,QAAS7E,SAC7BoU,IACCnU,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEnC,MAAO,qBAAsBzC,SAAC,+BACvCkU,IAGHnU,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEI,QAAS,OAAQwW,oBAAqB,iBAAkBvO,IAAK,QAASjN,SAAA,EAClFD,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EAAKC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,cAAiBC,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEc,OAAQ,QAASH,WAAY,4BAA6B5C,SAAU,UAAWF,MAAO,WAAYzC,SAAEkU,GAAYQ,cAC1J3U,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EAAKC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,mBAAsBC,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEc,OAAQ,SAAU1F,SAAEkU,GAAYS,cAAgB,eAC/F5U,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EAAKC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,aAAgBC,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEc,OAAQ,SAAU1F,UAACC,EAAAA,EAAAA,KAAA,QAAMR,UAAWyU,GAAYgB,UAAY,oCAAsC,mCAAmClV,SAAEkU,GAAYgB,UAAY,SAAW,mBACnNnV,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EAAKC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,eAAkBD,EAAAA,EAAAA,MAAA,KAAG6E,MAAO,CAAEc,OAAQ,QAASH,WAAY,4BAA6B5C,SAAU,WAAY3C,SAAA,CAAEkU,GAAYU,SAAS,cAClJ7U,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EAAKC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,gBAAmBD,EAAAA,EAAAA,MAAA,KAAG6E,MAAO,CAAEc,OAAQ,QAASH,WAAY,4BAA6B5C,SAAU,WAAY3C,SAAA,CAAEkU,GAAYW,UAAU,cACpJ9U,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EAAKC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,eAAkBC,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEc,OAAQ,SAAU1F,SAAEkU,GAAYe,eAC3ElV,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EAAKC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,eAAkBD,EAAAA,EAAAA,MAAA,KAAG6E,MAAO,CAAEc,OAAQ,QAASH,WAAY,6BAA8BvF,SAAA,CAAEkU,GAAYY,YAAY,aAChI/U,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EAAKC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,WAAcD,EAAAA,EAAAA,MAAA,KAAG6E,MAAO,CAAEc,OAAQ,QAASH,WAAY,6BAA8BvF,SAAA,CAAEkU,GAAYa,SAAS,cACzHhV,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EAAKC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,cAAiBD,EAAAA,EAAAA,MAAA,KAAG6E,MAAO,CAAEc,OAAQ,QAASH,WAAY,6BAA8BvF,SAAA,CAAEkU,GAAYc,YAAY,iBAXjI/U,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEnC,MAAO,oBAAqBE,SAAU,UAAW3C,SAAC,iDAkBnEkU,KACCjU,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEuI,UAAW,QAASnN,UAChCC,EAAAA,EAAAA,KAACwd,EAAa,CAACtX,OAAQ+N,GAAYQ,QAAStO,aAAW,OAK3DrG,EAAAA,EAAAA,MAAA,OAAKN,UAAU,OAAOmF,MAAO,CAAEuI,UAAW,OAAQhI,aAAc,QAASnF,SAAA,EACvED,EAAAA,EAAAA,MAAA,OAAKN,UAAU,cAAaO,SAAA,EAC1BC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,iBACJC,EAAAA,EAAAA,KAAA,UAAQ0N,QAASA,IAAMuI,GAAgB7C,GAAezK,IAAKnJ,UAAU,MAAMie,SAAUjK,GAAYzT,SAC9FyT,GAAc,aAAe,6BAGlC1T,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEC,QAAS,QAAS7E,SAAA,EAC5BqT,GAAeyJ,eACf7c,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEnC,MAAO,6BAA8Bkb,UAAW,UAAW3d,SAAC,sFAInD,IAAtBuT,GAAWhT,QAAgB8S,GAAeyJ,eAAiBrJ,KAC1DxT,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEnC,MAAO,8BAA+BzC,SAAC,oEAIpDyT,KACCxT,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEnC,MAAO,8BAA+BzC,SAAC,oBAIpDuT,GAAWhT,OAAS,IACnBN,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CACVgZ,UAAW,QACXC,UAAW,OACXtY,WAAY,4BACZ5C,SAAU,UACVuY,gBAAiB,UACjBrW,QAAS,OACTrC,aAAc,OACdxC,SACCuT,GAAWzI,IAAKgT,IACf/d,EAAAA,EAAAA,MAAA,OAAkB6E,MAAO,CACvBO,aAAc,MACd4Y,cAAe,MACfC,aAAc,iBACdvb,MAAqB,UAAdqb,EAAIG,MAAoB,UACV,YAAdH,EAAIG,MAAsB,UACZ,SAAdH,EAAIG,MAAmB,UAAY,WAC1Cje,SAAA,EACAD,EAAAA,EAAAA,MAAA,QAAM6E,MAAO,CAAEnC,MAAO,QAASzC,SAAA,CAAC,IAAE,IAAIJ,KAAKke,EAAI5T,WAAWrK,iBAAiB,QAC3EE,EAAAA,EAAAA,MAAA,QAAM6E,MAAO,CAAEQ,WAAY,OAAQQ,WAAY,OAAQ5F,SAAA,CAAC,IAAE8d,EAAIG,MAAM,QACpEhe,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEgB,WAAY,OAAQ5F,SAAE8d,EAAInV,YAVjCmV,EAAIlV,aAmBvB0L,KACCrU,EAAAA,EAAAA,KAAA,OAAKR,UAAU,QAAOO,UACpBD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,gBAAeO,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,MAAAD,SAAKkU,GAAW,cAAA1O,OAAiB0O,GAAYQ,SAAY,4BACzD3U,EAAAA,EAAAA,MAAA,QAAMme,SAAU1W,UACd8F,EAAE6Q,iBACF/I,IAAc,GACdE,GAAa,MACb,IACE,MAAM8I,EAAU,CACd1J,QAASF,GAASE,QAAQmE,OAC1BlE,aAAcH,GAASG,aAAakE,OACpCjE,SAAUyJ,WAAW7J,GAASI,UAC9BC,UAAWwJ,WAAW7J,GAASK,WAC/BC,YAAauJ,WAAW7J,GAASM,aACjCC,SAAUsJ,WAAW7J,GAASO,UAC9BC,YAAaqJ,WAAW7J,GAASQ,aACjCC,SAAUT,GAASS,SAAS4D,OAC5B3D,UAAWV,GAASU,WAGtB,IAAIoJ,EAOJ,GALEA,EADEpK,SACc9L,EAAAA,EAAWmW,iBAAiBlL,GAAezK,GAAIwV,SAE/ChW,EAAAA,EAAWoW,iBAAiBnL,GAAezK,GAAIwV,IAG5DE,IAAYA,EAAQ5J,QACvB,MAAM,IAAIhM,MAAM,yDAGlByL,GAAemK,GACf/J,IAAe,GACfa,IAAc,GAGTlB,IACH9S,WAAW,KACTgH,EAAAA,EAAWwO,cAAcvD,GAAezK,IACrCiO,KAAKnN,IAAcA,GAAMyK,GAAezK,KACxCoN,MAAMrO,GAAO6N,QAAQzP,MAAM,2BAA4B4B,KACzD,IAEP,CAAE,MAAOA,GACP6M,GAAa7M,EAAIE,SAAW,uBAC5ByM,IAAc,EAChB,GACApV,SAAA,EACAD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,CACxBqV,KACCpV,EAAAA,EAAAA,KAAA,KAAG2E,MAAO,CAAEnC,MAAO,+BAAgCE,SAAU,WAAYwC,aAAc,QAASnF,SAAEqV,MAGpGtV,EAAAA,EAAAA,MAAA,OAAKN,UAAU,eAAcO,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,MAAIR,UAAU,qBAAoBO,SAAC,oBACnCD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,wBAAuBO,SAAA,EACpCD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,eACPC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,OACL+Q,UAAQ,EACRla,MAAOiQ,GAASE,QAChBgJ,WAAYxJ,GACZ7G,SAAUC,GAAKmH,IAAWwI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIzI,IAAQ,IAAEE,QAASpH,EAAEC,OAAOhJ,SAC5Dma,YAAY,sBACZC,aAAa,UAEZzK,KAAejU,EAAAA,EAAAA,KAAA,SAAOR,UAAU,YAAWO,SAAC,kDAEjDD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,kBACPC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,OACLnJ,MAAOiQ,GAASG,aAChBtH,SAAUC,GAAKmH,IAAWwI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIzI,IAAQ,IAAEG,aAAcrH,EAAEC,OAAOhJ,SACjEma,YAAY,sBACZC,aAAa,kBAMrB5e,EAAAA,EAAAA,MAAA,OAAKN,UAAU,eAAcO,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,MAAIR,UAAU,qBAAoBO,SAAC,cACnCD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,wBAAuBO,SAAA,EACpCD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,gBACPC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,SACL+Q,UAAQ,EACRG,KAAK,MACLra,MAAOiQ,GAASI,SAChBvH,SAAUC,GAAKmH,IAAWwI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIzI,IAAQ,IAAEI,SAAUtH,EAAEC,OAAOhJ,SAC7Dma,YAAY,gBAGhB3e,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,iBACPC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,SACL+Q,UAAQ,EACRG,KAAK,MACLra,MAAOiQ,GAASK,UAChBxH,SAAUC,GAAKmH,IAAWwI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIzI,IAAQ,IAAEK,UAAWvH,EAAEC,OAAOhJ,SAC9Dma,YAAY,gBAGhB3e,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,cACPC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,OACLnJ,MAAOiQ,GAASS,SAChB5H,SAAUC,GAAKmH,IAAWwI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIzI,IAAQ,IAAES,SAAU3H,EAAEC,OAAOhJ,SAC7Dma,YAAY,eACZC,aAAa,kBAMrB5e,EAAAA,EAAAA,MAAA,OAAKN,UAAU,eAAcO,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,MAAIR,UAAU,qBAAoBO,SAAC,yBACnCD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,wBAAuBO,SAAA,EACpCD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,qBACPC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,SACL+Q,UAAQ,EACRG,KAAK,MACLra,MAAOiQ,GAASM,YAChBzH,SAAUC,GAAKmH,IAAWwI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIzI,IAAQ,IAAEM,YAAaxH,EAAEC,OAAOhJ,SAChEma,YAAY,YAGhB3e,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,iBACPC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,SACLkR,KAAK,MACLra,MAAOiQ,GAASO,SAChB1H,SAAUC,GAAKmH,IAAWwI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIzI,IAAQ,IAAEO,SAAUzH,EAAEC,OAAOhJ,eAGjExE,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,oBACPC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,SACLkR,KAAK,MACLra,MAAOiQ,GAASQ,YAChB3H,SAAUC,GAAKmH,IAAWwI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIzI,IAAQ,IAAEQ,YAAa1H,EAAEC,OAAOhJ,kBAItEtE,EAAAA,EAAAA,KAAA,OAAKR,UAAU,aAAYO,UACzBD,EAAAA,EAAAA,MAAA,SAAO6E,MAAO,CAAEI,QAAS,OAAQE,WAAY,SAAU+H,IAAK,MAAOO,OAAQ,WAAYxN,SAAA,EACrFC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,WACL9E,GAAG,kBACHiU,QAASrI,GAASU,UAClB7H,SAAUC,GAAKmH,IAAWwI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIzI,IAAQ,IAAEU,UAAW5H,EAAEC,OAAOsP,WAC9DjY,MAAO,CAAE/B,MAAO,OAAQC,OAAQ,UAChC,qBAOV/C,EAAAA,EAAAA,MAAA,OAAKN,UAAU,eAAemF,MAAO,CAAEC,QAAS,oBAAqB7E,SAAA,EACnEC,EAAAA,EAAAA,KAAA,UAAQyN,KAAK,SAASjO,UAAU,MAAMie,SAAUvI,GAAWnV,SACxDmV,GAAa,eAAYjB,GAAc,eAAiB,cAE3DjU,EAAAA,EAAAA,KAAA,UAAQyN,KAAK,SAASjO,UAAU,oBAAoBkO,QAASA,IAAM4G,IAAe,GAAQmJ,SAAUvI,GAAWnV,SAAC,sBASzH8Q,IACC7Q,EAAAA,EAAAA,KAAA,OAAKR,UAAU,QAAOO,UACpBD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,gBAAeO,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,MAAAD,SAAK8Q,EAAa,gBAAAtL,OAAmBsL,EAAc+C,eAAkB,yBACrE9T,EAAAA,EAAAA,MAAA,QAAMme,SAAW5Q,IAAQA,EAAE6Q,iBAAkBrN,EAAgB8I,KAAeE,MAAkB9Z,SAAA,EAC5FD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EAGzBD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,eAAcO,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,MAAIR,UAAU,qBAAoBO,SAAC,qBACnCC,EAAAA,EAAAA,KAAA,OAAKR,UAAU,YAAWO,UACxBD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,0BACPC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,OACLnJ,MAAOuM,EAAgB6C,GAASE,cAAgBG,GAAWH,cAC3DxG,SAAWC,GAAMwD,EAAgB8C,IAAWqJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGtJ,IAAQ,IAAEE,cAAevG,EAAEC,OAAOhJ,SAAU0P,IAAagJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGjJ,IAAU,IAAEH,cAAevG,EAAEC,OAAOhJ,SACnJka,UAAQ,EACRE,aAAa,MACbD,YAAY,yBAOpB3e,EAAAA,EAAAA,MAAA,OAAKN,UAAU,eAAcO,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,MAAIR,UAAU,qBAAoBO,SAAC,4BACnCC,EAAAA,EAAAA,KAAA,OAAKR,UAAU,YAAWO,UACxBD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,mBACPD,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEia,SAAU,YAAclR,QAAUL,GAAMA,EAAEwR,kBAAkB9e,SAAA,EACxEC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,OACLgR,YAAY,wCACZna,MAAO6M,EACP/D,SAAWC,IACT+D,EAAkB/D,EAAEC,OAAOhJ,OAC3BkN,GAAoB,IAEtBsN,QAASA,IAAMtN,GAAoB,GACnCkN,aAAa,MACblf,UAAU,eAEX+R,IACCvR,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CACVia,SAAU,WACVvQ,IAAK,OACLE,KAAM,IACND,MAAO,IACPjM,WAAY,+BACZC,OAAQ,0DACRC,aAAc,MACd2K,UAAW,MACXyQ,UAAW,QACXC,UAAW,OACXmB,OAAQ,GACRtc,UAAW,iCACX1C,SACCsR,EAAc/Q,OAAS,EACtB+Q,EAAcxG,IAAKgJ,IACjB/T,EAAAA,EAAAA,MAAA,OAEE4N,QAASA,KACHmD,EACF8C,IAAWqJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGtJ,IAAQ,IAAEG,KAAMA,EAAKsF,YAErCnF,IAAagJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGjJ,IAAU,IAAEF,KAAMA,EAAKsF,YAE3C/H,EAAkB,GAAD7L,OAAIsO,EAAKoF,WAAU,KAAA1T,OAAIsO,EAAKqF,UAAS,MAAA3T,OAAKsO,EAAKsF,SAAQ,MACxE3H,GAAoB,IAEtB7M,MAAO,CACLC,QAAS,YACT2I,OAAQ,UACRwQ,aAAc,0DACd1b,YAAawO,EAAgB6C,GAASG,KAAOE,GAAWF,QAAUA,EAAKsF,SAAW,2BAA6B,cAC/G3W,MAAO,+BACPwc,WAAY,iBACZtc,SAAU,YAEZuc,aAAe5R,GAAMA,EAAE6R,cAAcva,MAAMtC,WAAa,4BACxD8c,aAAe9R,GAAMA,EAAE6R,cAAcva,MAAMtC,YAAcwO,EAAgB6C,GAASG,KAAOE,GAAWF,QAAUA,EAAKsF,SAAW,2BAA6B,cAAcpZ,SAAA,CAExK8T,EAAKoF,WAAW,IAAEpF,EAAKqF,UAAU,KAAGrF,EAAKsF,SAAS,MAAEnZ,EAAAA,EAAAA,KAAA,UACrDA,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEjC,SAAU,UAAWF,MAAO,kCAAmCzC,SAAE8T,EAAKuF,UAvBhFvF,EAAKlL,MA2Bd3I,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEC,QAAS,YAAapC,MAAO,6BAA8BE,SAAU,YAAa3C,SACnE,KAA1BoR,EAAeyH,OAAgB,kCAAoC,iCAWpF9Y,EAAAA,EAAAA,MAAA,OAAKN,UAAU,eAAcO,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,MAAIR,UAAU,qBAAoBO,SAAC,mBACnCD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,wBAAuBO,SAAA,EACpCD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,qBACPD,EAAAA,EAAAA,MAAA,UACEwE,MAAOuM,EAAgB6C,GAASI,eAAiBC,GAAWD,eAC5D1G,SAAWC,GAAMwD,EAAgB8C,IAAWqJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAItJ,IAAQ,IAAEI,eAAgBzG,EAAEC,OAAOhJ,SAAW0P,IAAagJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIjJ,IAAU,IAAED,eAAgBzG,EAAEC,OAAOhJ,SACxJ9E,UAAU,aAAYO,SAAA,EAEtBC,EAAAA,EAAAA,KAAA,UAAQsE,MAAM,GAAEvE,SAAC,+BAChB2S,IAAkB1S,EAAAA,EAAAA,KAAA,UAAQsE,MAAM,GAAGmZ,UAAQ,EAAA1d,SAAC,wBAC3C2S,GAAkBF,EAAQ3H,IAAK2L,IAC/B1W,EAAAA,EAAAA,MAAA,UAAwBwE,MAAO2V,GAAkBzD,GAAQzW,SAAA,CACtDyW,EAAO9G,KAAK,KAAGuK,GAAkBzD,IAAW,QAAQ,MAD1CA,EAAO7N,SAKxB3I,EAAAA,EAAAA,KAAA,SAAOR,UAAU,YAAWO,SAAC,6DAE/BD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,uBACPC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,OACLnJ,MAAOuM,EAAgB6C,GAASI,eAAiBC,GAAWD,eAC5D1G,SAAWC,GAAMwD,EAAgB8C,IAAWqJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGtJ,IAAQ,IAAEI,eAAgBzG,EAAEC,OAAOhJ,SAAU0P,IAAagJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGjJ,IAAU,IAAED,eAAgBzG,EAAEC,OAAOhJ,SACrJoa,aAAa,MACbD,YAAY,iCAOrB5N,IACC7Q,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEC,QAAS,UAAW7E,UAC/BC,EAAAA,EAAAA,KAACd,EAAAA,EAAU,CACTE,UAAWyR,EAAc8L,oBACzBtd,UAAWwR,EAAcuO,WACzB9f,UAAWuR,EAAcwO,oBACzB9f,UAAWsR,EAAcyO,gBAIhCxf,EAAAA,EAAAA,MAAA,OAAKN,UAAU,eAAemF,MAAO,CAAEC,QAAS,oBAAqB7E,SAAA,EACnEC,EAAAA,EAAAA,KAAA,UAAQyN,KAAK,SAASjO,UAAU,MAAKO,SAAE8Q,EAAgB,eAAiB,mBACxE7Q,EAAAA,EAAAA,KAAA,UAAQyN,KAAK,SAASC,QAASqM,GAAcva,UAAU,oBAAmBO,SAAC,wBAQ3F,CAEA,OACED,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACEC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,uBAEJD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,OAAMO,SAAA,EACnBD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,cAAaO,SAAA,EAC1BD,EAAAA,EAAAA,MAAA,MAAAC,SAAA,CAAI,YAAU4Q,EAAgBrQ,OAAO,QACrCR,EAAAA,EAAAA,MAAA,OAAKN,UAAU,eAAcO,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,OACLgR,YAAY,oBACZna,MAAO2M,EACP7D,SA15BUC,IACpB,MAAMiM,EAAQjM,EAAEC,OAAOhJ,MACvB4M,EAAcoI,GACdrH,EAAe,GACfoH,GAAgBC,IAu5BN9Z,UAAU,iBAEXmS,EAAgBsG,KAAO,IACtBjY,EAAAA,EAAAA,KAAA,UACE0N,QA9xBWnG,UACvB,GAA6B,IAAzBoK,EAAgBsG,KAElB,YADApR,EAAS,oCAIX,MAAM0Y,EAAaxe,MAAM4J,KAAKgH,GAC3B9G,IAAIlC,GAAM8H,EAAQgG,KAAKzS,GAAKA,EAAE2E,KAAOA,IACrCe,OAAO8V,SAEJC,EAAc,mCAAAla,OAAsCoM,EAAgBsG,KAAI,mBAAA1S,OAAkBga,EAAW1U,IAAI7G,GAAM,OAADA,QAAC,IAADA,OAAC,EAADA,EAAG4P,eAAe8L,KAAK,OAE3I,GAAI9E,OAAOC,QAAQ4E,GACjB,IACE1N,GAAqB,SACf5J,EAAAA,EAAWwX,kBAAkB5e,MAAM4J,KAAKgH,IAE9C,MAAMiO,EAAiBnP,EAAQ/G,OAAO1F,IAAM2N,EAAgBpH,IAAIvG,EAAE2E,KAClE+H,EAAWkP,GACXhP,EAAmBgP,EAAelW,OAAO1F,GACvCA,EAAE4P,cAAckF,cAAcnJ,SAASsB,EAAW6H,iBAEpDlH,EAAmB,IAAIC,KACvBE,GAAqB,EACvB,CAAE,MAAOvJ,GACPuJ,GAAqB,GACrBsE,QAAQzP,MAAM,qBAAsB4B,GACpC3B,EAAS2B,aAAeC,MAAQD,EAAIE,QAAU,2BAChD,GAmwBU+U,SAAU3L,EACVnN,MAAO,CACLtC,WAAY,+BACZG,MAAO,QACPF,OAAQ,OACRsC,QAAS,WACTrC,aAAc,MACdgL,OAAQuE,EAAoB,cAAgB,UAC5CpP,SAAU,WACVyC,WAAY,MACZ0a,QAAS/N,EAAoB,MAAQ,KACrC/R,SAED+R,EAAiB,YAAAvM,OAAeoM,EAAgBsG,KAAI,2BAAA1S,OAA4BoM,EAAgBsG,KAAI,QAGzGjY,EAAAA,EAAAA,KAAA,UAAQ0N,QAASA,KACfsD,GAAkB,GAClBI,EAAkB,IAClBI,GAAoB,IACnBhS,UAAU,MAAKO,SAAC,+BAKvBD,EAAAA,EAAAA,MAAA,SAAON,UAAU,QAAOO,SAAA,EACtBC,EAAAA,EAAAA,KAAA,SAAAD,UACED,EAAAA,EAAAA,MAAA,MAAAC,SAAA,EACEC,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,SAAU/K,MAAO,QAAS7C,UAChDC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,WACLmP,QAASjL,EAAgBsG,OAAStH,EAAgBrQ,QAAUqQ,EAAgBrQ,OAAS,EACrF8M,SAx0BQ0S,KACtB,GAAInO,EAAgBsG,OAAStH,EAAgBrQ,OAC3CsR,EAAmB,IAAIC,SAClB,CACL,MAAMkO,EAAS,IAAIlO,IAAIlB,EAAgB9F,IAAI7G,GAAKA,EAAE2E,KAClDiJ,EAAmBmO,EACrB,GAm0Bc7E,MAAM,oCAGVlb,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,UAAW5N,SAAC,mBACpCC,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,UAAW5N,SAAC,YACpCC,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,UAAW5N,SAAC,iBACpCC,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,UAAW5N,SAAC,WACpCC,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,UAAW5N,SAAC,iBACpCC,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,UAAW5N,SAAC,oBACpCC,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,UAAW5N,SAAC,oBACpCC,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,UAAW5N,SAAC,kBAGxCC,EAAAA,EAAAA,KAAA,SAAAD,SACG4Q,EAAgB9F,IAAK0L,IACpBzW,EAAAA,EAAAA,MAAA,MAEE4N,QAASA,IAAM4I,GAAiBC,GAChC5R,MAAO,CACLtC,WAAYsP,EAAgBpH,IAAIgM,EAAO5N,IAAM,0BAA4B,cACzE4E,OAAQ,WAEV/N,UAAU,gBAAeO,SAAA,EAEzBC,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,UAAW5N,UACjCC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,WACLmP,QAASjL,EAAgBpH,IAAIgM,EAAO5N,IACpCyE,SAAUA,IA/2BA+I,KAC1B,MAAM6J,EAAc,IAAInO,IAAIF,GACxBqO,EAAYzV,IAAI4L,GAClB6J,EAAYC,OAAO9J,GAEnB6J,EAAYE,IAAI/J,GAElBvE,EAAmBoO,IAw2BaG,CAAmB5J,EAAO5N,SAG9C3I,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,SAAUrI,WAAY,4BAA6B5C,SAAU,WAAY3C,SAAEwW,EAAO3C,iBAC1G5T,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,UAAW5N,UACjCC,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CACXI,QAAS,eACTH,QAAS,UACTrC,aAAc,OACdG,SAAU,UACVyC,WAAY,MACZ8V,gBAAiB1E,EAAOiF,UAAY,UAAY,UAChDhZ,MAAO+T,EAAOiF,UAAY,UAAY,WACtCzb,SACCwW,EAAOiF,UAAY,sBAAc,4BAGtCxb,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,SAAUrI,WAAY,4BAA6B5C,SAAU,UAAWF,MAAO+T,EAAOmF,MAAQ,UAAY,8BAA+B3b,SAAEwW,EAAOmF,OAAS,YACnL1b,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,SAAUjL,SAAU,YAAa3C,SAAEwW,EAAOoF,QAAS3b,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEnC,MAAO,8BAA+BzC,SAAC,cACjIC,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,UAAW5N,SAAEwW,EAAO1C,MAAQ,OACpD7T,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,UAAW5N,SAAEwW,EAAOzC,gBAAkB,OAC9D9T,EAAAA,EAAAA,KAAA,MAAI2E,MAAO,CAAEgJ,UAAW,UAAW5N,SAChC,MACC,IAAKwW,EAAOmG,eAAgB,MAAO,MACnC,MAAMlb,EAAO,IAAI7B,KAAK4W,EAAOmG,gBAC7B,OAAO5E,MAAMtW,EAAKuW,WAAa,eAAiBvW,EAAKI,oBACtD,EAJA,MAMH9B,EAAAA,EAAAA,MAAA,MAAI6E,MAAO,CAAEgJ,UAAW,UAAW5N,SAAA,EACjCC,EAAAA,EAAAA,KAAA,UACE0N,QAAUL,IACRA,EAAEwR,kBACFtF,GAAWhD,IAEb5R,MAAO,CAAEtC,WAAY,OAAQC,OAAQ,OAAQiL,OAAQ,UAAW/K,MAAO,iCAAkCiD,OAAQ,SACjHyV,MAAM,OAAMnb,UAEZD,EAAAA,EAAAA,MAAA,OAAK8C,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,OAAO,eAAeC,YAAY,IAAGlD,SAAA,EAC/FC,EAAAA,EAAAA,KAAA,QAAMgE,EAAE,gEACRhE,EAAAA,EAAAA,KAAA,QAAMgE,EAAE,kEAGZhE,EAAAA,EAAAA,KAAA,UACE0N,QAAUL,IACRA,EAAEwR,kBA19BDtX,WACnB,GAAIqT,OAAOC,QAAQ,0CAADtV,OAA2CgR,EAAO3C,cAAa,MAC/E,UACQzL,EAAAA,EAAWkT,aAAa9E,EAAO5N,IACrC,MAAMiX,EAAiBnP,EAAQ/G,OAAO1F,GAAKA,EAAE2E,KAAO4N,EAAO5N,IAC3D+H,EAAWkP,GACXhP,EAAmBgP,EACrB,CAAE,MAAOpX,GACP6N,QAAQzP,MAAM,gBAAiB4B,GAC/B3B,EAAS2B,aAAeC,MAAQD,EAAIE,QAAU,0BAChD,GAi9BgB0X,CAAa7J,IAEf5R,MAAO,CAAEtC,WAAY,OAAQC,OAAQ,OAAQiL,OAAQ,UAAW/K,MAAO,+BAAgCiD,OAAQ,SAC/GyV,MAAM,SAAQnb,UAEdD,EAAAA,EAAAA,MAAA,OAAK8C,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,OAAO,eAAeC,YAAY,IAAGlD,SAAA,EAC/FC,EAAAA,EAAAA,KAAA,YAAUiE,OAAO,kBACjBjE,EAAAA,EAAAA,KAAA,QAAMgE,EAAE,oFACRhE,EAAAA,EAAAA,KAAA,QAAMuD,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,QACjC1D,EAAAA,EAAAA,KAAA,QAAMuD,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,iBAlElC6S,EAAO5N,UA4EnByJ,EAAa,IACZtS,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CACVI,QAAS,OACTC,eAAgB,gBAChBC,WAAY,SACZL,QAAS,OACTyb,UAAW,0DACXrT,IAAK,QACLjN,SAAA,EACAD,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEjC,SAAU,WAAYF,MAAO,kCAAmCzC,SAAA,CAAC,YAClEiS,EAAc,GAAKE,EAAY,EAAE,MAAIpG,KAAKwU,IAAItO,EAAcE,EAAUE,GAAY,OAAKA,EAAW,eAG/GtS,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEI,QAAS,OAAQiI,IAAK,MAAO/H,WAAY,UAAWlF,SAAA,EAChEC,EAAAA,EAAAA,KAAA,UACE0N,QAASA,IAAMuE,EAAenG,KAAKC,IAAI,EAAGiG,EAAc,IACxDyL,SAA0B,IAAhBzL,EACVrN,MAAO,CACLC,QAAS,WACTtC,OAAQ,0DACRC,aAAc,MACdF,WAA4B,IAAhB2P,EAAoB,2BAA6B,cAC7DxP,MAAO,+BACP+K,OAAwB,IAAhByE,EAAoB,cAAgB,UAC5C6N,QAAyB,IAAhB7N,EAAoB,MAAQ,KACrCjS,SACH,qBAIDC,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEI,QAAS,OAAQiI,IAAK,MAAO/H,WAAY,UAAWlF,SAC/D,MACC,MAAMwgB,EAAQ,GAEd,IAAK,IAAI3W,EAAI,EAAGA,GAAK0I,EAAY1I,IAAK,CAAC,IAAD4W,EAEb,IAAN5W,GAAWA,IAAM0I,GAAcxG,KAAK2U,IAAI7W,EAAIoI,IAAgB,EAG3EuO,EAAM7V,MACJ1K,EAAAA,EAAAA,KAAA,UAEE0N,QAASA,IAAMuE,EAAerI,GAC9BjF,MAAO,CACLC,QAAS,WACTtC,OAAQ,0DACRC,aAAc,MACdF,WAAYuH,IAAMoI,EAAc,0BAA4B,cAC5DxP,MAAO,+BACP+K,OAAQ,UACRpI,WAAYyE,IAAMoI,EAAc,OAAS,SACzClN,SAAU,QACV/E,SAED6J,GAbIA,KAgBuB,QAAvB4W,EAAAD,EAAMA,EAAMjgB,OAAS,UAAE,IAAAkgB,OAAA,EAAvBA,EAAyBE,OAAQ,YAAc5U,KAAKwQ,MAAM1S,EAAI,KAEvE2W,EAAM7V,MACJ1K,EAAAA,EAAAA,KAAA,QAA6C2E,MAAO,CAAEC,QAAS,QAASpC,MAAO,kCAAmCzC,SAAC,OAEnH,YAAAwF,OAFuBuG,KAAKwQ,MAAM1S,EAAI,MAK5C,CAEA,OAAO2W,CACR,EArCA,MAwCHvgB,EAAAA,EAAAA,KAAA,UACE0N,QAASA,IAAMuE,EAAenG,KAAKwU,IAAIhO,EAAYN,EAAc,IACjEyL,SAAUzL,IAAgBM,EAC1B3N,MAAO,CACLC,QAAS,WACTtC,OAAQ,0DACRC,aAAc,MACdF,WAAY2P,IAAgBM,EAAa,2BAA6B,cACtE9P,MAAO,+BACP+K,OAAQyE,IAAgBM,EAAa,cAAgB,UACrDuN,QAAS7N,IAAgBM,EAAa,MAAQ,KAC9CvS,SACH,oBAKHD,EAAAA,EAAAA,MAAA,UACEwE,MAAO4N,EACP9E,SAAWC,IACT8E,EAAYmG,SAASjL,EAAEC,OAAOhJ,QAC9B2N,EAAe,IAEjBtN,MAAO,CACLC,QAAS,MACTtC,OAAQ,0DACRC,aAAc,MACdF,WAAY,6BACZG,MAAO,+BACP+K,OAAQ,UACR7K,SAAU,YACV3C,SAAA,EAEFC,EAAAA,EAAAA,KAAA,UAAQsE,MAAO,GAAGvE,SAAC,iBACnBC,EAAAA,EAAAA,KAAA,UAAQsE,MAAO,GAAGvE,SAAC,iBACnBC,EAAAA,EAAAA,KAAA,UAAQsE,MAAO,GAAGvE,SAAC,iBACnBC,EAAAA,EAAAA,KAAA,UAAQsE,MAAO,IAAIvE,SAAC,2BAM1B8Q,GAAiBE,KACjB/Q,EAAAA,EAAAA,KAAA,OAAKR,UAAU,QAAOO,UACpBD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,gBAAeO,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,MAAAD,SAAK8Q,EAAa,gBAAAtL,OAAmBsL,EAAc+C,eAAkB,yBACrE9T,EAAAA,EAAAA,MAAA,QAAMme,SAAW5Q,IAAQA,EAAE6Q,iBAAkBrN,EAAgB8I,KAAeE,MAAkB9Z,SAAA,EAC5FD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EAGzBD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,eAAcO,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,MAAIR,UAAU,qBAAoBO,SAAC,qBACnCC,EAAAA,EAAAA,KAAA,OAAKR,UAAU,YAAWO,UACxBD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,0BACPC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,OACLnJ,MAAOuM,EAAgB6C,GAASE,cAAgBG,GAAWH,cAC3DxG,SAAWC,GAAMwD,EAAgB8C,IAAWqJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGtJ,IAAQ,IAAEE,cAAevG,EAAEC,OAAOhJ,SAAU0P,IAAagJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGjJ,IAAU,IAAEH,cAAevG,EAAEC,OAAOhJ,SACnJka,UAAQ,EACRE,aAAa,MACbD,YAAY,yBAOpB3e,EAAAA,EAAAA,MAAA,OAAKN,UAAU,eAAcO,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,MAAIR,UAAU,qBAAoBO,SAAC,4BACnCC,EAAAA,EAAAA,KAAA,OAAKR,UAAU,YAAWO,UACxBD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,mBACPD,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEia,SAAU,YAAclR,QAAUL,GAAMA,EAAEwR,kBAAkB9e,SAAA,EACxEC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,OACLgR,YAAY,4BACZna,MAAO6M,EACP/D,SAAWC,IACT+D,EAAkB/D,EAAEC,OAAOhJ,OAC3BkN,GAAoB,IAEtBsN,QAASA,IAAMtN,GAAoB,GACnCkN,aAAa,SAEb7N,EAAgB6C,GAASG,KAAOE,GAAWF,QAC3C/T,EAAAA,EAAAA,MAAA,OAAK6E,MAAO,CAAEuI,UAAW,MAAOxK,SAAU,WAAYF,MAAO,kCAAmCzC,SAAA,EAC9FC,EAAAA,EAAAA,KAAA,UAAAD,SAAQ,cAAkB,IAAmF,QAAlFsQ,EAACoB,EAAMgF,KAAKiD,GAAKA,EAAEP,YAActI,EAAgB6C,GAASG,KAAOE,GAAWF,cAAM,IAAAxD,OAAA,EAAjFA,EAAmF4I,WAAW,IAAmF,QAAlF3I,EAACmB,EAAMgF,KAAKiD,GAAKA,EAAEP,YAActI,EAAgB6C,GAASG,KAAOE,GAAWF,cAAM,IAAAvD,OAAA,EAAjFA,EAAmF4I,UAAU,KAAGrI,EAAgB6C,GAASG,KAAOE,GAAWF,KAAK,KAC5Q7T,EAAAA,EAAAA,KAAA,UACEyN,KAAK,SACLC,QAASA,KACHmD,EACF8C,IAAWqJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGtJ,IAAQ,IAAEG,KAAM,MAEhCG,IAAagJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGjJ,IAAU,IAAEF,KAAM,MAEtCzC,EAAkB,KAEpB5R,UAAU,2BACVmF,MAAO,CAAEgB,WAAY,QACrBuV,MAAM,oBAAmBnb,SAC1B,cAKJwR,IACCvR,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CACVia,SAAU,WACVvQ,IAAK,OACLE,KAAM,EACND,MAAO,EACPjM,WAAY,+BACZC,OAAQ,0DACRC,aAAc,MACdob,UAAW,QACXC,UAAW,OACXmB,OAAQ,IACRtc,UAAW,mBACXyK,UAAW,OACXnN,SACCsR,EAAc/Q,OAAS,EACtB+Q,EAAcxG,IAAKgJ,IACjB/T,EAAAA,EAAAA,MAAA,OAEE4N,QAASA,KACHmD,EACF8C,IAAWqJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGtJ,IAAQ,IAAEG,KAAMA,EAAKsF,YAErCnF,IAAagJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGjJ,IAAU,IAAEF,KAAMA,EAAKsF,YAE3C/H,EAAkB,GAAD7L,OAAIsO,EAAKoF,WAAU,KAAA1T,OAAIsO,EAAKqF,UAAS,MAAA3T,OAAKsO,EAAKsF,SAAQ,MACxE3H,GAAoB,IAEtB7M,MAAO,CACLC,QAAS,YACT2I,OAAQ,UACRwQ,aAAc,0DACd1b,YAAawO,EAAgB6C,GAASG,KAAOE,GAAWF,QAAUA,EAAKsF,SAAW,2BAA6B,cAC/G3W,MAAO,+BACPwc,WAAY,iBACZtc,SAAU,YAEZuc,aAAe5R,GAAMA,EAAE6R,cAAcva,MAAMtC,WAAa,4BACxD8c,aAAe9R,GAAMA,EAAE6R,cAAcva,MAAMtC,YAAcwO,EAAgB6C,GAASG,KAAOE,GAAWF,QAAUA,EAAKsF,SAAW,2BAA6B,cAAcpZ,SAAA,CAExK8T,EAAKoF,WAAW,IAAEpF,EAAKqF,UAAU,KAAGrF,EAAKsF,SAAS,MAAEnZ,EAAAA,EAAAA,KAAA,UACrDA,EAAAA,EAAAA,KAAA,QAAM2E,MAAO,CAAEjC,SAAU,UAAWF,MAAO,kCAAmCzC,SAAE8T,EAAKuF,UAvBhFvF,EAAKlL,MA2Bd3I,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEC,QAAS,YAAapC,MAAO,6BAA8BE,SAAU,YAAa3C,SACnE,KAA1BoR,EAAeyH,OAAgB,kCAAoC,iCAWpF9Y,EAAAA,EAAAA,MAAA,OAAKN,UAAU,eAAcO,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,MAAIR,UAAU,qBAAoBO,SAAC,mBACnCD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,wBAAuBO,SAAA,EACpCD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,qBACPD,EAAAA,EAAAA,MAAA,UACEwE,MAAOuM,EAAgB6C,GAASI,eAAiBC,GAAWD,eAC5D1G,SAAWC,GAAMwD,EAAgB8C,IAAWqJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAItJ,IAAQ,IAAEI,eAAgBzG,EAAEC,OAAOhJ,SAAW0P,IAAagJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIjJ,IAAU,IAAED,eAAgBzG,EAAEC,OAAOhJ,SACxJ9E,UAAU,aAAYO,SAAA,EAEtBC,EAAAA,EAAAA,KAAA,UAAQsE,MAAM,GAAEvE,SAAC,+BAChB2S,IAAkB1S,EAAAA,EAAAA,KAAA,UAAQsE,MAAM,GAAGmZ,UAAQ,EAAA1d,SAAC,wBAC3C2S,GAAkBF,EAAQ3H,IAAK2L,IAC/B1W,EAAAA,EAAAA,MAAA,UAAwBwE,MAAO2V,GAAkBzD,GAAQzW,SAAA,CACtDyW,EAAO9G,KAAK,KAAGuK,GAAkBzD,IAAW,QAAQ,MAD1CA,EAAO7N,SAKxB3I,EAAAA,EAAAA,KAAA,SAAOR,UAAU,YAAWO,SAAC,6DAE/BD,EAAAA,EAAAA,MAAA,OAAKN,UAAU,aAAYO,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,uBACPC,EAAAA,EAAAA,KAAA,SACEyN,KAAK,OACLnJ,MAAOuM,EAAgB6C,GAASI,eAAiBC,GAAWD,eAC5D1G,SAAWC,GAAMwD,EAAgB8C,IAAWqJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGtJ,IAAQ,IAAEI,eAAgBzG,EAAEC,OAAOhJ,SAAU0P,IAAagJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGjJ,IAAU,IAAED,eAAgBzG,EAAEC,OAAOhJ,SACrJoa,aAAa,MACbD,YAAY,iCAOrB5N,IACC7Q,EAAAA,EAAAA,KAAA,OAAK2E,MAAO,CAAEC,QAAS,UAAW7E,UAC/BC,EAAAA,EAAAA,KAACd,EAAAA,EAAU,CACTE,UAAWyR,EAAc8L,oBACzBtd,UAAWwR,EAAcuO,WACzB9f,UAAWuR,EAAcwO,oBACzB9f,UAAWsR,EAAcyO,gBAIhCxf,EAAAA,EAAAA,MAAA,OAAKN,UAAU,eAAemF,MAAO,CAAEC,QAAS,QAAS7E,SAAA,EACvDC,EAAAA,EAAAA,KAAA,UAAQyN,KAAK,SAASjO,UAAU,MAAKO,SAAE8Q,EAAgB,eAAiB,qBACxE7Q,EAAAA,EAAAA,KAAA,UAAQyN,KAAK,SAASC,QAASqM,GAAcva,UAAU,oBAAmBO,SAAC,yB,6CC1nD3F,MAAM4gB,EAAaC,WAAAA,GAAA,KACTC,MAAiC,IAAI/W,IAAM,KAC3CgX,YAAmD,IAAIhX,GAAM,CASrEU,GAAAA,CAAIkW,EAAajX,GAAgF,IAArEsX,EAAa1gB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAGsgB,EAAaK,YAAaC,EAAkB5gB,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EACtF2gB,KAAKL,MAAMrW,IAAIkW,EAAK,CAClBjX,OACAQ,UAAWtK,KAAKwhB,MAChBC,UAAWL,EACXE,UAAoB,OAATA,QAAS,IAATA,EAAAA,EAAanV,KAAKwU,IAAIS,EAAQ,EAAGJ,EAAaU,cAI3DH,KAAKI,kBAAkBZ,EAAKjX,EAC9B,CAKAgB,GAAAA,CAAIiW,GACF,MAAMjG,EAAQyG,KAAKL,MAAMpW,IAAIiW,GAC7B,IAAKjG,EAAO,OAAO,KAInB,OADY9a,KAAKwhB,MACP1G,EAAMxQ,UAAYwQ,EAAM2G,WAChCF,KAAKL,MAAMZ,OAAOS,GACX,MAGFjG,EAAMhR,IACf,CAMA8X,kBAAAA,CAAmBb,GAA0E,IAADc,EAC1F,MAAM/G,EAAQyG,KAAKL,MAAMpW,IAAIiW,GAC7B,IAAKjG,EAAO,OAAO,KAEnB,MACMgH,EADM9hB,KAAKwhB,MACC1G,EAAMxQ,UAClByX,EAAYD,EAAMhH,EAAM2G,UACxBO,EAAUF,GAAsB,QAAnBD,EAAI/G,EAAMwG,iBAAS,IAAAO,EAAAA,EAAI/G,EAAM2G,UAAY,GAG5D,OAAIM,GACFR,KAAKL,MAAMZ,OAAOS,GACX,MAGF,CACLjX,KAAMgR,EAAMhR,KACZkY,UACAD,WAAW,EAEf,CAKAnX,GAAAA,CAAImW,GACF,MAAMjG,EAAQyG,KAAKL,MAAMpW,IAAIiW,GAC7B,IAAKjG,EAAO,OAAO,EAGnB,QADY9a,KAAKwhB,MACP1G,EAAMxQ,UAAYwQ,EAAM2G,aAChCF,KAAKL,MAAMZ,OAAOS,IACX,EAIX,CAKAiB,OAAAA,CAAQjB,GAAuB,IAADkB,EAC5B,MAAMnH,EAAQyG,KAAKL,MAAMpW,IAAIiW,GAC7B,IAAKjG,EAAO,OAAO,EAInB,OAFY9a,KAAKwhB,MACC1G,EAAMxQ,WACK,QAAnB2X,EAAInH,EAAMwG,iBAAS,IAAAW,EAAAA,EAAInH,EAAM2G,UAAY,EACrD,CAKAS,KAAAA,CAAMnB,GACJQ,KAAKL,MAAMZ,OAAOS,EACpB,CAKAoB,YAAAA,CAAaC,GACX,MAAMC,EAA2B,kBAAZD,EAAuB,IAAIE,OAAOF,GAAWA,EAC5DG,EAAyB,GAE/BhB,KAAKL,MAAM9W,QAAQ,CAACJ,EAAG+W,KACjBsB,EAAMG,KAAKzB,IACbwB,EAAaxX,KAAKgW,KAItBwB,EAAanY,QAAQ2W,GAAOQ,KAAKL,MAAMZ,OAAOS,GAChD,CAKA0B,QAAAA,GACElB,KAAKL,MAAMgB,OACb,CAKA5J,IAAAA,GACE,OAAOiJ,KAAKL,MAAM5I,IACpB,CAKAoK,SAAAA,CAAU3B,EAAavgB,GAChB+gB,KAAKJ,YAAYvW,IAAImW,IACxBQ,KAAKJ,YAAYtW,IAAIkW,EAAK,IAAI7O,KAGhC,MAAMyQ,EAAkC,CAAEniB,YAI1C,OAHA+gB,KAAKJ,YAAYrW,IAAIiW,GAAMR,IAAIoC,GAGxB,KACL,MAAMC,EAAOrB,KAAKJ,YAAYrW,IAAIiW,GAC9B6B,IACFA,EAAKtC,OAAOqC,GACM,IAAdC,EAAKtK,MACPiJ,KAAKJ,YAAYb,OAAOS,IAIhC,CAKA8B,gBAAAA,CAAiBT,EAAiB5hB,GAChC,MAAMugB,EAAG,cAAAnb,OAAiBwc,EAAQU,QAC7BvB,KAAKJ,YAAYvW,IAAImW,IACxBQ,KAAKJ,YAAYtW,IAAIkW,EAAK,IAAI7O,KAGhC,MAAMyQ,EAAkC,CAAEniB,WAAU4hB,WAGpD,OAFAb,KAAKJ,YAAYrW,IAAIiW,GAAMR,IAAIoC,GAExB,KACL,MAAMC,EAAOrB,KAAKJ,YAAYrW,IAAIiW,GAC9B6B,IACFA,EAAKtC,OAAOqC,GACM,IAAdC,EAAKtK,MACPiJ,KAAKJ,YAAYb,OAAOS,IAIhC,CAKQY,iBAAAA,CAAkBZ,EAAajX,GAErC,MAAMiZ,EAAaxB,KAAKJ,YAAYrW,IAAIiW,GACpCgC,GACFA,EAAW3Y,QAAQvF,IACjB,IACEA,EAAIrE,SAASsJ,EACf,CAAE,MAAO7C,GACPyP,QAAQzP,MAAM,kCAADrB,OAAmCmb,EAAG,KAAK9Z,EAC1D,IAKJsa,KAAKJ,YAAY/W,QAAQ,CAACwY,EAAMI,KAC1BA,EAAOC,WAAW,gBACpBL,EAAKxY,QAAQvF,IACX,GAAIA,EAAIud,SAAWvd,EAAIud,QAAQI,KAAKzB,GAClC,IACElc,EAAIrE,SAASsJ,EACf,CAAE,MAAO7C,GACPyP,QAAQzP,MAAM,0CAADrB,OAA2Cmb,EAAG,KAAK9Z,EAClE,KAKV,CAKAic,IAAAA,GACE,OAAO9hB,MAAM4J,KAAKuW,KAAKL,MAAMgC,OAC/B,CAKAC,QAAAA,GACE,MAAO,CACL7K,KAAMiJ,KAAKL,MAAM5I,KACjB4K,KAAM3B,KAAK2B,OACX/B,YAAa/f,MAAM4J,KAAKuW,KAAKJ,YAAYlW,UAAUI,OAAO,CAACC,EAAKT,IAAQS,EAAMT,EAAIyN,KAAM,GAE5F,CAKA,aAAO8K,GACL,OAD+C1iB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,SAEhD,IAAK,WACH,OAAOsgB,EAAaqC,aACtB,IAAK,OACH,OAAOrC,EAAasC,SACtB,QACE,OAAOtC,EAAaK,YAE1B,EA/OIL,EAGoBK,YAAc,IAHlCL,EAIoBsC,SAAW,KAJ/BtC,EAKoBqC,aAAe,IALnCrC,EAMoBU,WAAa,IA4OhC,MAAM6B,EAAe,IAAIvC,EACnBK,EAAc,ICtQrBmC,EAAeC,oDAsjBd,MAAMjb,EAAa,IApjB1B,MACUkb,cAAAA,GACN,MAAMC,EAASC,aAAaC,QAAQ,cACpC,GAAIF,EACF,IACE,MAAMG,EAAeC,KAAKC,MAAML,GAChC,MAAO,CACL,cAAgB,UAAD/d,OAAYke,EAAaG,QACxC,eAAgB,mBAEpB,CAAE,MAAOhd,GACPyP,QAAQzP,MAAM,6BAA8BA,EAC9C,CAEF,MAAO,CACL,eAAgB,mBAEpB,CAEA,aAAcid,CAAQC,GAA4D,IAA1CC,EAAoB1jB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,EAC9D,MAAM2jB,EAAG,GAAAze,OAAM4d,GAAY5d,OAAGue,GAC9B,IAAIG,EAAU/C,KAAKmC,iBAEf1N,QAAiBuO,MAAMF,GAAGhH,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACzB+G,GAAO,IACVE,SAAOjH,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACFiH,GACAF,EAAQE,YAIf,GAAwB,MAApBtO,EAASwO,OAAgB,OAEEjD,KAAKkD,iBAGhCH,EAAU/C,KAAKmC,iBACf1N,QAAiBuO,MAAMF,GAAGhH,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACrB+G,GAAO,IACVE,SAAOjH,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACFiH,GACAF,EAAQE,YAInB,CAEA,GAAwB,MAApBtO,EAASwO,OAKX,MAHAZ,aAAac,WAAW,cACxBd,aAAac,WAAW,YACxBzJ,OAAO0J,SAASC,KAAO,SACjB,IAAI9b,MAAM,2BAGlB,IAAKkN,EAAS6O,GAAI,CAChB,MAAMC,QAAkB9O,EAAS+O,OACjC,MAAM,IAAIjc,MAAM,uBAADlD,OAAwBoQ,EAASwO,OAAM,KAAA5e,OAAIoQ,EAASgP,WAAU,OAAApf,OAAMkf,GACrF,CAEA,OAAwB,MAApB9O,EAASwO,OAAuB,KAC7BxO,EAASiP,MAClB,CAEA,kBAAcR,GACZ,MAAMd,EAASC,aAAaC,QAAQ,cACpC,IAAKF,EAAQ,OAAO,EAEpB,IACE,MAAMG,EAAeC,KAAKC,MAAML,GAC1B3N,QAAiBuO,MAAM,GAAD3e,OAAI4d,EAAY,wBAAwB,CAClE0B,OAAQ,OACRZ,QAAS,CACP,eAAgB,oBAElBa,KAAMpB,KAAKqB,UAAU,CAAEC,QAASvB,EAAauB,YAG/C,GAAIrP,EAAS6O,GAAI,CACf,MACMS,EAAY,CAChBrB,cAFiBjO,EAASiP,QAEbhB,OACboB,QAASvB,EAAauB,SAGxB,OADAzB,aAAa2B,QAAQ,aAAcxB,KAAKqB,UAAUE,KAC3C,CACT,CACF,CAAE,MAAOre,GACPyP,QAAQzP,MAAM,wBAAyBA,EACzC,CACA,OAAO,CACT,CAEA,sBAAMue,GACJ,OAAOjE,KAAK2C,QAAQ,WACtB,CAEA,kBAAMrM,GACJ,OAAO0J,KAAK2C,QAAQ,cACtB,CAEA,qBAAMuB,CAAgB3b,GACpB,MAAMkM,QAAiBuO,MAAM,GAAD3e,OAAI4d,EAAY,sBAAsB,CAChE0B,OAAQ,OACRZ,QAAS,CACP,eAAgB,oBAElBa,KAAMpB,KAAKqB,UAAUtb,KAEvB,IAAKkM,EAAS6O,GACZ,MAAM,IAAI/b,MAAM,wBAADlD,OAAyBoQ,EAASgP,aAEnD,OAAOhP,EAASiP,MAClB,CAEA,eAAMS,GACJ,MAAMC,EAAW,SACXC,EAASrC,EAAazY,IAAI6a,GAChC,GAAIC,EAAQ,OAAOA,EAEnB,MAAM9b,QAAayX,KAAK2C,QAAQ,YAEhC,OADAX,EAAa1Y,IAAI8a,EAAU7b,EAAMuX,GAC1BvX,CACT,CAEA,qBAAM8N,GACJ,MAAM+N,EAAW,gBACXC,EAASrC,EAAazY,IAAI6a,GAChC,GAAIC,EAAQ,OAAOA,EAEnB,MAAM9b,QAAayX,KAAK2C,QAAQ,YAEhC,OADAX,EAAa1Y,IAAI8a,EAAU7b,EAAMuX,GAC1BvX,CACT,CAEA,aAAM+b,GACJ,MAAMF,EAAW,OACXC,EAASrC,EAAazY,IAAI6a,GAChC,GAAIC,EAAQ,OAAOA,EAEnB,MAAM9b,QAAayX,KAAK2C,QAAQ,UAEhC,OADAX,EAAa1Y,IAAI8a,EAAU7b,EAAMuX,GAC1BvX,CACT,CAEA,cAAMuN,CAAStB,GACb,MAAM4P,EAAQ,SAAA/f,OAAYmQ,GAAU,OAC9B6P,EAASrC,EAAazY,IAAI6a,GAChC,GAAIC,EAAQ,OAAOA,EAEnB,MAAME,EAAS/P,EAAM,WAAAnQ,OAAcmgB,mBAAmBhQ,IAAY,GAC5DjM,QAAayX,KAAK2C,QAAQ,UAADte,OAAWkgB,IAE1C,OADAvC,EAAa1Y,IAAI8a,EAAU7b,EAAMuX,GAC1BvX,CACT,CAEA,gBAAMkc,CAAWC,GACf,MAAMC,QAAe3E,KAAK2C,QAAQ,iBAAkB,CAClDgB,OAAQ,OACRC,KAAMpB,KAAKqB,UAAUa,KAKvB,OAFA1C,EAAarB,MAAM,aACnBqB,EAAad,WACNyD,CACT,CAEA,oBAAMC,CAAeC,GACnB,MAAMF,QAAe3E,KAAK2C,QAAQ,iBAAkB,CAClDgB,OAAQ,OACRC,KAAMpB,KAAKqB,WAAS/H,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAI+I,GAAY,IAAE9O,UAAU,OAGpD,OADAiM,EAAarB,MAAM,aACZgE,CACT,CAEA,oBAAMG,CAAeC,GACnB,OAAO/E,KAAK2C,QAAQ,UAADte,OAAW0gB,EAAM,aACtC,CAEA,iBAAMC,CAAYD,GAChB,OAAO/E,KAAK2C,QAAQ,UAADte,OAAW0gB,EAAM,UACtC,CAEA,oBAAME,CAAeF,EAAgBxc,GACnC,OAAOyX,KAAK2C,QAAQ,UAADte,OAAW0gB,EAAM,UAAU,CAC5CpB,OAAQ,OACRC,KAAMpB,KAAKqB,UAAUtb,IAEzB,CAEA,oBAAM2c,CAAeH,EAAgBxc,GACnC,OAAOyX,KAAK2C,QAAQ,UAADte,OAAW0gB,EAAM,iBAAiB,CACnDpB,OAAQ,MACRC,KAAMpB,KAAKqB,UAAUtb,IAEzB,CAEA,mBAAMkN,CAAcR,GAClB,OAAO+K,KAAK2C,QAAQ,YAADte,OAAa4Q,EAAQ,UAC1C,CAEA,sBAAMoI,CAAiBpI,EAAkB1M,GACvC,OAAOyX,KAAK2C,QAAQ,YAADte,OAAa4Q,EAAQ,UAAU,CAChD0O,OAAQ,OACRC,KAAMpB,KAAKqB,UAAUtb,IAEzB,CAEA,sBAAM6U,CAAiBnI,EAAkB1M,GACvC,OAAOyX,KAAK2C,QAAQ,YAADte,OAAa4Q,EAAQ,iBAAiB,CACvD0O,OAAQ,MACRC,KAAMpB,KAAKqB,UAAUtb,IAEzB,CAGA,sBAAMrB,CAAiBlC,EAAgBuf,GACrC,MAAMnM,EAAQ,IAAI+M,gBACR,OAANZ,QAAM,IAANA,GAAAA,EAAQ/d,YAAY4R,EAAMgN,OAAO,aAAcb,EAAO/d,YAChD,OAAN+d,QAAM,IAANA,GAAAA,EAAQ7d,UAAU0R,EAAMgN,OAAO,WAAYb,EAAO7d,UAC5C,OAAN6d,QAAM,IAANA,GAAAA,EAAQ5d,MAAMyR,EAAMgN,OAAO,OAAQb,EAAO5d,KAAK0e,YACnD,MAAMvC,EAAG,UAAAze,OAAaW,EAAM,eAAAX,OAAc+T,EAAMiN,WAAa,IAAMjN,EAAMiN,WAAa,IACtF,OAAOrF,KAAK2C,QAAQG,EACtB,CAEA,qBAAM3b,CAAgBnC,EAAgBuf,GACpC,MAAMnM,EAAQ,IAAI+M,gBACR,OAANZ,QAAM,IAANA,GAAAA,EAAQjkB,MAAM8X,EAAMgN,OAAO,OAAQb,EAAOjkB,MACpC,OAANikB,QAAM,IAANA,GAAAA,EAAQ/d,YAAY4R,EAAMgN,OAAO,aAAcb,EAAO/d,YAChD,OAAN+d,QAAM,IAANA,GAAAA,EAAQ7d,UAAU0R,EAAMgN,OAAO,WAAYb,EAAO7d,UACtD,MAAMoc,EAAG,UAAAze,OAAaW,EAAM,cAAAX,OAAa+T,EAAMiN,WAAa,IAAMjN,EAAMiN,WAAa,IACrF,OAAOrF,KAAK2C,QAAQG,EACtB,CAEA,oBAAM1b,CAAepC,GACnB,OAAOgb,KAAK2C,QAAQ,UAADte,OAAWW,EAAM,aACtC,CAEA,gBAAMsgB,CAAWP,EAAgBxc,GAC/B,MAAMoc,QAAe3E,KAAK2C,QAAQ,UAADte,OAAW0gB,EAAM,KAAK,CACrDpB,OAAQ,MACRC,KAAMpB,KAAKqB,UAAUtb,KAGvB,OADAyZ,EAAarB,MAAM,aACZgE,CACT,CAEA,gBAAMY,CAAWR,GACf,MAAMJ,QAAe3E,KAAK2C,QAAQ,UAADte,OAAW0gB,EAAM,YAAY,CAC5DpB,OAAQ,WAGV,OADA3B,EAAarB,MAAM,aACZgE,CACT,CAGA,gBAAMa,GACJ,OAAOxF,KAAK2C,QAAQ,YACtB,CAEA,mBAAM8C,CAAcld,GAClB,OAAOyX,KAAK2C,QAAQ,mBAAoB,CACtCgB,OAAQ,MACRC,KAAMpB,KAAKqB,UAAUtb,IAEzB,CAEA,oBAAMmd,CAAend,GACnB,OAAOyX,KAAK2C,QAAQ,4BAA6B,CAC/CgB,OAAQ,OACRC,KAAMpB,KAAKqB,UAAUtb,IAEzB,CAGA,kBAAMod,CAAanR,GACjB,MAAM+P,EAAS/P,EAAM,WAAAnQ,OAAcmgB,mBAAmBhQ,IAAY,GAClE,OAAOwL,KAAK2C,QAAQ,cAADte,OAAekgB,GACpC,CAEA,oBAAMqB,CAAeC,GACnB,OAAO7F,KAAK2C,QAAQ,qBAAsB,CACxCgB,OAAQ,OACRC,KAAMpB,KAAKqB,UAAUgC,IAEzB,CAEA,iBAAMC,CAAYC,GAChB,OAAO/F,KAAK2C,QAAQ,cAADte,OAAe0hB,EAAU,KAC9C,CAEA,oBAAMC,CAAeD,EAAoBxd,GACvC,OAAOyX,KAAK2C,QAAQ,cAADte,OAAe0hB,EAAU,YAAY,CACtDpC,OAAQ,MACRC,KAAMpB,KAAKqB,UAAUtb,IAEzB,CAEA,oBAAM0d,CAAeF,GACnB,OAAO/F,KAAK2C,QAAQ,cAADte,OAAe0hB,EAAU,YAAY,CACtDpC,OAAQ,UAEZ,CAEA,gBAAMzN,GACJ,MAAMkO,EAAW,UACXC,EAASrC,EAAazY,IAAI6a,GAChC,GAAIC,EAAQ,OAAOA,EAEnB,MAAM9b,QAAayX,KAAK2C,QAAQ,aAGhC,OADAX,EAAa1Y,IAAI8a,EAAU7b,EAAM,MAC1BA,CACT,CAEA,kBAAM2d,CAAa3d,GACjB,MAAMoc,QAAe3E,KAAK2C,QAAQ,mBAAoB,CACpDgB,OAAQ,OACRC,KAAMpB,KAAKqB,UAAUtb,KAGvB,OADAyZ,EAAarB,MAAM,WACZgE,CACT,CAEA,kBAAMwB,CAAa1e,EAAYc,GAC7B,MAAMoc,QAAe3E,KAAK2C,QAAQ,YAADte,OAAaoD,EAAE,KAAK,CACnDkc,OAAQ,MACRC,KAAMpB,KAAKqB,UAAUtb,KAGvB,OADAyZ,EAAarB,MAAM,WACZgE,CACT,CAEA,kBAAMyB,CAAa3e,GACjB,MAAMkd,QAAe3E,KAAK2C,QAAQ,YAADte,OAAaoD,EAAE,YAAY,CAC1Dkc,OAAQ,WAGV,OADA3B,EAAarB,MAAM,WACZgE,CACT,CAEA,qBAAM0B,GACJ,OAAOrG,KAAK2C,QAAQ,WACtB,CAEA,uBAAM2D,CAAkBC,GACtB,OAAOvG,KAAK2C,QAAQ,kBAAmB,CACrCgB,OAAQ,OACRC,KAAMpB,KAAKqB,UAAU0C,IAEzB,CAEA,uBAAMC,CAAkBC,EAAiBF,GACvC,OAAOvG,KAAK2C,QAAQ,WAADte,OAAYoiB,EAAO,KAAK,CACzC9C,OAAQ,MACRC,KAAMpB,KAAKqB,UAAU0C,IAEzB,CAEA,uBAAMG,CAAkBD,GACtB,OAAOzG,KAAK2C,QAAQ,WAADte,OAAYoiB,EAAO,YAAY,CAChD9C,OAAQ,UAEZ,CAEA,gBAAMjP,CAAWF,GAAyE,IAAxDD,EAAYpV,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,EAAG6R,EAAgB7R,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,GACrE,MAAMolB,EAAS,IAAIY,gBACf3Q,GAAQ+P,EAAOa,OAAO,SAAU5Q,GACpC+P,EAAOa,OAAO,OAAQ7Q,EAAK8Q,YAC3Bd,EAAOa,OAAO,YAAapU,EAASqU,YAEpC,MAAMsB,EAAcpC,EAAOc,WAC3B,OAAOrF,KAAK2C,QAAQ,aAADte,OAAcsiB,GACnC,CAEA,kBAAM/N,CAAagO,GACjB,OAAO5G,KAAK2C,QAAQ,mBAAoB,CACtCgB,OAAQ,OACRC,KAAMpB,KAAKqB,UAAU+C,IAEzB,CAEA,kBAAMlO,CAAazD,EAAkB1M,GACnC,OAAOyX,KAAK2C,QAAQ,YAADte,OAAa4Q,EAAQ,KAAK,CAC3C0O,OAAQ,MACRC,KAAMpB,KAAKqB,UAAUtb,IAEzB,CAEA,kBAAM4R,CAAalF,GACjB,OAAO+K,KAAK2C,QAAQ,YAADte,OAAa4Q,EAAQ,YAAY,CAClD0O,OAAQ,UAEZ,CAEA,kBAAM/J,CAAa3E,GACjB,OAAO+K,KAAK2C,QAAQ,YAADte,OAAa4Q,EAAQ,YAAY,CAClD0O,OAAQ,QAEZ,CAEA,qBAAM1J,CAAgBhF,GACpB,OAAO+K,KAAK2C,QAAQ,YAADte,OAAa4Q,EAAQ,gBAAgB,CACtD0O,OAAQ,QAEZ,CAEA,mBAAM3O,CAAcC,GAA0E,IAAxD4R,EAAa1nB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,IAAKoO,EAAcpO,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,EAC1E,OAAO6gB,KAAK2C,QAAQ,YAADte,OAAa4Q,EAAQ,iBAAA5Q,OAAgBwiB,EAAK,YAAAxiB,OAAWkJ,GAC1E,CAEA,sBAAMsO,CAAiB5G,EAAkB2G,GACvC,OAAOoE,KAAK2C,QAAQ,YAADte,OAAa4Q,EAAQ,iBAAiB,CACvD0O,OAAQ,OACRC,KAAMpB,KAAKqB,UAAU,CAAEjI,aAE3B,CAEA,uBAAM6C,CAAkBqI,GACtB,OAAO9G,KAAK2C,QAAQ,wBAAyB,CAC3CgB,OAAQ,OACRC,KAAMpB,KAAKqB,UAAU,CAAEkD,WAAYD,KAEvC,CAEA,eAAME,CAAUC,GACd,OAAOjH,KAAK2C,QAAQ,YAADte,OAAa4iB,EAAQ,YAC1C,CAEA,iBAAMC,CAAYD,EAAkBV,GAClC,OAAOvG,KAAK2C,QAAQ,YAADte,OAAa4iB,EAAQ,mBAAmB,CACzDtD,OAAQ,OACRC,KAAMpB,KAAKqB,UAAU0C,IAEzB,CAEA,iBAAMY,CAAYF,EAAkBR,EAAiBF,GACnD,OAAOvG,KAAK2C,QAAQ,YAADte,OAAa4iB,EAAQ,YAAA5iB,OAAWoiB,EAAO,KAAK,CAC7D9C,OAAQ,MACRC,KAAMpB,KAAKqB,UAAU0C,IAEzB,CAEA,iBAAMa,CAAYH,EAAkBR,GAClC,OAAOzG,KAAK2C,QAAQ,YAADte,OAAa4iB,EAAQ,YAAA5iB,OAAWoiB,EAAO,YAAY,CACpE9C,OAAQ,UAEZ,CAEA,uBAAM0D,CAAkBJ,EAAkBK,GACxC,OAAOtH,KAAK2C,QAAQ,YAADte,OAAa4iB,EAAQ,gBAAgB,CACtDtD,OAAQ,OACRC,KAAMpB,KAAKqB,UAAU,CAAE0D,UAAWD,KAEtC,CAEA,2BAAME,CAAsBP,EAAkBR,GAC5C,OAAOzG,KAAK2C,QAAQ,YAADte,OAAa4iB,EAAQ,YAAA5iB,OAAWoiB,EAAO,YAAY,CACpE9C,OAAQ,QAEZ,CAGA,yBAAM8D,GAA+D,IAA3CC,IAAmBvoB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,KAAAA,UAAA,GAC3C,MAAMolB,EAAS,IAAIY,gBAEnB,OADAZ,EAAOa,OAAO,SAAUsC,EAAWrC,YAC5BrF,KAAK2C,QAAQ,kBAADte,OAAmBkgB,EAAOc,YAC/C,CAEA,2BAAMsC,CAAsBC,GAC1B,MAAM9E,EAAG,GAAAze,OAAM4d,EAAY,yBACrBG,EAASC,aAAaC,QAAQ,cAEpC,IAAKF,EACH,MAAM,IAAI7a,MAAM,2BAGlB,MAAMgb,EAAeC,KAAKC,MAAML,GAChC,IAAIW,EAAuB,CACzB,cAAgB,UAAD1e,OAAYke,EAAaG,SAItCjO,QAAiBuO,MAAMF,EAAK,CAC9Ba,OAAQ,OACRZ,UACAa,KAAMgE,IAIR,GAAwB,MAApBnT,EAASwO,OAAgB,CAE3B,SAD6BjD,KAAKkD,eACd,CAClB,MAAMa,EAAYvB,KAAKC,MAAMJ,aAAaC,QAAQ,eAAiB,MACnES,EAAU,CACR,cAAgB,UAAD1e,OAAY0f,EAAUrB,SAEvCjO,QAAiBuO,MAAMF,EAAK,CAC1Ba,OAAQ,OACRZ,UACAa,KAAMgE,GAEV,CACF,CAEA,GAAwB,MAApBnT,EAASwO,OAIX,MAHAZ,aAAac,WAAW,cACxBd,aAAac,WAAW,YACxBzJ,OAAO0J,SAASC,KAAO,SACjB,IAAI9b,MAAM,2BAGlB,IAAKkN,EAAS6O,GAAI,CAChB,MAAMC,QAAkB9O,EAAS+O,OACjC,MAAM,IAAIjc,MAAM,kBAADlD,OAAmBoQ,EAASwO,OAAM,KAAA5e,OAAIoQ,EAASgP,WAAU,OAAApf,OAAMkf,GAChF,CAEA,OAAO9O,EAASiP,MAClB,CAEA,2BAAMmE,CAAsBC,EAAoBvf,GAC9C,OAAOyX,KAAK2C,QAAQ,iBAADte,OAAkByjB,EAAU,KAAK,CAClDnE,OAAQ,QACRC,KAAMpB,KAAKqB,UAAUtb,IAEzB,CAEA,2BAAMwf,CAAsBD,GAC1B,OAAO9H,KAAK2C,QAAQ,iBAADte,OAAkByjB,EAAU,YAAY,CACzDnE,OAAQ,UAEZ,CAEA,yBAAMqE,CAAoB/S,GACxB,OAAO+K,KAAK2C,QAAQ,gBAADte,OAAiB4Q,EAAQ,SAC9C,CAEA,kBAAMgT,GACJ,OAAOjI,KAAK2C,QAAQ,eACtB,CAEA,qBAAMuF,CAAgBC,GACpB,OAAOnI,KAAK2C,QAAQ,sBAAuB,CACzCgB,OAAQ,QACRC,KAAMpB,KAAKqB,UAAUsE,IAEzB,CAEA,kBAAMC,GACJ,OAAOpI,KAAK2C,QAAQ,eACtB,CAEA,qBAAM0F,CAAgBC,EAAsBC,GAC1C,OAAOvI,KAAK2C,QAAQ,yBAA0B,CAC5CgB,OAAQ,OACRC,KAAMpB,KAAKqB,UAAU,CACnBnR,cAAe4V,EACfC,MAAOA,GAAS,MAGtB,E","sources":["components/AuditTrail.tsx","hooks/useDebounce.ts","components/SiteDataPanel.tsx","components/Devices.tsx","services/cacheService.ts","services/api.ts"],"sourcesContent":["import React from 'react';\r\n\r\ninterface AuditTrailProps {\r\n  createdBy?: string | null;\r\n  createdAt?: string;\r\n  updatedBy?: string | null;\r\n  updatedAt?: string;\r\n  className?: string;\r\n}\r\n\r\nconst AuditTrail: React.FC<AuditTrailProps> = ({\r\n  createdBy,\r\n  createdAt,\r\n  updatedBy,\r\n  updatedAt,\r\n  className = 'audit-trail',\r\n}) => {\r\n  const formatDate = (dateString?: string) => {\r\n    if (!dateString) return 'N/A';\r\n    try {\r\n      return new Date(dateString).toLocaleString();\r\n    } catch {\r\n      return dateString;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={className}>\r\n      <div className=\"audit-row\">\r\n        <span className=\"audit-label\">Created:</span>\r\n        {createdBy ? (\r\n          <span className=\"audit-value\">\r\n            by <strong>{createdBy}</strong> on {formatDate(createdAt)}\r\n          </span>\r\n        ) : (\r\n          <span className=\"audit-value\">System</span>\r\n        )}\r\n      </div>\r\n\r\n      {updatedBy && (\r\n        <div className=\"audit-row\">\r\n          <span className=\"audit-label\">Last Updated:</span>\r\n          <span className=\"audit-value\">\r\n            by <strong>{updatedBy}</strong> on {formatDate(updatedAt)}\r\n          </span>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default React.memo(AuditTrail);\r\n","import { useState, useEffect, useCallback } from 'react';\r\n\r\ninterface UseDebouncedValueOptions {\r\n  delay?: number;\r\n}\r\n\r\n/**\r\n * Custom hook to debounce a value with a delay\r\n * Useful for search inputs and other frequent updates\r\n */\r\nexport function useDebouncedValue<T>(\r\n  value: T,\r\n  options: UseDebouncedValueOptions = {}\r\n): T {\r\n  const { delay = 300 } = options;\r\n  const [debouncedValue, setDebouncedValue] = useState<T>(value);\r\n\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setDebouncedValue(value);\r\n    }, delay);\r\n\r\n    return () => clearTimeout(timer);\r\n  }, [value, delay]);\r\n\r\n  return debouncedValue;\r\n}\r\n\r\n/**\r\n * Custom hook to debounce a callback function\r\n * Useful for search, filtering, and other expensive operations\r\n */\r\nexport function useDebouncedCallback<T extends (...args: any[]) => any>(\r\n  callback: T,\r\n  delay: number = 300\r\n): (...args: Parameters<T>) => void {\r\n  const [timeoutId, setTimeoutId] = useState<NodeJS.Timeout | null>(null);\r\n\r\n  const debouncedCallback = useCallback(\r\n    (...args: Parameters<T>) => {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId);\r\n      }\r\n\r\n      const newTimeoutId = setTimeout(() => {\r\n        callback(...args);\r\n      }, delay);\r\n\r\n      setTimeoutId(newTimeoutId);\r\n    },\r\n    [callback, delay, timeoutId]\r\n  );\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId);\r\n      }\r\n    };\r\n  }, [timeoutId]);\r\n\r\n  return debouncedCallback;\r\n}\r\n\r\n/**\r\n * Custom hook for search input with debouncing\r\n * Returns a hook that handles search input changes with built-in debouncing\r\n */\r\nexport function useDebouncedSearch(\r\n  onSearch: (query: string) => void,\r\n  delay: number = 300\r\n) {\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const debouncedCallback = useDebouncedCallback(onSearch, delay);\r\n\r\n  const handleSearch = useCallback(\r\n    (query: string) => {\r\n      setSearchQuery(query);\r\n      debouncedCallback(query);\r\n    },\r\n    [debouncedCallback]\r\n  );\r\n\r\n  return {\r\n    searchQuery,\r\n    setSearchQuery,\r\n    handleSearch,\r\n  };\r\n}\r\n","/**\n * SiteDataPanel  reusable panel that fetches and visualises DynamoDB data\n * for a solar site. Accepts a siteId prop and shows:\n *  - 4 live KPI cards (PV power, battery SOC, load, energy today)\n *  - 24 h power history area chart\n *  - Today's ML forecast with p10/p50/p90 confidence bands\n *  - Latest weather observation\n */\nimport React, { useState, useEffect, useCallback } from 'react';\nimport {\n  AreaChart, Area, Line,\n  XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend,\n} from 'recharts';\nimport { apiService } from '../services/api';\n\n//  helpers \n\nfunction fmt(ts: string, range: string): string {\n  // Format timestamp based on date range\n  try {\n    const date = new Date(ts);\n    if (range === '24h') {\n      // \"14:30\"\n      return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    } else if (range === '7d') {\n      // \"Mon 14:00\" for 7 days\n      return date.toLocaleDateString([], { weekday: 'short' }) + ' ' + \n             date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    } else {\n      // \"Feb 23\" for 30d or custom\n      return date.toLocaleDateString([], { month: 'short', day: 'numeric' });\n    }\n  } catch { return ts; }\n}\n\nfunction fmtForecast(ts: string): string {\n  // \"FORECAST#2026-02-23T14:30:00Z\"  \"14:30\"\n  const cleanTs = ts.replace('FORECAST#', '');\n  try {\n    return new Date(cleanTs).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n  } catch { return cleanTs; }\n}\n\nfunction aggregateByPeriod(data: any[], range: string): any[] {\n  // Aggregate telemetry data based on date range\n  if (!data || data.length === 0) return [];\n  \n  if (range === '24h') {\n    // 24h: downsample to ~48 points (every other 15-min = 30-min)\n    return data.filter((_, i) => i % 2 === 0 || i === data.length - 1);\n  } else if (range === '7d') {\n    // 7d: aggregate by hour (~168 points max)\n    const buckets = new Map<string, any[]>();\n    data.forEach(row => {\n      const date = new Date(row.timestamp);\n      const hourKey = `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}-${date.getHours()}`;\n      if (!buckets.has(hourKey)) buckets.set(hourKey, []);\n      buckets.get(hourKey)!.push(row);\n    });\n    \n    return Array.from(buckets.values()).map(bucket => {\n      const first = bucket[0];\n      return {\n        timestamp: first.timestamp,\n        pv1_power_w: bucket.reduce((sum, r) => sum + (r.pv1_power_w ?? 0), 0) / bucket.length,\n        pv2_power_w: bucket.reduce((sum, r) => sum + (r.pv2_power_w ?? 0), 0) / bucket.length,\n        load_power_w: bucket.reduce((sum, r) => sum + (r.load_power_w ?? 0), 0) / bucket.length,\n        grid_power_w: bucket.reduce((sum, r) => sum + (r.grid_power_w ?? 0), 0) / bucket.length,\n        battery_soc_percent: bucket.reduce((sum, r) => sum + (r.battery_soc_percent ?? 0), 0) / bucket.length,\n        pv_today_kwh: first.pv_today_kwh,\n      };\n    });\n  } else {\n    // 30d or custom: aggregate by day (max 30-90 points)\n    const buckets = new Map<string, any[]>();\n    data.forEach(row => {\n      const date = new Date(row.timestamp);\n      const dayKey = `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;\n      if (!buckets.has(dayKey)) buckets.set(dayKey, []);\n      buckets.get(dayKey)!.push(row);\n    });\n    \n    return Array.from(buckets.values()).map(bucket => {\n      const first = bucket[0];\n      // For daily aggregation, use averages for instantaneous values, max for daily energy\n      return {\n        timestamp: first.timestamp,\n        pv1_power_w: bucket.reduce((sum, r) => sum + (r.pv1_power_w ?? 0), 0) / bucket.length,\n        pv2_power_w: bucket.reduce((sum, r) => sum + (r.pv2_power_w ?? 0), 0) / bucket.length,\n        load_power_w: bucket.reduce((sum, r) => sum + (r.load_power_w ?? 0), 0) / bucket.length,\n        grid_power_w: bucket.reduce((sum, r) => sum + (r.grid_power_w ?? 0), 0) / bucket.length,\n        battery_soc_percent: bucket.reduce((sum, r) => sum + (r.battery_soc_percent ?? 0), 0) / bucket.length,\n        pv_today_kwh: Math.max(...bucket.map(r => r.pv_today_kwh ?? 0)),\n      };\n    });\n  }\n}\n\nconst TOOLTIP_STYLE = {\n  background: 'rgba(255,255,255,0.97)',\n  border: '1px solid rgba(0,166,62,0.15)',\n  borderRadius: 10,\n  color: '#0a0a0a',\n  boxShadow: '0 8px 24px rgba(0,0,0,0.1)',\n  fontSize: 12,\n};\n\n//  tiny inline icons \nconst IconSun = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#F07522\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <circle cx=\"12\" cy=\"12\" r=\"5\" fill=\"#FFD600\" stroke=\"#F07522\" strokeWidth=\"1.5\"/>\n    <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\"/>\n    <line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"23\"/>\n    <line x1=\"4.22\" y1=\"4.22\" x2=\"5.64\" y2=\"5.64\"/>\n    <line x1=\"18.36\" y1=\"18.36\" x2=\"19.78\" y2=\"19.78\"/>\n    <line x1=\"1\" y1=\"12\" x2=\"3\" y2=\"12\"/>\n    <line x1=\"21\" y1=\"12\" x2=\"23\" y2=\"12\"/>\n  </svg>\n);\nconst IconBattery = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <rect x=\"1\" y=\"6\" width=\"18\" height=\"12\" rx=\"2\"/>\n    <line x1=\"23\" y1=\"13\" x2=\"23\" y2=\"11\"/>\n    <rect x=\"3\" y=\"8\" width=\"10\" height=\"8\" fill=\"currentColor\" rx=\"1\"/>\n  </svg>\n);\nconst IconLoad = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z\"/>\n    <polyline points=\"9 22 9 12 15 12 15 22\"/>\n  </svg>\n);\nconst IconEnergy = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M13 2L3 14h9l-1 8 10-12h-9l1-8z\"/>\n  </svg>\n);\nconst IconCloud = () => (\n  <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M18 10h-1.26A8 8 0 109 20h9a5 5 0 000-10z\"/>\n  </svg>\n);\n\n//  sub-components \n\ninterface KpiCardProps {\n  label: string;\n  value: string;\n  unit?: string;\n  sub?: string;\n  accent: string;\n  icon: React.ReactNode;\n}\nconst KpiCard: React.FC<KpiCardProps> = ({ label, value, unit, sub, accent, icon }) => (\n  <div className=\"card\" style={{ padding: '1.1rem', flex: 1, minWidth: 130 }}>\n    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.4rem' }}>\n      <span style={{ fontSize: '0.7rem', fontWeight: 700, textTransform: 'uppercase', letterSpacing: '0.06em', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>{label}</span>\n      <span style={{ width: 28, height: 28, borderRadius: '50%', background: `${accent}18`, display: 'flex', alignItems: 'center', justifyContent: 'center', color: accent, flexShrink: 0 }}>{icon}</span>\n    </div>\n    <p style={{ margin: 0, fontFamily: 'JetBrains Mono, monospace', fontSize: '1.55rem', fontWeight: 800, color: '#0a0a0a', lineHeight: 1 }}>\n      {value}\n      {unit && <span style={{ fontSize: '0.8rem', fontWeight: 500, color: '#9ca3af', marginLeft: 4 }}>{unit}</span>}\n    </p>\n    {sub && <p style={{ margin: '0.25rem 0 0', fontSize: '0.7rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>{sub}</p>}\n  </div>\n);\n\n//  main component \n\ninterface Props {\n  siteId: string;\n  /** If true, auto-refreshes every 60 s */\n  autoRefresh?: boolean;\n}\n\nconst SiteDataPanel: React.FC<Props> = ({ siteId, autoRefresh = false }) => {\n  const [telemetry, setTelemetry] = useState<any[]>([]);\n  const [forecast, setForecast] = useState<any[]>([]);\n  const [weather, setWeather] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);\n  \n  // Date range controls\n  const [dateRange, setDateRange] = useState<string>('24h'); // '24h' | '7d' | '30d' | 'custom'\n  const [customStartDate, setCustomStartDate] = useState<string>('');\n  const [customEndDate, setCustomEndDate] = useState<string>('');\n\n  const fetchAll = useCallback(async () => {\n    try {\n      // Calculate date range parameters\n      let telemetryParams: any = {};\n      let forecastParams: any = {};\n      \n      if (dateRange === 'custom' && customStartDate && customEndDate) {\n        telemetryParams = {\n          start_date: new Date(customStartDate).toISOString(),\n          end_date: new Date(customEndDate).toISOString(),\n        };\n        forecastParams = {\n          start_date: new Date(customStartDate).toISOString(),\n          end_date: new Date(customEndDate).toISOString(),\n        };\n      } else if (dateRange === '7d') {\n        telemetryParams = { days: 7 };\n        // For forecast, get today's forecast\n        forecastParams = {};\n      } else if (dateRange === '30d') {\n        telemetryParams = { days: 30 };\n        forecastParams = {};\n      } else {\n        // Default 24h\n        telemetryParams = {};\n        forecastParams = {};\n      }\n      \n      const [tel, fcst, wth] = await Promise.all([\n        apiService.getSiteTelemetry(siteId, telemetryParams),\n        apiService.getSiteForecast(siteId, forecastParams),\n        apiService.getSiteWeather(siteId),\n      ]);\n      setTelemetry(Array.isArray(tel) ? tel : []);\n      setForecast(Array.isArray(fcst) ? fcst : []);\n      setWeather(wth || null);\n      setLastUpdated(new Date());\n      setError(null);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load site data');\n    } finally {\n      setLoading(false);\n    }\n  }, [siteId, dateRange, customStartDate, customEndDate]);\n\n  useEffect(() => {\n    setLoading(true);\n    fetchAll();\n    if (!autoRefresh) return;\n    const id = setInterval(fetchAll, 60_000);\n    return () => clearInterval(id);\n  }, [fetchAll, autoRefresh]);\n\n  //  derived values \n  const latest = telemetry.length > 0 ? telemetry[telemetry.length - 1] : null;\n\n  const pvKw    = latest ? ((latest.pv1_power_w ?? 0) + (latest.pv2_power_w ?? 0)) / 1000 : null;\n  const batSoc  = latest?.battery_soc_percent ?? null;\n  const loadKw  = latest ? (latest.load_power_w ?? 0) / 1000 : null;\n  const todayKwh = latest?.pv_today_kwh ?? null;\n\n  // History chart: aggregate based on date range\n  const aggregated = aggregateByPeriod(telemetry, dateRange);\n  const historyData = aggregated.map(row => ({\n    time: fmt(row.timestamp, dateRange),\n    'PV (kW)': +((( row.pv1_power_w ?? 0) + (row.pv2_power_w ?? 0)) / 1000).toFixed(2),\n    'Load (kW)': +((row.load_power_w ?? 0) / 1000).toFixed(2),\n    'Grid (kW)': +((row.grid_power_w ?? 0) / 1000).toFixed(2),\n    'Batt SOC (%)': row.battery_soc_percent ?? null,\n  }));\n\n  // Forecast chart\n  const forecastData = forecast.map(row => ({\n    time: fmtForecast(row.timestamp),\n    p50: row.p50_kw != null ? +row.p50_kw.toFixed(3) : null,\n    p10: row.p10_kw != null ? +row.p10_kw.toFixed(3) : null,\n    p90: row.p90_kw != null ? +row.p90_kw.toFixed(3) : null,\n  }));\n\n  //  render \n\n  if (loading) {\n    return (\n      <div style={{ padding: '1.5rem 0' }}>\n        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem', flexWrap: 'wrap' }}>\n          {[...Array(4)].map((_, i) => (\n            <div key={i} className=\"card skeleton\" style={{ flex: 1, minWidth: 130, height: 96 }} />\n          ))}\n        </div>\n        <div className=\"card skeleton\" style={{ height: 220, marginBottom: '1rem' }} />\n        <div className=\"card skeleton\" style={{ height: 200 }} />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div style={{ padding: '1.5rem', color: '#ef4444', fontSize: '0.85rem', background: 'rgba(239,68,68,0.06)', borderRadius: 10, marginTop: '1rem' }}>\n        Failed to load DynamoDB data for <strong>{siteId}</strong>: {error}\n      </div>\n    );\n  }\n\n  const noData = telemetry.length === 0 && forecast.length === 0 && !weather;\n\n  return (\n    <div style={{ marginTop: '1.5rem' }}>\n      {/* Section header */}\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '0.75rem', gap: '1rem', flexWrap: 'wrap' }}>\n        <p className=\"dash-section-label\" style={{ margin: 0 }}>Live Site Intelligence  <span style={{ fontFamily: 'JetBrains Mono, monospace', color: '#00a63e' }}>{siteId}</span></p>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>\n          {/* Date range selector */}\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n            <select\n              value={dateRange}\n              onChange={(e) => setDateRange(e.target.value)}\n              style={{\n                background: 'var(--card-bg, #fff)',\n                border: '1px solid rgba(0,166,62,0.2)',\n                borderRadius: 8,\n                padding: '0.3rem 0.6rem',\n                fontSize: '0.72rem',\n                color: 'var(--text-color, #0a0a0a)',\n                cursor: 'pointer',\n                fontFamily: 'Poppins, sans-serif',\n                fontWeight: 600,\n              }}\n            >\n              <option value=\"24h\">Last 24 hours</option>\n              <option value=\"7d\">Last 7 days</option>\n              <option value=\"30d\">Last 30 days</option>\n              <option value=\"custom\">Custom range</option>\n            </select>\n            \n            {dateRange === 'custom' && (\n              <>\n                <input\n                  type=\"date\"\n                  value={customStartDate}\n                  onChange={(e) => setCustomStartDate(e.target.value)}\n                  style={{\n                    background: 'var(--card-bg, #fff)',\n                    border: '1px solid rgba(0,166,62,0.2)',\n                    borderRadius: 8,\n                    padding: '0.3rem 0.6rem',\n                    fontSize: '0.72rem',\n                    color: 'var(--text-color, #0a0a0a)',\n                    fontFamily: 'Poppins, sans-serif',\n                    fontWeight: 600,\n                  }}\n                />\n                <span style={{ color: '#9ca3af', fontSize: '0.7rem' }}>to</span>\n                <input\n                  type=\"date\"\n                  value={customEndDate}\n                  onChange={(e) => setCustomEndDate(e.target.value)}\n                  style={{\n                    background: 'var(--card-bg, #fff)',\n                    border: '1px solid rgba(0,166,62,0.2)',\n                    borderRadius: 8,\n                    padding: '0.3rem 0.6rem',\n                    fontSize: '0.72rem',\n                    color: 'var(--text-color, #0a0a0a)',\n                    fontFamily: 'Poppins, sans-serif',\n                    fontWeight: 600,\n                  }}\n                />\n              </>\n            )}\n          </div>\n          \n          {lastUpdated && (\n            <span style={{ fontSize: '0.7rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>\n              Updated {lastUpdated.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n            </span>\n          )}\n          <button\n            onClick={() => { setLoading(true); fetchAll(); }}\n            style={{ background: 'none', border: '1px solid rgba(0,166,62,0.2)', borderRadius: 8, padding: '0.2rem 0.6rem', fontSize: '0.72rem', color: '#00a63e', cursor: 'pointer', fontFamily: 'Poppins, sans-serif', fontWeight: 600 }}\n          >\n             Refresh\n          </button>\n        </div>\n      </div>\n\n      {noData ? (\n        <div style={{ padding: '2rem', textAlign: 'center', color: '#9ca3af', fontSize: '0.875rem', background: 'rgba(0,166,62,0.03)', borderRadius: 12, border: '1px dashed rgba(0,166,62,0.15)' }}>\n          No DynamoDB data found for site <strong style={{ color: '#00a63e' }}>{siteId}</strong> in the last 24 h.<br />\n          <span style={{ fontSize: '0.78rem' }}>Data is written by the ML forecast scheduler when the device is actively posting telemetry.</span>\n        </div>\n      ) : (\n        <>\n          {/*  KPI strip  */}\n          <div style={{ display: 'flex', gap: '0.75rem', flexWrap: 'wrap', marginBottom: '1rem' }}>\n            <KpiCard label=\"PV Power\"     value={pvKw != null ? pvKw.toFixed(2) : ''}         unit=\"kW\"  sub=\"Current generation\"   accent=\"#F07522\" icon={<IconSun />}     />\n            <KpiCard label=\"Battery SOC\"  value={batSoc != null ? batSoc.toFixed(1) : ''}      unit=\"%\"   sub=\"State of charge\"       accent=\"#00a63e\" icon={<IconBattery />} />\n            <KpiCard label=\"Load\"         value={loadKw != null ? loadKw.toFixed(2) : ''}      unit=\"kW\"  sub=\"Current consumption\"   accent=\"#8b5cf6\" icon={<IconLoad />}    />\n            <KpiCard label=\"Energy Today\" value={todayKwh != null ? todayKwh.toFixed(2) : ''}  unit=\"kWh\" sub=\"Solar yield today\"     accent=\"#10b981\" icon={<IconEnergy />}  />\n          </div>\n\n          {/*  Weather pill row  */}\n          {weather && (\n            <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap', marginBottom: '1rem' }}>\n              {[\n                { label: 'Temp', value: weather.temperature_c != null ? `${weather.temperature_c.toFixed(1)} C` : null },\n                { label: 'Humidity', value: weather.humidity_pct != null ? `${weather.humidity_pct} %` : null },\n                { label: 'Cloud', value: weather.cloud_cover_pct != null ? `${weather.cloud_cover_pct} %` : null, icon: <IconCloud /> },\n                { label: 'Wind', value: weather.wind_speed_ms != null ? `${weather.wind_speed_ms.toFixed(1)} m/s` : null },\n                { label: 'GHI', value: weather.ghi_wm2 != null ? `${Math.round(weather.ghi_wm2)} W/m` : null },\n              ].filter(p => p.value != null).map(p => (\n                <span key={p.label} style={{\n                  fontSize: '0.72rem', fontWeight: 600, fontFamily: 'Poppins, sans-serif',\n                  padding: '0.2rem 0.65rem', borderRadius: 99,\n                  background: 'rgba(0,166,62,0.07)', border: '1px solid rgba(0,166,62,0.12)',\n                  color: '#007a55', display: 'flex', alignItems: 'center', gap: '0.3rem',\n                }}>\n                  {p.icon}{p.label}: <span style={{ fontFamily: 'JetBrains Mono, monospace', color: '#0a0a0a' }}>{p.value}</span>\n                </span>\n              ))}\n            </div>\n          )}\n\n          {/*  History chart  */}\n          {historyData.length > 0 && (\n            <div className=\"card\" style={{ padding: '1.25rem', marginBottom: '1rem' }}>\n              <div style={{ marginBottom: '1rem' }}>\n                <h3 style={{ margin: '0 0 0.25rem', fontSize: '0.9rem', fontFamily: 'Urbanist, sans-serif', color: '#0a0a0a' }}>\n                  Power History  {\n                    dateRange === '24h' ? 'Last 24 hours' :\n                    dateRange === '7d' ? 'Last 7 days' :\n                    dateRange === '30d' ? 'Last 30 days' :\n                    dateRange === 'custom' && customStartDate && customEndDate ? \n                      `${new Date(customStartDate).toLocaleDateString()} - ${new Date(customEndDate).toLocaleDateString()}` :\n                      'Custom range'\n                  }\n                </h3>\n                {(dateRange === '7d' || dateRange === '30d' || dateRange === 'custom') && (\n                  <p style={{ margin: 0, fontSize: '0.7rem', color: '#9ca3af', fontFamily: 'Poppins, sans-serif' }}>\n                    {dateRange === '7d' ? 'Data aggregated by hour' : 'Data aggregated by day'}\n                  </p>\n                )}\n              </div>\n              <div style={{ height: 220 }}>\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <AreaChart data={historyData} margin={{ top: 4, right: 8, left: 0, bottom: dateRange === '7d' || dateRange === '30d' ? 20 : 0 }}>\n                    <defs>\n                      <linearGradient id=\"pvGrad\"   x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                        <stop offset=\"5%\"  stopColor=\"#F07522\" stopOpacity={0.22}/>\n                        <stop offset=\"95%\" stopColor=\"#F07522\" stopOpacity={0}/>\n                      </linearGradient>\n                      <linearGradient id=\"loadGrad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                        <stop offset=\"5%\"  stopColor=\"#8b5cf6\" stopOpacity={0.18}/>\n                        <stop offset=\"95%\" stopColor=\"#8b5cf6\" stopOpacity={0}/>\n                      </linearGradient>\n                    </defs>\n                    <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(0,166,62,0.08)\" />\n                    <XAxis \n                      dataKey=\"time\" \n                      stroke=\"#9ca3af\" \n                      fontSize={dateRange === '30d' ? 9 : 10} \n                      interval={dateRange === '24h' ? 'preserveStartEnd' : Math.ceil(historyData.length / 10)}\n                      angle={dateRange === '7d' || dateRange === '30d' ? -15 : 0}\n                      textAnchor={dateRange === '7d' || dateRange === '30d' ? 'end' : 'middle'}\n                    />\n                    <YAxis stroke=\"#9ca3af\" fontSize={10} tickFormatter={v => `${v}kW`} />\n                    <Tooltip contentStyle={TOOLTIP_STYLE} formatter={(v: any, name: string) => [`${v} ${name.includes('%') ? '%' : 'kW'}`, name]} />\n                    <Legend iconType=\"circle\" iconSize={8} wrapperStyle={{ fontSize: 11, fontFamily: 'Poppins, sans-serif' }} />\n                    <Area type=\"monotone\" dataKey=\"PV (kW)\"   stroke=\"#F07522\" strokeWidth={2} fill=\"url(#pvGrad)\"   dot={false} />\n                    <Area type=\"monotone\" dataKey=\"Load (kW)\" stroke=\"#8b5cf6\" strokeWidth={2} fill=\"url(#loadGrad)\" dot={false} />\n                    <Line type=\"monotone\" dataKey=\"Grid (kW)\" stroke=\"#3b82f6\" strokeWidth={1.5} dot={false} strokeDasharray=\"4 3\" />\n                  </AreaChart>\n                </ResponsiveContainer>\n              </div>\n            </div>\n          )}\n\n          {/*  Forecast chart  */}\n          {forecastData.length > 0 && (\n            <div className=\"card\" style={{ padding: '1.25rem' }}>\n              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '1rem' }}>\n                <h3 style={{ margin: 0, fontSize: '0.9rem', fontFamily: 'Urbanist, sans-serif', color: '#0a0a0a' }}>\n                  Today's Solar Forecast\n                </h3>\n                <div style={{ display: 'flex', gap: '0.4rem' }}>\n                  {[{ label: 'P10 pessimistic', color: '#fbbf24' }, { label: 'P50 median', color: '#00a63e' }, { label: 'P90 optimistic', color: '#4ade80' }].map(b => (\n                    <span key={b.label} style={{ fontSize: '0.67rem', fontWeight: 600, color: '#9ca3af', display: 'flex', alignItems: 'center', gap: '0.25rem', fontFamily: 'Poppins, sans-serif' }}>\n                      <span style={{ width: 8, height: 8, borderRadius: '50%', background: b.color, display: 'inline-block' }} />\n                      {b.label}\n                    </span>\n                  ))}\n                </div>\n              </div>\n              <div style={{ height: 200 }}>\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <AreaChart data={forecastData} margin={{ top: 4, right: 8, left: 0, bottom: 0 }}>\n                    <defs>\n                      <linearGradient id=\"p50Grad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                        <stop offset=\"5%\"  stopColor=\"#00a63e\" stopOpacity={0.25}/>\n                        <stop offset=\"95%\" stopColor=\"#00a63e\" stopOpacity={0}/>\n                      </linearGradient>\n                    </defs>\n                    <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(0,166,62,0.08)\" />\n                    <XAxis dataKey=\"time\" stroke=\"#9ca3af\" fontSize={10} interval=\"preserveStartEnd\" />\n                    <YAxis stroke=\"#9ca3af\" fontSize={10} tickFormatter={v => `${v}kW`} />\n                    <Tooltip contentStyle={TOOLTIP_STYLE} formatter={(v: any) => [`${v} kW`]} />\n                    {/* Confidence band: p90 filled down to p10 */}\n                    <Area type=\"monotone\" dataKey=\"p90\" stroke=\"#4ade80\" strokeWidth={1} strokeDasharray=\"4 3\" fill=\"rgba(74,222,128,0.08)\" dot={false} />\n                    <Area type=\"monotone\" dataKey=\"p50\" stroke=\"#00a63e\" strokeWidth={2} fill=\"url(#p50Grad)\" dot={false} />\n                    <Area type=\"monotone\" dataKey=\"p10\" stroke=\"#fbbf24\" strokeWidth={1} strokeDasharray=\"4 3\" fill=\"none\" dot={false} />\n                  </AreaChart>\n                </ResponsiveContainer>\n              </div>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default SiteDataPanel;\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport { apiService } from '../services/api';\r\nimport { useDebouncedCallback } from '../hooks/useDebounce';\r\nimport AuditTrail from './AuditTrail';\r\nimport SiteDataPanel from './SiteDataPanel';\r\n\r\ninterface User {\r\n  id: number;\r\n  username: string;\r\n  first_name: string;\r\n  last_name: string;\r\n  email: string;\r\n  is_staff: boolean;\r\n  is_superuser: boolean;\r\n}\r\n\r\ninterface Device {\r\n  id: number;\r\n  device_serial: string;\r\n  hw_id?: string;\r\n  model?: string;\r\n  user?: string;\r\n  provisioned_at: string;\r\n  config_version?: string;\r\n  is_online?: boolean;\r\n  last_heartbeat?: string;\r\n  logs_enabled?: boolean;\r\n  pending_config_update?: boolean;\r\n  config_ack_ver?: number | null;\r\n  config_downloaded_at?: string | null;\r\n  config_acked_at?: string | null;\r\n  created_by_username?: string;\r\n  created_at?: string;\r\n  updated_by_username?: string;\r\n  updated_at?: string;\r\n}\r\n\r\ninterface Preset {\r\n  id: number;\r\n  config_id?: string;\r\n  name: string;\r\n  description?: string;\r\n  slaves_count?: number;\r\n  version?: number;\r\n  updated_at?: string;\r\n  gateway_configuration?: {\r\n    general_settings?: {\r\n      config_id?: string;\r\n      last_updated?: string;\r\n    };\r\n  };\r\n}\r\n\r\ninterface SystemHealthData {\r\n  total_devices: number;\r\n  active_devices: number;\r\n  total_telemetry_points: number;\r\n  uptime_seconds: number;\r\n  database_status: string;\r\n  mqtt_status: string;\r\n  overall_health: string;\r\n}\r\n\r\ninterface TelemetryData {\r\n  deviceId: string;\r\n  timestamp: string;\r\n  data_type: string;\r\n  value: number;\r\n  unit: string;\r\n}\r\n\r\ninterface TelemetrySummary {\r\n  totalPoints: number;\r\n  deviceCount: number;\r\n  latestTimestamp: string | null;\r\n}\r\n\r\ninterface SolarSite {\r\n  id: number;\r\n  device_id: number;\r\n  site_id: string;\r\n  display_name: string;\r\n  latitude: number;\r\n  longitude: number;\r\n  capacity_kw: number;\r\n  tilt_deg: number;\r\n  azimuth_deg: number;\r\n  timezone: string;\r\n  is_active: boolean;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\ninterface SolarSiteForm {\r\n  site_id: string;\r\n  display_name: string;\r\n  latitude: string;\r\n  longitude: string;\r\n  capacity_kw: string;\r\n  tilt_deg: string;\r\n  azimuth_deg: string;\r\n  timezone: string;\r\n  is_active: boolean;\r\n}\r\n\r\nconst Devices: React.FC = () => {\r\n  const [searchParams] = useSearchParams();\r\n  const [devices, setDevices] = useState<Device[]>([]);\r\n  const [filteredDevices, setFilteredDevices] = useState<Device[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [editingDevice, setEditingDevice] = useState<Device | null>(null);\r\n  const [creatingDevice, setCreatingDevice] = useState(false);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [userSearchTerm, setUserSearchTerm] = useState('');\r\n  const [filteredUsers, setFilteredUsers] = useState<User[]>([]);\r\n  const [showUserDropdown, setShowUserDropdown] = useState(false);\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [selectedDevices, setSelectedDevices] = useState<Set<number>>(new Set());\r\n  const [bulkDeleteLoading, setBulkDeleteLoading] = useState(false);\r\n  // Pagination state\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [pageSize, setPageSize] = useState(25);\r\n  const [totalCount, setTotalCount] = useState(0);\r\n  const [totalPages, setTotalPages] = useState(0);\r\n  const [presets, setPresets] = useState<Preset[]>([]);\r\n  const [presetsLoading, setPresetsLoading] = useState(true);\r\n  const [health, setHealth] = useState<SystemHealthData | null>(null);\r\n  const [telemetrySummary, setTelemetrySummary] = useState<TelemetrySummary | null>(null);\r\n  const [telemetryData, setTelemetryData] = useState<TelemetryData[]>([]);\r\n  const [dashboardError, setDashboardError] = useState<string | null>(null);\r\n  const [selectedDevice, setSelectedDevice] = useState<Device | null>(null);\r\n  const [deviceLogs, setDeviceLogs] = useState<any[]>([]);\r\n  const [logsLoading, setLogsLoading] = useState(false);\r\n  const [editForm, setEditForm] = useState({\r\n    device_serial: '',\r\n    user: '',\r\n    config_version: '',\r\n  });\r\n  const [createForm, setCreateForm] = useState({\r\n    device_serial: '',\r\n    user: '',\r\n    config_version: '',\r\n  });\r\n\r\n  // Site management state\r\n  const [siteDetails, setSiteDetails] = useState<SolarSite | null>(null);\r\n  const [siteLoading, setSiteLoading] = useState(false);\r\n  const [editingSite, setEditingSite] = useState(false);\r\n  const [siteForm, setSiteForm] = useState<SolarSiteForm>({\r\n    site_id: '', display_name: '', latitude: '', longitude: '',\r\n    capacity_kw: '', tilt_deg: '18', azimuth_deg: '180',\r\n    timezone: 'Asia/Kolkata', is_active: true,\r\n  });\r\n  const [siteSaving, setSiteSaving] = useState(false);\r\n  const [siteError, setSiteError] = useState<string | null>(null);\r\n  const [devicePreset, setDevicePreset] = useState<Preset | null>(null);\r\n\r\n  const fetchDevices = useCallback(async (page: number = 1, search: string = '') => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await apiService.getDevices(search || undefined, page, pageSize);\r\n      \r\n      // Handle paginated response\r\n      if (response.results) {\r\n        setDevices(response.results);\r\n        setFilteredDevices(response.results);\r\n        setTotalCount(response.count);\r\n        setTotalPages(response.total_pages);\r\n        setCurrentPage(response.current_page);\r\n      } else {\r\n        // Fallback for non-paginated response\r\n        setDevices(Array.isArray(response) ? response : []);\r\n        setFilteredDevices(Array.isArray(response) ? response : []);\r\n        setTotalCount(Array.isArray(response) ? response.length : 0);\r\n        setTotalPages(1);\r\n        setCurrentPage(1);\r\n      }\r\n      \r\n      setLoading(false);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'An error occurred');\r\n      setLoading(false);\r\n    }\r\n  }, [pageSize]);\r\n\r\n  const fetchUsers = async () => {\r\n    try {\r\n      const data: User[] = await apiService.getUsers();\r\n      // Filter out staff and superusers, only showing regular customers\r\n      const customers = data.filter(user => !user.is_staff && !user.is_superuser);\r\n      setUsers(customers);\r\n    } catch (err) {\r\n      console.error('Failed to fetch users:', err);\r\n      setError('Failed to load users for device assignment');\r\n    }\r\n  };\r\n\r\n  const fetchPresets = async () => {\r\n    try {\r\n      const data = await apiService.getPresets();\r\n      setPresets(Array.isArray(data) ? data : []);\r\n    } catch (err) {\r\n      console.error('Failed to fetch presets:', err);\r\n    } finally {\r\n      setPresetsLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchDashboardData = async () => {\r\n    try {\r\n      const [healthData, telemetryData] = await Promise.all([\r\n        apiService.getSystemHealth(),\r\n        apiService.getTelemetry(),\r\n      ]);\r\n\r\n      setHealth(healthData || null);\r\n\r\n      const telemetryArray = Array.isArray(telemetryData) ? telemetryData : [];\r\n      setTelemetryData(telemetryArray);\r\n      const latest = telemetryArray.reduce<string | null>((currentLatest, item) => {\r\n        if (!item?.timestamp) return currentLatest;\r\n        const itemDate = new Date(item.timestamp);\r\n        if (Number.isNaN(itemDate.getTime())) return currentLatest;\r\n        if (!currentLatest) return item.timestamp;\r\n        const currentDate = new Date(currentLatest);\r\n        return itemDate > currentDate ? item.timestamp : currentLatest;\r\n      }, null);\r\n\r\n      const deviceCount = new Set(telemetryArray.map((item: TelemetryData) => item.deviceId)).size;\r\n      setTelemetrySummary({\r\n        totalPoints: telemetryArray.length,\r\n        deviceCount,\r\n        latestTimestamp: latest,\r\n      });\r\n    } catch (err) {\r\n      console.error('Failed to fetch dashboard data:', err);\r\n      setDashboardError('Failed to load device dashboards');\r\n    }\r\n  };\r\n\r\n  const fetchDeviceLogs = useCallback(async (deviceId: number) => {\r\n    setLogsLoading(true);\r\n    try {\r\n      const response = await apiService.getDeviceLogs(deviceId, 50, 0);\r\n      setDeviceLogs(response.logs || []);\r\n    } catch (err) {\r\n      console.error('Failed to fetch device logs:', err);\r\n      setDeviceLogs([]);\r\n    } finally {\r\n      setLogsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const handleViewDevice = useCallback((device: Device) => {\r\n    setSelectedDevice(device);\r\n    setSiteDetails(null);\r\n    setSiteLoading(true);\r\n    setDeviceLogs([]);\r\n    \r\n    // Load preset details if device has config\r\n    if (device.config_version) {\r\n      const preset = presets.find(p => p.config_id === device.config_version);\r\n      setDevicePreset(preset || null);\r\n    } else {\r\n      setDevicePreset(null);\r\n    }\r\n    \r\n    // Fetch site details and logs in parallel\r\n    Promise.all([\r\n      apiService.getDeviceSite(device.id)\r\n        .then(data => setSiteDetails(data))\r\n        .catch((err) => {\r\n          console.error('Failed to fetch site for device', device.id, ':', err);\r\n          setSiteDetails(null);\r\n        }),\r\n      fetchDeviceLogs(device.id)\r\n    ]).finally(() => setSiteLoading(false));\r\n  }, [fetchDeviceLogs, presets]);\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n    fetchPresets();\r\n    fetchDashboardData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const deviceIdParam = searchParams.get('deviceId');\r\n    if (deviceIdParam) {\r\n      const deviceId = parseInt(deviceIdParam, 10);\r\n      if (!isNaN(deviceId)) {\r\n        const foundDevice = devices.find(d => d.id === deviceId);\r\n        if (foundDevice) {\r\n          handleViewDevice(foundDevice);\r\n        }\r\n      }\r\n    }\r\n  }, [searchParams, devices, handleViewDevice]);\r\n  \r\n  useEffect(() => {\r\n    fetchDevices(currentPage, searchTerm);\r\n  }, [currentPage, searchTerm, pageSize, fetchDevices]);\r\n  \r\n  useEffect(() => {\r\n    const handleClickOutside = () => {\r\n      setShowUserDropdown(false);\r\n    };\r\n\r\n    if (showUserDropdown) {\r\n      document.addEventListener('click', handleClickOutside);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('click', handleClickOutside);\r\n    };\r\n  }, [showUserDropdown]);\r\n\r\n  useEffect(() => {\r\n    if (userSearchTerm.trim() === '') {\r\n      setFilteredUsers(users);\r\n    } else {\r\n      const searchLower = userSearchTerm.toLowerCase();\r\n      const filtered = users.filter(user => {\r\n        const fullName = `${user.first_name} ${user.last_name}`.toLowerCase();\r\n        return (\r\n          user.username.toLowerCase().includes(searchLower) ||\r\n          user.first_name.toLowerCase().includes(searchLower) ||\r\n          user.last_name.toLowerCase().includes(searchLower) ||\r\n          fullName.includes(searchLower) ||\r\n          user.email.toLowerCase().includes(searchLower)\r\n        );\r\n      });\r\n      setFilteredUsers(filtered);\r\n    }\r\n  }, [users, userSearchTerm]);\r\n\r\n  // Debounced search function that runs the actual search after 300ms of inactivity\r\n  const debouncedSearch = useDebouncedCallback(\r\n    (query: string) => {\r\n      // The actual search happens via useEffect that watches currentPage and searchTerm\r\n      // This ensures we don't make too many API calls\r\n    },\r\n    300\r\n  );\r\n\r\n  const handleSearch = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const query = e.target.value;\r\n    setSearchTerm(query);\r\n    setCurrentPage(1);  // Reset to page 1 on new search\r\n    debouncedSearch(query);  // Debounce the search\r\n  };\r\n\r\n  const handleEdit = (device: Device) => {\r\n    setEditingDevice(device);\r\n    setEditForm({\r\n      device_serial: device.device_serial,\r\n      user: device.user || '',\r\n      config_version: device.config_version || '',\r\n    });\r\n    setUserSearchTerm(device.user ? `${users.find(u => u.username === device.user)?.first_name} ${users.find(u => u.username === device.user)?.last_name} (${device.user})` : '');\r\n    setShowUserDropdown(false);\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    if (!editingDevice) return;\r\n\r\n    try {\r\n      await apiService.updateDevice(editingDevice.id, editForm);\r\n      setEditingDevice(null);\r\n      // Refetch to get the updated device with all fields including audit trail\r\n      await fetchDevices(currentPage, searchTerm);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to update device');\r\n    }\r\n  };\r\n\r\n  const handleCreate = async () => {\r\n    try {\r\n      await apiService.createDevice(createForm);\r\n      setCreatingDevice(false);\r\n      setCreateForm({\r\n        device_serial: '',\r\n        user: '',\r\n        config_version: '',\r\n      });\r\n      // Refetch to get the new device with all fields including audit trail\r\n      await fetchDevices(currentPage, searchTerm);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to create device');\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (device: any) => {\r\n    if (window.confirm(`Are you sure you want to delete device ${device.device_serial}?`)) {\r\n      try {\r\n        await apiService.deleteDevice(device.id);\r\n        const updatedDevices = devices.filter(d => d.id !== device.id);\r\n        setDevices(updatedDevices);\r\n        setFilteredDevices(updatedDevices);\r\n      } catch (err) {\r\n        console.error('Delete error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to delete device');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleReboot = async (device: any) => {\r\n    if (window.confirm(`Are you sure you want to reboot device ${device.device_serial}? The device will restart on its next heartbeat.`)) {\r\n      try {\r\n        await apiService.rebootDevice(device.id);\r\n        alert(`Reboot command queued for ${device.device_serial}. Device will reboot on next heartbeat.`);\r\n      } catch (err) {\r\n        console.error('Reboot error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to queue reboot command');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleHardReset = async (device: any) => {\r\n    if (window.confirm(` WARNING: Hard reset will erase device configuration and restart it.\\n\\nAre you sure you want to hard reset device ${device.device_serial}?`)) {\r\n      try {\r\n        await apiService.hardResetDevice(device.id);\r\n        alert(`Hard reset command queued for ${device.device_serial}. Device will reset on next heartbeat.`);\r\n      } catch (err) {\r\n        console.error('Hard reset error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to queue hard reset command');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDeleteDevice = async (device: any) => {\r\n    if (window.confirm(` WARNING: This will permanently delete device ${device.device_serial} and all its data.\\n\\nAre you sure you want to delete this device?`)) {\r\n      try {\r\n        await apiService.deleteDevice(device.id);\r\n        alert(`Device ${device.device_serial} deleted successfully.`);\r\n        setSelectedDevice(null);\r\n        fetchDevices(); // Refresh device list\r\n      } catch (err) {\r\n        console.error('Delete device error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to delete device');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleToggleLogs = async (device: any, enabled: boolean) => {\r\n    try {\r\n      await apiService.toggleDeviceLogs(device.id, enabled);\r\n      setSelectedDevice({ ...device, logs_enabled: enabled });\r\n      fetchDevices(); // Refresh device list\r\n    } catch (err) {\r\n      console.error('Toggle logs error:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to toggle device logs');\r\n    }\r\n  };\r\n\r\n  const handleSelectDevice = (deviceId: number) => {\r\n    const newSelected = new Set(selectedDevices);\r\n    if (newSelected.has(deviceId)) {\r\n      newSelected.delete(deviceId);\r\n    } else {\r\n      newSelected.add(deviceId);\r\n    }\r\n    setSelectedDevices(newSelected);\r\n  };\r\n\r\n  const handleSelectAll = () => {\r\n    if (selectedDevices.size === filteredDevices.length) {\r\n      setSelectedDevices(new Set());\r\n    } else {\r\n      const allIds = new Set(filteredDevices.map(d => d.id));\r\n      setSelectedDevices(allIds);\r\n    }\r\n  };\r\n\r\n  const handleBulkDelete = async () => {\r\n    if (selectedDevices.size === 0) {\r\n      setError('No devices selected for deletion');\r\n      return;\r\n    }\r\n\r\n    const deviceList = Array.from(selectedDevices)\r\n      .map(id => devices.find(d => d.id === id))\r\n      .filter(Boolean);\r\n\r\n    const confirmMessage = `Are you sure you want to delete ${selectedDevices.size} device(s)?\\n\\n${deviceList.map(d => d?.device_serial).join(', ')}`;\r\n\r\n    if (window.confirm(confirmMessage)) {\r\n      try {\r\n        setBulkDeleteLoading(true);\r\n        await apiService.deleteDevicesBulk(Array.from(selectedDevices));\r\n        \r\n        const updatedDevices = devices.filter(d => !selectedDevices.has(d.id));\r\n        setDevices(updatedDevices);\r\n        setFilteredDevices(updatedDevices.filter(d => \r\n          d.device_serial.toLowerCase().includes(searchTerm.toLowerCase())\r\n        ));\r\n        setSelectedDevices(new Set());\r\n        setBulkDeleteLoading(false);\r\n      } catch (err) {\r\n        setBulkDeleteLoading(false);\r\n        console.error('Bulk delete error:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to delete devices');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setEditingDevice(null);\r\n    setCreatingDevice(false);\r\n    setUserSearchTerm('');\r\n    setShowUserDropdown(false);\r\n  };\r\n\r\n  const handleBackToList = () => {\r\n    setSelectedDevice(null);\r\n    setSiteDetails(null);\r\n    setEditingSite(false);\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"loading\">Loading devices...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div className=\"error\">Error: {error}</div>;\r\n  }\r\n\r\n  const getPresetConfigId = (preset: Preset): string => {\r\n    return preset.gateway_configuration?.general_settings?.config_id || preset.config_id || '';\r\n  };\r\n\r\n  if (selectedDevice) {\r\n    const deviceTelemetry = telemetryData.filter((entry) => entry.deviceId === selectedDevice.device_serial);\r\n    const latestTelemetry = deviceTelemetry.reduce<string | null>((currentLatest, item) => {\r\n      if (!item?.timestamp) return currentLatest;\r\n      const itemDate = new Date(item.timestamp);\r\n      if (Number.isNaN(itemDate.getTime())) return currentLatest;\r\n      if (!currentLatest) return item.timestamp;\r\n      const currentDate = new Date(currentLatest);\r\n      return itemDate > currentDate ? item.timestamp : currentLatest;\r\n    }, null);\r\n\r\n    return (\r\n      <div>\r\n        <div style={{ display: 'flex', alignItems: 'center', marginBottom: '20px' }}>\r\n          <button\r\n            onClick={handleBackToList}\r\n            className=\"btn btn-secondary\"\r\n            style={{ marginRight: '15px' }}\r\n          >\r\n             Back to Devices\r\n          </button>\r\n          <h1 style={{ margin: 0 }}>{selectedDevice.device_serial} Dashboard</h1>\r\n        </div>\r\n\r\n        <div className=\"card\" style={{ marginBottom: '20px' }}>\r\n          <div className=\"card-header\">\r\n            <h2>Device Details</h2>\r\n            <div style={{ display: 'flex', gap: '10px' }}>\r\n              <button onClick={() => handleEdit(selectedDevice)} className=\"btn\">\r\n                Edit Device\r\n              </button>\r\n              <button \r\n                onClick={() => handleReboot(selectedDevice)} \r\n                className=\"btn\"\r\n                style={{ \r\n                  backgroundColor: '#f59e0b', \r\n                  color: 'white',\r\n                  border: 'none'\r\n                }}\r\n                title=\"Queue reboot command for device\"\r\n              >\r\n                 Reboot\r\n              </button>\r\n              <button \r\n                onClick={() => handleHardReset(selectedDevice)} \r\n                className=\"btn\"\r\n                style={{ \r\n                  backgroundColor: '#dc2626', \r\n                  color: 'white',\r\n                  border: 'none'\r\n                }}\r\n                title=\"Queue hard reset command for device (erases config)\"\r\n              >\r\n                 Hard Reset\r\n              </button>\r\n              <button \r\n                onClick={() => handleDeleteDevice(selectedDevice)} \r\n                className=\"btn\"\r\n                style={{ \r\n                  backgroundColor: '#7f1d1d', \r\n                  color: 'white',\r\n                  border: 'none'\r\n                }}\r\n                title=\"Permanently delete device and all its data\"\r\n              >\r\n                 Delete\r\n              </button>\r\n            </div>\r\n          </div>\r\n          <div style={{ padding: '20px' }}>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '15px' }}>\r\n              <div>\r\n                <strong>Status:</strong>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  <span style={{\r\n                    display: 'inline-block',\r\n                    padding: '4px 12px',\r\n                    borderRadius: '12px',\r\n                    fontSize: '0.875rem',\r\n                    fontWeight: '500',\r\n                    backgroundColor: selectedDevice.is_online ? '#dcfce7' : '#fee2e2',\r\n                    color: selectedDevice.is_online ? '#166534' : '#991b1b'\r\n                  }}>\r\n                    {selectedDevice.is_online ? ' Online' : ' Offline'}\r\n                  </span>\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <strong>Last Heartbeat:</strong>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  {selectedDevice.last_heartbeat\r\n                    ? new Date(selectedDevice.last_heartbeat).toLocaleString()\r\n                    : 'Never'}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <strong>MAC / HW ID:</strong>\r\n                <p style={{ margin: '5px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.9rem' }}>{selectedDevice.hw_id || ''}</p>\r\n              </div>\r\n              <div>\r\n                <strong>Model:</strong>\r\n                <p style={{ margin: '5px 0' }}>{selectedDevice.model || ''}</p>\r\n              </div>\r\n              <div>\r\n                <strong>Assigned User:</strong>\r\n                <p style={{ margin: '5px 0' }}>{selectedDevice.user || '-'}</p>\r\n              </div>\r\n              <div style={{ gridColumn: '1 / -1', padding: '15px', backgroundColor: 'transparent', borderRadius: '8px', border: '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-sync-card\">\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '12px' }}>\r\n                  <div>\r\n                    <strong style={{ fontSize: '0.95rem', color: 'inherit' }} className=\"config-heading\">Configuration</strong>\r\n                    {devicePreset && (\r\n                      <div style={{ fontSize: '0.875rem', color: 'rgba(0, 0, 0, 0.6)', marginTop: '2px' }} className=\"config-label\">\r\n                        {devicePreset.name || selectedDevice.config_version}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  {!selectedDevice.config_version ? (\r\n                    <span style={{ color: 'rgba(0, 0, 0, 0.5)', fontSize: '0.875rem' }} className=\"config-no-preset\">No preset assigned</span>\r\n                  ) : selectedDevice.pending_config_update ? (\r\n                    <span style={{\r\n                      display: 'inline-flex', alignItems: 'center', gap: '5px',\r\n                      padding: '4px 12px', borderRadius: '12px', fontSize: '0.8rem', fontWeight: '500',\r\n                      backgroundColor: '#fef9c3', color: '#854d0e'\r\n                    }}> Pending update</span>\r\n                  ) : (\r\n                    <span style={{\r\n                      display: 'inline-flex', alignItems: 'center', gap: '5px',\r\n                      padding: '4px 12px', borderRadius: '12px', fontSize: '0.8rem', fontWeight: '500',\r\n                      backgroundColor: '#dcfce7', color: '#166534'\r\n                    }}> Synced</span>\r\n                  )}\r\n                </div>\r\n                {selectedDevice.config_version && (\r\n                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '8px', fontSize: '0.8rem' }}>\r\n                    <div style={{ padding: '8px', backgroundColor: 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                      <div style={{ color: 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Preset ID</div>\r\n                      <div style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>{selectedDevice.config_version}</div>\r\n                    </div>\r\n                    {devicePreset?.slaves_count != null && (\r\n                      <div style={{ padding: '8px', backgroundColor: 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                        <div style={{ color: 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Slaves</div>\r\n                        <div style={{ fontWeight: '500', color: 'inherit' }}>{devicePreset.slaves_count} device{devicePreset.slaves_count !== 1 ? 's' : ''}</div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_ack_ver != null && devicePreset?.version != null && (\r\n                      <div style={{ \r\n                        padding: '8px', \r\n                        backgroundColor: 'rgba(0, 0, 0, 0.05)', \r\n                        borderRadius: '6px',\r\n                        gridColumn: '1 / -1',\r\n                        border: selectedDevice.config_ack_ver === devicePreset.version ? '2px solid #dcfce7' : '2px solid #fef9c3'\r\n                      }} className=\"config-info-box\">\r\n                        <div style={{ color: 'rgba(0, 0, 0, 0.6)', marginBottom: '4px' }} className=\"config-label\">Version Status</div>\r\n                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                          <div>\r\n                            <span style={{ fontSize: '0.75rem', color: 'rgba(0, 0, 0, 0.6)' }} className=\"config-label\">Device: </span>\r\n                            <span style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>v{selectedDevice.config_ack_ver}</span>\r\n                            <span style={{ margin: '0 8px', color: 'rgba(0, 0, 0, 0.4)' }} className=\"config-arrow\"></span>\r\n                            <span style={{ fontSize: '0.75rem', color: 'rgba(0, 0, 0, 0.6)' }} className=\"config-label\">Latest: </span>\r\n                            <span style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>v{devicePreset.version}</span>\r\n                          </div>\r\n                          {selectedDevice.config_ack_ver === devicePreset.version ? (\r\n                            <span style={{ color: '#166534', fontSize: '0.75rem', fontWeight: '500' }}> Up to date</span>\r\n                          ) : (\r\n                            <span style={{ color: '#854d0e', fontSize: '0.75rem', fontWeight: '500' }}> Update available</span>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_ack_ver != null && devicePreset?.version == null && (\r\n                      <div style={{ padding: '8px', backgroundColor: 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                        <div style={{ color: 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Device Version</div>\r\n                        <div style={{ fontWeight: '500', fontFamily: 'monospace', color: 'inherit' }}>v{selectedDevice.config_ack_ver}</div>\r\n                      </div>\r\n                    )}\r\n                    {devicePreset?.gateway_configuration?.general_settings?.last_updated && (\r\n                      <div style={{ padding: '8px', backgroundColor: 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: '1px solid rgba(0, 0, 0, 0.1)' }} className=\"config-info-box\">\r\n                        <div style={{ color: 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Last Modified</div>\r\n                        <div style={{ fontWeight: '500', fontSize: '0.75rem', color: 'inherit' }}>\r\n                          {new Date(devicePreset.gateway_configuration.general_settings.last_updated).toLocaleDateString()}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_acked_at && (\r\n                      <div style={{ padding: '8px', backgroundColor: 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: '1px solid rgba(0, 0, 0, 0.1)', gridColumn: '1 / -1' }} className=\"config-info-box\">\r\n                        <div style={{ color: 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Last Synced</div>\r\n                        <div style={{ fontWeight: '500', fontSize: '0.75rem', color: 'inherit' }}>\r\n                          {new Date(selectedDevice.config_acked_at).toLocaleString()}\r\n                          {(() => {\r\n                            const ackTime = new Date(selectedDevice.config_acked_at);\r\n                            const now = new Date();\r\n                            const diffMs = now.getTime() - ackTime.getTime();\r\n                            const diffMins = Math.floor(diffMs / 60000);\r\n                            const diffHours = Math.floor(diffMins / 60);\r\n                            const diffDays = Math.floor(diffHours / 24);\r\n                            if (diffMins < 1) return '  just now';\r\n                            if (diffMins < 60) return `  ${diffMins}m ago`;\r\n                            if (diffHours < 24) return `  ${diffHours}h ago`;\r\n                            return `  ${diffDays}d ago`;\r\n                          })()}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {selectedDevice.config_downloaded_at && selectedDevice.config_acked_at && (\r\n                      <div style={{ padding: '8px', backgroundColor: 'rgba(0, 0, 0, 0.05)', borderRadius: '6px', border: '1px solid rgba(0, 0, 0, 0.1)', gridColumn: '1 / -1' }} className=\"config-info-box\">\r\n                        <div style={{ color: 'rgba(0, 0, 0, 0.6)', marginBottom: '2px' }} className=\"config-label\">Apply Duration</div>\r\n                        <div style={{ fontWeight: '500', color: 'inherit' }}>\r\n                          {Math.round((new Date(selectedDevice.config_acked_at).getTime() - new Date(selectedDevice.config_downloaded_at).getTime()) / 1000)} seconds\r\n                          <span style={{ color: 'rgba(0, 0, 0, 0.5)', marginLeft: '8px', fontSize: '0.75rem' }} className=\"config-label\">\r\n                            (download  acknowledge)\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div>\r\n                <strong>Provisioned At:</strong>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  {selectedDevice.provisioned_at\r\n                    ? new Date(selectedDevice.provisioned_at).toLocaleDateString()\r\n                    : 'N/A'}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <strong>Created By:</strong>\r\n                <p style={{ margin: '5px 0' }}>{selectedDevice.created_by_username || '-'}</p>\r\n              </div>\r\n              <div style={{ gridColumn: '1 / -1' }}>\r\n                <label style={{ display: 'flex', alignItems: 'center', gap: '10px', cursor: 'pointer' }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedDevice.logs_enabled || false}\r\n                    onChange={(e) => handleToggleLogs(selectedDevice, e.target.checked)}\r\n                  />\r\n                  <strong>Enable Device Logs</strong>\r\n                  <span style={{ fontSize: '0.875rem', color: 'var(--text-muted, #9ca3af)' }}>\r\n                    (Device will send logs when enabled)\r\n                  </span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-2\" style={{ gap: 'var(--space-6, 24px)', marginTop: '32px' }}>\r\n          <div className=\"card\">\r\n            <h2>System Health</h2>\r\n            {dashboardError && <p className=\"error\">{dashboardError}</p>}\r\n            {!dashboardError && !health && <p>Loading system health...</p>}\r\n            {health && (\r\n              <div>\r\n                <p><strong>Overall:</strong> {health.overall_health}</p>\r\n                <p><strong>Devices:</strong> {health.active_devices}/{health.total_devices} active</p>\r\n                <p><strong>Telemetry Points:</strong> {health.total_telemetry_points.toLocaleString()}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"card\">\r\n            <h2>Telemetry Snapshot</h2>\r\n            {dashboardError && <p className=\"error\">{dashboardError}</p>}\r\n            {!dashboardError && !telemetrySummary && <p>Loading telemetry...</p>}\r\n            {telemetrySummary && (\r\n              <div>\r\n                <p><strong>Total Points:</strong> {deviceTelemetry.length.toLocaleString()}</p>\r\n                <p><strong>Data Types:</strong> {new Set(deviceTelemetry.map((entry) => entry.data_type)).size}</p>\r\n                <p><strong>Latest:</strong> {latestTelemetry ? new Date(latestTelemetry).toLocaleString() : 'N/A'}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  Site Configuration  */}\r\n        <div className=\"card\" style={{ marginTop: '48px' }}>\r\n          <div className=\"card-header\">\r\n            <h2>Site Configuration</h2>\r\n            {!siteLoading && (\r\n              <button className=\"btn\" onClick={() => {\r\n                if (siteDetails) {\r\n                  setSiteForm({\r\n                    site_id: siteDetails.site_id,\r\n                    display_name: siteDetails.display_name,\r\n                    latitude: String(siteDetails.latitude),\r\n                    longitude: String(siteDetails.longitude),\r\n                    capacity_kw: String(siteDetails.capacity_kw),\r\n                    tilt_deg: String(siteDetails.tilt_deg),\r\n                    azimuth_deg: String(siteDetails.azimuth_deg),\r\n                    timezone: siteDetails.timezone,\r\n                    is_active: siteDetails.is_active,\r\n                  });\r\n                } else {\r\n                  setSiteForm({ site_id: '', display_name: '', latitude: '', longitude: '', capacity_kw: '', tilt_deg: '18', azimuth_deg: '180', timezone: 'Asia/Kolkata', is_active: true });\r\n                }\r\n                setSiteError(null);\r\n                setEditingSite(true);\r\n              }}>\r\n                {siteDetails ? 'Edit Site' : 'Add Site'}\r\n              </button>\r\n            )}\r\n          </div>\r\n          <div style={{ padding: '20px' }}>\r\n            {siteLoading ? (\r\n              <p style={{ color: 'var(--text-muted)' }}>Loading site details</p>\r\n            ) : !siteDetails ? (\r\n              <p style={{ color: 'var(--text-muted)', fontSize: '0.9rem' }}>No site configured for this device yet.</p>\r\n            ) : (\r\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '15px' }}>\r\n                <div><strong>Site ID:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.88rem', color: '#00a63e' }}>{siteDetails.site_id}</p></div>\r\n                <div><strong>Display Name:</strong><p style={{ margin: '4px 0' }}>{siteDetails.display_name || ''}</p></div>\r\n                <div><strong>Status:</strong><p style={{ margin: '4px 0' }}><span className={siteDetails.is_active ? 'status-badge status-badge-success' : 'status-badge status-badge-danger'}>{siteDetails.is_active ? 'Active' : 'Inactive'}</span></p></div>\r\n                <div><strong>Latitude:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.88rem' }}>{siteDetails.latitude}</p></div>\r\n                <div><strong>Longitude:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.88rem' }}>{siteDetails.longitude}</p></div>\r\n                <div><strong>Timezone:</strong><p style={{ margin: '4px 0' }}>{siteDetails.timezone}</p></div>\r\n                <div><strong>Capacity:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace' }}>{siteDetails.capacity_kw} kW</p></div>\r\n                <div><strong>Tilt:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace' }}>{siteDetails.tilt_deg}</p></div>\r\n                <div><strong>Azimuth:</strong><p style={{ margin: '4px 0', fontFamily: 'JetBrains Mono, monospace' }}>{siteDetails.azimuth_deg}</p></div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  Live Site Intelligence (DynamoDB)  */}\r\n        {siteDetails && (\r\n          <div style={{ marginTop: '48px' }}>\r\n            <SiteDataPanel siteId={siteDetails.site_id} autoRefresh />\r\n          </div>\r\n        )}\r\n\r\n        {/*  Device Logs  */}\r\n        <div className=\"card\" style={{ marginTop: '48px', marginBottom: '20px' }}>\r\n          <div className=\"card-header\">\r\n            <h2>Device Logs</h2>\r\n            <button onClick={() => fetchDeviceLogs(selectedDevice.id)} className=\"btn\" disabled={logsLoading}>\r\n              {logsLoading ? 'Loading...' : ' Refresh'}\r\n            </button>\r\n          </div>\r\n          <div style={{ padding: '20px' }}>\r\n            {!selectedDevice.logs_enabled && (\r\n              <p style={{ color: 'var(--text-muted, #9ca3af)', fontStyle: 'italic' }}>\r\n                Logging is disabled for this device. Enable it in Device Details to receive logs.\r\n              </p>\r\n            )}\r\n            {deviceLogs.length === 0 && selectedDevice.logs_enabled && !logsLoading && (\r\n              <p style={{ color: 'var(--text-muted, #9ca3af)' }}>\r\n                No logs available yet. Logs will appear when device sends them.\r\n              </p>\r\n            )}\r\n            {logsLoading && (\r\n              <p style={{ color: 'var(--text-muted, #9ca3af)' }}>\r\n                Loading logs...\r\n              </p>\r\n            )}\r\n            {deviceLogs.length > 0 && (\r\n              <div style={{ \r\n                maxHeight: '400px', \r\n                overflowY: 'auto', \r\n                fontFamily: 'JetBrains Mono, monospace', \r\n                fontSize: '0.85rem',\r\n                backgroundColor: '#1e1e1e',\r\n                padding: '10px',\r\n                borderRadius: '4px'\r\n              }}>\r\n                {deviceLogs.map((log) => (\r\n                  <div key={log.id} style={{ \r\n                    marginBottom: '8px', \r\n                    paddingBottom: '8px', \r\n                    borderBottom: '1px solid #333',\r\n                    color: log.level === 'ERROR' ? '#ff6b6b' : \r\n                           log.level === 'WARNING' ? '#ffa500' : \r\n                           log.level === 'INFO' ? '#4dabf7' : '#ced4da'\r\n                  }}>\r\n                    <span style={{ color: '#888' }}>[{new Date(log.timestamp).toLocaleString()}]</span>\r\n                    <span style={{ fontWeight: 'bold', marginLeft: '8px' }}>[{log.level}]</span>\r\n                    <span style={{ marginLeft: '8px' }}>{log.message}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  Site edit modal  */}\r\n        {editingSite && (\r\n          <div className=\"modal\">\r\n            <div className=\"modal-content\">\r\n              <h3>{siteDetails ? `Edit Site: ${siteDetails.site_id}` : 'Add Site Configuration'}</h3>\r\n              <form onSubmit={async (e) => {\r\n                e.preventDefault();\r\n                setSiteSaving(true);\r\n                setSiteError(null);\r\n                try {\r\n                  const payload = {\r\n                    site_id: siteForm.site_id.trim(),\r\n                    display_name: siteForm.display_name.trim(),\r\n                    latitude: parseFloat(siteForm.latitude),\r\n                    longitude: parseFloat(siteForm.longitude),\r\n                    capacity_kw: parseFloat(siteForm.capacity_kw),\r\n                    tilt_deg: parseFloat(siteForm.tilt_deg),\r\n                    azimuth_deg: parseFloat(siteForm.azimuth_deg),\r\n                    timezone: siteForm.timezone.trim(),\r\n                    is_active: siteForm.is_active,\r\n                  };\r\n\r\n                  let updated;\r\n                  if (siteDetails) {\r\n                    updated = await apiService.updateDeviceSite(selectedDevice.id, payload);\r\n                  } else {\r\n                    updated = await apiService.createDeviceSite(selectedDevice.id, payload);\r\n                  }\r\n\r\n                  if (!updated || !updated.site_id) {\r\n                    throw new Error('Invalid response from server  site data missing');\r\n                  }\r\n\r\n                  setSiteDetails(updated);\r\n                  setEditingSite(false);\r\n                  setSiteSaving(false);\r\n\r\n                  // Re-fetch after creation to get server-assigned fields\r\n                  if (!siteDetails) {\r\n                    setTimeout(() => {\r\n                      apiService.getDeviceSite(selectedDevice.id)\r\n                        .then(data => { if (data) setSiteDetails(data); })\r\n                        .catch(err => console.error('Failed to re-fetch site:', err));\r\n                    }, 500);\r\n                  }\r\n                } catch (err: any) {\r\n                  setSiteError(err.message || 'Failed to save site');\r\n                  setSiteSaving(false);\r\n                }\r\n              }}>\r\n                <div className=\"modal-body\">\r\n                  {siteError && (\r\n                    <p style={{ color: 'var(--danger-color, #ef4444)', fontSize: '0.875rem', marginBottom: '1rem' }}>{siteError}</p>\r\n                  )}\r\n\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Identification</h4>\r\n                    <div className=\"form-grid form-grid-2\">\r\n                      <div className=\"form-group\">\r\n                        <label>Site ID *</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          required\r\n                          value={siteForm.site_id}\r\n                          disabled={!!siteDetails}\r\n                          onChange={e => setSiteForm({ ...siteForm, site_id: e.target.value })}\r\n                          placeholder=\"e.g. site_mumbai_01\"\r\n                          autoComplete=\"off\"\r\n                        />\r\n                        {!!siteDetails && <small className=\"form-hint\">Site ID cannot be changed after creation.</small>}\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Display Name</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={siteForm.display_name}\r\n                          onChange={e => setSiteForm({ ...siteForm, display_name: e.target.value })}\r\n                          placeholder=\"e.g. Mumbai Rooftop\"\r\n                          autoComplete=\"off\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Location</h4>\r\n                    <div className=\"form-grid form-grid-3\">\r\n                      <div className=\"form-group\">\r\n                        <label>Latitude *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          required\r\n                          step=\"any\"\r\n                          value={siteForm.latitude}\r\n                          onChange={e => setSiteForm({ ...siteForm, latitude: e.target.value })}\r\n                          placeholder=\"19.0760\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Longitude *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          required\r\n                          step=\"any\"\r\n                          value={siteForm.longitude}\r\n                          onChange={e => setSiteForm({ ...siteForm, longitude: e.target.value })}\r\n                          placeholder=\"72.8777\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Timezone</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={siteForm.timezone}\r\n                          onChange={e => setSiteForm({ ...siteForm, timezone: e.target.value })}\r\n                          placeholder=\"Asia/Kolkata\"\r\n                          autoComplete=\"off\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Panel Configuration</h4>\r\n                    <div className=\"form-grid form-grid-3\">\r\n                      <div className=\"form-group\">\r\n                        <label>Capacity (kW) *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          required\r\n                          step=\"any\"\r\n                          value={siteForm.capacity_kw}\r\n                          onChange={e => setSiteForm({ ...siteForm, capacity_kw: e.target.value })}\r\n                          placeholder=\"5.0\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Tilt ()</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          step=\"any\"\r\n                          value={siteForm.tilt_deg}\r\n                          onChange={e => setSiteForm({ ...siteForm, tilt_deg: e.target.value })}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Azimuth ()</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          step=\"any\"\r\n                          value={siteForm.azimuth_deg}\r\n                          onChange={e => setSiteForm({ ...siteForm, azimuth_deg: e.target.value })}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label style={{ display: 'flex', alignItems: 'center', gap: '8px', cursor: 'pointer' }}>\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          id=\"dev-site-active\"\r\n                          checked={siteForm.is_active}\r\n                          onChange={e => setSiteForm({ ...siteForm, is_active: e.target.checked })}\r\n                          style={{ width: '16px', height: '16px' }}\r\n                        />\r\n                        Active\r\n                      </label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"form-actions\" style={{ padding: '0 24px 24px 24px' }}>\r\n                  <button type=\"submit\" className=\"btn\" disabled={siteSaving}>\r\n                    {siteSaving ? 'Saving' : siteDetails ? 'Save Changes' : 'Add Site'}\r\n                  </button>\r\n                  <button type=\"button\" className=\"btn btn-secondary\" onClick={() => setEditingSite(false)} disabled={siteSaving}>\r\n                    Cancel\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {editingDevice && (\r\n          <div className=\"modal\">\r\n            <div className=\"modal-content\">\r\n              <h3>{editingDevice ? `Edit Device: ${editingDevice.device_serial}` : 'Register New Device'}</h3>\r\n              <form onSubmit={(e) => { e.preventDefault(); editingDevice ? handleSave() : handleCreate(); }}>\r\n                <div className=\"modal-body\">\r\n                  \r\n                  {/* Device Identity */}\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Device Identity</h4>\r\n                    <div className=\"form-grid\">\r\n                      <div className=\"form-group\">\r\n                        <label>Device Serial Number</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={editingDevice ? editForm.device_serial : createForm.device_serial}\r\n                          onChange={(e) => editingDevice ? setEditForm({...editForm, device_serial: e.target.value}) : setCreateForm({...createForm, device_serial: e.target.value})}\r\n                          required\r\n                          autoComplete=\"off\"\r\n                          placeholder=\"SN-12345678\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Ownership */}\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Ownership & Assignment</h4>\r\n                    <div className=\"form-grid\">\r\n                      <div className=\"form-group\">\r\n                        <label>Assigned User</label>\r\n                        <div style={{ position: 'relative' }} onClick={(e) => e.stopPropagation()}>\r\n                          <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search by name, username, or email...\"\r\n                            value={userSearchTerm}\r\n                            onChange={(e) => {\r\n                              setUserSearchTerm(e.target.value);\r\n                              setShowUserDropdown(true);\r\n                            }}\r\n                            onFocus={() => setShowUserDropdown(true)}\r\n                            autoComplete=\"off\"\r\n                            className=\"full-width\"\r\n                          />\r\n                          {showUserDropdown && (\r\n                            <div style={{\r\n                              position: 'absolute',\r\n                              top: '100%',\r\n                              left: '0',\r\n                              right: '0',\r\n                              background: 'var(--bg-secondary, #1e293b)',\r\n                              border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                              borderRadius: '6px',\r\n                              marginTop: '4px',\r\n                              maxHeight: '200px',\r\n                              overflowY: 'auto',\r\n                              zIndex: 10,\r\n                              boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)'\r\n                            }}>\r\n                              {filteredUsers.length > 0 ? (\r\n                                filteredUsers.map((user) => (\r\n                                  <div\r\n                                    key={user.id}\r\n                                    onClick={() => {\r\n                                      if (editingDevice) {\r\n                                        setEditForm({...editForm, user: user.username});\r\n                                      } else {\r\n                                        setCreateForm({...createForm, user: user.username});\r\n                                      }\r\n                                      setUserSearchTerm(`${user.first_name} ${user.last_name} (${user.username})`);\r\n                                      setShowUserDropdown(false);\r\n                                    }}\r\n                                    style={{\r\n                                      padding: '12px 16px',\r\n                                      cursor: 'pointer',\r\n                                      borderBottom: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n                                      background: (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent',\r\n                                      color: 'var(--text-primary, #f8fafc)',\r\n                                      transition: 'all 0.15s ease',\r\n                                      fontSize: '0.875rem'\r\n                                    }}\r\n                                    onMouseEnter={(e) => e.currentTarget.style.background = 'rgba(255, 255, 255, 0.06)'}\r\n                                    onMouseLeave={(e) => e.currentTarget.style.background = (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent'}\r\n                                  >\r\n                                    {user.first_name} {user.last_name} ({user.username}) <br/>\r\n                                    <span style={{ fontSize: '0.75rem', color: 'var(--text-secondary, #94a3b8)' }}>{user.email}</span>\r\n                                  </div>\r\n                                ))\r\n                              ) : (\r\n                                <div style={{ padding: '12px 16px', color: 'var(--text-muted, #64748b)', fontSize: '0.875rem' }}>\r\n                                  {userSearchTerm.trim() === '' ? 'Start typing to search users...' : 'No users found'}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Configuration */}\r\n                  <div className=\"form-section\">\r\n                    <h4 className=\"form-section-title\">Configuration</h4>\r\n                    <div className=\"form-grid form-grid-2\">\r\n                      <div className=\"form-group\">\r\n                        <label>Preset Template</label>\r\n                        <select\r\n                          value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                          onChange={(e) => editingDevice ? setEditForm({ ...editForm, config_version: e.target.value }) : setCreateForm({ ...createForm, config_version: e.target.value })}\r\n                          className=\"full-width\"\r\n                        >\r\n                          <option value=\"\">-- Manual Configuration --</option>\r\n                          {presetsLoading && <option value=\"\" disabled>Loading presets...</option>}\r\n                          {!presetsLoading && presets.map((preset) => (\r\n                            <option key={preset.id} value={getPresetConfigId(preset)}>\r\n                              {preset.name} ({getPresetConfigId(preset) || 'no ID'})\r\n                            </option>\r\n                          ))}\r\n                        </select>\r\n                        <small className=\"form-hint\">Selecting a preset sets the Config Version ID below.</small>\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label>Config Version ID</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                          onChange={(e) => editingDevice ? setEditForm({...editForm, config_version: e.target.value}) : setCreateForm({...createForm, config_version: e.target.value})}\r\n                          autoComplete=\"off\"\r\n                          placeholder=\"Manual Config ID\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                </div>\r\n                {editingDevice && (\r\n                  <div style={{ padding: '0 24px' }}>\r\n                     <AuditTrail\r\n                       createdBy={editingDevice.created_by_username}\r\n                       createdAt={editingDevice.created_at}\r\n                       updatedBy={editingDevice.updated_by_username}\r\n                       updatedAt={editingDevice.updated_at}\r\n                     />\r\n                  </div>\r\n                )}\r\n                <div className=\"form-actions\" style={{ padding: '0 24px 24px 24px' }}>\r\n                  <button type=\"submit\" className=\"btn\">{editingDevice ? 'Save Changes' : 'Create Device'}</button>\r\n                  <button type=\"button\" onClick={handleCancel} className=\"btn btn-secondary\">Cancel</button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h1>Device Management</h1>\r\n\r\n      <div className=\"card\">\r\n        <div className=\"card-header\">\r\n          <h2>Devices ({filteredDevices.length})</h2>\r\n          <div className=\"card-actions\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search devices...\"\r\n              value={searchTerm}\r\n              onChange={handleSearch}\r\n              className=\"search-input\"\r\n            />\r\n            {selectedDevices.size > 0 && (\r\n              <button \r\n                onClick={handleBulkDelete}\r\n                disabled={bulkDeleteLoading}\r\n                style={{ \r\n                  background: 'var(--danger-color, #ef4444)',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  padding: '8px 16px',\r\n                  borderRadius: '6px',\r\n                  cursor: bulkDeleteLoading ? 'not-allowed' : 'pointer',\r\n                  fontSize: '0.875rem',\r\n                  fontWeight: '500',\r\n                  opacity: bulkDeleteLoading ? '0.6' : '1'\r\n                }}\r\n              >\r\n                {bulkDeleteLoading ? `Deleting ${selectedDevices.size}...` : `Delete Selected (${selectedDevices.size})`}\r\n              </button>\r\n            )}\r\n            <button onClick={() => {\r\n              setCreatingDevice(true);\r\n              setUserSearchTerm('');\r\n              setShowUserDropdown(false);\r\n            }} className=\"btn\">\r\n              Register New Device\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <table className=\"table\">\r\n          <thead>\r\n            <tr>\r\n              <th style={{ textAlign: 'center', width: '40px' }}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={selectedDevices.size === filteredDevices.length && filteredDevices.length > 0}\r\n                  onChange={handleSelectAll}\r\n                  title=\"Select all displayed devices\"\r\n                />\r\n              </th>\r\n              <th style={{ textAlign: 'center' }}>Device Serial</th>\r\n              <th style={{ textAlign: 'center' }}>Status</th>\r\n              <th style={{ textAlign: 'center' }}>MAC / HW ID</th>\r\n              <th style={{ textAlign: 'center' }}>Model</th>\r\n              <th style={{ textAlign: 'center' }}>Assigned To</th>\r\n              <th style={{ textAlign: 'center' }}>Config Version</th>\r\n              <th style={{ textAlign: 'center' }}>Provisioned At</th>\r\n              <th style={{ textAlign: 'center' }}>Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {filteredDevices.map((device) => (\r\n              <tr\r\n                key={device.id}\r\n                onClick={() => handleViewDevice(device)}\r\n                style={{\r\n                  background: selectedDevices.has(device.id) ? 'rgba(99, 102, 241, 0.1)' : 'transparent',\r\n                  cursor: 'pointer'\r\n                }}\r\n                className=\"clickable-row\"\r\n              >\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedDevices.has(device.id)}\r\n                    onChange={() => handleSelectDevice(device.id)}\r\n                  />\r\n                </td>\r\n                <td style={{ textAlign: 'center', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.85rem' }}>{device.device_serial}</td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <span style={{\r\n                    display: 'inline-block',\r\n                    padding: '4px 8px',\r\n                    borderRadius: '12px',\r\n                    fontSize: '0.75rem',\r\n                    fontWeight: '500',\r\n                    backgroundColor: device.is_online ? '#dcfce7' : '#fee2e2',\r\n                    color: device.is_online ? '#166534' : '#991b1b'\r\n                  }}>\r\n                    {device.is_online ? ' Online' : ' Offline'}\r\n                  </span>\r\n                </td>\r\n                <td style={{ textAlign: 'center', fontFamily: 'JetBrains Mono, monospace', fontSize: '0.82rem', color: device.hw_id ? 'inherit' : 'var(--text-muted, #9ca3af)' }}>{device.hw_id || ''}</td>\r\n                <td style={{ textAlign: 'center', fontSize: '0.875rem' }}>{device.model || <span style={{ color: 'var(--text-muted, #9ca3af)' }}></span>}</td>\r\n                <td style={{ textAlign: 'center' }}>{device.user || '-'}</td>\r\n                <td style={{ textAlign: 'center' }}>{device.config_version || '-'}</td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  {(() => {\r\n                    if (!device.provisioned_at) return 'N/A';\r\n                    const date = new Date(device.provisioned_at);\r\n                    return isNaN(date.getTime()) ? 'Invalid Date' : date.toLocaleDateString();\r\n                  })()}\r\n                </td>\r\n                <td style={{ textAlign: 'center' }}>\r\n                  <button\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleEdit(device);\r\n                    }}\r\n                    style={{ background: 'none', border: 'none', cursor: 'pointer', color: 'var(--text-secondary, #94a3b8)', margin: '0 6px' }}\r\n                    title=\"Edit\"\r\n                  >\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                      <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\r\n                      <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\r\n                    </svg>\r\n                  </button>\r\n                  <button\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleDelete(device);\r\n                    }}\r\n                    style={{ background: 'none', border: 'none', cursor: 'pointer', color: 'var(--danger-color, #ef4444)', margin: '0 6px' }}\r\n                    title=\"Delete\"\r\n                  >\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                      <polyline points=\"3,6 5,6 21,6\"></polyline>\r\n                      <path d=\"M19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2\"></path>\r\n                      <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\"></line>\r\n                      <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\"></line>\r\n                    </svg>\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n        \r\n        {/* Pagination Controls */}\r\n        {totalCount > 0 && (\r\n          <div style={{\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            padding: '16px',\r\n            borderTop: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n            gap: '16px'\r\n          }}>\r\n            <div style={{ fontSize: '0.875rem', color: 'var(--text-secondary, #94a3b8)' }}>\r\n              Showing {((currentPage - 1) * pageSize) + 1} - {Math.min(currentPage * pageSize, totalCount)} of {totalCount} devices\r\n            </div>\r\n            \r\n            <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>\r\n              <button\r\n                onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\r\n                disabled={currentPage === 1}\r\n                style={{\r\n                  padding: '8px 12px',\r\n                  border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                  borderRadius: '6px',\r\n                  background: currentPage === 1 ? 'rgba(148, 163, 184, 0.1)' : 'transparent',\r\n                  color: 'var(--text-primary, #f8fafc)',\r\n                  cursor: currentPage === 1 ? 'not-allowed' : 'pointer',\r\n                  opacity: currentPage === 1 ? '0.5' : '1'\r\n                }}\r\n              >\r\n                 Previous\r\n              </button>\r\n              \r\n              <div style={{ display: 'flex', gap: '4px', alignItems: 'center' }}>\r\n                {(() => {\r\n                  const pages = [];\r\n                  \r\n                  for (let i = 1; i <= totalPages; i++) {\r\n                    // Always show first page, last page, current page, and adjacent pages\r\n                    const showPage = i === 1 || i === totalPages || Math.abs(i - currentPage) <= 1;\r\n                    \r\n                    if (showPage) {\r\n                      pages.push(\r\n                        <button\r\n                          key={i}\r\n                          onClick={() => setCurrentPage(i)}\r\n                          style={{\r\n                            padding: '6px 10px',\r\n                            border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                            borderRadius: '4px',\r\n                            background: i === currentPage ? 'rgba(99, 102, 241, 0.2)' : 'transparent',\r\n                            color: 'var(--text-primary, #f8fafc)',\r\n                            cursor: 'pointer',\r\n                            fontWeight: i === currentPage ? 'bold' : 'normal',\r\n                            minWidth: '32px'\r\n                          }}\r\n                        >\r\n                          {i}\r\n                        </button>\r\n                      );\r\n                    } else if (pages[pages.length - 1]?.key !== 'ellipsis-' + Math.floor(i / 10)) {\r\n                      // Add ellipsis if we skipped pages and haven't added one recently\r\n                      pages.push(\r\n                        <span key={`ellipsis-${Math.floor(i / 10)}`} style={{ padding: '0 4px', color: 'var(--text-secondary, #94a3b8)' }}>\r\n                          ...\r\n                        </span>\r\n                      );\r\n                    }\r\n                  }\r\n                  \r\n                  return pages;\r\n                })()}\r\n              </div>\r\n              \r\n              <button\r\n                onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\r\n                disabled={currentPage === totalPages}\r\n                style={{\r\n                  padding: '8px 12px',\r\n                  border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                  borderRadius: '6px',\r\n                  background: currentPage === totalPages ? 'rgba(148, 163, 184, 0.1)' : 'transparent',\r\n                  color: 'var(--text-primary, #f8fafc)',\r\n                  cursor: currentPage === totalPages ? 'not-allowed' : 'pointer',\r\n                  opacity: currentPage === totalPages ? '0.5' : '1'\r\n                }}\r\n              >\r\n                Next \r\n              </button>\r\n            </div>\r\n            \r\n            <select\r\n              value={pageSize}\r\n              onChange={(e) => {\r\n                setPageSize(parseInt(e.target.value));\r\n                setCurrentPage(1);\r\n              }}\r\n              style={{\r\n                padding: '8px',\r\n                border: '1px solid var(--border-color, rgba(148, 163, 184, 0.2))',\r\n                borderRadius: '6px',\r\n                background: 'var(--bg-primary, #0f172a)',\r\n                color: 'var(--text-primary, #f8fafc)',\r\n                cursor: 'pointer',\r\n                fontSize: '0.875rem'\r\n              }}\r\n            >\r\n              <option value={10}>10 per page</option>\r\n              <option value={25}>25 per page</option>\r\n              <option value={50}>50 per page</option>\r\n              <option value={100}>100 per page</option>\r\n            </select>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {(editingDevice || creatingDevice) && (\r\n        <div className=\"modal\">\r\n          <div className=\"modal-content\">\r\n            <h3>{editingDevice ? `Edit Device: ${editingDevice.device_serial}` : 'Register New Device'}</h3>\r\n            <form onSubmit={(e) => { e.preventDefault(); editingDevice ? handleSave() : handleCreate(); }}>\r\n              <div className=\"modal-body\">\r\n                \r\n                {/* Device Identity */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Device Identity</h4>\r\n                  <div className=\"form-grid\">\r\n                    <div className=\"form-group\">\r\n                      <label>Device Serial Number</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingDevice ? editForm.device_serial : createForm.device_serial}\r\n                        onChange={(e) => editingDevice ? setEditForm({...editForm, device_serial: e.target.value}) : setCreateForm({...createForm, device_serial: e.target.value})}\r\n                        required\r\n                        autoComplete=\"off\"\r\n                        placeholder=\"SN-12345678\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Ownership */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Ownership & Assignment</h4>\r\n                  <div className=\"form-grid\">\r\n                    <div className=\"form-group\">\r\n                      <label>Assigned User</label>\r\n                      <div style={{ position: 'relative' }} onClick={(e) => e.stopPropagation()}>\r\n                        <input\r\n                          type=\"text\"\r\n                          placeholder=\"Search and select user...\"\r\n                          value={userSearchTerm}\r\n                          onChange={(e) => {\r\n                            setUserSearchTerm(e.target.value);\r\n                            setShowUserDropdown(true);\r\n                          }}\r\n                          onFocus={() => setShowUserDropdown(true)}\r\n                          autoComplete=\"off\"\r\n                        />\r\n                        {(editingDevice ? editForm.user : createForm.user) && (\r\n                          <div style={{ marginTop: '8px', fontSize: '0.875rem', color: 'var(--text-secondary, #94a3b8)' }}>\r\n                            <strong>Selected:</strong> {users.find(u => u.username === (editingDevice ? editForm.user : createForm.user))?.first_name} {users.find(u => u.username === (editingDevice ? editForm.user : createForm.user))?.last_name} ({editingDevice ? editForm.user : createForm.user})\r\n                            <button\r\n                              type=\"button\"\r\n                              onClick={() => {\r\n                                if (editingDevice) {\r\n                                  setEditForm({...editForm, user: ''});\r\n                                } else {\r\n                                  setCreateForm({...createForm, user: ''});\r\n                                }\r\n                                setUserSearchTerm('');\r\n                              }}\r\n                              className=\"btn-icon btn-icon-danger\"\r\n                              style={{ marginLeft: '10px' }}\r\n                              title=\"Remove Assignment\"\r\n                            >\r\n                              \r\n                            </button>\r\n                          </div>\r\n                        )}\r\n                        {showUserDropdown && (\r\n                          <div style={{\r\n                            position: 'absolute',\r\n                            top: '100%',\r\n                            left: 0,\r\n                            right: 0,\r\n                            background: 'var(--bg-secondary, #0f172a)',\r\n                            border: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n                            borderRadius: '8px',\r\n                            maxHeight: '200px',\r\n                            overflowY: 'auto',\r\n                            zIndex: 1000,\r\n                            boxShadow: 'var(--shadow-xl)',\r\n                            marginTop: '4px'\r\n                          }}>\r\n                            {filteredUsers.length > 0 ? (\r\n                              filteredUsers.map((user) => (\r\n                                <div\r\n                                  key={user.id}\r\n                                  onClick={() => {\r\n                                    if (editingDevice) {\r\n                                      setEditForm({...editForm, user: user.username});\r\n                                    } else {\r\n                                      setCreateForm({...createForm, user: user.username});\r\n                                    }\r\n                                    setUserSearchTerm(`${user.first_name} ${user.last_name} (${user.username})`);\r\n                                    setShowUserDropdown(false);\r\n                                  }}\r\n                                  style={{\r\n                                    padding: '12px 16px',\r\n                                    cursor: 'pointer',\r\n                                    borderBottom: '1px solid var(--border-color, rgba(148, 163, 184, 0.1))',\r\n                                    background: (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent',\r\n                                    color: 'var(--text-primary, #f8fafc)',\r\n                                    transition: 'all 0.15s ease',\r\n                                    fontSize: '0.875rem'\r\n                                  }}\r\n                                  onMouseEnter={(e) => e.currentTarget.style.background = 'rgba(255, 255, 255, 0.06)'}\r\n                                  onMouseLeave={(e) => e.currentTarget.style.background = (editingDevice ? editForm.user : createForm.user) === user.username ? 'rgba(99, 102, 241, 0.15)' : 'transparent'}\r\n                                >\r\n                                  {user.first_name} {user.last_name} ({user.username}) <br/>\r\n                                  <span style={{ fontSize: '0.75rem', color: 'var(--text-secondary, #94a3b8)' }}>{user.email}</span>\r\n                                </div>\r\n                              ))\r\n                            ) : (\r\n                              <div style={{ padding: '12px 16px', color: 'var(--text-muted, #64748b)', fontSize: '0.875rem' }}>\r\n                                {userSearchTerm.trim() === '' ? 'Start typing to search users...' : 'No users found'}\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Configuration */}\r\n                <div className=\"form-section\">\r\n                  <h4 className=\"form-section-title\">Configuration</h4>\r\n                  <div className=\"form-grid form-grid-2\">\r\n                    <div className=\"form-group\">\r\n                      <label>Preset Template</label>\r\n                      <select\r\n                        value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                        onChange={(e) => editingDevice ? setEditForm({ ...editForm, config_version: e.target.value }) : setCreateForm({ ...createForm, config_version: e.target.value })}\r\n                        className=\"full-width\"\r\n                      >\r\n                        <option value=\"\">-- Manual Configuration --</option>\r\n                        {presetsLoading && <option value=\"\" disabled>Loading presets...</option>}\r\n                        {!presetsLoading && presets.map((preset) => (\r\n                          <option key={preset.id} value={getPresetConfigId(preset)}>\r\n                            {preset.name} ({getPresetConfigId(preset) || 'no ID'})\r\n                          </option>\r\n                        ))}\r\n                      </select>\r\n                      <small className=\"form-hint\">Selecting a preset sets the Config Version ID below.</small>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label>Config Version ID</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingDevice ? editForm.config_version : createForm.config_version}\r\n                        onChange={(e) => editingDevice ? setEditForm({...editForm, config_version: e.target.value}) : setCreateForm({...createForm, config_version: e.target.value})}\r\n                        autoComplete=\"off\"\r\n                        placeholder=\"Manual Config ID\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n              </div>\r\n              {editingDevice && (\r\n                <div style={{ padding: '0 24px' }}>\r\n                   <AuditTrail\r\n                     createdBy={editingDevice.created_by_username}\r\n                     createdAt={editingDevice.created_at}\r\n                     updatedBy={editingDevice.updated_by_username}\r\n                     updatedAt={editingDevice.updated_at}\r\n                   />\r\n                </div>\r\n              )}\r\n              <div className=\"form-actions\" style={{ padding: '24px' }}>\r\n                <button type=\"submit\" className=\"btn\">{editingDevice ? 'Save Changes' : 'Register Device'}</button>\r\n                <button type=\"button\" onClick={handleCancel} className=\"btn btn-secondary\">Cancel</button>\r\n              </div>\r\n            </form>\r\n        </div>\r\n      </div>\r\n    )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Devices;","/**\r\n * Enhanced in-memory cache service for API responses\r\n * Features:\r\n * - TTL-based expiration\r\n * - Stale-while-revalidate pattern support\r\n * - Subscription system for real-time updates\r\n * - Pattern-based cache invalidation\r\n */\r\n\r\ninterface CacheEntry {\r\n  data: any;\r\n  timestamp: number;\r\n  expiresIn: number; // milliseconds\r\n  staleTime?: number; // Time after which data is considered stale but usable\r\n}\r\n\r\ninterface CacheSubscription {\r\n  callback: (data: any) => void;\r\n  pattern?: RegExp;\r\n}\r\n\r\nclass CacheService {\r\n  private cache: Map<string, CacheEntry> = new Map();\r\n  private subscribers: Map<string, Set<CacheSubscription>> = new Map();\r\n  private static readonly DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes default\r\n  private static readonly LONG_TTL = 30 * 60 * 1000; // 30 minutes for static data\r\n  private static readonly REALTIME_TTL = 10 * 1000; // 10 seconds for real-time data\r\n  private static readonly STALE_TIME = 30 * 1000; // 30 seconds before data is stale\r\n\r\n  /**\r\n   * Set a cache entry and notify subscribers\r\n   */\r\n  set(key: string, data: any, ttlMs: number = CacheService.DEFAULT_TTL, staleTime?: number): void {\r\n    this.cache.set(key, {\r\n      data,\r\n      timestamp: Date.now(),\r\n      expiresIn: ttlMs,\r\n      staleTime: staleTime ?? Math.min(ttlMs / 2, CacheService.STALE_TIME),\r\n    });\r\n    \r\n    // Notify subscribers\r\n    this.notifySubscribers(key, data);\r\n  }\r\n\r\n  /**\r\n   * Get a cache entry if valid (returns null if expired)\r\n   */\r\n  get(key: string): any | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    // Check if expired\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return entry.data;\r\n  }\r\n\r\n  /**\r\n   * Get cache entry even if stale (for stale-while-revalidate pattern)\r\n   * Returns { data, isStale } or null if no entry exists\r\n   */\r\n  getWithStaleStatus(key: string): { data: any; isStale: boolean; isExpired: boolean } | null {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return null;\r\n\r\n    const now = Date.now();\r\n    const age = now - entry.timestamp;\r\n    const isExpired = age > entry.expiresIn;\r\n    const isStale = age > (entry.staleTime ?? entry.expiresIn / 2);\r\n\r\n    // Remove if fully expired\r\n    if (isExpired) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      data: entry.data,\r\n      isStale,\r\n      isExpired: false,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Check if key exists and is not expired\r\n   */\r\n  has(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return false;\r\n\r\n    const now = Date.now();\r\n    if (now - entry.timestamp > entry.expiresIn) {\r\n      this.cache.delete(key);\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Check if cached data is stale but usable\r\n   */\r\n  isStale(key: string): boolean {\r\n    const entry = this.cache.get(key);\r\n    if (!entry) return true;\r\n\r\n    const now = Date.now();\r\n    const age = now - entry.timestamp;\r\n    return age > (entry.staleTime ?? entry.expiresIn / 2);\r\n  }\r\n\r\n  /**\r\n   * Clear a specific cache entry\r\n   */\r\n  clear(key: string): void {\r\n    this.cache.delete(key);\r\n  }\r\n\r\n  /**\r\n   * Clear cache entries matching a pattern\r\n   */\r\n  clearPattern(pattern: string | RegExp): void {\r\n    const regex = typeof pattern === 'string' ? new RegExp(pattern) : pattern;\r\n    const keysToDelete: string[] = [];\r\n    \r\n    this.cache.forEach((_, key) => {\r\n      if (regex.test(key)) {\r\n        keysToDelete.push(key);\r\n      }\r\n    });\r\n    \r\n    keysToDelete.forEach(key => this.cache.delete(key));\r\n  }\r\n\r\n  /**\r\n   * Clear all cache entries\r\n   */\r\n  clearAll(): void {\r\n    this.cache.clear();\r\n  }\r\n\r\n  /**\r\n   * Get cache size\r\n   */\r\n  size(): number {\r\n    return this.cache.size;\r\n  }\r\n\r\n  /**\r\n   * Subscribe to cache updates for a specific key\r\n   */\r\n  subscribe(key: string, callback: (data: any) => void): () => void {\r\n    if (!this.subscribers.has(key)) {\r\n      this.subscribers.set(key, new Set());\r\n    }\r\n    \r\n    const subscription: CacheSubscription = { callback };\r\n    this.subscribers.get(key)!.add(subscription);\r\n\r\n    // Return unsubscribe function\r\n    return () => {\r\n      const subs = this.subscribers.get(key);\r\n      if (subs) {\r\n        subs.delete(subscription);\r\n        if (subs.size === 0) {\r\n          this.subscribers.delete(key);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Subscribe to cache updates matching a pattern\r\n   */\r\n  subscribePattern(pattern: RegExp, callback: (data: any) => void): () => void {\r\n    const key = `__pattern__${pattern.source}`;\r\n    if (!this.subscribers.has(key)) {\r\n      this.subscribers.set(key, new Set());\r\n    }\r\n    \r\n    const subscription: CacheSubscription = { callback, pattern };\r\n    this.subscribers.get(key)!.add(subscription);\r\n\r\n    return () => {\r\n      const subs = this.subscribers.get(key);\r\n      if (subs) {\r\n        subs.delete(subscription);\r\n        if (subs.size === 0) {\r\n          this.subscribers.delete(key);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Notify all subscribers of a cache update\r\n   */\r\n  private notifySubscribers(key: string, data: any): void {\r\n    // Direct key subscribers\r\n    const directSubs = this.subscribers.get(key);\r\n    if (directSubs) {\r\n      directSubs.forEach(sub => {\r\n        try {\r\n          sub.callback(data);\r\n        } catch (error) {\r\n          console.error(`Cache subscriber error for key ${key}:`, error);\r\n        }\r\n      });\r\n    }\r\n\r\n    // Pattern subscribers\r\n    this.subscribers.forEach((subs, subKey) => {\r\n      if (subKey.startsWith('__pattern__')) {\r\n        subs.forEach(sub => {\r\n          if (sub.pattern && sub.pattern.test(key)) {\r\n            try {\r\n              sub.callback(data);\r\n            } catch (error) {\r\n              console.error(`Cache pattern subscriber error for key ${key}:`, error);\r\n            }\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get all keys in cache\r\n   */\r\n  keys(): string[] {\r\n    return Array.from(this.cache.keys());\r\n  }\r\n\r\n  /**\r\n   * Get cache stats for debugging\r\n   */\r\n  getStats(): { size: number; keys: string[]; subscribers: number } {\r\n    return {\r\n      size: this.cache.size,\r\n      keys: this.keys(),\r\n      subscribers: Array.from(this.subscribers.values()).reduce((sum, set) => sum + set.size, 0),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get TTL constants\r\n   */\r\n  static getTTL(type: 'short' | 'long' | 'realtime' = 'short'): number {\r\n    switch (type) {\r\n      case 'realtime':\r\n        return CacheService.REALTIME_TTL;\r\n      case 'long':\r\n        return CacheService.LONG_TTL;\r\n      default:\r\n        return CacheService.DEFAULT_TTL;\r\n    }\r\n  }\r\n}\r\n\r\nexport const cacheService = new CacheService();\r\nexport const DEFAULT_TTL = 5 * 60 * 1000; // 5 minutes\r\nexport const LONG_TTL = 30 * 60 * 1000; // 30 minutes\r\nexport const REALTIME_TTL = 10 * 1000; // 10 seconds\r\n","import { cacheService, DEFAULT_TTL } from './cacheService';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'https://smart-solar-django-backend.vercel.app/api';\r\n\r\nclass ApiService {\r\n  private getAuthHeaders(): HeadersInit {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (tokens) {\r\n      try {\r\n        const parsedTokens = JSON.parse(tokens);\r\n        return {\r\n          'Authorization': `Bearer ${parsedTokens.access}`,\r\n          'Content-Type': 'application/json',\r\n        };\r\n      } catch (error) {\r\n        console.error('Error parsing auth tokens:', error);\r\n      }\r\n    }\r\n    return {\r\n      'Content-Type': 'application/json',\r\n    };\r\n  }\r\n\r\n  private async request(endpoint: string, options: RequestInit = {}): Promise<any> {\r\n    const url = `${API_BASE_URL}${endpoint}`;\r\n    let headers = this.getAuthHeaders();\r\n\r\n    let response = await fetch(url, {\r\n      ...options,\r\n      headers: {\r\n        ...headers,\r\n        ...options.headers,\r\n      },\r\n    });\r\n\r\n    if (response.status === 401) {\r\n      // Try to refresh token\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        // Retry with new token\r\n        headers = this.getAuthHeaders();\r\n        response = await fetch(url, {\r\n          ...options,\r\n          headers: {\r\n            ...headers,\r\n            ...options.headers,\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      // Token refresh failed or not attempted, logout\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`API request failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n    }\r\n\r\n    if (response.status === 204) return null;\r\n    return response.json();\r\n  }\r\n\r\n  private async refreshToken(): Promise<boolean> {\r\n    const tokens = localStorage.getItem('authTokens');\r\n    if (!tokens) return false;\r\n\r\n    try {\r\n      const parsedTokens = JSON.parse(tokens);\r\n      const response = await fetch(`${API_BASE_URL}/auth/token/refresh/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ refresh: parsedTokens.refresh }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        const newTokens = {\r\n          access: data.access,\r\n          refresh: parsedTokens.refresh, // Keep the same refresh token\r\n        };\r\n        localStorage.setItem('authTokens', JSON.stringify(newTokens));\r\n        return true;\r\n      }\r\n    } catch (error) {\r\n      console.error('Token refresh failed:', error);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  async getConfiguration(): Promise<any> {\r\n    return this.request('/config/');\r\n  }\r\n\r\n  async getTelemetry(): Promise<any[]> {\r\n    return this.request('/telemetry/');\r\n  }\r\n\r\n  async provisionDevice(data: any): Promise<any> {\r\n    const response = await fetch(`${API_BASE_URL}/devices/provision`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n    if (!response.ok) {\r\n      throw new Error(`Provisioning failed: ${response.statusText}`);\r\n    }\r\n    return response.json();\r\n  }\r\n\r\n  async getAlerts(): Promise<any[]> {\r\n    const cacheKey = 'alerts';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/alerts/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getSystemHealth(): Promise<any> {\r\n    const cacheKey = 'system_health';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/health/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getKPIs(): Promise<any> {\r\n    const cacheKey = 'kpis';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/kpis/');\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async getUsers(search?: string): Promise<any[]> {\r\n    const cacheKey = `users_${search || 'all'}`;\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    const data = await this.request(`/users/${params}`);\r\n    cacheService.set(cacheKey, data, DEFAULT_TTL);\r\n    return data;\r\n  }\r\n\r\n  async createUser(userData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(userData),\r\n    });\r\n    // Invalidate users cache\r\n    cacheService.clear('users_all');\r\n    cacheService.clearAll(); // Clear all cache for safety\r\n    return result;\r\n  }\r\n\r\n  async createEmployee(employeeData: any): Promise<any> {\r\n    const result = await this.request('/users/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ ...employeeData, is_staff: true }),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async getUserDevices(userId: number): Promise<any[]> {\r\n    return this.request(`/users/${userId}/devices/`);\r\n  }\r\n\r\n  async getUserSite(userId: number): Promise<any> {\r\n    return this.request(`/users/${userId}/site/`);\r\n  }\r\n\r\n  async createUserSite(userId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/users/${userId}/site/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async updateUserSite(userId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/users/${userId}/site/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async getDeviceSite(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/`);\r\n  }\r\n\r\n  async createDeviceSite(deviceId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async updateDeviceSite(deviceId: number, data: Record<string, unknown>): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/site/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // DynamoDB site data\r\n  async getSiteTelemetry(siteId: string, params?: { start_date?: string; end_date?: string; days?: number }): Promise<any[]> {\r\n    const query = new URLSearchParams();\r\n    if (params?.start_date) query.append('start_date', params.start_date);\r\n    if (params?.end_date) query.append('end_date', params.end_date);\r\n    if (params?.days) query.append('days', params.days.toString());\r\n    const url = `/sites/${siteId}/telemetry/${query.toString() ? '?' + query.toString() : ''}`;\r\n    return this.request(url);\r\n  }\r\n\r\n  async getSiteForecast(siteId: string, params?: { date?: string; start_date?: string; end_date?: string }): Promise<any[]> {\r\n    const query = new URLSearchParams();\r\n    if (params?.date) query.append('date', params.date);\r\n    if (params?.start_date) query.append('start_date', params.start_date);\r\n    if (params?.end_date) query.append('end_date', params.end_date);\r\n    const url = `/sites/${siteId}/forecast/${query.toString() ? '?' + query.toString() : ''}`;\r\n    return this.request(url);\r\n  }\r\n\r\n  async getSiteWeather(siteId: string): Promise<any> {\r\n    return this.request(`/sites/${siteId}/weather/`);\r\n  }\r\n\r\n  async updateUser(userId: number, data: any): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  async deleteUser(userId: number): Promise<any> {\r\n    const result = await this.request(`/users/${userId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('users_all');\r\n    return result;\r\n  }\r\n\r\n  // Profile Management (for current logged-in user)\r\n  async getProfile(): Promise<any> {\r\n    return this.request('/profile/');\r\n  }\r\n\r\n  async updateProfile(data: any): Promise<any> {\r\n    return this.request('/profile/update/', {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async changePassword(data: { current_password: string; new_password: string }): Promise<any> {\r\n    return this.request('/profile/change-password/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  // Customer Management (separate from staff users/employees)\r\n  async getCustomers(search?: string): Promise<any[]> {\r\n    const params = search ? `?search=${encodeURIComponent(search)}` : '';\r\n    return this.request(`/customers/${params}`);\r\n  }\r\n\r\n  async createCustomer(customerData: any): Promise<any> {\r\n    return this.request('/customers/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(customerData),\r\n    });\r\n  }\r\n\r\n  async getCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/`);\r\n  }\r\n\r\n  async updateCustomer(customerId: number, data: any): Promise<any> {\r\n    return this.request(`/customers/${customerId}/update/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteCustomer(customerId: number): Promise<any> {\r\n    return this.request(`/customers/${customerId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getPresets(): Promise<any[]> {\r\n    const cacheKey = 'presets';\r\n    const cached = cacheService.get(cacheKey);\r\n    if (cached) return cached;\r\n\r\n    const data = await this.request('/presets/');\r\n    // Use longer TTL for presets as they change less frequently\r\n    cacheService.set(cacheKey, data, 30 * 60 * 1000); // 30 minutes\r\n    return data;\r\n  }\r\n\r\n  async createPreset(data: any): Promise<any> {\r\n    const result = await this.request('/presets/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async updatePreset(id: number, data: any): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async deletePreset(id: number): Promise<any> {\r\n    const result = await this.request(`/presets/${id}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n    cacheService.clear('presets');\r\n    return result;\r\n  }\r\n\r\n  async getGlobalSlaves(): Promise<any[]> {\r\n    return this.request('/slaves/');\r\n  }\r\n\r\n  async createGlobalSlave(slaveData: any): Promise<any> {\r\n    return this.request('/slaves/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateGlobalSlave(slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteGlobalSlave(slaveId: number): Promise<any> {\r\n    return this.request(`/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getDevices(search?: string, page: number = 1, pageSize: number = 25): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    if (search) params.append('search', search);\r\n    params.append('page', page.toString());\r\n    params.append('page_size', pageSize.toString());\r\n    \r\n    const queryString = params.toString();\r\n    return this.request(`/devices/?${queryString}`);\r\n  }\r\n\r\n  async createDevice(deviceData: any): Promise<any> {\r\n    return this.request('/devices/create/', {\r\n      method: 'POST',\r\n      body: JSON.stringify(deviceData),\r\n    });\r\n  }\r\n\r\n  async updateDevice(deviceId: number, data: any): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async rebootDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/reboot/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  async hardResetDevice(deviceId: number): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/hard-reset/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  async getDeviceLogs(deviceId: number, limit: number = 100, offset: number = 0): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/logs/?limit=${limit}&offset=${offset}`);\r\n  }\r\n\r\n  async toggleDeviceLogs(deviceId: number, enabled: boolean): Promise<any> {\r\n    return this.request(`/devices/${deviceId}/logs/toggle/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ enabled }),\r\n    });\r\n  }\r\n\r\n  async deleteDevicesBulk(deviceIds: number[]): Promise<any> {\r\n    return this.request(`/devices/delete-bulk/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ device_ids: deviceIds }),\r\n    });\r\n  }\r\n\r\n  async getSlaves(configId: string): Promise<any[]> {\r\n    return this.request(`/presets/${configId}/slaves/`);\r\n  }\r\n\r\n  async createSlave(configId: string, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/create/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async updateSlave(configId: string, slaveId: number, slaveData: any): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(slaveData),\r\n    });\r\n  }\r\n\r\n  async deleteSlave(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async addSlavesToPreset(configId: string, slaveIds: number[]): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/add/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ slave_ids: slaveIds }),\r\n    });\r\n  }\r\n\r\n  async detachSlaveFromPreset(configId: string, slaveId: number): Promise<any> {\r\n    return this.request(`/presets/${configId}/slaves/${slaveId}/detach/`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  // OTA (Over-The-Air) Update Endpoints\r\n  async getFirmwareVersions(activeOnly: boolean = true): Promise<any> {\r\n    const params = new URLSearchParams();\r\n    params.append('active', activeOnly.toString());\r\n    return this.request(`/ota/firmware/?${params.toString()}`);\r\n  }\r\n\r\n  async uploadFirmwareVersion(formData: FormData): Promise<any> {\r\n    const url = `${API_BASE_URL}/ota/firmware/create/`;\r\n    const tokens = localStorage.getItem('authTokens');\r\n    \r\n    if (!tokens) {\r\n      throw new Error('Authentication required');\r\n    }\r\n    \r\n    const parsedTokens = JSON.parse(tokens);\r\n    let headers: HeadersInit = {\r\n      'Authorization': `Bearer ${parsedTokens.access}`,\r\n    };\r\n    // Don't set Content-Type - let browser set it with boundary for multipart/form-data\r\n    \r\n    let response = await fetch(url, {\r\n      method: 'POST',\r\n      headers,\r\n      body: formData,\r\n    });\r\n\r\n    // Handle 401 with token refresh\r\n    if (response.status === 401) {\r\n      const refreshSuccess = await this.refreshToken();\r\n      if (refreshSuccess) {\r\n        const newTokens = JSON.parse(localStorage.getItem('authTokens') || '{}');\r\n        headers = {\r\n          'Authorization': `Bearer ${newTokens.access}`,\r\n        };\r\n        response = await fetch(url, {\r\n          method: 'POST',\r\n          headers,\r\n          body: formData,\r\n        });\r\n      }\r\n    }\r\n\r\n    if (response.status === 401) {\r\n      localStorage.removeItem('authTokens');\r\n      localStorage.removeItem('authUser');\r\n      window.location.href = '/login';\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`Upload failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  async updateFirmwareVersion(firmwareId: number, data: any): Promise<any> {\r\n    return this.request(`/ota/firmware/${firmwareId}/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(data),\r\n    });\r\n  }\r\n\r\n  async deleteFirmwareVersion(firmwareId: number): Promise<any> {\r\n    return this.request(`/ota/firmware/${firmwareId}/delete/`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  async getDeviceUpdateLogs(deviceId: string): Promise<any> {\r\n    return this.request(`/ota/devices/${deviceId}/logs`);\r\n  }\r\n\r\n  async getOTAConfig(): Promise<any> {\r\n    return this.request(`/ota/config/`);\r\n  }\r\n\r\n  async updateOTAConfig(config: any): Promise<any> {\r\n    return this.request(`/ota/config/update/`, {\r\n      method: 'PATCH',\r\n      body: JSON.stringify(config),\r\n    });\r\n  }\r\n\r\n  async getOTAHealth(): Promise<any> {\r\n    return this.request(`/ota/health/`);\r\n  }\r\n\r\n  async triggerRollback(deviceSerial: string, notes?: string): Promise<any> {\r\n    return this.request(`/ota/updates/rollback/`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        device_serial: deviceSerial,\r\n        notes: notes || ''\r\n      }),\r\n    });\r\n  }\r\n}\r\n\r\nexport const apiService = new ApiService();"],"names":["AuditTrail","_ref","createdBy","createdAt","updatedBy","updatedAt","className","formatDate","dateString","Date","toLocaleString","_unused","_jsxs","children","_jsx","React","useDebouncedCallback","callback","delay","arguments","length","undefined","timeoutId","setTimeoutId","useState","debouncedCallback","useCallback","_len","args","Array","_key","clearTimeout","newTimeoutId","setTimeout","useEffect","fmt","ts","range","date","toLocaleTimeString","hour","minute","toLocaleDateString","weekday","month","day","fmtForecast","cleanTs","replace","_unused2","TOOLTIP_STYLE","background","border","borderRadius","color","boxShadow","fontSize","IconSun","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","cx","cy","r","x1","y1","x2","y2","IconBattery","x","y","rx","IconLoad","d","points","IconEnergy","IconCloud","KpiCard","label","value","unit","sub","accent","icon","style","padding","flex","minWidth","display","justifyContent","alignItems","marginBottom","fontWeight","textTransform","letterSpacing","fontFamily","concat","flexShrink","margin","lineHeight","marginLeft","_ref2","_latest$pv1_power_w","_latest$pv2_power_w","_latest$battery_soc_p","_latest$load_power_w","_latest$pv_today_kwh","siteId","autoRefresh","telemetry","setTelemetry","forecast","setForecast","weather","setWeather","loading","setLoading","error","setError","lastUpdated","setLastUpdated","dateRange","setDateRange","customStartDate","setCustomStartDate","customEndDate","setCustomEndDate","fetchAll","async","telemetryParams","forecastParams","start_date","toISOString","end_date","days","tel","fcst","wth","Promise","all","apiService","getSiteTelemetry","getSiteForecast","getSiteWeather","isArray","err","Error","message","id","setInterval","clearInterval","latest","pvKw","pv1_power_w","pv2_power_w","batSoc","battery_soc_percent","loadKw","load_power_w","todayKwh","pv_today_kwh","historyData","data","filter","_","i","buckets","Map","forEach","row","timestamp","hourKey","getFullYear","getMonth","getDate","getHours","has","set","get","push","from","values","map","bucket","first","reduce","sum","_r$pv1_power_w","_r$pv2_power_w","_r$load_power_w","grid_power_w","_r$grid_power_w","_r$battery_soc_percen","dayKey","_r$pv1_power_w2","_r$pv2_power_w2","_r$load_power_w2","_r$grid_power_w2","_r$battery_soc_percen2","Math","max","_r$pv_today_kwh","aggregateByPeriod","_row$pv1_power_w","_row$pv2_power_w","_row$load_power_w","_row$grid_power_w","_row$battery_soc_perc","time","toFixed","forecastData","p50","p50_kw","p10","p10_kw","p90","p90_kw","gap","flexWrap","marginTop","noData","onChange","e","target","cursor","_Fragment","type","onClick","textAlign","temperature_c","humidity_pct","cloud_cover_pct","wind_speed_ms","ghi_wm2","round","p","ResponsiveContainer","AreaChart","top","right","left","bottom","offset","stopColor","stopOpacity","CartesianGrid","strokeDasharray","XAxis","dataKey","interval","ceil","angle","textAnchor","YAxis","tickFormatter","v","Tooltip","contentStyle","formatter","name","includes","Legend","iconType","iconSize","wrapperStyle","Area","dot","Line","b","Devices","_users$find3","_users$find4","searchParams","useSearchParams","devices","setDevices","filteredDevices","setFilteredDevices","editingDevice","setEditingDevice","creatingDevice","setCreatingDevice","searchTerm","setSearchTerm","userSearchTerm","setUserSearchTerm","filteredUsers","setFilteredUsers","showUserDropdown","setShowUserDropdown","users","setUsers","selectedDevices","setSelectedDevices","Set","bulkDeleteLoading","setBulkDeleteLoading","currentPage","setCurrentPage","pageSize","setPageSize","totalCount","setTotalCount","totalPages","setTotalPages","presets","setPresets","presetsLoading","setPresetsLoading","health","setHealth","telemetrySummary","setTelemetrySummary","telemetryData","setTelemetryData","dashboardError","setDashboardError","selectedDevice","setSelectedDevice","deviceLogs","setDeviceLogs","logsLoading","setLogsLoading","editForm","setEditForm","device_serial","user","config_version","createForm","setCreateForm","siteDetails","setSiteDetails","siteLoading","setSiteLoading","editingSite","setEditingSite","siteForm","setSiteForm","site_id","display_name","latitude","longitude","capacity_kw","tilt_deg","azimuth_deg","timezone","is_active","siteSaving","setSiteSaving","siteError","setSiteError","devicePreset","setDevicePreset","fetchDevices","page","search","response","getDevices","results","count","total_pages","current_page","fetchDeviceLogs","getDeviceLogs","deviceId","logs","console","handleViewDevice","device","preset","find","config_id","getDeviceSite","then","catch","finally","customers","getUsers","is_staff","is_superuser","fetchUsers","getPresets","fetchPresets","healthData","getSystemHealth","getTelemetry","telemetryArray","currentLatest","item","itemDate","Number","isNaN","getTime","deviceCount","size","totalPoints","latestTimestamp","fetchDashboardData","deviceIdParam","parseInt","foundDevice","handleClickOutside","document","addEventListener","removeEventListener","trim","searchLower","toLowerCase","filtered","fullName","first_name","last_name","username","email","debouncedSearch","query","handleEdit","_users$find","_users$find2","u","handleSave","updateDevice","handleCreate","createDevice","handleCancel","handleBackToList","getPresetConfigId","_preset$gateway_confi","_preset$gateway_confi2","gateway_configuration","general_settings","_devicePreset$gateway","_devicePreset$gateway2","deviceTelemetry","entry","latestTelemetry","marginRight","window","confirm","rebootDevice","alert","handleReboot","backgroundColor","title","hardResetDevice","handleHardReset","deleteDevice","handleDeleteDevice","gridTemplateColumns","is_online","last_heartbeat","hw_id","model","gridColumn","pending_config_update","slaves_count","config_ack_ver","version","last_updated","config_acked_at","ackTime","diffMs","diffMins","floor","diffHours","diffDays","config_downloaded_at","provisioned_at","created_by_username","checked","logs_enabled","enabled","toggleDeviceLogs","_objectSpread","handleToggleLogs","overall_health","active_devices","total_devices","total_telemetry_points","data_type","String","SiteDataPanel","disabled","fontStyle","maxHeight","overflowY","log","paddingBottom","borderBottom","level","onSubmit","preventDefault","payload","parseFloat","updated","updateDeviceSite","createDeviceSite","required","placeholder","autoComplete","step","position","stopPropagation","onFocus","zIndex","transition","onMouseEnter","currentTarget","onMouseLeave","created_at","updated_by_username","updated_at","deviceList","Boolean","confirmMessage","join","deleteDevicesBulk","updatedDevices","opacity","handleSelectAll","allIds","newSelected","delete","add","handleSelectDevice","handleDelete","borderTop","min","pages","_pages","abs","key","CacheService","constructor","cache","subscribers","ttlMs","DEFAULT_TTL","staleTime","this","now","expiresIn","STALE_TIME","notifySubscribers","getWithStaleStatus","_entry$staleTime","age","isExpired","isStale","_entry$staleTime2","clear","clearPattern","pattern","regex","RegExp","keysToDelete","test","clearAll","subscribe","subscription","subs","subscribePattern","source","directSubs","subKey","startsWith","keys","getStats","getTTL","REALTIME_TTL","LONG_TTL","cacheService","API_BASE_URL","process","getAuthHeaders","tokens","localStorage","getItem","parsedTokens","JSON","parse","access","request","endpoint","options","url","headers","fetch","status","refreshToken","removeItem","location","href","ok","errorText","text","statusText","json","method","body","stringify","refresh","newTokens","setItem","getConfiguration","provisionDevice","getAlerts","cacheKey","cached","getKPIs","params","encodeURIComponent","createUser","userData","result","createEmployee","employeeData","getUserDevices","userId","getUserSite","createUserSite","updateUserSite","URLSearchParams","append","toString","updateUser","deleteUser","getProfile","updateProfile","changePassword","getCustomers","createCustomer","customerData","getCustomer","customerId","updateCustomer","deleteCustomer","createPreset","updatePreset","deletePreset","getGlobalSlaves","createGlobalSlave","slaveData","updateGlobalSlave","slaveId","deleteGlobalSlave","queryString","deviceData","limit","deviceIds","device_ids","getSlaves","configId","createSlave","updateSlave","deleteSlave","addSlavesToPreset","slaveIds","slave_ids","detachSlaveFromPreset","getFirmwareVersions","activeOnly","uploadFirmwareVersion","formData","updateFirmwareVersion","firmwareId","deleteFirmwareVersion","getDeviceUpdateLogs","getOTAConfig","updateOTAConfig","config","getOTAHealth","triggerRollback","deviceSerial","notes"],"sourceRoot":""}