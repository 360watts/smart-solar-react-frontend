"use strict";(self.webpackChunksmart_solar_frontend=self.webpackChunksmart_solar_frontend||[]).push([[578],{5578(e,s,a){a.r(s),a.d(s,{default:()=>i});var r=a(9379),l=a(5043),n=a(9066),t=a(5560),d=a(579);const i=()=>{const{user:e,updateUser:s}=(0,n.A)(),[a,i]=(0,l.useState)(null),[o,c]=(0,l.useState)(!0),[m,u]=(0,l.useState)(null),[p,h]=(0,l.useState)(null),[x,j]=(0,l.useState)(!1),[f,g]=(0,l.useState)(!1),[b,v]=(0,l.useState)({first_name:"",last_name:"",email:"",mobile_number:"",address:""}),[w,y]=(0,l.useState)({current_password:"",new_password:"",confirm_password:""});(0,l.useEffect)(()=>{_()},[]);const _=async()=>{try{c(!0);const e=await t.K.getProfile();i(e),v({first_name:e.first_name||"",last_name:e.last_name||"",email:e.email||"",mobile_number:e.mobile_number||"",address:e.address||""}),u(null)}catch(e){console.error("Profile fetch error:",e),u(e instanceof Error?e.message:"Failed to load profile")}finally{c(!1)}};return o?(0,d.jsx)("div",{className:"loading",children:"Loading profile..."}):(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{children:"My Profile"}),m&&(0,d.jsxs)("div",{className:"alert alert-error",style:{marginBottom:"20px",padding:"10px",backgroundColor:"#ffebee",color:"#c62828",borderRadius:"4px"},children:[m,(0,d.jsx)("button",{onClick:()=>u(null),style:{float:"right",background:"none",border:"none",cursor:"pointer"},children:"\xd7"})]}),p&&(0,d.jsx)("div",{className:"alert alert-success",style:{marginBottom:"20px",padding:"10px",backgroundColor:"#e8f5e9",color:"#2e7d32",borderRadius:"4px"},children:p}),(0,d.jsxs)("div",{className:"card",style:{marginBottom:"20px"},children:[(0,d.jsxs)("div",{className:"card-header",children:[(0,d.jsx)("h2",{children:"Account Information"}),!x&&(0,d.jsx)("button",{onClick:()=>j(!0),className:"btn",children:"Edit Profile"})]}),x?(0,d.jsxs)("form",{onSubmit:async a=>{a.preventDefault();try{const a=await t.K.updateProfile(b);i(a),j(!1),h("Profile updated successfully!"),s&&s((0,r.A)((0,r.A)({},e),{},{first_name:a.first_name,last_name:a.last_name,email:a.email})),setTimeout(()=>h(null),3e3)}catch(l){u(l instanceof Error?l.message:"Failed to update profile")}},style:{padding:"20px"},children:[(0,d.jsxs)("div",{className:"form-section",children:[(0,d.jsx)("h4",{className:"form-section-title",children:"Account Information"}),(0,d.jsx)("div",{className:"form-grid",children:(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Username"}),(0,d.jsx)("input",{type:"text",value:(null===a||void 0===a?void 0:a.username)||"",disabled:!0,className:"input-disabled"}),(0,d.jsx)("small",{className:"form-hint",children:"Username cannot be changed"})]})})]}),(0,d.jsxs)("div",{className:"form-section",children:[(0,d.jsx)("h4",{className:"form-section-title",children:"Personal Details"}),(0,d.jsxs)("div",{className:"form-grid form-grid-2",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"First Name"}),(0,d.jsx)("input",{type:"text",value:b.first_name,onChange:e=>v((0,r.A)((0,r.A)({},b),{},{first_name:e.target.value})),required:!0,placeholder:"John"})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Last Name"}),(0,d.jsx)("input",{type:"text",value:b.last_name,onChange:e=>v((0,r.A)((0,r.A)({},b),{},{last_name:e.target.value})),required:!0,placeholder:"Doe"})]})]})]}),(0,d.jsxs)("div",{className:"form-section",children:[(0,d.jsx)("h4",{className:"form-section-title",children:"Contact Information"}),(0,d.jsxs)("div",{className:"form-grid form-grid-2",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Email Address"}),(0,d.jsx)("input",{type:"email",value:b.email,onChange:e=>v((0,r.A)((0,r.A)({},b),{},{email:e.target.value})),required:!0,placeholder:"john.doe@example.com"})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Mobile Number"}),(0,d.jsx)("input",{type:"tel",value:b.mobile_number,onChange:e=>v((0,r.A)((0,r.A)({},b),{},{mobile_number:e.target.value})),placeholder:"+1 (555) 000-0000"})]}),(0,d.jsxs)("div",{className:"form-group full-width",children:[(0,d.jsx)("label",{children:"Address"}),(0,d.jsx)("textarea",{value:b.address,onChange:e=>v((0,r.A)((0,r.A)({},b),{},{address:e.target.value})),rows:3,placeholder:"123 Solar Street..."})]})]})]}),(0,d.jsxs)("div",{className:"form-actions",children:[(0,d.jsx)("button",{type:"submit",className:"btn",children:"Save Changes"}),(0,d.jsx)("button",{type:"button",onClick:()=>{j(!1),a&&v({first_name:a.first_name||"",last_name:a.last_name||"",email:a.email||"",mobile_number:a.mobile_number||"",address:a.address||""})},className:"btn btn-secondary",children:"Cancel"})]})]}):(0,d.jsx)("div",{style:{padding:"20px"},children:(0,d.jsx)("table",{className:"profile-table",style:{width:"100%",borderCollapse:"collapse"},children:(0,d.jsxs)("tbody",{children:[(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{style:{padding:"10px",fontWeight:"bold",width:"150px"},children:"Username:"}),(0,d.jsx)("td",{style:{padding:"10px"},children:null===a||void 0===a?void 0:a.username})]}),(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{style:{padding:"10px",fontWeight:"bold"},children:"Name:"}),(0,d.jsxs)("td",{style:{padding:"10px"},children:[null===a||void 0===a?void 0:a.first_name," ",null===a||void 0===a?void 0:a.last_name]})]}),(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{style:{padding:"10px",fontWeight:"bold"},children:"Email:"}),(0,d.jsx)("td",{style:{padding:"10px"},children:null===a||void 0===a?void 0:a.email})]}),(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{style:{padding:"10px",fontWeight:"bold"},children:"Mobile:"}),(0,d.jsx)("td",{style:{padding:"10px"},children:(null===a||void 0===a?void 0:a.mobile_number)||"-"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{style:{padding:"10px",fontWeight:"bold"},children:"Address:"}),(0,d.jsx)("td",{style:{padding:"10px"},children:(null===a||void 0===a?void 0:a.address)||"-"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{style:{padding:"10px",fontWeight:"bold"},children:"Role:"}),(0,d.jsx)("td",{style:{padding:"10px"},children:null!==a&&void 0!==a&&a.is_superuser?"Administrator":null!==a&&void 0!==a&&a.is_staff?"Employee":"User"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{style:{padding:"10px",fontWeight:"bold"},children:"Member Since:"}),(0,d.jsx)("td",{style:{padding:"10px"},children:null!==a&&void 0!==a&&a.date_joined?new Date(a.date_joined).toLocaleDateString():"-"})]})]})})})]}),(0,d.jsxs)("div",{className:"card",children:[(0,d.jsxs)("div",{className:"card-header",children:[(0,d.jsx)("h2",{children:"Security"}),!f&&(0,d.jsx)("button",{onClick:()=>g(!0),className:"btn",children:"Change Password"})]}),f?(0,d.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),w.new_password===w.confirm_password)if(w.new_password.length<8)u("Password must be at least 8 characters long");else try{await t.K.changePassword({current_password:w.current_password,new_password:w.new_password}),g(!1),y({current_password:"",new_password:"",confirm_password:""}),h("Password changed successfully!"),setTimeout(()=>h(null),3e3)}catch(s){u(s instanceof Error?s.message:"Failed to change password")}else u("New passwords do not match")},style:{padding:"20px"},children:[(0,d.jsxs)("div",{className:"form-group",style:{marginBottom:"15px"},children:[(0,d.jsx)("label",{children:"Current Password:"}),(0,d.jsx)("input",{type:"password",value:w.current_password,onChange:e=>y((0,r.A)((0,r.A)({},w),{},{current_password:e.target.value})),required:!0,autoComplete:"current-password"})]}),(0,d.jsxs)("div",{className:"form-group",style:{marginBottom:"15px"},children:[(0,d.jsx)("label",{children:"New Password:"}),(0,d.jsx)("input",{type:"password",value:w.new_password,onChange:e=>y((0,r.A)((0,r.A)({},w),{},{new_password:e.target.value})),required:!0,autoComplete:"new-password",minLength:8}),(0,d.jsx)("small",{style:{color:"#666"},children:"Must be at least 8 characters"})]}),(0,d.jsxs)("div",{className:"form-group",style:{marginBottom:"15px"},children:[(0,d.jsx)("label",{children:"Confirm New Password:"}),(0,d.jsx)("input",{type:"password",value:w.confirm_password,onChange:e=>y((0,r.A)((0,r.A)({},w),{},{confirm_password:e.target.value})),required:!0,autoComplete:"new-password"})]}),(0,d.jsxs)("div",{className:"form-actions",children:[(0,d.jsx)("button",{type:"submit",className:"btn",children:"Change Password"}),(0,d.jsx)("button",{type:"button",onClick:()=>{g(!1),y({current_password:"",new_password:"",confirm_password:""})},className:"btn btn-secondary",children:"Cancel"})]})]}):(0,d.jsxs)("div",{style:{padding:"20px"},children:[(0,d.jsx)("p",{children:"You can change your password here for security purposes."}),(0,d.jsx)("p",{style:{color:"#666",fontSize:"14px"},children:"It's recommended to use a strong password that you don't use on other websites."})]})]})]})}}}]);
//# sourceMappingURL=578.87bdf031.chunk.js.map